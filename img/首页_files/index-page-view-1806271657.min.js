/*! tms-performance - v0.0.1 - 2018-06-27 16:58 */
define("templates/assessment",[],function(){return this.JST=this.JST||{},this.JST["assessment/assessment-count-info-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="assessment-count-info">\n\t<span class="count-title">'+__e(_.langs("common","total"))+':</span>\n\t<span class="count-score-container disinblock fright">\n\t\t\t',_.each(stepScopreList,function(a){__p+='\n\t\t\t\t<span class="score-item disinblock">\n\t\t   \t\t\t<span class="disblock">\n\t\t   \t\t\t\t'+__e(a.UserId==OwnerInfo.UserId?_.langs("common","selfAssessment"):a.UserName)+'\n\t\t   \t\t\t</span>\n\t\t   \t\t\t<span class="disblock">\n\t\t           \t\t<strong>'+__e(a.Score?a.Score:"-")+"</strong>\n\t\t   \t\t\t</span>\n\t\t   \t\t</span>\n\t\t\t"}),__p+="\n\t</span>\t\n</div>\n\n";return __p},this.JST["assessment/assessment-link-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showPrev&&(__p+='\n<a href="'+__e(prevLink)+'"><span class="btn btn-gray btn-medium">'+__e(i18n.prevLink)+"</span></a>\n"),__p+="\n",showNext&&(__p+='\n<a href="'+__e(nextLink)+'"><span class="btn btn-gray btn-medium">'+__e(i18n.nextLink)+"</span></a>\n");return __p},this.JST["assessment/assessment-operate-view"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="operate-container">\n',InIframe?(__p+="\n\t",showAllOpen&&(__p+='\n\t\t<span class="btn btn-white btn-medium btnOpenAll ">'+(null==(__t=i18n.btnCloseAll)?"":__t)+"</span>\n\t"),__p+="\n"):(__p+="\n\t",2==Status||4==Status?(__p+="\n\t\t",showAllOpen&&(__p+='\n\t\t\t<span class="btn btn-white btn-medium btnOpenAll ">'+(null==(__t=i18n.btnCloseAll)?"":__t)+"</span>\n\t\t"),__p+='\n\t\t<span class="btn btn-gray btn-medium btnFeedBack">'+(null==(__t=i18n.btnFeedBack)?"":__t)+"</span>\n\t"):(__p+="\n\t\t",showAddKPI&&HasTask&&100910!=BSGlobal.tenantInfo.Id&&(__p+='\n\t\t\t<span class="btn btn-green btn-medium btnNewAdd">'+(null==(__t=i18n.btnNewAdd)?"":__t)+"</span>\n\t\t"),__p+="\n\t\t",showBindObject&&HasTask&&(__p+="\n\t\t\t",HasGoal&&(__p+='\n\t\t\t\t<span class="btn btn-white btn-medium btnBindObject">'+(null==(__t=i18n.btnBindObject)?"":__t)+"</span>\n\t\t\t"),__p+="\t\n\t\t\t",showBindObject2&&(__p+='\n\t\t\t\t<span class="btn btn-white btn-medium btnSelectFromObject">\n\t\t\t\t\t'+(null==(__t=i18n.btnSelectFromObject)?"":__t)+"\n\t\t\t\t</span>\n\t\t\t"),__p+="\t\n\t\t"),__p+="\n\t\t",showBatchWeight&&HasTask&&1==BatchWeightChange&&(__p+='\n\t\t\t<span class="btn btn-white btn-medium btnWeightChange">\n\t\t\t\t'+(null==(__t=i18n.btnWeightChange)?"":__t)+"\n\t\t\t</span>\n\t\t"),__p+="\n\t\t",showAllOpen&&(__p+="\n\t\t\t",5==CurrentStepTypeId&&HasTask?__p+='\n\t\t\t\t<span class="btn btn-white btn-medium btnOpenAll ">'+(null==(__t=i18n.btnOpenAll)?"":__t)+"</span>\n\t\t\t":__p+='\n\t\t\t\t<span class="btn btn-white btn-medium btnOpenAll ">'+(null==(__t=i18n.btnCloseAll)?"":__t)+"</span>\n\t\t\t",__p+="\n\t\t"),__p+='\n\t\t<span class="btn btn-gray btn-medium btnFeedBack">'+(null==(__t=i18n.btnFeedBack)?"":__t)+"</span>\n\t\t",2==CurrentStepTypeId&&HasTask&&ShowSumMoudule&&1==QuickEstimate&&(__p+='\n\t\t\t<span class="btn btn-gray btn-medium btnScore">'+(null==(__t=i18n.btnScore)?"":__t)+"</span>\n\t\t"),__p+="\n\t"),__p+="\n"),__p+="\n</div>";return __p},this.JST["assessment/assessment-operation-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)6==CurrentStepTypeId&&Assessment.HasTask?(__p+="\n\t",3==Assessment.Status&&(__p+='\n\t\t<span class="btn btn-green btn-medium btn-commit">'+__e(i18n.commit)+"</span>\n\t"),__p+="\n"):(__p+="\n\t ",7!=CurrentStepTypeId&&Assessment.HasTask&&HandIsOperate-0==1&&(__p+="\n\t\t",3!=Assessment.Status||IsHideSubmitButton||(__p+='\n\t\t\t<span class="btn btn-green btn-medium btn-commit">'+__e(i18n.commit)+"</span>\n\t\t"),__p+="\n\t\t","1"==IsRollback&&CurrentStepIndex>1&&4!=Assessment.Status&&(__p+='\n\t\t\t<span class="btn btn-gray btn-medium btn-reback">'+__e(i18n.reject)+"</span>\n\t\t"),__p+="\n\t\t\n\t"),__p+="\n"),__p+="\n";return __p},this.JST["assessment/assessment-operation-warn"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)6==CurrentStepTypeId&&Assessment.HasTask||(__p+="\n\t\t",5==CurrentStepTypeId&&IsHideSubmitButton&&(__p+='\n\t\t\t<span class="hideSubmitButtonWarn">'+__e(i18n.warnHideSubmitButton)+"</span>\n\t\t"),__p+="\n");return __p},this.JST["assessment/back-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="module-dialog" style="width:'+__e(width)+"px;height:"+__e(height)+'px;">\n\t<a class="dialog-btn dialog-close simplemodal-close"></a>\n\t<div class="dialog_header" >\n\t\t'+__e(title)+'\n\t</div>\n\t<div class="dialog_body" style="height:'+__e(inHeight)+'px;">\n\t\t<ul class="feedperson-form">\n\t\t\t<li class="form-item">\n\t\t\t\t<span class="item_label fleft">'+__e(i18n.appriUser)+'</span>\n\t\t\t\t<span class="item_content input-appraiser input-text new-input-appraiser">\n\t\t\t\t\t<span class="add-person"><span></span></span>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="form-item">\n\t\t\t<span class="item_label fleft">'+__e(i18n.appriContent)+'</span>\n\t\t\t<span class="item_content">\n\t\t\t\t<div class="list-body app-content">\n\t\t\t\t\t<ul class="list_data">\n\t\t\t\t\t',_.each(moduleList,function(a,b){__p+='\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t  <div class="title">\n\t\t\t\t\t\t  \t \n\t\t\t\t\t\t\t\t<span class="checkbox checkbox_uncheck" data-id=\''+__e(a.Id)+"' data-parent='true'>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t  \t "+__e(a.Name)+'\n\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t  <ul data-id="'+__e(a.Id)+'" class="list_item_back">\n\t\t\t\t\t\t\t',_.each(a.GoalList,function(a,b){__p+='\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<span class="checkbox checkbox_uncheck" data-id=\''+__e(a.Id)+"' data-type='0' data-parent='false'></span>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t"+__e(a.Name)+"\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t\t  </ul>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+='\n\t\t\t\t\t<ul>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="form-item">\n\t\t\t\t<span class="item_label fleft">'+__e(i18n.emailContext)+'</span>\n\t\t\t\t<span class="form-content item_content disinblock">\n\t\t\t\t\t<textarea>'+__e(i18n.emailDefaultContextPre)+__e(userName)+(null==(__t=i18n.emailDefaultContextSuf)?"":__t)+'</textarea>\n\t\t\t\t\t<span class="str-len">0/200</span>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="form-item">\n\t\t\t\t<span class="item_label fleft">'+__e(i18n.isRate)+'</span>\n\t\t\t\t<span class="item_content off6-0">\n\t\t\t\t\t<span class="checkbox checkbox_checked isScore"></span>'+__e(i18n.isRateTip)+'\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="form-item clearfix">\n\t\t\t\t<span class="item_label fleft">'+__e(i18n.isShowType)+'</span>\n\t\t\t\t<span class="item_content off6-0">\n\t\t\t\t\t<span class="radio radio_checked isShow" data-value="0"></span>\n\t\t\t\t\t\t'+__e(i18n.realApprise)+'\n\t\t\t\t\t<span class="radio radio_uncheck isShow" data-value="1"></span>\n\t\t\t\t\t\t'+__e(i18n.anonymousApprise)+'\n\t\t\t\t\t<span class="radio radio_uncheck isShow" data-value="2"></span>\n\t\t\t\t\t\t'+__e(i18n.evaluatedPersonAnonymousApprise)+'\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</div><div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-blue btn-sure">'+__e(yesText)+'</span>\n\t\t<span class="btn btn-small btn-white btn-cancel simplemodal-close">'+__e(noText)+"</span>\n\t</div>\n</div>";return __p},this.JST["assessment/copyobject-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="module-dialog" style="width:'+__e(width)+"px;height:"+__e(height)+'px;">\n    <a class="dialog-btn dialog-close simplemodal-close"></a>\n\t<div class="dialog_header">\n\t\t'+__e(title)+'\n\t</div>\n\t<div class="dialog_body" style="height:'+__e(inHeight)+'px;">\n\t\t<div class="select-header copyObjectMangment">\n\t\t\t<span class="date-period yearList"></span>\n\t\t\t<span class="date-period periodList"></span>\n\t\t\t<span class="date-period statusList"></span>\n\t\t\t\n\t\t</div>\n\t\t<div class="list-body">\n\t\t\n\t\t</div>\n\t\t<div class="select-module">\n\t\t\t<span class="disinblock fleft">'+__e(i18n.copyTo)+'：</span>\n\t\t\t<span class="select-container fleft fuzhidao">\n\t\t\t</span>\n\t\t</div>\n\t</div><div class="dialog_operation clearfix">\n\t\t<span class="btn btn-small btn-blue btn-sure">'+__e(_.langs("common","submit"))+'</span>\n\t\t<span class="btn btn-small btn-white btn-cancel simplemodal-close">'+__e(_.langs("common","cancel"))+"</span>\n\t</div>\n</div>";return __p},this.JST["assessment/copytarget-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="module-dialog" style="width:'+__e(width)+"px;height:"+__e(height)+'px;">\n\t<a class="dialog-btn dialog-close simplemodal-close"></a>\n\t<div class="dialog_body" style="height:'+__e(inHeight)+'px;">\n\t\t<div class="module-header">\n\t\t\t<span class="title current" data-type="0">'+__e(i18n.copyFromZhibiao)+'</span>\n\t\t\t<span class="title" data-type="1">'+__e(i18n.copyFromAssessment)+'</span>\n\t\t</div>\n\t\t<div class="activity-select" style="display:none;">\n\t\t\t<span class="select-container fleft fuzhidao">\n\t\t\t</span>\n\t\t\t<span class="fleft m10" style="margin-top:10px;">\n\t\t\t\t<span class="checkbox checkbox_uncheck copyTask" style="vertical-align:middle;">\n\t\t\t\t</span>\n\t\t\t\t'+__e(i18n.copyTask)+'\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="list-body">\n\t\t\t',0==respData.length&&(__p+='\n\t\t\t\t<div class="empty-data">\n\t\t\t\t\t'+__e(i18n.noTarget)+"\n\t\t\t\t</div>\n\t\t\t"),__p+='\n\t\t</div>\n\t\t<div class="select-module">\n\t\t\t<span class="disinblock fleft">'+__e(i18n.copyTo)+'：</span>\n\t\t\t<span class="select-container fuzhidao fleft">\n\t\t\t</span>\n\t\t</div>\n\t</div><div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-blue btn-sure">'+__e(_.langs("common","submit"))+'</span>\n\t\t<span class="btn btn-small btn-white btn-cancel simplemodal-close">'+__e(_.langs("common","cancel"))+"</span>\n\t</div>\n</div>";return __p},this.JST["assessment/copytask-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="module-dialog" style="width:'+__e(width)+"px;height:"+__e(height)+'px;">\n\t<a class="dialog-btn dialog-close simplemodal-close"></a>\n\t<div class="dialog_header">\n\t\t'+__e(title)+'\n\t</div>\n\t<div class="dialog_body copy-task-container" style="height:'+__e(inHeight)+'px;">\n\t\t<div class="activity-select" style="margin-left: 40px;">\n\t\t\t<span class="select-container fleft fuzhidao" >\n\t\t\t\t\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="list-body">\n\t\t\t\n\t\t</div>\n\t</div><div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-blue btn-sure">\n\t\t\t'+(null==(__t=_.langs("common","submit"))?"":__t)+'\n\t\t</span>\n\t\t<span class="btn btn-small btn-white btn-cancel simplemodal-close">\n\t\t\t'+(null==(__t=_.langs("common","cancel"))?"":__t)+"\n\t\t</span>\n\t</div>\n</div>";return __p},this.JST["assessment/create-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="module-dialog" style="width:'+__e(width)+"px;min-height:"+__e(height)+'px;">\n\t<a class="dialog-btn dialog-close simplemodal-close"></a>\n\t<div class="dialog_header">\n\t\t'+__e(title)+'aaaa\n\t</div>\n\t<div class="dialog_body" style="height:'+__e(inHeight)+'px;overflow-y:auto;margin-top:0px;">\n\t\t<div class="form_items">\n\t\t\t\n\t\t\t\t<ul class="form_item_list">\n\t\t\t\t<li>\n\t\t\t\t\t<span class="form_item_name"></span>\n\t\t\t\t\t<span class="form_name_content input-text">\n\t\t\t\t\t   ',name==i18n.targetNameTip||""==name?__p+='\n\t\t\t\t\t\t  <input type="text" name="name" class="input_objective_name" maxlength="50" value="您的目标是什么？" />\n\t\t\t\t\t\t   <span class="warning-tip" >'+__e(_.langs("common","required"))+"</span>\n\t\t\t\t\t\t":__p+='\n\t\t\t\t\t\t   <input type="text" name="name" class="input_objective_name hasval" maxlength="50" '+__e("1"==typeId||"0"==currentModule.FieldRight.Property?"disabled":"")+'  value="'+__e(name)+'"/>\n\t\t\t\t\t\t   <span class="warning-tip" style="display:none;">'+__e(_.langs("common","required"))+"</span>\n\t\t\t\t\t\t",__p+='\n\t\t\t\t\t\t<span class="period-tooltip" title="起止日期:'+__e(startDate.replace(/-/g,"/"))+"--"+__e(endDate.replace(/-/g,"/"))+'"></span>\n\t\t\t\t\t</span>\n\n\t\t\t\t</li>\n\t\t\t\t<li class="clearfix">\n\t\t\t\t\t<span class="form_label" style="text-align:right">'+__e(i18n.weight)+'：</span>\n\t\t\t\t\t<span class="form_item w400 display-inbl">\n\t\t\t\t\t\t<input '+__e("0"==currentModule.FieldRight.Weight?"disabled":"")+'  type="text"  class="input-weight hasval" value="'+__e(_.toFixed(weight))+'">   %\n\t\t\t\t\t\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li class="dropDownList">\n\n\t\t\t\t\t<span class="form_label fleft form_label_module" \n\t\t\t\t\tstyle="margin: 0 6px 0 0;text-align:right" >'+__e(i18n.module)+'：</span>\n\t\t\t\t\t<span class="form_item form_item_module select-container-create '+(null==(__t=name.length>0?"edit":"create")?"":__t)+' disinblock fuzhidao">\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li style="display:none">\n\t\t\t\t\t<span class="form_label">'+__e(i18n.dateline)+'：</span>\n\t\t\t\t\t<span class="form_item form_item_time">\n\t\t\t\t\t\t<input type="text" class="datetime startDate hasval" value="'+__e(startDate.replace(/\./g,"-"))+'">\n\t\t\t\t\t\t<span class="dot">......</span>\n\t\t\t\t\t\t<input type="text" class="datetime endDate hasval" value="'+__e(endDate.replace(/\./g,"-"))+'">\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t',"1"==typeId?__p+='\n\t\t\t\t\t<li class="clearfix" '+__e("1"==MinimumValue.IsAdopt?"":"style= display:none")+'>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span class="form_label" style="text-align:right">'+__e(i18n.minimumValue)+'：</span>\n\t\t\t\t\t\t\t<span class="form_item display-inbl">\n\t\t\t\t\t\t\t\t<input type="text" class="lianghvinput  hasval" value="'+__e(MinimumValue.Value)+'" '+__e("0"==currentModule.FieldRight.ObjectiveType?"disabled":"")+' id="bdz">\n\t\t\t\t\t\t\t\t\t'+__e(Unit)+'\n\t\t\t\t\t\t\t</span>    \n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class="clearfix" '+__e("1"==ItemValue.IsAdopt?"":"style= display:none")+'>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span class="form_label" style="text-align:right" >'+__e(i18n.itemValue)+'：</span>\n\t\t\t\t\t\t\t<span class="form_item display-inbl">\n\t\t\t\t\t\t\t\t<input type="text" class="lianghvinput  hasval" id="mbz" '+__e("0"==currentModule.FieldRight.ObjectiveType?"disabled":"")+' value="'+__e(ItemValue.Value)+'">\n\t\t\t\t\t\t\t\t'+__e(Unit)+'\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class="clearfix" '+__e("1"==ChallengeValue.IsAdopt?"":"style= display:none")+'>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span class="form_label" style="text-align:right" >'+__e(i18n.challengeValue)+'：</span>\n\t\t\t\t\t\t\t\t<span class="form_item display-inbl">\n\t\t\t\t\t\t\t\t\t<input type="text" class="lianghvinput  hasval" id="tzz" '+__e("0"==currentModule.FieldRight.ObjectiveType?"disabled":"")+' value="'+__e(ChallengeValue.Value)+'">\n\t\t\t\t\t\t\t\t\t'+__e(Unit)+'\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class="clearfix" '+__e(1!=currentStepTypeId&&6!=currentStepTypeId?"":"style=display:none")+'>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span class="form_label" style="text-align:right" >'+__e(i18n.completeValue)+'：</span>\n\t\t\t\t\t\t\t\t<span class="form_item display-inbl">\n\t\t\t\t\t\t\t\t<input type="text" class="lianghvinput  hasval" id="wcz" '+__e(1==currentModule.FieldRight.CompleteValue&&1==CompleteValueSource?"":"disabled")+' value="'+__e(CompleteValue)+'">\n\t\t\t\t\t\t\t\t\t\t'+__e(Unit)+"\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t":__p+="\n\t\t\t\t\t\n\t\t\t\t\t\n\n\t\t\t\t",__p+='\n\t\t\t\t<li class="clearfix">\n\t\t\t\t\t<span class="form_label" style="text-align:right;position:relative;top:-34px;" >'+__e(i18n.description)+'：</span>\n\t\t\t\t\t\n\t\t\t\t\t<span class="form_item w400 display-inbl form_cc">\n\t\t\t\t\t\t',description==i18n.descriptionTip||""==description?__p+='\n\t\t\t\t\t\t  \t<textarea class="inner" '+__e("1"==typeId||"0"==currentModule.FieldRight.Property?"disabled ":"")+"  >"+__e(i18n.descriptionTip)+'</textarea>\n\t\t\t\t\t\t\t<span class="str-len">0/4000</span>\n\t\t\t\t\t\t':__p+='\n\t\t\t\t\t\t   \t<textarea  class="hasval inner"  '+__e("1"==typeId||"0"==currentModule.FieldRight.Property?"disabled ":"")+"  >"+__e(description)+'</textarea>\n\t\t\t\t\t\t\t<span class="str-len">'+__e(description.length)+"/4000</span>\n\t\t\t\t\t\t",__p+='\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\n\t\t</div>\n\t\t<div class="form_items last_item">\n\t\t\t\n\t\t</div>\n\t</div><div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-blue btn-sure">\n\t\t\t'+__e(_.langs("common","submit"))+'\n\t\t</span>\n\t\t<span class="btn btn-small btn-white btn-cancel simplemodal-close">\n\t\t\t'+__e(_.langs("common","cancel"))+"\n\t\t</span>\n\t</div>\n</div>";return __p},this.JST["assessment/feed-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+="";return __p},this.JST["assessment/history-panel-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+="<li>"+(null==(__t=Message)?"":__t)+"</li>\n";return __p},this.JST["assessment/index-page"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="perform-detail" style="position:relative;display: none" >\n\t\n\t',InIframe||(__p+='\n\t<a class="btn btn-medium btn-green fright back-home" href="javascript:void(0);">\n\t\t'+__e(i18n.backTodo)+'\n\t</a>\n\t<div class="topView">\n\t\t\x3c!-- 顶部视图渲染区域 --\x3e\n\t</div>\n\n\t<div class="user-info">\n\t\t\x3c!-- 用户信息视图渲染区域 --\x3e\n\t</div>\n\t<div class="work-flowlist">\n\t\t\x3c!-- 绩效流程视图渲染区域 --\x3e\n\t</div>\n\t'),__p+='\n\t<div class="assessment-operate">\n\n\t\t\x3c!-- 考核项操作按钮视图渲染区域 --\x3e\n\n\t</div>\n\t<div class="module-list">\n\t\t\x3c!-- 模块列表视图渲染区域 --\x3e\n\t</div>\n\t<div class="assessment-count-region">\n\t\t\x3c!-- 合计内容渲染区域 --\x3e\n\t</div>\n\t\x3c!--\n\t<div class="signconfirm-module-region signconfirm-module clearfix">\n\t\t\n\t</div>\n\t<div class="overview-module-region signconfirm-module">\n\t\t\n\t</div>\n\t--\x3e\n\t<div class="largeWeightModule-region signconfirm-module clearfix">\n\t\t\x3c!-- 考核总览 签字确认 和大权重的自定义模块渲染区域--\x3e\n\t</div>\n\t',InIframe||(__p+='\n\t<div class="assessment-operation clearfix">\n\t\t<span class="assessment-operation-commit-region">\n\t\t\t\n\t\t</span>\n\t\t<span class="assessment-link-region">\n\t\t\n\t\t</span>\n\t\t\n\t</div>\n\t<div class="assessment-operation-warn">\n\t\t\n\t\t\n\t</div>\n\n\t\n\t \x3c!-- 右侧视图渲染区域 --\x3e\n\t<div class="right-container-region">\n\t</div>\n\t\x3c!--沟通反馈--\x3e\n\t<div class="ps-details-container" style="display:none;">\n\t\t<div>\n\t\t\t<div class="title_tita_widget _per_kk">\n\t\t\t\t<label>'+__e(_.langs("common","feedback"))+'</label>\n\t\t\t\t<a href="javascript:void(0)" class="close_communicate">\n\t\t\t\t\t'+__e(_.langs("common","closeCommunicate"))+'\t\n\t\t\t\t</a>\n\t\t\t</div>\n\t\t\t<div class="outcontent_tita_widget">\n\t\t\t\t\n\t\t\t\t<h2 title=""></h2>\n\t\t\t</div>\n\t\t\t<div class="content_tita_widget">\n\n\t\t\t\t<iframe id="iframe_sepm_tita_widget"  width="100%" height="100%" frameborder="0" src=""></iframe>\n\n\t\t\t</div>\n\t\t</div>\n\t</div>\n\t'),__p+="\n</div>";return __p},this.JST["assessment/key-result-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+=' <li class="list-kr">\n    <div class="kr-left">'+(null==(__t=Name)?"":__t)+'</div>\n    <div class="kr-right">\n        <span class="kr-info progerss-bar">\n            <div class="progressColor">\n                <div class="goal-progerss-1  goal-progerss-status-1" \n                style="width:'+__e(Progress)+'%"> \n                </div>\n                <div class="timeColor" style="width:'+__e(timesPross)+'%"></div>\n                <div class="progerss-value kr-number">'+(null==(__t=Progress)?"":__t)+'%</div>\n            </div>\n        </span>\n        <span class="kr-info kr-number">'+(null==(__t=EndDate)?"":__t)+'</span>\n        <span class="kr-info">'+(null==(__t=OwnerName)?"":__t)+"</span>\n    </div>\n</li>\n\n";return __p},this.JST["assessment/linkcaret-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="link-caret">\n\t',OwnerInfo.UserId==Talent.Context.getUserInfo().UserId?__p+='\n\t\t<a href="#myhome" class="link">'+(null==(__t=i18n.myPerformance)?"":__t)+"</a> \n\t":__p+='\n\t\t<a href="#myhome?userId='+__e(OwnerInfo.UserId)+'" class="link">'+__e(OwnerInfo.Name)+(null==(__t=i18n.performanceEnd)?"":__t)+"</a>\n\t",__p+="\n\t&nbsp;>>&nbsp;"+__e(Assessment.Name)+'\n</div>\n<div class="activity-page-title">\n\t<span class="activity-name" title="'+__e(Assessment.Name)+'">\n\t\t'+__e(Assessment.Name)+"\n\t</span>\n\t",Show360Link&&I360Link&&(__p+='\n\t    <a class="btn btn-gray btn-medium" href="'+__e(I360Link)+'" target="_blank">'+__e(i18n.watch360Link)+"\n\t    </a>\n\t"),__p+="\n</div>\n\n\n";return __p},this.JST["assessment/module-item-addsub"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="module-title" id="'+__e(Id)+'">\n\t\x3c!-- 模块状态视图渲染区域--\x3e\n</div>\n<div class="target-list">\n\x3c!-- Target Region--\x3e\n</div>\n',1!=FieldRight.Property||InIframe||(__p+='\n<div class="add-quick-target">\n\t<a href="javascript:void(0)" class="link quick_add_addsubmodel">'+__e(i18n.addSubModule)+"</a>\n\t\n</div>\n"),__p+="\n\n\n\n";return __p},this.JST["assessment/module-item-custom"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n\t<div class="module-title" id="'+__e(Id)+'" >\n\t\x3c!-- 模块状态视图渲染区域--\x3e\n</div>\n<div class="target-list">\n\x3c!-- Target Region--\x3e\n</div>\n\n\n\n\n';return __p},this.JST["assessment/module-item-state"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){__p+="\n\t";var _msg="",_goalLen=GoalList.length;_msg=4==ModuleType?"（ "+i18n.summary+" ）":5==ModuleType?"（本模块为加减分模块,加减分结果直接对总分生效）":1==WeightType?1==ScoreMethod?"（ "+i18n.static(_goalLen)+" ）":"（ "+i18n.staticA(_goalLen,NumWeight)+" ）":0==WeightType?"（ "+i18n.normal(_goalLen)+" ）":"（ "+i18n.staticB(_goalLen)+" ）",0==RelType&&6!=ModuleType||(_msg=""),5==ModuleType&&"104232"==BSGlobal.tenantInfo.Id&&(_msg=""),__p+='\n\n\t<div style="display:inline-block;max-width:300px;" title="'+__e(Name)+" "+__e(_msg)+'" >\n\t\t<span class="module-name disinblock" style="overflow: hidden;\n\t\t    text-overflow: ellipsis;\n\t\t    width:100%;\n\t\t    white-space: nowrap;\n\t\t    padding-left: 20px">\n\t\t\t\t'+__e(Name)+'\n\t\t\t\t\n\t\t</span>\n\n\t</div>\n\t<span class="module-desc" style="color:#AAA !important;font-size:12px;">\n\t\t'+__e(_msg)+"\n\t</span>\n\t\n",6!=ModuleType&&(__p+="\n\t",4!=ModuleType&&5!=ModuleType&&1!=RelType&&Assessment.HasTask&&!InIframe&&(__p+='\n\n\t\t<span class="fright sort-order " style="margin-left:10px;">\n\t\t\t'+__e(i18n.sort)+'\n\t\t\t<a href="javascript:;" class="iconfont icon-xiangshang-copy iconfont-arrow-down" >\n\t\t    </a>\t\n\t\t    <div class="disinblock pd-down-list sort-order">\n\n\t\t\t\t<ul class="list-ul-box dp-list-front">\n\t\t\t\t\t',2!=WeightType&&(__p+='\n\t\t\t\t\t\t<li class="dp-list-item">\n\t\t\t\t\t\t\t<a href="javascript:;" class="sort-weight "  index="1">'+__e(i18n.sortByWeight)+"</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"),__p+='\n\t\t\t\t\t\n\t\t\t\t\n\t\t\t\t\t<li class="dp-list-item">\n\t\t\t\t\t\t<a href="javascript:;" class="sort-time"  index="0">'+__e(i18n.sortByTime)+'</a></li>\n\t\t\t\t\n\t\t\t\t\t<li class="dp-list-item">\n\t\t\t\t\t\t<a href="javascript:;"  class="sortable-btn" index="2">'+__e(i18n.sortByCustom)+'</a></li>\n\t\t\t\t\n\t\t\t\t</ul>\n\n\t\t\t\t<ul class="list-ul-box dp-list-shadow" style="display: none;">\n\t\t\t\t\t\n\t\t\t\t\t\t<li class="item-0 li-scale" item-index="0">\n\t\t\t\t\t\t\t<a href="">\n\t\t\t\t\t\t\t\t'+__e(i18n.sortByWeight)+'\n\t\t\t\t\t\t\t</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\n\t\t\t\t\t\t<li class="item-1" item-index="1"><a href="">'+__e(i18n.sortByTime)+'</a></li>\n\t\t\t\t\t\n\t\t\t\t\t\t<li class="item-2" item-index="2"><a href="">'+__e(i18n.sortByCustom)+"</a></li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</span>\n\t\t\n\t\t\n\t\t\n\t\t\n\t\n\t"),__p+="\n\n\t\n",5!=ModuleType&&2!=WeightType&&(__p+='\n\t<span class="module-weight disinblock">\n\t\t'+__e(i18n.weight)+'<strong class="totalWeight">'+__e(Weight?_.toFixed(Weight,2):Weight)+"</strong>%\n\t</span>\n"),__p+="\n",Score==undefined&&null==Score||2==WeightType||(__p+="\n\t\t\n\n\t",showModuleScore?(__p+="\n\t\t",""==$.trim(Score)?__p+="\n\n\t\t\n\t\t":__p+='\n\t\t<span class="module-score">\n\t\t\t'+__e(i18n.score)+':<strong class="moduleScore">'+__e(Score)+"</strong>\n\t\t</span>\n\t\t",__p+="\n\t"):__p+='\n\t\t<span class="module-score" style="display:none">\n\t\t\t'+__e(i18n.score)+":<strong>"+__e(Score)+"</strong>\n\t\t</span>\n\t",__p+="\t\n\t\t\n"),__p+="\n",5==ModuleType&&(__p+='\n\t<div class="addAndSubLimit">\n\t\t',Limit&&(__p+='\n\t\t\t<span>模块得分限制：<span class="moduleLimit">'+__e(Limit)+"</span></span>\n\t\t"),__p+="\n\t</div>\t\n"),__p+="\n\n"),__p+="\n\t"}return __p},this.JST["assessment/module-item-summy"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="module-title" id="'+__e(Id)+'">\r\n\t\x3c!-- 模块状态视图渲染区域--\x3e\r\n</div>\r\n<div class="target-list">\r\n\x3c!-- Target Region--\x3e\r\n</div>\r\n\r\n\r\n\r\n\r\n';return __p},this.JST["assessment/module-item-thirdmodules"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="epmtothird-module">\r\n\t<div class="module-title">\r\n\t<span class="module-name disinblock">\r\n\t\t'+__e(Name)+'\r\n\t</span>\r\n\t<span class="module-weight disinblock">\r\n\t\t'+__e(i18n.weight)+'<strong class="totalWeight">'+__e(_.toFixed(Weight,2))+"%</strong>\r\n\t</span>\r\n\t",Score&&(__p+="\r\n\r\n\t\t",showModuleScore?__p+='\r\n\t\t\t<span class="module-score">\r\n\t\t\t\t'+__e(i18n.score)+"<strong>"+__e(_.toFixed(Score,2))+"</strong>\r\n\t\t\t</span>\r\n\t\t":__p+='\r\n\t\t\t<span class="module-score">\r\n\t\t\t\t\r\n\t\t\t</span>\r\n\t\t',__p+="\r\n\r\n\t"),__p+='\r\n</div>\r\n<div class="module-count">\r\n\t',ForeignObject?(__p+='\r\n\t<div class="module-info">\r\n\t\t\r\n\t\t<span class="obj-name obj-item disinblock">\r\n\t\t\t<strong>'+__e(ForeignObject.Name)+'</strong>\r\n\t\t</span>\r\n\t\t<span class="score-container disinblock fright">\r\n\t\t\t',ForeignObject.RateScore&&(__p+='\r\n\t\t\t\t<span class="disinblock">\r\n\t\t\t\t\t<strong>'+__e(ForeignObject.RateScore)+"分</strong>\r\n\t\t\t\t</span>\r\n\t\t\t"),__p+='\r\n\t\t\t<span class="disinblock">\r\n\t\t\t\t<strong>'+__e(ForeignObject.ScoreParameter)+"</strong>\r\n\t\t\t</span>\r\n\t\t</span>\r\n\t</div>\r\n\t"):__p+='\r\n\t<div class="module-info">\r\n\t\t<span class="obj-name obj-item disinblock" >\r\n\t\t\t'+__e(i18n.no360Result)+"\r\n\t\t</span>\r\n\t</div>\r\n\t",__p+="\r\n</div>\r\n</div>";return __p},this.JST["assessment/module-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n\t<div class="module-title" id="'+__e(Id)+'" data-score="'+__e(FieldRight.RateScore)+'" data-weight="'+__e(FieldRight.Weight)+'">\n\t\x3c!-- 模块状态视图渲染区域--\x3e\n</div>\n<div class="target-list">\n\x3c!-- Target Region--\x3e\n</div>\n\x3c!-- 判断可优化 --\x3e\n',"simple"!=mode&&"all"!=mode&&GoalList.length>0&&(0!=FieldRight.Weight||0!=FieldRight.RateScore)&&(__p+="\n",("weightChange"!=mode||0!=FieldRight.Weight&&2!=WeightType)&&(__p+='\n<div class="module-count" >\n\t\t',("quickScore"==mode&&1==FieldRight.RateScore||"weightChange"==mode&&1==FieldRight.Weight)&&(__p+="\n\t\t\t",2!=WeightType&&(__p+='\n\t\t\t\t<div class="module-info js-module-info">\n\t\t\t\t\t<span class="obj-name obj-item disinblock">\n\t\t\t\t\t\t<strong>'+__e(_.langs("common","total"))+"：</strong>\n\t\t\t\t\t</span>\n\t\t\t\t\t",100!=CurrentStepTypeId&&1==FieldRight.Property?__p+='\n\t\t\t\t\t<span class="score-container disinblock fright" style="margin-right:60px;">\n\t\t\t\t\t\n\t\t\t\t\t':__p+='\n\t\t\t\t\t<span class="score-container disinblock fright">\n\t\t\t\t\t',__p+="\n\t\t\t\t\t\t",_.each(WeightScoreList,function(a,b){__p+="\n\t\t\t\t\t\t\t",1==WeightShow&&(__p+='\n\t\t\t\t\t\t\t\t<span class="disinblock">\n\t\t\t\t\t\t\t\t\t<strong class="person-score" style="margin-left:10px">'+__e(_.toFixed(a.ScoreCount,2))+"</strong>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t"),__p+="\n\t\t\t\t\t\t"}),__p+='\n\t\t\t\t\t\t<span class="disinblock">\n\t\t\t\t\t\t\t<strong></strong>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class="disinblock count-weight">\n\t\t\t\t\t\t\t<strong>'+__e(goalWeightCount)+"%</strong>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t</div>\n\t\t\t"),__p+='\n\t\t\t\n\t\t\t<div class="module-operate clearfix" >\n\t\t\t\t<span class="fright">\n\t\t\t\t\t<span class="btn btn-white btn-small btn-cancel">'+__e(_.langs("common","cancel"))+"</span>\n\t\t\t\t\t","quickScore"==mode?__p+='\n\t\t\t\t\t   <span class="btn btn-blue btn-small btn-sure" data-handlar="upScore">'+__e(_.langs("common","submit"))+"</span>\n\t\t\t\t\t":"weightChange"==mode?(__p+="\n\t\t\t\t\t\t",0==FieldRight.Weight?__p+='\n\t\t\t\t\t\t\t <span class="btn btn-blue btn-small  btn-cancel" id="batch_bs_sure" tipName="">'+__e(_.langs("common","submit"))+"</span>\n\t\t\t\t\t\t":__p+='\n\t\t\t\t\t\t\t<span class="btn btn-blue btn-small btn-sure" id="batch_bs_sure" data-handlar="upWeight">'+__e(_.langs("common","submit"))+"</span>\n\t\t\t\t\t\t",__p+="\n\t\t\t\t\t \n\t\t\t\t\t"):__p+='\n\t\t\t\t\t\t<span class="btn btn-blue btn-small btn-sure" data-handlar="upWeight">'+__e(_.langs("common","submit"))+"</span>\n\t\t\t\t\t",__p+="\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t"),__p+="\n\n\n</div>\n"),__p+="\n"),__p+="\n\n\n",6!=CurrentStepTypeId&&100!=CurrentStepTypeId&&1==FieldRight.Property&&Assessment.HasTask&&(__p+="\n",InIframe||7==ModuleType||(__p+='\n<div class="add-quick-target">\n\t',100910==BSGlobal.tenantInfo.Id&&0==ModuleType||(__p+='\n\t\t<span class="object-image"></span>\n\t\t<a href="javascript:void(0)" class="link quick_add_target">'+__e(i18n.fastAddTarget)+'</a>\n\t\t<div class="add_target_container" style="display: none;">\n\t\t\t<input type="text" name="target_name" class="input-txt">\n\t\t\t<span class="btn btn-blue btn-small btn-sure">'+__e(_.langs("common","submit"))+'</span>\n\t\t\t<span class="btn btn-white btn-small btn-cancel">'+__e(_.langs("common","cancel"))+"</span>\n\t\t</div>\n\t"),__p+="  \n\t\n</div>\n"),__p+="\n"),__p+='\n<div class="sort-customize-status">\n\n</div>\n';return __p},this.JST["assessment/overview-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){if(__p+='\n\n<div class="module-title assessment-overview clearfix">\n\t<span class="module-name disinblock ">\n\t\t'+__e(OverviewModule.ModuleName||i18n.overviewModule.title)+"\n\t\t",InIframe&&(__p+='\n\t\t<span class="historyContainer">\n\t\t\t<span class="historyShow" title="点击查看变更历史"></span>\n\t\t</span>\t\n\t\t'),__p+='\n\t</span>\n\t\n</div>\n\n\n\n<div class="module-content assessment-overview clearfix">\n\t<ul class="form-list-overview">\n\t\t',"add"==OverviewStatus){if(__p+="\n\t\t\t\t",OverviewModule.AssessmentResultShow&&(__p+='\n\t\t\t\t\t<li class="form-select pad12">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<span class="form-label">'+(null==(__t=i18n.overviewModule.score)?"":__t)+"</span>\n\t\t\t\t\t\t",""==OverviewModule.RateScore||"undefined"==OverviewModule.RateScore?__p+="\n\t\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t\t<strong class='colorGray calcScore'>"+__e(_.langs("assessment","overviewModule","empty"))+"</strong>\n\t\t\t\t\t\t</span><strong class=\"score-unit\" style='display:none;'>"+__e(i18n.overviewModule.scoreUnit)+"</strong>\n\n\t\t\t\t\t\t":__p+="\n\t\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t\t<strong class='colorGray calcScore'>"+__e(_.toFixed(OverviewModule.RateScore,2))+'</strong>\n\t\t\t\t\t\t</span><strong class="score-unit" >'+__e(i18n.overviewModule.scoreUnit)+"</strong>\n\t\t\t\t\t\t",__p+="\n\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\t\t\t\t","1"==OverviewModule.IsModifyScore&&(__p+='\n\t\t\t\t<li class="form-select pad12">\n\t\t\t\t\t\n\t\t\t\t\t<span class="label-hand">'+(null==(__t=i18n.overviewModule.changeScore)?"":__t)+'</span>\n\t\t\t\t\t<strong class="js_change_input"><input type="text" class="input-text hand-input" '+(null==(__t=textdisabled?"disabled":"")?"":__t)+' value="'+__e(OverviewModule.ChangeScore?_.toFixed(OverviewModule.ChangeScore,2):"")+'"/><strong class="score-unit">'+__e(i18n.overviewModule.scoreUnit)+"</strong>\n\t\t\t\t\t</strong>\n\t\t\t\t\t",OverviewModule.LowerScore&&(__p+="<span  class='overflow-range'>（"+__e(i18n.common.scoreRange)+"："+__e(OverviewModule.LowerScore||"-")+" ~ "+__e(OverviewModule.UpperScore||"-")+"）</span>\n\t\t\t\t\t"),__p+="\n\t\t\t\t\t\n\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\t\t\t\t",OverviewModule.FinalScoreShow&&(__p+='\n\t\t\t\t\t<li class="form-select pad12">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<span class="form-label">'+(null==(__t=i18n.overviewModule.finalScore)?"":__t)+"</span>\n\t\t\t\t\t\t",""==OverviewModule.FinalScore||"undefined"==OverviewModule.FinalScore?__p+="\n\t\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t\t<strong class='colorRed finalScore'>"+__e(_.langs("assessment","overviewModule","empty"))+"</strong>\n\t\t\t\t\t\t</span><strong class=\"score-unit\" style='display:none;'>"+__e(i18n.overviewModule.scoreUnit)+"</strong>\n\n\t\t\t\t\t\t":__p+="\n\t\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t\t<strong class='colorRed finalScore'>"+__e(_.toFixed(OverviewModule.FinalScore,2))+'</strong>\n\t\t\t\t\t\t</span><strong class="score-unit" >'+__e(i18n.overviewModule.scoreUnit)+"</strong>",__p+="\n\t\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\t\t\n\t\t\t\t",1==OverviewModule.AssessmentClassNeed&&ShowGrade){__p+='\n\t\t\t\t\t<li class="form-select pad12">\n\n\t\t\t\t\t\t<span class="form-label">'+__e(i18n.overviewModule.grade)+'</span>\n\n\t\t\t\t\t\t<span class="grade-container">\n\t\t\t\t\t\t\t';var gradeLenth=OverviewModule.GradeList.length;if(gradeLenth>0){__p+="\n\t\t\t\t\t\t\t\t";for(var i=gradeLenth-1;i>=0;i--){var item=OverviewModule.GradeList[i];item.Value==OverviewModule.AssessmentClass&&""!=OverviewModule.AssessmentClassName?__p+='\n\t\t\t\t\t\t\t\t\t<span class="grade-item-active" original-title=\''+__e(_.escape2(item.Description))+"' data-name=\""+__e(item.Name)+'" \n\t\t\t\t\t\t\t\t\t\tdata-kid="'+__e(item.Id)+'" data-description="'+__e(item.Description)+'"\n\t\t\t\t\t\t\t\t\t\tdata-value="'+__e(item.Value)+'">\n\n\t\t\t\t\t\t\t\t\t\t'+__e(item.Name)+"\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t":__p+='\n\t\t\t\t\t\t\t\t\t<span class="grade-item" original-title=\''+__e(_.escape2(item.Description))+"'  data-description=\""+__e(item.Description)+'"\n\t\t\t\t\t\t\t\t\t\tdata-name="'+__e(item.Name)+'"  data-kid="'+__e(item.Id)+'" data-value="'+__e(item.Value)+'">\n\t\t\t\t\t\t\t\t\t\t'+__e(item.Name)+"\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t",__p+="\n\t\t\t\t\t\t\t\t\t"}__p+="\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t"}else __p+="\n\t\t\t\t\t\t\t\t<strong class='colorGray '>"+__e(_.langs("assessment","overviewModule","empty"))+"</strong>\t\n\t\t\t\t\t\t\t";__p+="\n\t\t\t\t\t</li>\n\t\t\t\t"}__p+="\t\n\t\t\t\t",OverviewModule.AllcommentNeed&&OverviewModule.RateStatementShow&&(__p+='\n\n\t\t\t\t\t<li class="form-select">\n\t\t\t\t\t\t<span class="form-label">\n\t\t\t\t\t\t\t',OverviewModule.AllcommentWriteIn&&(__p+='\n\t\t\t\t\t\t\t<span class="must-fill">*</span>\n\t\t\t\t\t\t\t'),__p+="\n\t\t\t\t\t\t\t"+__e(i18n.overviewModule.comment)+'</span>\n\t\t\t\t\t\t\t<span class="form-content disinblock">\n\t\t\t\t\t\t\t\t<textarea '+(null==(__t=commentDisabled?"disabled":"")?"":__t)+' class="comment hasval">'+__e(OverviewModule.RateStatement)+'</textarea>\n\t\t\t\t\t\t\t\t<span class="str-len">'+__e(OverviewModule.RateStatement.length)+"/500</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\t\t\t\t",OverviewModule.DevelopmentPlanNeed&&OverviewModule.DevelopmentPlanShow&&(__p+='\n\t\t\t\t\t<li class="form-select">\n\t\t\t\t\t\t<span class="form-label">\n\t\t\t\t\t\t\t',OverviewModule.DevelopmentPlanWriteIn&&(__p+='\n\t\t\t\t\t\t\t<span class="must-fill">*</span>\n\t\t\t\t\t\t\t'),__p+=__e(i18n.overviewModule.plan)+'</span>\n\t\t\t\t\t\t\t<span class="form-content disinblock">\n\t\t\t\t\t\t\t\t<textarea '+(null==(__t=devPlanDisabled?"disabled":"")?"":__t)+'  class="developPlan hasval">'+__e(OverviewModule.DevelopmentPlan)+'</textarea>\n\t\t\t\t\t\t\t\t<span class="str-len">'+__e(OverviewModule.DevelopmentPlan.length)+"/500</span>\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\t\t\t\t",4!=Assessment.Status&&(__p+="\n\t\t\t\t\t",(OverviewModule.DevelopmentPlanNeed||OverviewModule.AllcommentNeed||OverviewModule.AssessmentClassNeed||"1"==OverviewModule.IsModifyScore)&&(__p+='\n\t\t\t\t\t<li class="form-select">\n\t\t\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t\t\t<span class="form-content">\n\t\t\t\t\t\t\t<span class="btn btn-blue btn-small add-overflow">\n\t\t\t\t\t\t\t\t'+__e(_.langs("common","save"))+"\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</li>\n\t\t\t\t\t"),__p+="\n\t\t\t\t"),__p+="\n\t\t"}else if("edit"==OverviewStatus){if(__p+="\n\t\t\t\t<label "+__e(OverviewStatus)+" ></label>\n\t\t\t\t",OverviewModule.AssessmentResultShow&&(__p+='\n\t\t\t\t<li class="form-select pad12">\n\t\t\t\t\t<span class="form-label">'+(null==(__t=i18n.overviewModule.score)?"":__t)+"</span>\t\n\t\t\t\t\t",""==OverviewModule.RateScore||"undefined"==OverviewModule.RateScore?__p+="\n\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t<strong class='colorGray calcScore'>"+__e(_.langs("assessment","overviewModule","empty"))+"</strong>\n\t\t\t\t\t</span><strong class=\"score-unit\" style='display:none;'>"+__e(i18n.overviewModule.scoreUnit)+"</strong>\n\t\t\t\t\t\n\t\t\t\t\t":__p+="\n\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t<strong class='colorGray calcScore'>"+__e(_.toFixed(OverviewModule.RateScore,2))+'</strong>\n\t\t\t\t\t</span><strong class="score-unit" >'+__e(i18n.overviewModule.scoreUnit)+"</strong>",__p+="\n\t\t\t\t</li>\n\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\t\t\t\t","1"==OverviewModule.IsModifyScore&&(__p+='\n\t\t\t\t<li class="form-select pad12">\n\n\t\t\t\t\t<span class="label-hand">'+(null==(__t=i18n.overviewModule.changeScore)?"":__t)+'</span>\n\t\t\t\t\t<strong class="js_change_input"><input type="text" class="input-text hand-input" '+(null==(__t=textdisabled?"disabled":"")?"":__t)+' value="'+__e(OverviewModule.ChangeScore?_.toFixed(OverviewModule.ChangeScore,2):"")+'"/><strong class="score-unit">'+__e(i18n.overviewModule.scoreUnit)+"</strong>\n\t\t\t\t</strong>",OverviewModule.LowerScore&&(__p+="<span  class='overflow-range'>（"+__e(i18n.common.scoreRange)+"："+__e(OverviewModule.LowerScore||"-")+" ~ "+__e(OverviewModule.UpperScore||"-")+"）</span>\n\t\t\t\t\t"),__p+="\n\n\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\t\t\t\t",OverviewModule.FinalScoreShow&&(__p+='\n\t\t\t\t\t<li class="form-select pad12">\n\n\t\t\t\t\t\t<span class="form-label">'+(null==(__t=i18n.overviewModule.finalScore)?"":__t)+"</span>\n\t\t\t\t\t\t",""==OverviewModule.FinalScore||"undefined"==OverviewModule.FinalScore?__p+="\n\t\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t\t<strong class='colorRed finalScore'>"+__e(_.langs("assessment","overviewModule","empty"))+"</strong>\n\t\t\t\t\t\t</span><strong class=\"score-unit\" style='display:none;'>"+__e(i18n.overviewModule.scoreUnit)+"</strong>\n\n\t\t\t\t\t\t":__p+="\n\t\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t\t<strong class='colorRed finalScore'>"+__e(_.toFixed(OverviewModule.FinalScore,2))+'</strong>\n\t\t\t\t\t\t</span><strong class="score-unit">'+__e(i18n.overviewModule.scoreUnit)+"</strong>",__p+="\n\t\t\t\t</li>\n\t\t\t\t\t</li>\t\n\t\t\t\t"),__p+="\n\t\t\t\t\t",1==OverviewModule.AssessmentClassNeed&&ShowGrade){__p+='\n\t\t\t\t\t<li class="form-select pad12">\n\n\t\t\t\t\t\t<span class="form-label">'+__e(i18n.overviewModule.grade)+'</span>\n\n\t\t\t\t\t\t<span class="grade-container">\n\t\t\t\t\t\t\t';var gradeLenth=OverviewModule.GradeList.length;if(gradeLenth>0){__p+="\n\n\t\t\t\t\t\t\t";for(var i=OverviewModule.GradeList.length-1;i>=0;i--){var item=OverviewModule.GradeList[i];__p+="\n\t\t\t\t\t\t\t\t",item.Name==OverviewModule.AssessmentClassName&&""!=OverviewModule.AssessmentClassName?__p+='\n\t\t\t\t\t\t\t\t<span class="grade-item-active" original-title=\''+__e(item.Description)+"' data-name=\""+__e(item.Name)+'" data-kid="'+__e(item.Id)+'" data-description="'+__e(item.Description)+'" data-value="'+__e(item.Value)+'">\n\t\t\t\t\t\t\t\t\t'+__e(item.Name)+"\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t":__p+='\n\t\t\t\t\t\t\t\t<span class="grade-item" original-title=\''+__e(item.Description)+"' data-name=\""+__e(item.Name)+'" data-description="'+__e(item.Description)+'" data-kid="'+__e(item.Id)+'" data-value="'+__e(item.Value)+'">\n\t\t\t\t\t\t\t\t\t'+__e(item.Name)+"\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t",__p+="\n\t\t\t\t\t\t\t\t"}__p+="\n\t\t\t\t\t\t\t\t"}else __p+="\n\t\t\t\t\t\t\t\t<strong class='colorGray '>"+__e(_.langs("assessment","overviewModule","empty"))+"</strong>\t\n\t\t\t\t\t\t\t\t";__p+="\n\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t</li>\n\n\t\t\t\t\t\t"}__p+="\n\n\t\t\t\t\t\t",OverviewModule.AllcommentNeed&&OverviewModule.RateStatementShow&&(__p+='\n\t\t\t\t\t\t<li class="form-select">\n\t\t\t\t\t\t\t<span class="form-label">',OverviewModule.AllcommentWriteIn&&(__p+='\n\t\t\t\t\t\t\t\t<span class="must-fill">*</span>\n\t\t\t\t\t\t\t\t'),__p+=__e(i18n.overviewModule.comment)+'</span>\n\t\t\t\t\t\t\t\t<span class="form-content disinblock">\n\t\t\t\t\t\t\t\t\t<textarea '+(null==(__t=commentDisabled?"disabled":"")?"":__t)+' class="comment hasval" >'+__e(OverviewModule.RateStatement)+'</textarea>\n\t\t\t\t\t\t\t\t\t<span class="str-len">'+__e(OverviewModule.RateStatement.length)+"/500</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t"),__p+="\n\t\t\t\t\t\t\t",OverviewModule.DevelopmentPlanNeed&&OverviewModule.DevelopmentPlanShow&&(__p+='\n\t\t\t\t\t\t\t<li class="form-select">\n\t\t\t\t\t\t\t\t<span class="form-label">',OverviewModule.DevelopmentPlanWriteIn&&(__p+='\n\t\t\t\t\t\t\t\t\t<span class="must-fill">*</span>\n\t\t\t\t\t\t\t\t\t'),__p+=__e(i18n.overviewModule.plan)+'</span>\n\t\t\t\t\t\t\t\t\t<span class="form-content disinblock">\n\t\t\t\t\t\t\t\t\t\t<textarea '+(null==(__t=devPlanDisabled?"disabled":"")?"":__t)+' class="developPlan hasval" >'+__e(OverviewModule.DevelopmentPlan)+'</textarea>\n\t\t\t\t\t\t\t\t\t\t<span class="str-len">'+__e(OverviewModule.DevelopmentPlan.length)+"/500</span>\n\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t"),__p+="\n\t\t\t\t\t\t\t\t",(4!=Assessment.Status||InIframe)&&(__p+='\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<li class="form-select">\n\t\t\t\t\t\t\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t\t\t\t\t\t\t<span class="form-content">\n\t\t\t\t\t\t\t\t\t\t\t<span class="btn btn-blue btn-small add-overflow">\n\t\t\t\t\t\t\t\t\t\t\t\t'+__e(_.langs("common","save"))+'\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t\t<span class="btn btn-white btn-small cancel-overflow">\n\t\t\t\t\t\t\t\t\t\t\t\t'+__e(_.langs("common","cancel"))+"\n\t\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t"),__p+="\n\t\t"}else __p+="\n\t\t\t\t",OverviewModule.AssessmentResultShow&&(__p+='\n\t\t\t\t\t<li class="form-select pad12">\n\n\t\t\t\t\t\t<span class="form-label">'+(null==(__t=i18n.overviewModule.score)?"":__t)+"</span>\n\t\t\t\t\t\t",""==OverviewModule.RateScore||"undefined"==OverviewModule.RateScore?__p+="\n\t\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t\t<strong class='colorGray calcScore' "+__e(OverviewStatus)+">"+__e(_.langs("assessment","overviewModule","empty"))+"</strong>\n\t\t\t\t\t\t</span><strong class=\"score-unit\" style='display:none;'>"+__e(i18n.overviewModule.scoreUnit)+"</strong>\n\t\t\t\t\t\t":__p+="\n\t\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t\t<strong class='colorGray calcScore'>"+__e(_.toFixed(OverviewModule.RateScore,2))+'</strong>\n\t\t\t\t\t\t</span><strong class="score-unit">'+__e(i18n.overviewModule.scoreUnit)+"</strong>\n\t\t\t\t\t\t",__p+="\n\t\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\t\t\t\t\t","1"==OverviewModule.IsModifyScore&&OverviewModule.ChangeScore&&(__p+='\n\t\t\t\t\t<li class="form-select pad12">\n\n\t\t\t\t\t\t<span class="label-hand">'+(null==(__t=i18n.overviewModule.changeScore)?"":__t)+'</span>\n\t\t\t\t\t\t<strong class="js_change_input"><span class="inline-block">'+__e(OverviewModule.ChangeScore?_.toFixed(OverviewModule.ChangeScore,2):"")+'</span><strong class="score-unit">'+__e(i18n.overviewModule.scoreUnit)+"</strong>\n\t\t\t\t\t</strong>",OverviewModule.LowerScore&&(__p+="<span  class='overflow-range'>（"+__e(i18n.common.scoreRange)+"："+__e(OverviewModule.LowerScore||"-")+" ~ "+__e(OverviewModule.UpperScore||"-")+"）</span>\n\t\t\t\t\t\t"),__p+="\n\n\t\t\t\t\t</li>\n\t\t\t\t\t"),__p+="\n\t\t\t\t\t",OverviewModule.FinalScoreShow&&(__p+='\n\t\t\t\t\t<li class="form-select pad12">\n\n\t\t\t\t\t\t<span class="form-label">'+(null==(__t=i18n.overviewModule.finalScore)?"":__t)+"</span>\n\t\t\t\t\t\t",""==OverviewModule.FinalScore||"undefined"==OverviewModule.FinalScore?__p+="\n\t\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t\t<strong class='colorRed finalScore'>"+__e(_.langs("assessment","overviewModule","empty"))+"</strong>\n\t\t\t\t\t\t</span><strong class=\"score-unit\" style='display:none;'>"+__e(i18n.overviewModule.scoreUnit)+"</strong>\n\n\t\t\t\t\t\t":__p+="\n\t\t\t\t\t\t<span class=\"count-num\">\n\t\t\t\t\t\t\t<strong class='colorRed finalScore'>"+__e(_.toFixed(OverviewModule.FinalScore,2))+'</strong>\n\t\t\t\t\t\t</span><strong class="score-unit">'+__e(i18n.overviewModule.scoreUnit)+"</strong>",__p+="\n\t\t\t\t\t</li>\n\t\t\t\t\t</li>\t\n\t\t\t\t\t"),__p+="\n\n\t\t\t\t",1==OverviewModule.AssessmentClassNeed&&ShowGrade&&(__p+='\n\t\t\t\t<li class="form-select pad12">\n\n\t\t\t\t\t<span class="form-label">'+__e(i18n.overviewModule.grade)+'</span>\n\n\t\t\t\t\t<span class="grade-container">\n\t\t\t\t\t\t\n\t\t\t\t\t\t',""!=OverviewModule.AssessmentClassName?_.each(OverviewModule.GradeList,function(a,b){__p+="\n\n\t\t\t\t\t\t\t\t",a.Name==OverviewModule.AssessmentClassName&&(__p+='\n\t\t\t\t\t\t\t\t<span class="grade-item-active" original-title=\''+__e(a.Description)+"' data-name=\""+__e(a.Name)+'" data-description="'+__e(a.Description)+'" data-kid="'+__e(a.Id)+'"  data-value="'+__e(a.Value)+'">\n\t\t\t\t\t\t\t\t\t'+__e(a.Name)+"\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t"),__p+="\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t"}):__p+="\n\t\t\t\t\t\t\t<strong class='colorGray '>"+__e(_.langs("assessment","overviewModule","empty"))+"</strong>\t\n\t\t\t\t\t\t",__p+="\n\t\t\t\t\t\t\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\n\n\t\t\t\t",OverviewModule.AllcommentNeed&&OverviewModule.RateStatementShow&&(__p+='\n\n\t\t\t\t<li class="form-select">\n\t\t\t\t\t<span class="form-label">',OverviewModule.AllcommentWriteIn&&(__p+='\n\t\t\t\t\t\t<span class="must-fill">*</span>\n\t\t\t\t\t\t'),__p+=__e(i18n.overviewModule.comment)+'</span>\n\t\t\t\t\t\t<pre class="form-content disinblock">'+__e(OverviewModule.RateStatement||i18n.overviewModule.empty)+"</pre>\n\t\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\t\t\t\t\t",OverviewModule.DevelopmentPlanNeed&&OverviewModule.DevelopmentPlanShow&&(__p+='\n\t\t\t\t\t<li class="form-select">\n\t\t\t\t\t\t<span class="form-label">',OverviewModule.DevelopmentPlanWriteIn&&(__p+='\n\t\t\t\t\t\t\t<span class="must-fill">*</span>\n\t\t\t\t\t\t\t'),__p+=__e(i18n.overviewModule.plan)+'</span>\n\t\t\t\t\t\t\t<pre class="form-content disinblock">'+__e(OverviewModule.DevelopmentPlan||i18n.overviewModule.empty)+"</pre>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"),__p+="\n\n\t\t\t\t\t\t",2!=Assessment.Status&&(Assessment.HasTask&&6!=CurrentStepTypeId&&4!=CurrentStepTypeId||InIframe&&3==Assessment.Status)&&("1"==OverviewModule.IsModifyScore&&!textdisabled||ShowGrade&&(!OverviewModule.MatchRange||"1"==OverviewModule.ModifyAssessmentClass)&&!classDisabled||OverviewModule.AllcommentNeed&&OverviewModule.RateStatementShow&&!commentDisabled||OverviewModule.DevelopmentPlanNeed&&OverviewModule.DevelopmentPlanShow&&!devPlanDisabled)&&(__p+='\n\t\t\t\t\t\t\t<li class="form-select">\n\t\t\t\t\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t\t\t\t\t<span class="form-content">\n\t\t\t\t\t\t\t\t\t<a href="javascript:void(0)" class="link edit-overflow fright">'+__e(i18n.common.edit)+"</a>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t</li>\n\n\t\t\t\t\t\t"),__p+="\n\t\t\t\t\t\t\n\t\t\t\t\t";if(__p+="\n\t\t\t\t\t\t</ul>\n\n\t\t\t\t\t\t",1==OverviewModule.AssessmentClassNeed&&ShowGrade){__p+='\n\t\t\t\t\t\t<ul class="grade-info">\n\t\t\t\t\t\t\t<li class="title">\n\t\t\t\t\t\t\t\t<strong>'+__e(i18n.overviewModule.gradeInstruction)+"：</strong>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t";for(var i=OverviewModule.GradeList.length-1;i>=0;i--){var item=OverviewModule.GradeList[i];__p+='\n\t\t\t\t\t\t\t\t<li class="grade-list">\n\t\t\t\t\t\t\t\t\t'+(null==(__t=_.escape(item.Name))?"":__t)+":"+(null==(__t=_.escape(_.escape2(item.Description)))?"":__t)+"\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t"}__p+="\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t\t"}__p+="\n\t\t\t\t\t\t</div>\n"}return __p},this.JST["assessment/person-range-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="right-container">\n\t<div class="person-range-right"></div>\n</div>\n';return __p},this.JST["assessment/ratescore-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)1!=FieldRight.RateScore&&1!=FieldRight.RateStatement&&!Score&&1!=CommentDisplay||1==TypeId&&(1!=TypeId||1!=ScoringMethod)||(__p+='\n<div class="person-info disinblock f'+__e(modelClass)+'">\n\t<span class="disblock" origin-title="'+__e(Name||Talent.Context.getUserInfo().Name)+'">\n\t\t',UserAvatar&&!1===UserAvatar.HasAvatar||!UserAvatar?__p+="\n\t\t\t"+(null==(__t=_.convertImagePerDefault({name:Name,size:50}))?"":__t)+"\n\t\t":__p+="\n\t\t\t"+(null==(__t=_.convertImage({className:"photo",src:UserAvatar.Medium,size:50,shape:"radius",name:UserAvatar.Name,bgColor:UserAvatar.Color,HasAvatar:UserAvatar.HasAvatar}))?"":__t)+"\n\t\t",__p+='\n\t\t\n\t</span>\n\t<span class="disblock colorBlack">'+__e(Name||Talent.Context.getUserInfo().Name)+'</span>\n\t<span class="disblock">'+__e(RoleName)+'</span>\n</div>\n<div class="cart-'+__e(modelClass)+" disinblock f"+__e(modelClass)+'">\n</div>\n<div class="info-content disinblock f'+__e(modelClass)+'">\n\t<ul>\n\t\t',"add"==mode||"edit"==mode?(__p+="\n\t\t\t",1==FieldRight.RateScore&&(__p+='\n\t\t\t\t<li class="form-select">\n\t\t\t\t\t<span class="form-label">\n\t\t\t\t\t\t<span class="must-fill">*</span>\n\t\t\t\t\t'+__e(Talent.Context.getMutiFields("RateScore"))+"</span>\n\t\t\t\t\t","0"==scoreType?__p+='\n\t\t\t\t\t\t<span class="form-num disinblock">\n\t\t\t\t\t\t</span>\n\t\t\t\t\t':(__p+="\n\t\t\t\t\t\t","add"==mode?__p+='\n\t\t\t\t\t\t\t<input type="text" class="form-num" value=""/>\n\t\t\t\t\t\t':__p+='\n\t\t\t\t\t\t\t<input type="text" class="form-num" value="'+__e(_.toFixed(Score,2))+'"/>\n\t\t\t\t\t\t',__p+='\n\t\t\t\t\t\t\n\t\t\t\t\t\t<span class="form-desc disinblock" style="display:none;">\n\t\t\t\t\t\t\t',1==ScoreMethod?__p+="\n\t\t\t\t\t\t\t\t\t<strong>"+(null==(__t=_.langs("common","scoreRange"))?"":__t)+"："+__e(TargetScoreLevels.MinValue)+"&nbsp;～&nbsp;"+__e(TargetScoreLevels.MaxValue)+"</strong>\n\t\t\t\t\t\t\t":2==ScoreMethod&&WeightScoreLevel&&(__p+="\n\t\t\t\t\t\t\t\t<strong>"+(null==(__t=_.langs("common","scoreRange"))?"":__t)+"："+__e(WeightScoreLevel.MinValueStr)+"&nbsp;～&nbsp;"+__e(WeightScoreLevel.MaxValueStr)+"</strong>\n\t\t\t\t\t\t\t"),__p+="\n\t\t\t\t\t\t</span>\n\t\t\t\t\t"),__p+="\n\t\t\t\t</li>\n\t\t\t\t",TargetScoreLevels&&TargetScoreLevels.Description&&(__p+='\n\t\t\t\t\t<li class="form-select" style=\'margin-top: -5px;\'>\n\t\t\t\t\t\t<pre style="padding-left: 40px;">'+__e(TargetScoreLevels.Description)+"</pre>\n\t\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\t\t\t"),__p+="\n\t\t\t",1==FieldRight.RateStatement&&(__p+='\n\t\t\t\t<li class="form-select">\n\t\t\t\t\t<span class="form-label">\n\t\t\t\t\t',1==FieldRight.IsCommentRequired&&(__p+='\n\t\t\t\t\t\t<span class="must-fill">*</span>\n\t\t\t\t\t'),__p+="\n\t\t\t\t\t"+__e(Talent.Context.getMutiFields("RateStatement"))+'</span>\n\t\t\t\t\t<span class="form-content disinblock">\n\t\t\t\t\t\t',"add"==mode?__p+='\n\t\t\t\t\t\t\t<textarea class="hasval" >'+__e(_.unescape(Comment))+'</textarea>\n\t\t\t\t\t\t\t<span class="str-len">0/4000</span>\n\t\t\t\t\t\t':(__p+='\n\t\t\t\t\t\t\t<textarea class="hasval">'+__e(Comment)+"</textarea>\n\t\t\t\t\t\t\t",Comment?__p+='\n\t\t\t\t\t\t\t    <span class="str-len">'+__e(Comment.length)+"/4000</span>\n\t\t\t\t\t\t\t":__p+='\n\t\t\t\t\t\t\t    <span class="str-len">0/4000</span>\n\t\t\t\t\t\t\t',__p+="\n\t\t\t\t\t\t"),__p+="\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t"),__p+="\n\t\t\t","add"==mode?__p+='\n\t\t\t\t<li class="form-select-last">\n\t\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t\t<span class="form-content">\n\t\t\t\t\t\t<span class="btn btn-blue btn-small add-signModule">\n\t\t\t\t\t\t\t'+(null==(__t=_.langs("common","save"))?"":__t)+"\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t":(__p+="\n\t\t\t\t",CanOperate&&(__p+='\n\t\t\t\t<li class="form-select-last ratescore-edit">\n\t\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t\t<span class="form-content">\n\t\t\t\t\t\t<span class="btn btn-blue btn-small add-signModule">\n\t\t\t\t\t\t\t'+(null==(__t=_.langs("common","save"))?"":__t)+'\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<span class="btn btn-white btn-small cancel-signModule">\n\t\t\t\t\t\t\t'+(null==(__t=_.langs("common","cancel"))?"":__t)+"\n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t"),__p+="\n\t\t\t"),__p+="\n\t\t"):(__p+="\n\t\t\t",(currentStepId==WorkflowStepId&&1==FieldRight.RateScore||Score)&&(__p+='\n\t\t\t\t<li class="form-select">\n\t\t\t\t\t<span class="form-label">'+__e(Talent.Context.getMutiFields("RateScore"))+"</span>\n\t\t\t\t\t\x3c!--是否显示值--\x3e\n\t\t\t\t\t",showValue&&(__p+='\n\t\t\t\t\t\t<span class="form-num disinblock hasval" style="line-height: 22px;">\n\t\t\t\t\t\t\t'+__e(1e4==Number(Score)?_.langs("common","invaluably"):_.toFixed(Score,2))+"\n\n\t\t\t\t\t\t</span>\n\t\t\t\t\t"),__p+="\n\t\t\t\t\t\x3c!--是否显示名称--\x3e\n\t\t\t\t\t",showName&&(__p+='\n\t\t\t\t\t\t<span class="form-desc disinblock hasval">\n\t\t\t\t\t\t\t<strong>'+(null==(__t=ScoreName)?"":__t)+"</strong>\t\n\t\t\t\t\t\t</span>\n\t\t\t\t\t"),__p+="\n\t\t\t\t\t\x3c!--是否显示描述--\x3e\n\t\t\t\t\t",showDescription&&(__p+='\n\t\t\t\t\t\t<span class="form-desc disinblock hasval">\n\t\t\t\t\t\t\t<strong title=\''+__e(ScoreDescription)+"'>"+__e(ScoreDescription)+"</strong>\t\n\t\t\t\t\t\t</span>\n\t\t\t\t\t"),__p+="\n\t\t\t\t</li>\n\t\t\t"),__p+="\n\t\t\t",(currentStepId==WorkflowStepId&&1==FieldRight.RateStatement||1==CommentDisplay)&&(__p+='\n\t\t\t<li class="form-select">\n\t\t\t\t<span class="form-label">'+__e(Talent.Context.getMutiFields("RateStatement"))+'</span>\n\t\t\t\t<div class="form-content disinblock hasval" >\n\t\t\t\t\t<div class="form-content disinblock">\n\t\t\t\t\t\t',_.each(_.unescape(Comment||_.langs("common","empty")).split("\n"),function(a){__p+="\n               \t\t\t\t"+__e(a)+"<br>\n              \t\t\t"}),__p+=" \n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t\t"),__p+="\n\t\t\t",CanOperate&&(__p+='\n\t\t\t<li class="form-select-last">\n\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t<span class="form-content">\n\t\t\t\t\t<a href="javascript:void(0)" class="link edit-signModule fright">'+(null==(__t=_.langs("common","edit"))?"":__t)+"</a>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t"),__p+="\n\t\t"),__p+="\n\t</ul>\n</div>\n\n");return __p},this.JST["assessment/signconfirm-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n\t<div class="module-title sign-confirm">\n\t\t<span class="module-name disinblock">\n\t\t\t'+__e(SignModule.Name)+'\n\t\t</span>\n\t</div>\n\t<div class="module-content sign-confirm"></div>\n';return __p},this.JST["assessment/signinfo-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){if(__p+='<div class="content-'+__e(sClass)+' clearfix" style="margin-bottom:10px;">\n\t<div class="person-info f'+__e(sClass)+'">\n\t\t<span class="disblock" origin-title="'+__e(Name||Talent.Context.getUserInfo().Name)+'">\n\t\t\t',UserAvatar?__p+="\n\t\t\t\t"+(null==(__t=_.convertImage({className:"photo",src:UserAvatar.Medium,size:50,shape:"radius",name:Name,bgColor:UserAvatar.Color,HasAvatar:UserAvatar.HasAvatar}))?"":__t)+"\n\t\t\t":__p+="\n\t\t\t\t"+(null==(__t=_.convertImagePerDefault({name:Name,size:50}))?"":__t)+"\n\t\t\t",__p+='\n\t\t</span>\n\t\t<span class="disblock colorBlack">'+__e(Name||"")+'</span>\n\t\t<span class="disblock">'+__e(RoleName)+'</span>\n\t</div>\n\t<div class="cart-'+__e(sClass)+" f"+__e(sClass)+'">\n\t</div>\n\t<div class="info-content f'+__e(sClass)+'">\n\t<ul>\n\t\t',"add"!=mode||InIframe)if("edit"==mode){if(__p+='\n\t\t\t<li class="form-select">\n\t\t\t\t<span class="form-label">\n\t\t\t\t',page.SignModule.AgreeOne.Name==Result){__p+='\n\t\t\t  \t\t<span class="radio radio_checked" isok="1" data-value="'+__e(page.SignModule.AgreeOne.Name)+'"></span>\n\t\t\t  \t\t';var isShow=!1;__p+="\n\t\t\t\t  "}else __p+='\n\t\t\t\t  \t <span class="radio radio_uncheck" isok="1" data-value="'+__e(page.SignModule.AgreeOne.Name)+'"></span>\n\t\t\t\t  ';if(__p+='\n\t\t\t\t</span>\n\t\t\t\t<span class="form-content">'+__e(page.SignModule.AgreeOne.Name)+'</span>\n\t\t\t</li>\n\t\t\t<li class="form-select">\n\t\t\t    <span class="form-label">\n\t\t\t    \t ',page.SignModule.AgreeTwo.Name==Result){__p+='\n\t\t\t\t  \t\t<span class="radio radio_checked" isok="0" data-value="'+__e(page.SignModule.AgreeTwo.Name)+'"></span>\n\t\t\t\t  \t\t';var isShow=!0;__p+="\n\t\t\t\t\t  "}else __p+='\n\t\t\t\t\t  \t <span class="radio radio_uncheck" isok="0" data-value="'+__e(page.SignModule.AgreeTwo.Name)+'"></span>\n\t\t\t\t\t  ';__p+='\n\t\t\t    </span>\n\t\t\t    <span class="form-content">'+__e(page.SignModule.AgreeTwo.Name)+'</span></li>\n\t\t\t<li class="form-select reson" style="display:'+__e(isShow?"block":"none")+'">\n\t\t\t\t<span class="form-label">'+__e(i18n.reason)+'</span>\n\t\t\t\t<span class="form-content disinblock">\n\t\t\t\t\t<textarea style="color:#666" class="str_renson">'+(null==(__t=Reason)?"":__t)+'</textarea>\n\t\t\t\t\t<span class="str-len">'+__e(Reason.length)+'/500</span>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="form-select-last">\n\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t<span class="form-content">\n\t\t\t\t\t<span class="btn btn-blue btn-small add-signModule">\n\t\t\t\t\t\t'+__e(_.langs("common","save"))+'\n\t\t\t\t\t</span>\n\t\t\t\t\t<span class="btn btn-white btn-small cancel-signModule">\n\t\t\t\t\t\t'+__e(_.langs("common","cancel"))+"\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t"}else"signing"==mode?__p+='\n\t\t\t\n\t\t\t\t<li>\n\t\t\t\t\t<span class="content-result disinblock">\n\t\t\t\t\t\t'+__e(i18n.signing)+"\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\n\t\t":"empty"==mode?__p+='\n\n\t\t<li class="info-result"></li>\n\t\t':(__p+="\n\t\t\t\t\t\t\t\n\t\t\t",Result==page.SignModule.AgreeTwo.Name?(__p+='\n\t\t\t<li class="info-result">'+__e(Result)+'</li>\n\n\t\t\t\t<li>\n\t\t\t\t    <span class="label-result">'+__e(i18n.reason)+':</span>\n\t\t\t\t\t<span class="content-result disinblock">\n\t\t\t\t\t\t\n\t\t\t\t\t\t',_.each(Reason.split("\n"),function(a){__p+="\n            \t\t\t\t"+__e(a)+"<br>\n        \t\t\t\t"}),__p+=" \n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t"):__p+='\n\t\t\t<li class="info-result">\n\t\t\t\t\n\t\t\t\t\t\t'+__e(Result)+"\n\t\t\t\t\t\n\t\t\t</li>\n\t\t\t",__p+="\n\n\n\t\t\t",page.Assessment.HasTask&&4==page.Assessment.CurrentStepTypeId&&"1"==operation&&!InIframe&&(__p+='\n\t\t\t<li class="form-select-last">\n\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t<span class="form-content">\n\t\t\t\t\t\n\t\t\t\t\t<a href="javascript:void(0)" class="link edit-signModule fright">\n\t\t\t\t\t\t'+__e(_.langs("common","edit"))+"\n\t\t\t\t\t</a>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t"),__p+="\n\t\t");else __p+='\n\t\t\t<li class="form-select">\n\t\t\t\t<span class="form-label">\n\t\t\t  \t\t<span class="radio radio_checked " isok="1"  data-value="'+__e(page.SignModule.AgreeOne.Name)+'"></span>\n\t\t\t\t</span>\n\t\t\t\t<span class="form-content">'+__e(page.SignModule.AgreeOne.Name)+'</span>\n\t\t\t</li>\n\t\t\t<li class="form-select">\n\t\t\t    <span class="form-label">\n\t\t\t\t\t<span class="radio radio_uncheck" isok="0" data-value="'+__e(page.SignModule.AgreeTwo.Name)+'"></span>\n\t\t\t    </span>\n\t\t\t    <span class="form-content">'+__e(page.SignModule.AgreeTwo.Name)+'</span>\n\t\t\t</li>\n\t\t\t<li class="form-select reson" style="display:none">\n\t\t\t\t<span class="form-label">'+__e(i18n.reason)+'</span>\n\t\t\t\t<span class="form-content disinblock">\n\t\t\t\t\t<textarea style="color:#666"  class="str_renson"></textarea>\n\t\t\t\t\t<span class="str-len">0/500</span>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="form-select-last">\n\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t<span class="form-content">\n\t\t\t\t\t<span class="btn btn-blue btn-small add-signModule">\n\t\t\t\t\t\t'+__e(_.langs("common","save"))+"\n\t\t\t\t\t</span>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t";__p+="\n\t</ul>\n\t</div>\n</div>"}return __p},this.JST["assessment/target-composite-view"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<ul class="target-container target-container-status-'+(null==(__t=mode)?"":__t)+'">\r\n\t\r\n</ul>\r\n',"sortable"==mode&&(__p+='\r\n\t<div class="module-operate clearfix operator-'+(null==(__t=mode)?"":__t)+'" >\r\n\t\t<span class="fright">\r\n\t\t\t<span class="btn btn-gray btn-small btn-cancel-sort" >'+__e(_.langs("common","cancel"))+'</span>\r\n\t\t\t<span class="btn btn-blue btn-small btn-ensure-sort" >'+__e(_.langs("common","submit"))+"</span>\r\n\t\t</span>\r\n\t</div>\r\n");return __p},this.JST["assessment/target-custom-composite-view"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<ul class="target-container ">\n\t\n</ul>\n',!InIframe&&isShowAddBtn&&FieldRight.RateStatement&&(__p+='\n<div class="add-custom">\n\t<a href="javascript:void(0)" class="link quick_add_custom">'+(null==(__t=_.langs("assessment","module","addSubModule"))?"":__t)+"</a>\n\t\n</div>\n"),__p+="\n";return __p},this.JST["assessment/target-item-addsub"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="addsub-item"  >\n   <div class="target-title content-hide status-simple" data-id="56fb9c14-32b3-49a4-9727-bf7cf467fa2a" data-type="1" data-score="1" data-weight="1">\n\t\t<span class="object-name disinblock show_obj_name2" style="max-width: 727px;">\n\t\t\t<ul>\n\t\t\t\t<li>\n\t\t\t\t\t<span class="obj-name obj-item show_obj_name" title="'+(null==(__t=Name)?"":__t)+'" style="min-width:200px">\n\t\t\t\t\t\t'+(null==(__t=Name)?"":__t)+'\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li>\n\t\t\t\t\t<span class="obj-desc obj-value goal-desc">\n\t\t\t\t\t\t ',Description.length<=22?__p+="\n\n                        "+__e(Description)+"\n\n                    ":__p+="\n                        "+__e(Description.substr(0,22)+"...")+"\n                    ",__p+="\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t</span>\n\t\t",InIframe||(__p+='\n\t\t<span class="object-operation disinblock">\n\t\t',1!=FieldRight.Property&&1!=FieldRight.RateScore||(__p+='\n\t \n\t\t\t<span class="editAddSub"  title="编辑加减分"></span>\n\t \n\t\t'),__p+="\n \n\t\t\t",1==FieldRight.Delete&&(__p+='\n\t \n\t\t\t<span class="js-delete" title="删除加减分"></span>\n\t \n\t\t\t'),__p+="\n\t\t</span>\n\t\t"),__p+='\n\t\t<span class="fright  disinblock add_sub_score-container">\n\t\t\t\n\t\t\t',null==RateScore||RateScore==undefined||""==RateScore?__p+="\n\t\t\t\t\t"+__e("")+"\n\t\t\t":(__p+="\n\t\t\t\t\t","10000.00"==RateScore||1e4==RateScore?__p+="\n\t\t\t\t\t\t"+__e("")+"\n\t\t\t\t\t":(__p+="\n\t\t\t\t\t\t",RateScore>0?__p+="\n\t\t\t\t\t\t\t"+__e("+"+RateScore+_.langs("assessment","overviewModule","scoreUnit"))+"\n\t\t\t\t\t\t":RateScore<=0&&(__p+="\n\t\t\t\t\t\t\t"+__e(RateScore+"分")+"\n\t\t\t\t\t\t"),__p+="\t\n\t\t\t\t\t"),__p+="\n\t\t\t"),__p+="\n\t\t</span>\n\t</div>\n</div>\n\n";return __p},this.JST["assessment/target-item-custom"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n",isShowImage&&(__p+='\n<div class="person-info disinblock custom-module">\n\t<span class="disblock" origin-title="'+__e(AssessorName||Talent.Context.getUserInfo().Name)+'">\n\t',UserAvatar&&!1===UserAvatar.HasAvatar||!UserAvatar?__p+="\n\t\t\t"+(null==(__t=_.convertImagePerDefault({name:AssessorName,size:50}))?"":__t)+"\n\t\t":__p+="\n\t\t\t"+(null==(__t=_.convertImage({className:"photo",src:UserAvatar.Medium,size:50,shape:"radius",name:UserAvatar.Name,bgColor:UserAvatar.Color,HasAvatar:UserAvatar.HasAvatar}))?"":__t)+"\n\t\t",__p+='\n\t\t\n\t</span>\n\t<span class="disblock colorBlack">'+__e(AssessorName||Talent.Context.getUserInfo().Name)+'</span>\n\t<span class="disblock">'+__e(StaffRelationName)+"</span>\n</div>\n"),__p+='\n<div class=" disinblock ">\n</div>\n<div class="info-content disinblock custom-module-content">\n\t<ul class="customListUl">\n\t\t',"edit"==mode?(__p+="\n\t\t\t",_.each(CustomItems,function(a,b){__p+='\n\t\t\t\t<li class="form-select">\n\t\t\t\t\t<span class="form-label">'+__e(Talent.Context.getMutiFields("Standard"))+'</span>\n\t\t\t\t\t<span class="customName">\n\t\t\t\t\t\t',a.MinCharCount&&(__p+='\n\t\t\t\t\t\t\t<span class="redstar" style="vertical-align: middle;">*</span>\t\n\t\t\t\t\t\t'),__p+="\n\t\t\t\t\t\t"+__e(a.Name)+"\n\t\t\t\t\t\t\n\t\t\t\t\t</span>\t\t\t\t\t\n\t\t\t\t\t",placeHolderList[b].Content&&(__p+='\n\t\t\t\t\t\t<span class="descSpan">\n\t\t\t\t\t\t\t<span class="descIcon"></span>\n\t\t\t\t\t\t\t<pre class="describeCus">'+__e(placeHolderList[b].Content)+"</pre>\n\t\t\t\t\t\t</span>\n\t\t\t\t\t"),__p+='\n\t\t\t\t\t<span class="requerdError" data-id=\''+__e(a.CustomItemId)+"'>"+__e(i18n.customRequired)+'</span>\n\t\t\t\t\t<span class="form-content disinblock">\n\t\t\t\t\t\t',1==a.Type?(__p+='\n\t\t\t\t\t\t\t<textarea class="'+(null==(__t=a.Content?"hasval":"")?"":__t)+' tArea" data-holder="'+__e(placeHolderList[b].Content)+"\" data-id='"+__e(a.CustomItemId)+"'>"+__e(_.encodescript2(a.Content||placeHolderList[b].Content))+"</textarea>\n\t\t\t\t\t\t\t",a.MinCharCount>1?__p+='\n\t\t\t\t\t\t\t\t<span class="leastError">'+__e(i18n.customTips(a.MinCharCount))+"</span>\n\t\t\t\t\t\t\t":__p+="\n\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t",__p+="\n\t\t\t\t\t\t\t",a.Content?__p+='\n\t\t\t\t\t\t\t    <span class="str-len">\n\t\t\t\t\t\t\t    \t'+__e(a.Content.length)+"/4000\n\t\t\t\t\t\t\t    </span>\n\t\t\t\t\t\t\t":__p+='\n\t\t\t\t\t\t\t    <span class="str-len">\t\n\t\t\t\t\t\t\t    \t0/4000\n\t\t\t\t\t\t\t    </span>\n\t\t\t\t\t\t\t',__p+="\n\t\t\t\t\t\t\t",a.MinCharCount?__p+='\n\t\t\t\t\t\t\t\t<span class="wordsLimit">'+__e(i18n.customLimit(a.MinCharCount))+"</span>\n\t\t\t\t\t\t\t":__p+="\n\t\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t\t",__p+="\n\t\t\t\t\t\t"):2==a.Type&&(__p+='\n\t\t\t\t\t\t\t<ul class="optionRadioList">\n\t\t\t\t\t\t\t',_.each(a.Options,function(b){__p+='\n\t\t\t\t\t\t\t\t<li><input type="radio" name="'+__e(a.Id)+'" class="customOptionRadio" value="'+__e(b)+'" '+__e(b==a.Content?"checked":"")+" >"+(null==(__t=b)?"":__t)+"</li>\n\t\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t\t\t</ul>\n\t\t\t\t\t\t"),__p+="\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t"}),__p+="\n\t\t\t\n\t\t\t",CanOperate&&(__p+='\n\t\t\t<li class="form-select-last custom-edit">\n\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t<span class="form-content">\n\t\t\t\t\t<span class="btn btn-blue btn-small save-custom">\n\t\t\t\t\t\t'+(null==(__t=_.langs("common","save"))?"":__t)+"\n\t\t\t\t\t</span>\n\t\t\t\t\t",isShowAddBtn&&(__p+='\n\t\t\t\t\t<span class="btn btn-white btn-small cancel-custom">\n\t\t\t\t\t\t'+(null==(__t=_.langs("common","cancel"))?"":__t)+"\n\t\t\t\t\t</span>\n\t\t\t\t\t"),__p+="\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t"),__p+="\n\t\t"):"add"==mode?(__p+="\n\t\t\t",_.each(CustomItems,function(a,b){__p+='\n\t\t\t<li class="form-select custom-edit">\n\t\t\t\t<span class="form-label">'+__e(Talent.Context.getMutiFields("Standard"))+'</span>\n\t\t\t\t<span class="customName">\n\t\t\t\t\t',a.MinCharCount&&(__p+='\n\t\t\t\t\t\t<span class="redstar" style="vertical-align: middle;">*</span>\n\t\t\t\t\t'),__p+="\n\t\t\t\t\t"+__e(a.Name)+"\n\t\t\t\t</span>\n\t\t\t\t",a.Content&&(__p+='\n\t\t\t\t\t<span class="descSpan">\n\t\t\t\t\t\t<span class="descIcon"></span>\n\t\t\t\t\t\t<pre class="describeCus">'+__e(a.Content)+"</pre>\n\t\t\t\t\t</span>\n\t\t\t\t"),__p+='\n\t\t\t\t<span class="requerdError" data-id=\''+__e(a.CustomItemId)+"'>"+__e(i18n.customRequired)+'</span>\n\t\t\t\t<span class="form-content disinblock">\n\t\t\t\t\t',1==a.Type?(__p+='\n\t\t\t\t\t\t<textarea class="tArea"  data-holder="'+__e(a.Content)+"\" data-id='"+__e(a.CustomItemId)+"'>"+__e(a.Content)+"</textarea>\n\t\t\t\t\t\t",a.MinCharCount>1?__p+='\n\t\t\t\t\t\t\t<span class="leastError">'+__e(i18n.customTips(a.MinCharCount))+"</span>\n\t\t\t\t\t\t":__p+="\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t",__p+='\n\t\t\t\t\t\t<span class="str-len">\n\t\t\t\t\t\t\t0/4000\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t',a.MinCharCount?__p+='\n\t\t\t\t\t\t\t<span class="wordsLimit">'+__e(i18n.customLimit(a.MinCharCount))+"</span>\n\t\t\t\t\t\t":__p+="\n\t\t\t\t\t\t\t<span></span>\n\t\t\t\t\t\t",__p+="\n\t\t\t\t\t"):2==a.Type&&(__p+='\n\t\t\t\t\t\t<ul class="optionRadioList">\n\t\t\t\t\t\t',_.each(a.Options,function(b){__p+='\n\t\t\t\t\t\t\t<li><input type="radio" name="'+__e(a.Id)+'" class="customOptionRadio" value="'+__e(b)+'">'+(null==(__t=b)?"":__t)+"</li>\n\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t"),__p+="\n\t\t\t\t\t\n\t\t\t\t\t\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t"}),__p+='\n\t\t\t\n\t\t\t\n\t\t\t<li class="form-select-last">\n\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t<span class="form-content">\n\t\t\t\t\t<span class="btn btn-blue btn-small save-custom">\n\t\t\t\t\t\t'+(null==(__t=_.langs("common","save"))?"":__t)+"\n\t\t\t\t\t</span>\n\t\t\t\t\t",isShowAddBtn&&(__p+='\n\t\t\t\t\t<span class="btn btn-white btn-small cancel-custom">\n\t\t\t\t\t\t'+(null==(__t=_.langs("common","cancel"))?"":__t)+"\n\t\t\t\t\t</span>\n\t\t\t\t\t"),__p+="\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t"):"noright"==mode?__p+="\n\t\t\t\n\t\t":(__p+="\n\t\t\t",_.each(CustomItems,function(a,b){__p+='\n\t\t\t<li class="form-select border-bottom">\n\t\t\t\t<span class="form-label">'+__e(Talent.Context.getMutiFields("Standard"))+'</span>\n\t\t\t\t<span class="customName">\n\t\t\t\t\t',a.MinCharCount&&(__p+='\n\t\t\t\t\t\t<span class="redstar" style="vertical-align: middle;">*</span>\n\t\t\t\t\t'),__p+="\n\t\t\t\t\t"+__e(a.Name)+"\n\t\t\t\t</span>\n\t\t\t\t",placeHolderList[b].Content&&(__p+='\n\t\t\t\t\t<span class="descSpan">\n\t\t\t\t\t\t<span class="descIcon"></span>\n\t\t\t\t\t\t<pre class="describeCus">'+__e(placeHolderList[b].Content)+"</pre>\n\t\t\t\t\t</span>\n\t\t\t\t"),__p+='\n\t\t\t\t<div class="form-content disinblock hasval" >\n\t\t\t\t\t<div class="form-content disinblock">\n\t\t\t\t\t',1==a.Type?(__p+="\n\t\t\t\t\t\t",a.Content&&""!==a.Content?(__p+="\n\t\t\t\t\t\t\t",_.each(_.encodescript2(a.Content).split("\n"),function(a){__p+="\n\t\t\t\t\t\t\t<p>"+__e(a)+"</p>\n\t\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t\t"):__p+="\n\t\t\t\t\t\t \t"+__e(_.langs("assessment","overviewModule","empty"))+"\n\t\t\t\t\t\t",__p+=" \n\t\t\t\t\t"):2==a.Type&&(__p+='\n\t\t\t\t\t\t<ul class="optionRadioList">\n\t\t\t\t\t\t',_.each(a.Options,function(b){__p+='\n\t\t\t\t\t\t\t<li><input type="radio" name="'+__e(a.Id)+'" class="customOptionRadio" value="'+__e(b)+'" disabled '+__e(b==a.Content?"checked":"")+" >"+(null==(__t=b)?"":__t)+"</li>\n\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t"),__p+="\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t</li>\n\t\t\t"}),__p+="\n\t\t\t\n\t\t\t\n\t\t\t",CanOperate&&!InIframe&&(__p+='\n\t\t\t<li class="form-select-last">\n\t\t\t\t<span class="form-label">&nbsp;</span>\n\t\t\t\t<span class="form-content">\n\t\t\t\t\t',isShowAddBtn&&(__p+='\n\t\t\t\t\t<a href="javascript:void(0)" class="link delete-custom fright">'+(null==(__t=_.langs("common","operation","delete"))?"":__t)+"</a>\n\t\t\t\t\t"),__p+='\n\t\t\t\t\t<a href="javascript:void(0)" class="link edit-custom fright">'+(null==(__t=_.langs("common","edit"))?"":__t)+"</a>\n\t\t\t\t\t\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t"),__p+="\n\t\t"),__p+="\n\t</ul>\n</div>\n";return __p},this.JST["assessment/target-item-setscore"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="setscore-item" >\n\t<span class="object-name disinblock show_obj_name2"  style="max-width:'+__e(MaxWidth)+'px">\n\t\t<ul>\n\t\t\t<li>\n\t\t\t\t<span class="obj-name obj-item show_obj_name" title="'+(null==(__t=Name)?"":__t)+'" style="min-width:200px">\n\t\t\t\t\t'+(null==(__t=Name)?"":__t)+"\n\t\t\t\t\t","1"==TypeId&&(__p+='\n\t\t\t\t\t\t<i class="show_obj_name_bg"></i>\n\t\t\t\t\t'),__p+='\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li>\n\t\t\t\t<span class="obj-desc obj-value goal-desc">\n\t\t\t\t\t',Description.length<=22?__p+="\n\n\t\t\t\t\t\t"+__e(Description)+"\n\n\t\t\t\t\t":__p+="\n\t\t\t\t\t\t"+__e(Description.substr(0,22)+"...")+"\n\t\t\t\t\t",__p+='\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</span>\n\t<span class="object-operation disinblock">\n\t\t\t<span class="object-edit icon-edit" title="'+__e(i18n.editTarget)+'"></span>\n\t\t\t<span class="object-delete icon-delete" title="'+__e(i18n.deleteTarget)+'"></span>\n\t</span>\n</div>\n\n';return __p},this.JST["assessment/target-item-summy"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){if(__p+='<div class="summy-item" >\r\n\t<ul class="summaryList">\r\n\t\r\n\t\t<li class="summy-item-title">\r\n\t\t\t',InIframe){if(__p+="\r\n\t\t\t\t",AssessmentID){var cnCom="Testing"==BSGlobal.env?"cn":"com";__p+='\r\n\r\n\t\t\t\t<a href="http://epm.tms.beisen.'+__e(cnCom)+"/Assessment/AssessmentDetail?pid="+(null==(__t=ParticipantId)?"":__t)+'&flag=1" target="_blank">\r\n\t\t\t\t\t'+(null==(__t=Name)?"":__t)+"\r\n\t\t\t\t</a>\r\n\t\t\t\t"}else __p+='\r\n\t\t\t\t<span style="color:#AAA">'+(null==(__t=Name)?"":__t)+"</span>\r\n\t\t\t\t";__p+="\r\n\t\t\t"}else __p+="\r\n\t\t\t\t",AssessmentID?__p+='\r\n\t\t\t\t<a href="/#assessment?assessmentId='+(null==(__t=AssessmentID)?"":__t)+"&userId="+(null==(__t=Employee)?"":__t)+'" target="_blank">\r\n\t\t\t\t\t'+(null==(__t=Name)?"":__t)+"\r\n\t\t\t\t</a>\r\n\t\t\t\t":__p+='\r\n\t\t\t\t<span style="color:#AAA">'+(null==(__t=Name)?"":__t)+"</span>\r\n\t\t\t\t",__p+="\r\n\t\t\t";__p+="\r\n\t\t\t\r\n\t\t\t\r\n\t\t</li>\r\n\t\t",1==CollectType&&(__p+='\r\n\t\t\t<li class="object-weight disinblock fright ">\r\n\t            <span class="obj-value disblock  text-aligin-right">\r\n\t                <strong>\r\n\t                    <span class="weight-val">'+__e(Weight?_.toFixed(Weight,2):Weight)+"</span>%\r\n\t                </strong>\r\n\t            </span>\r\n        \t</li>\r\n\t\t"),__p+='\r\n\t\t<li class="summy-item-period">\r\n\t\t\t'+(null==(__t=PeriodicityTypeText)?"":__t)+"\r\n\t\t</li>\r\n\r\n\t\t<li class=\"summy-item-score\"  style='max-width:80px;' >\r\n\t\t\t"+(null==(__t=SummaryItemClassName)?"":__t)+'\t\r\n\t\t</li>\r\n\t\t\r\n\t\t<li class="summy-item-score" >\r\n\t\t\t',AssessmentID&&""!=RateScore&&1==NumRateScoreShow&&(__p+="\r\n\t\t\t\t"+(null==(__t=RateScore)?"":__t)+__e(_.langs("common","scoreUnit"))+"\r\n\t\t\t"),__p+="\r\n\t\t</li>\r\n\t\t\r\n\t\t\r\n\r\n\t</ul>\r\n</div>\r\n\r\n"}return __p},this.JST["assessment/target-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){"all"==mode?__p+='\n    <div class="target-title content-show" data-id="'+__e(Id)+'" data-type="'+__e(ModuleType)+'" data-score="'+__e(FieldRight.RateScore)+'" data-weight="'+__e(FieldRight.Weight)+'" data-scoretype="'+__e(ScoreType)+'" data-scorelevelid="'+__e(ScoreLevelId)+'">\n':__p+='\n   <div  class="target-title content-hide status-'+(null==(__t=mode)?"":__t)+'" data-id="'+__e(Id)+'"  data-type="'+__e(ModuleType)+'" data-score="'+__e(FieldRight.RateScore)+'" data-weight="'+__e(FieldRight.Weight)+'" data-scoretype="'+__e(ScoreType)+'" data-scorelevelid="'+__e(ScoreLevelId)+'">\n',__p+='\n\n    <span class="object-image"></span>\n    <span class="object-name disinblock show_obj_name2">\n        <ul>\n            <li>            \n                ',TargetUrl&&!cacheContainer.get("InIframe")?(__p+='\n                    <a class="obj-name obj-item show_obj_name" title="'+(null==(__t=Name)?"":__t)+'" \n                    style="max-width:300px;overflow: hidden;display: inline-block;text-overflow: ellipsis;white-space: nowrap;" target="_blank" href='+__e(TargetUrl)+">\n                        "+(null==(__t=Name)?"":__t)+"\n                    </a>\n                    ","1"==TypeId&&(__p+='\n                            <i class="show_obj_name_bg"></i>\n                        '),__p+="\n                "):(__p+='\n                    <a class="obj-name obj-item show_obj_name" title="'+(null==(__t=Name)?"":__t)+'" \n                    style="max-width:300px;overflow: hidden;display: inline-block;text-overflow: ellipsis;white-space: nowrap;" >\n                        '+(null==(__t=Name)?"":__t)+"\n                    </a>\n                     ","1"==TypeId&&(__p+='\n                            <i class="show_obj_name_bg"></i>\n                        '),__p+="\n                "),__p+='\n            </li>\n            <li>\n                \n                    <span class="obj-desc obj-value goal-desc">\n                       ';var isENLang="en-US"==BSGlobal.lang,ljLen=isENLang?40:22;Description.length<=ljLen?__p+="\n                            "+__e(_.unescape(Description))+"\n                        ":__p+="\n                            "+__e(_.unescape(Description).substr(0,ljLen)+"...")+"\n                        ",__p+="\n                    </span>\n                \n            </li>\n        </ul>\n    </span>\n    ",InIframe||(__p+='\n    <span class="object-operation disinblock">\n        ',"sortable"==mode?__p+='\n                <a class="sort-icon"></a>\n        ':(__p+="\n            ",((1==FieldRight.Property||1==FieldRight.Weight||1==FieldRight.ObjectiveType||1==FieldRight.CompleteValue)&&7!=ModuleType||7==ModuleType&&1==FieldRight.Weight)&&(__p+='\n                <span class="js-edit" title="'+__e(i18n.editTarget)+'"></span>\n            '),__p+="\n            ",1==FieldRight.Delete&&(__p+='\n                <span class="js-delete" title="'+__e(i18n.deleteTarget)+'"></span>\n            '),__p+="\n        "),__p+="\n    </span>\n    "),__p+='\n    <div  class="fright scoreList">\n    \n        ',0==FieldRight.Weight&&2!=WeightType?__p+='\n        <span class="object-weight disinblock fright">\n            <span class="obj-item disblock">\n                '+__e(i18n.weight)+'\n            </span>\n            <span class="obj-value disblock  text-aligin-right">\n                <strong>\n                    <span class="weight-val">'+__e(Weight?_.toFixed(Weight,2):Weight)+"</span>%\n                </strong>\n            </span>\n        </span>\n        ":1==FieldRight.Weight&&2!=WeightType&&(__p+='\n        <span class="object-weight disinblock  fright">\n            <span class="obj-item disblock">\n                '+__e(i18n.weight)+'\n            </span>\n            <span class="obj-value disblock">\n                <strong>\n                    ',"weightChange"==mode?__p+='\n\n\n\n                    <input type="text" class="weight-val disinblock" value="'+__e(Weight)+'"tip-info="'+__e(_.langs("assessment","weightRange"))+':0.00&nbsp;～&nbsp;100.00"/>%\n                    ':__p+='\n                    <span class="weight-val">'+__e(Weight?_.toFixed(Weight,2):Weight)+"</span>%\n\n\n\n                    ",__p+="\n                </strong>\n            </span>\n        </span>\n        "),__p+="\n        ",7==ModuleType&&(__p+='\n            <span class="goalProgress disinblock fright">\n                <span class="obj-item disblock">\n                    进度\n                </span>\n                <span class="obj-value disblock">\n                    <strong>\n                        '+__e(Progress)+"%\n                    </strong>\n                </span>\n            </span>\n            \n        "),__p+='\n    <span class="score-container disinblock fright">\n        ',("1"!=TypeId||"1"==TypeId&&"1"==ScoringMethod)&&(__p+="\n            ",_.each(RateScoreList,function(a,b){(a.Score||0==parseInt(a.Score))&&(a.Score=_.toFixed(a.Score,2)),__p+='\n\n            <span class="object-score person-score disinblock" index="'+__e(b)+'">\n                <span class="obj-item disblock">\n                    '+__e(a.Name||Talent.Context.getUserInfo().Name)+'\n                </span>\n                <span class="obj-value disblock">\n                    ',("quickScore"!=mode||"1"==TypeId||0==FieldRight.RateScore||a.WorkflowStepId!=CurrentStepId&&a.WorkflowStepId)&&("quickScore"!=mode||"1"!=TypeId||"1"!=ScoringMethod||0==FieldRight.RateScore||a.WorkflowStepId!=CurrentStepId&&a.WorkflowStepId)?(__p+="\n                        ",a.Score&&"-2147483648.00"!=a.Score?(__p+="\n                            \n                            <strong> \n                                ",showValue&&(__p+="\n\n                                    "+(null==(__t=Number(a.Score)==Number(1e4)?"无法评价":a.Score)?"":__t)+"\n\n                                "),__p+="\n                            \n                                ",showName&&(__p+="\n                                    "+(null==(__t=a.ScoreName)?"":__t)+"\n                                "),__p+="\n                                ",showDescription&&(__p+="\n                                    "+(null==(__t=a.ScoreDescription)?"":__t)+"\n                                "),__p+="\n                            </strong>\n                        "):__p+="\n                            <strong>-</strong>\n                        ",__p+="\n                    "):(__p+="\n                            ",0==ScoreType?__p+='\n                              <span class="item-score disinblock"></span>\n                            ':(__p+='\n                                    <input type="text" name="score" class="item-score form-num" value="'+__e(a.Score)+'" tip-info="'+__e(_.langs("common","scoreRange"))+":\n                                    ",1==ScoreMethod?__p+="\n                                        "+__e(TargetScoreLevels.MinValue)+"&nbsp;～&nbsp;"+__e(TargetScoreLevels.MaxValue)+'"\n                                    ':__p+="\n                                        "+__e(WeightScoreLevel.MinValueStr)+"&nbsp;～&nbsp;"+__e(WeightScoreLevel.MaxValueStr)+'"\n                                    ',__p+="\n                                    />\n                            "),__p+="\n                    "),__p+="\n                </span>\n                \n            </span>\n        "}),__p+="\n\n        "),__p+="\n        ",showItemScore?__p+='\n            <span class="object-score disinblock">\n                <span class="obj-item disblock">\n                    '+__e(i18n.rateScore)+'\n                </span>\n                <span class="obj-value disblock">\n\n                    <strong>'+__e(RateScore-0!=1e4&&RateScore?_.toFixed(RateScore,2):"")+"</strong>\n\n\n                </span>\n            </span>\n        ":__p+='\n            <span class="object-score disinblock" style="display:none">\n                <span class="obj-item disblock">\n                    \n                </span>\n                <span class="obj-value disblock">\n                    \n                </span>\n            </span>\n        ',__p+="\n    </span>\n\n    ","1"==TypeId&&(__p+="\n        ","1"==Assessment.CurrentStepTypeId?(__p+='\n            <span class="object-scoreGoal disinblock  fright" style="min-width:130px;padding-right:20px;">\n                ',(MinimumValue.IsAdopt||ItemValue.IsAdopt||ChallengeValue.IsAdopt)&&(__p+='\n                <span class="obj-item disblock textCenter">\n                    '+__e(i18n.targetValue)+"("+__e(Unit)+")\n                </span>\n\n                "),__p+='\n                <span class="obj-value disblock textCenter">\n                    <strong>  \n                        <span class="target-val">\n                            '+__e(MinimumValue.IsAdopt?""==MinimumValue.Value?"":MinimumValue.Value:"")+"\n                            "+__e(MinimumValue.IsAdopt&&""!=MinimumValue.Value&&ItemValue.IsAdopt&&""!=ItemValue.Value?"/":"")+"\n                            "+__e(ItemValue.IsAdopt?""==ItemValue.Value?"":ItemValue.Value:"")+"\n                            "+__e(ItemValue.IsAdopt&&""!=ItemValue.Value&&ChallengeValue.IsAdopt&&""!=ChallengeValue.Value||MinimumValue.IsAdopt&&""!=MinimumValue.Value&&ChallengeValue.IsAdopt&&""!=ChallengeValue.Value?"/":"")+"\n                            "+__e(ChallengeValue.IsAdopt?""==ChallengeValue.Value?"":ChallengeValue.Value:"")+"\n                        </span>\n                    </strong>\n                </span>\n            </span>\n        "):(__p+="\n            ",0!=Assessment.Status&&(__p+='\n            <span class="object-score disinblock  fright">\n                <span class="obj-item disblock ">\n                    '+__e(i18n.completeValue)+"("+__e(Unit)+')\n                </span>\n                <span class="obj-value disblock">\n                    <strong>\n                        <span class="target-val">\n                            '+__e(CompleteValue||"")+"\n                        </span>\n                    </strong>\n                </span>\n            </span>\n            "),__p+='\n            <span class="object-scoreGoal disinblock  fright">\n            ',(MinimumValue.IsAdopt||ItemValue.IsAdopt||ChallengeValue.IsAdopt)&&(__p+='\n            <span class="obj-item disblock">\n                    '+__e(i18n.targetValue)+"("+__e(Unit)+")\n                </span>\n            "),__p+='\n                <span class="obj-value disblock">\n                    <strong>\n                        <span class="target-val">\n                            '+__e(MinimumValue.IsAdopt?""==MinimumValue.Value?"":MinimumValue.Value:"")+"\n                            "+__e(MinimumValue.IsAdopt&&""!=MinimumValue.Value&&ItemValue.IsAdopt&&""!=ItemValue.Value?"/":"")+"\n                            "+__e(ItemValue.IsAdopt&&""!=ItemValue.Value&&ItemValue.Value?ItemValue.Value:"")+"\n                            "+__e(ItemValue.IsAdopt&&""!=ItemValue.Value&&ChallengeValue.IsAdopt&&""!=ChallengeValue.Value||MinimumValue.IsAdopt&&""!=MinimumValue.Value&&ChallengeValue.IsAdopt&&""!=ChallengeValue.Value?"/":"")+"\n                            "+__e(ChallengeValue.IsAdopt?""==ChallengeValue.Value?"":ChallengeValue.Value:"")+"\n                        </span>\n                    </strong>\n                </span>\n            </span>\n        "),__p+="\n    "),__p+='\n    </div>\n</div>\n\n<div class="target-content">\n    ',"all"==mode?(__p+='\n       <ul class="con-list">\n        \x3c!--汇总模块 多个循环--\x3e\n            <li class="goal-content">\n                <label>'+__e(i18n.deadline)+'</label>\n                <span class="label-value">'+__e(EndDate)+"</span>\n            </li>\n            ","0"!=ModuleType&&"7"!=ModuleType||(__p+="\n                ",CustomFields&&(__p+='\n                    <ul class="customsFiled">     \n                        ',_.each(CustomFields,function(a,b){__p+='\n                             <li class="custom-container goal-content custom-line">\n                                <label>'+__e(a.Name)+'</label>\n                                <pre class="label-value">'+__e(a.Description)+"</pre>\n                            </li>\n                        "}),__p+="\n                    </ul>\n                "),__p+='\n                <li class="goal-content">\n                    ',7==ModuleType?__p+="\n                        <label>"+__e(i18n.relatedTasks)+'</label>\n                        <span class="label-value">\n                            '+__e(i18n.sumTasks)+'\n                            <strong id="taskNumber">0</strong>'+__e(i18n.countTasks)+"\n                        </span>\n                    ":(__p+="\n                        ","Task"==AssessmentItemManageType?__p+="\n                            <label>"+__e(i18n.relatedTasks)+'</label>\n                            <span class="label-value">\n                                '+__e(i18n.sumTasks)+'\n                                <strong id="taskNumber">0</strong>'+__e(i18n.countTasks)+"\n                            </span>\n                        ":"OKR"==AssessmentItemManageType&&"00000000-0000-0000-0000-000000000000"!=TargetId&&(__p+='\n                            <span class="label-value">\n                                '+__e(i18n.sumTasks)+'\n                                <strong id="KrNumber">0</strong>'+__e(i18n.countTarget)+"\n                            </span>\n                        "),__p+="\n                    "),__p+="\n                    \n                    ",InIframe||(__p+='\n                    <span class="task-operation fright">\n                        ',"Task"==AssessmentItemManageType&&"7"!=ModuleType&&(__p+='\n                            <a href="javascript:void(0)" class="link add-taskItem">\n                                '+__e(i18n.addTask)+'\n                            </a>|\n                            <a href="javascript:void(0)" class="link copy-taskItem">\n                                '+__e(i18n.copyTask)+'\n                            </a>|\n                            <a href="javascript:void(0)" class="link add-feedback">\n                                '+__e(i18n.feedback)+"\n                                ",AttachmentCount&&(__p+='\n                                    <span class="object-feedback">'+__e(AttachmentCount)+'</span>\n                                    <span class="object-number"></span>\n                                '),__p+="                               \n                            </a>\n                        "),__p+="                            \n                    </span>\n                    "),__p+='\n                </li>\n                <li class="task-item add-task" style="display:none;">\n                    <input type="text" class="input-taskname" value="'+__e(i18n.taskName)+'" >\n                    <input type="text" class="input-tasktime"  readonly="readonly" value="'+__e(i18n.taskDeadline)+'" />\n                    <span class="btn btn-blue btn-small addTask"> \n                        '+__e(i18n.addTaskBtn)+'\n                    </span> \n                </li>\n                <br/>\n                <li class="task-container">\n                    \n                </li>\n            '),__p+='\n                <li class="ratescore-list">\n                </li>\n                <li class="third-feed">\n                </li>\n                <li class="object-feed clearfix">\n                    ',1==FeedShow&&(__p+='\n                        <a href="javascript:void(0)" class="link" data-count="'+__e(FeedCount)+'" data-type="feed">\n                            '+__e(i18n.otherFeed)+"("+__e(FeedCount)+")"+__e(i18n.frUnit)+"</a>\n                            ",1==AppraiserShow&&(__p+="\n                                |\n                            "),__p+="\n                    "),__p+="\n                    ",1==AppraiserShow&&(__p+='\n                        <a href="javascript:void(0)" class="link" data-count="'+__e(AppraiserCount)+'"  data-type="rate">\n                            '+__e(i18n.otherRate)+"("+__e(AppraiserCount)+")"+__e(i18n.frUnit)+"</a>\n                    "),__p+='\n                </li>\n    \n        </ul>\n    </div>\n    <div class="show-content">\n        <span class="arrow-up"></span>\n    </div>\n    '):"simple"==mode||"weightChange"==mode&&2==WeightType?__p+='\n        </div>\n        <div class="show-content">\n            <span class="arrow-down"></span>\n        </div>\n    ':"sortable"==mode&&(__p+="\n    \n    "),__p+=" \n    \n\n"}return __p},this.JST["assessment/third-feed-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="person-info disinblock fright">\n\t<span class="disblock">\n\t\t<img src="'+__e(Talent.Context.getStaticUrl("images/third-person.png"))+'" height="50"  width="50">\n\t</span>\n\t',"feed"==type?__p+='\n\t\t<span class="disblock colorBlack">'+__e(i18n.thirdFeed)+"</span>\n\t":__p+='\n\t    <span class="disblock colorBlack">'+__e(i18n.thirdRate)+"</span>\n\t",__p+='\n</div>\n<div class="cart-right disinblock fright">\n</div>\n<div class="info-content disinblock fright">\n\t<ul>\n\t\t<li class="person-score-list">\n\t\t\t',_.each(RoleRates,function(a,b){__p+="\n\t\t\t\t<span>"+__e(a.Name)+__e(i18n.rateScore)+"</span>:<span>"+__e(a.RateScore)+"</span>&nbsp;&nbsp;\n\t\t\t"}),__p+='\n\t\t</li>\n\t\t<li class="feed-desc">\n\t\t\t'+__e(i18n.thirdRight(ownerName))+"\n\t\t</li>\n\t\t",_.each(Appraises,function(a,b){b+1==Appraises.length?__p+='\n\t\t\t<li class="feed-info-last">\n\t\t':__p+='\n\t\t\t<li class="feed-info">\n\t\t',__p+='\n\t\t\t<div class="person-info disinblock fleft  specWidth">\n\t\t\t\t<span class="disblock">\n\t\t\t\t\t'+(null==(__t=_.convertImage({className:"photo",src:a.UserAvatar.Small,size:30,shape:"radius",name:a.UserAvatar.Name,bgColor:a.UserAvatar.Color,HasAvatar:a.UserAvatar.HasAvatar}))?"":__t)+'\n\t\t\t\t</span>\n\t\t\t\t<span class="disblock colorBlack" title="'+__e(a.AssessorName)+'">'+__e(a.AssessorName)+'</span>\n\t\t\t</div>\n\t\t\t<div class="person-feed-info disinblock specContent">\n\t\t\t\t<ul>\n\t\t\t\t\t<li class="form-select">\n\t\t\t\t\t<span class="disblock">\n\t\t\t\t\t\t<span class="form-label">'+__e(i18n.rateScore)+'</span>\n\t\t\t\t\t\t<span class="form-num disinblock">\n\t\t\t\t\t\t\t',"-"!=a.RateScore&&a.RateScore-0==1e4?__p+="\n\t\t\t\t\t\t\t\t"+__e(a.RateScore-0==1e4?_.langs("common","invaluably"):Number(a.RateScore))+"</strong>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t<strong>"+(null==(__t=a.RateScoreDesc)?"":__t)+"</strong>\t\n\t\t\t\t\t\t\t":__p+="\n\t\t\t\t\t\t\t\t<strong>\n\t\t\t\t\t\t\t\t"+__e(a.RateScore)+"</strong>\n\t\t\t\t\t\t\t\t<strong>"+(null==(__t=a.RateScoreName)?"":__t)+"</strong>\n\t\t\t\t\t\t\t\t<strong>"+(null==(__t=a.RateScoreDesc)?"":__t)+"</strong>\t\n\n\t\t\t\t\t\t\t",__p+='\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t</span> &nbsp;\n\t\t\t\t\t</span>\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class="form-select">\n\t\t\t\t\t<span class="disblock">\n\t\t\t\t\t\t<span class="form-label">'+__e(i18n.rateComment)+'</span>\n\t\t\t\t\t\t<span class="form-content disinblock" >\n\t\t\t\t\t\t\t',_.each(_.unescape(a.RateStatement).split("\n"),function(a){__p+="\n\t               \t\t\t\t"+__e(a)+"<br />\n\t              \t\t\t"}),__p+=" \n\t\t\t\t\t\t</span>\n\t\t\t\t\t</span>\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</li>\n\t\t"}),__p+="\n\t</ul>\n</div>";return __p},this.JST["assessment/user-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)UserInfo.UserAvatar&&!1===UserInfo.UserAvatar.HasAvatar||!UserInfo.UserAvatar?__p+="\n\t"+(null==(__t=_.convertImagePerDefault({name:UserInfo.Name,size:112}))?"":__t)+"\n":__p+="\n\t"+(null==(__t=_.convertImage({className:"photo",src:UserInfo.UserAvatar.Big,size:112,shape:"square",name:UserInfo.UserAvatar.Name,bgColor:UserInfo.UserAvatar.Color,HasAvatar:UserInfo.UserAvatar.HasAvatar}))?"":__t)+"\n",__p+="\n",isAppraiserStep?(2==Assessment.CurrentRoleTypeId?__p+='\n\t\t   <div class="stamp stamp-step2 stamp-langs-'+__e(BSGlobal.lang)+'-2"></div>\n\t':__p+='\n\t\t\t<div class="stamp stamp-step101  stamp-langs-'+__e(BSGlobal.lang)+'-101"></div>\n\t',__p+="\n"):__p+=' \n\t<div class="stamp stamp-step'+__e(CurrentStepTypeId)+"  stamp-langs-"+__e(BSGlobal.lang)+"-"+__e(CurrentStepTypeId)+'" ></div>\n',__p+='\n<ul class="info disinblock">\n\t<li class="firstLine">\n\t\t<span class="current-name">\n\t\t\t'+__e(UserInfo.Name)+'\n\t\t</span>\n\t\t<span class=" list-image js-tips iconfont toOther-fix pdf-image " original-title="pdf">\n\t\t</span>\n\t\t',CanToOther&&(__p+='\n\t\t\t<span class="js-toOther list-image js-tips iconfont icon-zhuanjiao toOther-fix" original-title="'+__e(i18n.transmitOther)+'">\n\t\t</span>\n\t\t'),__p+="\n\n\t\t",CanAdd&&(__p+='\n\t\t\t<span class="js-sendback list-image js-tips iconfont icon-tianjia feedback-fix" original-title="'+__e(i18n.inviteotherstofeedback)+'">\n\t\t\t</span>\n\t\t'),__p+="\n\t\t",isMultipleStep||(__p+='\n\t\t\t<span style="width:300px;margin-top:3px;">\n\t\t\t',_.each(appraiserList,function(a,b){CanAdd?(__p+='\n\t\t\t\t\t<div style="position: relative;float: left;">\n\t\t\t\t\t\t<span class="back-person list-image" data-id="'+__e(a.AppraiserId)+'" original-title="'+__e(a.Name)+'" >\n\t\t\t\t\t    \t\n\t\t\t\t\t\t\t',a.UserAvatar&&!1===a.UserAvatar.HasAvatar||!a.UserAvatar?__p+="\n\t\t\t\t\t\t\t\t"+(null==(__t=_.convertImagePerDefault({name:a.Name,size:30}))?"":__t)+"\n\t\t\t\t\t\t\t":__p+="\n\t\t\t\t\t\t\t\t"+(null==(__t=_.convertImage({className:"photo",src:a.UserAvatar.Small,size:30,shape:"radius",name:a.UserAvatar.Name,bgColor:a.UserAvatar.Color,HasAvatar:a.UserAvatar.HasAvatar}))?"":__t)+"\n\t\t\t\t\t\t\t",__p+="\n\t\t\t\t\t\t\t",a.IsProcess&&(__p+='\n\t\t\t\t\t\t\t\t<div class="appraiserMask"></div>\n\t\t\t\t\t\t\t'),__p+='\n\t\t\t\t\t\t</span>\n\t\t\t\t\t\t<div class="tipsAppraiser">\n\t\t\t\t\t\t\t',a.IsProcess?__p+='\n\t\t\t\t\t\t\t\t<span class="deleteAppraiser" original-title="'+__e(i18n.deleteAppraiser)+'" data-id="'+__e(a.AppraiserId)+"\" style='margin-left: 12px;'></span>\n\t\t\t\t\t\t\t":__p+='\n\t\t\t\t\t\t\t\t<span class="pressAppraiser" original-title="'+__e(i18n.pressAppraiser)+'" data-id="'+__e(a.AppraiserId)+'"></span>\n\t\t\t\t\t\t\t\t<span class="deleteAppraiser" original-title="'+__e(i18n.deleteAppraiser)+'" data-id="'+__e(a.AppraiserId)+"\" style='margin-left: 7px;'></span>\n\t\t\t\t\t\t\t",__p+="\n\t\t\t\t\t\t</div>\n\t\t\t\t\t</div>\n\t\t\t\t"):(__p+='\n\t\t\t\t\t<span class="list-image" data-id="'+__e(a.AppraiserId)+'" original-title="'+__e(a.Name)+'">\n\t\t\t\t\t    '+(null==(__t=_.convertImage({className:"photo",src:a.UserAvatar.Small,size:30,shape:"radius",name:a.UserAvatar.Name,bgColor:a.UserAvatar.Color,HasAvatar:a.UserAvatar.HasAvatar}))?"":__t)+"\n\t\t\t\t\t    ",a.IsProcess&&(__p+='\n\t\t\t\t\t\t\t<div class="appraiserMask"></div>\n\t\t\t\t\t\t'),__p+="\n\t\t\t\t\t</span>\n\t\t\t\t")}),__p+="\n\t\t\t</span>\n\t\t"),__p+="\n\t\t\n\t</li>\n\t",UserInfo.Department?(__p+='\n\t\t<li class="disblock">\n\t\t\t<i class="iconfont  icon-bumen disinblock" />\n\t\t\t<span class=\'info-text\'>'+__e(UserInfo.Department)+"\n\t\t\t\t",UserInfo.Position&&(__p+="\n\t\t\t\t&nbsp;|&nbsp;"+__e(UserInfo.Position)+"\n\t\t\t\t"),__p+="\n\t\t\t</span>\n\t\t</li>\n\t"):(__p+="\n\t\t",UserInfo.Position&&(__p+="\n\t\t<li class=\"iconfont disinblock  icon-gangweiguanli\" >\n\t\t\t<span class='info-text'>\n\t\t\t\t"+__e(UserInfo.Position)+"\n\t\t\t</span>\n\t\t</li>\n\t\t"),__p+="\n\t"),__p+="\n\t",UserInfo.Email&&(__p+='\n\t\t<li class="">\n\t\t\t<i class="iconfont  icon-youxiang disinblock" />\n\t\t\t<span class=\'info-text\' style="position:relative;top:-1px">\n\t\t\t\t'+__e(UserInfo.Email)+"\n\t\t\t</span>\n\t\t</li>\n\t"),__p+="\n\t",UserInfo.Phone&&(__p+="\n\t\t<li class=\"iconfont icon-dianhua disblock\">\n\t\t\t<span class='info-text'>"+__e(UserInfo.Phone)+"&nbsp;</span>\n\t\t\t\n\t\t</li>\n\t"),__p+="\n\t",UserInfo.Mobile&&(__p+="\n\t\t<li class=\"iconfont icon-cp-number disblock\">\n\t\t\t<span class='info-text'>"+__e(UserInfo.Mobile)+"</span>\n\t\t</li>\n\t"),__p+="\n</ul>\n";return __p},this.JST}),function(a){"function"==typeof define&&define.amd?define("select2",["jquery"],a):a("object"==typeof exports?require("jquery"):jQuery)}(function(a){var b=function(){if(a&&a.fn&&a.fn.select2&&a.fn.select2.amd)var b=a.fn.select2.amd;var b;return function(){if(!b||!b.requirejs){b?c=b:b={};var a,c,d;!function(b){function e(a,b){return u.call(a,b)}function f(a,b){var c,d,e,f,g,h,i,j,k,l,m,n=b&&b.split("/"),o=s.map,p=o&&o["*"]||{};if(a&&"."===a.charAt(0))if(b){for(a=a.split("/"),g=a.length-1,s.nodeIdCompat&&w.test(a[g])&&(a[g]=a[g].replace(w,"")),a=n.slice(0,n.length-1).concat(a),k=0;k<a.length;k+=1)if("."===(m=a[k]))a.splice(k,1),k-=1;else if(".."===m){if(1===k&&(".."===a[2]||".."===a[0]))break;k>0&&(a.splice(k-1,2),k-=2)}a=a.join("/")}else 0===a.indexOf("./")&&(a=a.substring(2));if((n||p)&&o){for(c=a.split("/"),k=c.length;k>0;k-=1){if(d=c.slice(0,k).join("/"),n)for(l=n.length;l>0;l-=1)if((e=o[n.slice(0,l).join("/")])&&(e=e[d])){f=e,h=k;break}if(f)break;!i&&p&&p[d]&&(i=p[d],j=k)}!f&&i&&(f=i,h=j),f&&(c.splice(0,h,f),a=c.join("/"))}return a}function g(a,c){return function(){var d=v.call(arguments,0);return"string"!=typeof d[0]&&1===d.length&&d.push(null),n.apply(b,d.concat([a,c]))}}function h(a){return function(b){return f(b,a)}}function i(a){return function(b){q[a]=b}}function j(a){if(e(r,a)){var c=r[a];delete r[a],t[a]=!0,m.apply(b,c)}if(!e(q,a)&&!e(t,a))throw new Error("No "+a);return q[a]}function k(a){var b,c=a?a.indexOf("!"):-1;return c>-1&&(b=a.substring(0,c),a=a.substring(c+1,a.length)),[b,a]}function l(a){return function(){return s&&s.config&&s.config[a]||{}}}var m,n,o,p,q={},r={},s={},t={},u=Object.prototype.hasOwnProperty,v=[].slice,w=/\.js$/;o=function(a,b){var c,d=k(a),e=d[0];return a=d[1],e&&(e=f(e,b),c=j(e)),e?a=c&&c.normalize?c.normalize(a,h(b)):f(a,b):(a=f(a,b),d=k(a),e=d[0],a=d[1],e&&(c=j(e))),{f:e?e+"!"+a:a,n:a,pr:e,p:c}},p={require:function(a){return g(a)},exports:function(a){var b=q[a];return void 0!==b?b:q[a]={}},module:function(a){return{id:a,uri:"",exports:q[a],config:l(a)}}},m=function(a,c,d,f){var h,k,l,m,n,s,u=[],v=typeof d;if(f=f||a,"undefined"===v||"function"===v){for(c=!c.length&&d.length?["require","exports","module"]:c,n=0;n<c.length;n+=1)if(m=o(c[n],f),"require"===(k=m.f))u[n]=p.require(a);else if("exports"===k)u[n]=p.exports(a),s=!0;else if("module"===k)h=u[n]=p.module(a);else if(e(q,k)||e(r,k)||e(t,k))u[n]=j(k);else{if(!m.p)throw new Error(a+" missing "+k);m.p.load(m.n,g(f,!0),i(k),{}),u[n]=q[k]}l=d?d.apply(q[a],u):void 0,a&&(h&&h.exports!==b&&h.exports!==q[a]?q[a]=h.exports:l===b&&s||(q[a]=l))}else a&&(q[a]=d)},a=c=n=function(a,c,d,e,f){if("string"==typeof a)return p[a]?p[a](c):j(o(a,c).f);if(!a.splice){if(s=a,s.deps&&n(s.deps,s.callback),!c)return;c.splice?(a=c,c=d,d=null):a=b}return c=c||function(){},"function"==typeof d&&(d=e,e=f),e?m(b,a,c,d):setTimeout(function(){m(b,a,c,d)},4),n},n.config=function(a){return n(a)},a._defined=q,d=function(a,b,c){if("string"!=typeof a)throw new Error("See almond README: incorrect module build, no module name");b.splice||(c=b,b=[]),e(q,a)||e(r,a)||(r[a]=[a,b,c])},d.amd={jQuery:!0}}(),b.requirejs=a,b.require=c,b.define=d}}(),b.define("almond",function(){}),b.define("jquery",[],function(){return a||$}),b.define("select2/utils",["jquery"],function(a){function b(a){var b=a.prototype,c=[];for(var d in b){"function"==typeof b[d]&&("constructor"!==d&&c.push(d))}return c}var c={};c.Extend=function(a,b){function c(){this.constructor=a}var d={}.hasOwnProperty;for(var e in b)d.call(b,e)&&(a[e]=b[e]);return c.prototype=b.prototype,a.prototype=new c,a.__super__=b.prototype,a},c.Decorate=function(a,c){function d(){var b=Array.prototype.unshift,d=c.prototype.constructor.length,e=a.prototype.constructor;d>0&&(b.call(arguments,a.prototype.constructor),e=c.prototype.constructor),e.apply(this,arguments)}function e(){this.constructor=d}var f=b(c),g=b(a);c.displayName=a.displayName,d.prototype=new e;for(var h=0;h<g.length;h++){var i=g[h];d.prototype[i]=a.prototype[i]}for(var j=(function(a){var b=function(){};a in d.prototype&&(b=d.prototype[a]);var e=c.prototype[a];return function(){return Array.prototype.unshift.call(arguments,b),e.apply(this,arguments)}}),k=0;k<f.length;k++){var l=f[k];d.prototype[l]=j(l)}return d};var d=function(){this.listeners={}};return d.prototype.on=function(a,b){this.listeners=this.listeners||{},a in this.listeners?this.listeners[a].push(b):this.listeners[a]=[b]},d.prototype.trigger=function(a){var b=Array.prototype.slice;this.listeners=this.listeners||{},a in this.listeners&&this.invoke(this.listeners[a],b.call(arguments,1)),"*"in this.listeners&&this.invoke(this.listeners["*"],arguments)},d.prototype.invoke=function(a,b){for(var c=0,d=a.length;c<d;c++)a[c].apply(this,b)},c.Observable=d,c.generateChars=function(a){for(var b="",c=0;c<a;c++){b+=Math.floor(36*Math.random()).toString(36)}return b},c.bind=function(a,b){return function(){a.apply(b,arguments)}},c._convertData=function(a){for(var b in a){var c=b.split("-"),d=a;if(1!==c.length){for(var e=0;e<c.length;e++){var f=c[e];f=f.substring(0,1).toLowerCase()+f.substring(1),f in d||(d[f]={}),e==c.length-1&&(d[f]=a[b]),d=d[f]}delete a[b]}}return a},c.hasScroll=function(b,c){var d=a(c),e=c.style.overflowX,f=c.style.overflowY;return(e!==f||"hidden"!==f&&"visible"!==f)&&("scroll"===e||"scroll"===f||(d.innerHeight()<c.scrollHeight||d.innerWidth()<c.scrollWidth))},c.escapeMarkup=function(a){var b={"\\":"&#92;","&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#39;","/":"&#47;"};return"string"!=typeof a?a:String(a).replace(/[&<>"'\/\\]/g,function(a){return b[a]})},c.appendMany=function(b,c){if("1.7"===a.fn.jquery.substr(0,3)){var d=a();a.map(c,function(a){d=d.add(a)}),c=d}b.append(c)},c}),b.define("select2/results",["jquery","./utils"],function(a,b){function c(a,b,d){this.$element=a,this.data=d,this.options=b,c.__super__.constructor.call(this)}return b.Extend(c,b.Observable),c.prototype.render=function(){var b=a('<ul class="select2-results__options" role="tree"></ul>');return this.options.get("multiple")&&b.attr("aria-multiselectable","true"),this.$results=b,b},c.prototype.clear=function(){this.$results.empty()},c.prototype.displayMessage=function(b){var c=this.options.get("escapeMarkup");this.clear(),this.hideLoading();var d=a('<li role="treeitem" aria-live="assertive" class="select2-results__option"></li>'),e=this.options.get("translations").get(b.message);d.append(c(e(b.args))),d[0].className+=" select2-results__message",this.$results.append(d)},c.prototype.hideMessages=function(){this.$results.find(".select2-results__message").remove()},c.prototype.append=function(a){this.hideLoading();var b=[];if(null==a.results||0===a.results.length)return void(0===this.$results.children().length&&this.trigger("results:message",{message:"noResults"}));a.results=this.sort(a.results);for(var c=0;c<a.results.length;c++){var d=a.results[c],e=this.option(d);b.push(e)}this.$results.append(b)},c.prototype.position=function(a,b){b.find(".select2-results").append(a)},c.prototype.sort=function(a){return this.options.get("sorter")(a)},c.prototype.setClasses=function(){var b=this;this.data.current(function(c){var d=a.map(c,function(a){return a.id.toString()}),e=b.$results.find(".select2-results__option[aria-selected]");e.each(function(){var b=a(this),c=a.data(this,"data"),e=""+c.id;null!=c.element&&c.element.selected||null==c.element&&a.inArray(e,d)>-1?b.attr("aria-selected","true"):b.attr("aria-selected","false")});var f=e.filter("[aria-selected=true]");f.length>0?f.first().trigger("mouseenter"):e.first().trigger("mouseenter")})},c.prototype.showLoading=function(a){this.hideLoading();var b=this.options.get("translations").get("searching"),c={disabled:!0,loading:!0,text:b(a)},d=this.option(c);d.className+=" loading-results",this.$results.prepend(d)},c.prototype.hideLoading=function(){this.$results.find(".loading-results").remove()},c.prototype.option=function(b){var c=document.createElement("li");c.className="select2-results__option";var d={role:"treeitem","aria-selected":"false"};b.disabled&&(delete d["aria-selected"],d["aria-disabled"]="true"),null==b.id&&delete d["aria-selected"],null!=b._resultId&&(c.id=b._resultId),b.title&&(c.title=b.title),b.children&&(d.role="group",d["aria-label"]=b.text,delete d["aria-selected"]);for(var e in d){var f=d[e];c.setAttribute(e,f)}if(b.children){var g=a(c),h=document.createElement("strong");h.className="select2-results__group";a(h);this.template(b,h);for(var i=[],j=0;j<b.children.length;j++){var k=b.children[j],l=this.option(k);i.push(l)}var m=a("<ul></ul>");m.addClass("select2-results__options select2-results__options--nested"),m.append(i),g.append(h),g.append(m)}else this.template(b,c);return a.data(c,"data",b),c},c.prototype.bind=function(b,c){var d=this,e=b.id+"-results";this.$results.attr("id",e),b.on("results:all",function(a){d.clear(),d.append(a.data),b.isOpen()&&d.setClasses()}),b.on("results:append",function(a){d.append(a.data),b.isOpen()&&d.setClasses()}),b.on("query",function(a){d.hideMessages(),d.showLoading(a)}),b.on("select",function(){b.isOpen()&&d.setClasses()}),b.on("unselect",function(){b.isOpen()&&d.setClasses()}),b.on("open",function(){d.$results.attr("aria-expanded","true"),d.$results.attr("aria-hidden","false"),d.setClasses(),d.ensureHighlightVisible()}),b.on("close",function(){d.$results.attr("aria-expanded","false"),d.$results.attr("aria-hidden","true"),d.$results.removeAttr("aria-activedescendant")}),b.on("results:toggle",function(){var a=d.getHighlightedResults();0!==a.length&&a.trigger("mouseup")}),b.on("results:select",function(){var a=d.getHighlightedResults();if(0!==a.length){var b=a.data("data");"true"==a.attr("aria-selected")?d.trigger("close",{}):d.trigger("select",{data:b})}}),b.on("results:previous",function(){var a=d.getHighlightedResults(),b=d.$results.find("[aria-selected]"),c=b.index(a);if(0!==c){var e=c-1;0===a.length&&(e=0);var f=b.eq(e);f.trigger("mouseenter");var g=d.$results.offset().top,h=f.offset().top,i=d.$results.scrollTop()+(h-g);0===e?d.$results.scrollTop(0):h-g<0&&d.$results.scrollTop(i)}}),b.on("results:next",function(){var a=d.getHighlightedResults(),b=d.$results.find("[aria-selected]"),c=b.index(a),e=c+1;if(!(e>=b.length)){var f=b.eq(e);f.trigger("mouseenter");var g=d.$results.offset().top+d.$results.outerHeight(!1),h=f.offset().top+f.outerHeight(!1),i=d.$results.scrollTop()+h-g;0===e?d.$results.scrollTop(0):h>g&&d.$results.scrollTop(i)}}),b.on("results:focus",function(a){a.element.addClass("select2-results__option--highlighted")}),b.on("results:message",function(a){d.displayMessage(a)}),a.fn.mousewheel&&this.$results.on("mousewheel",function(a){var b=d.$results.scrollTop(),c=d.$results.get(0).scrollHeight-b+a.deltaY,e=a.deltaY>0&&b-a.deltaY<=0,f=a.deltaY<0&&c<=d.$results.height();e?(d.$results.scrollTop(0),a.preventDefault(),a.stopPropagation()):f&&(d.$results.scrollTop(d.$results.get(0).scrollHeight-d.$results.height()),a.preventDefault(),a.stopPropagation())}),this.$results.on("mouseup",".select2-results__option[aria-selected]",function(b){var c=a(this),e=c.data("data");if("true"===c.attr("aria-selected"))return void(d.options.get("multiple")?d.trigger("unselect",{originalEvent:b,data:e}):d.trigger("close",{}));d.trigger("select",{originalEvent:b,data:e})}),this.$results.on("mouseenter",".select2-results__option[aria-selected]",function(b){var c=a(this).data("data");d.getHighlightedResults().removeClass("select2-results__option--highlighted"),d.trigger("results:focus",{data:c,element:a(this)})})},c.prototype.getHighlightedResults=function(){return this.$results.find(".select2-results__option--highlighted")},c.prototype.destroy=function(){this.$results.remove()},c.prototype.ensureHighlightVisible=function(){var a=this.getHighlightedResults();if(0!==a.length){var b=this.$results.find("[aria-selected]"),c=b.index(a),d=this.$results.offset().top,e=a.offset().top,f=this.$results.scrollTop()+(e-d),g=e-d;f-=2*a.outerHeight(!1),c<=2?this.$results.scrollTop(0):(g>this.$results.outerHeight()||g<0)&&this.$results.scrollTop(f)}},c.prototype.template=function(b,c){var d=this.options.get("templateResult"),e=this.options.get("escapeMarkup"),f=d(b,c);null==f?c.style.display="none":"string"==typeof f?c.innerHTML=e(f):a(c).append(f)},c}),b.define("select2/keys",[],function(){return{BACKSPACE:8,TAB:9,ENTER:13,SHIFT:16,CTRL:17,ALT:18,ESC:27,SPACE:32,PAGE_UP:33,PAGE_DOWN:34,END:35,HOME:36,LEFT:37,UP:38,RIGHT:39,DOWN:40,DELETE:46}}),b.define("select2/selection/base",["jquery","../utils","../keys"],function(a,b,c){function d(a,b){this.$element=a,this.options=b,d.__super__.constructor.call(this)}return b.Extend(d,b.Observable),d.prototype.render=function(){var b=a('<span class="select2-selection" role="combobox"  aria-haspopup="true" aria-expanded="false"></span>');return this._tabindex=0,null!=this.$element.data("old-tabindex")?this._tabindex=this.$element.data("old-tabindex"):null!=this.$element.attr("tabindex")&&(this._tabindex=this.$element.attr("tabindex")),b.attr("title",this.$element.attr("title")),b.attr("tabindex",this._tabindex),this.$selection=b,b},d.prototype.bind=function(a,b){var d=this,e=(a.id,a.id+"-results");this.container=a,this.$selection.on("focus",function(a){d.trigger("focus",a)}),this.$selection.on("blur",function(a){d._handleBlur(a)}),this.$selection.on("keydown",function(a){d.trigger("keypress",a),a.which===c.SPACE&&a.preventDefault()}),a.on("results:focus",function(a){d.$selection.attr("aria-activedescendant",a.data._resultId)}),a.on("selection:update",function(a){d.update(a.data)}),a.on("open",function(){d.$selection.attr("aria-expanded","true"),d.$selection.attr("aria-owns",e),d._attachCloseHandler(a)}),a.on("close",function(){d.$selection.attr("aria-expanded","false"),d.$selection.removeAttr("aria-activedescendant"),d.$selection.removeAttr("aria-owns"),d.$selection.focus(),d._detachCloseHandler(a)}),a.on("enable",function(){d.$selection.attr("tabindex",d._tabindex)}),a.on("disable",function(){d.$selection.attr("tabindex","-1")})},d.prototype._handleBlur=function(b){var c=this;window.setTimeout(function(){document.activeElement==c.$selection[0]||a.contains(c.$selection[0],document.activeElement)||c.trigger("blur",b)},1)},d.prototype._attachCloseHandler=function(b){a(document.body).on("mousedown.select2."+b.id,function(b){var c=a(b.target),d=c.closest(".select2");a(".select2.select2-container--open").each(function(){var b=a(this);this!=d[0]&&b.data("element").select2("close")})})},d.prototype._detachCloseHandler=function(b){a(document.body).off("mousedown.select2."+b.id)},d.prototype.position=function(a,b){b.find(".selection").append(a)},d.prototype.destroy=function(){this._detachCloseHandler(this.container)},d.prototype.update=function(a){throw new Error("The `update` method must be defined in child classes.")},d}),b.define("select2/selection/single",["jquery","./base","../utils","../keys"],function(a,b,c,d){function e(){e.__super__.constructor.apply(this,arguments)}return c.Extend(e,b),e.prototype.render=function(){var a=e.__super__.render.call(this);return a.addClass("select2-selection--single"),a.html('<span class="select2-selection__rendered"></span><span class="select2-selection__arrow" role="presentation"><b role="presentation"></b></span>'),a},e.prototype.bind=function(a,b){var c=this;e.__super__.bind.apply(this,arguments);var d=a.id+"-container";this.$selection.find(".select2-selection__rendered").attr("id",d),this.$selection.attr("aria-labelledby",d),this.$selection.on("mousedown",function(a){1===a.which&&c.trigger("toggle",{originalEvent:a})}),this.$selection.on("focus",function(a){}),this.$selection.on("blur",function(a){}),a.on("selection:update",function(a){c.update(a.data)})},e.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},e.prototype.display=function(a,b){var c=this.options.get("templateSelection");return this.options.get("escapeMarkup")(c(a,b))},e.prototype.selectionContainer=function(){return a("<span></span>")},e.prototype.update=function(a){if(0===a.length)return void this.clear();var b=a[0],c=this.$selection.find(".select2-selection__rendered"),d=this.display(b,c);c.empty().append(d),c.prop("title",b.title||b.text)},e}),b.define("select2/selection/multiple",["jquery","./base","../utils"],function(a,b,c){function d(a,b){d.__super__.constructor.apply(this,arguments)}return c.Extend(d,b),d.prototype.render=function(){var a=d.__super__.render.call(this);return a.addClass("select2-selection--multiple"),a.html('<ul class="select2-selection__rendered"></ul>'),a},d.prototype.bind=function(b,c){var e=this;d.__super__.bind.apply(this,arguments),this.$selection.on("click",function(a){e.trigger("toggle",{originalEvent:a})}),this.$selection.on("click",".select2-selection__choice__remove",function(b){if(!e.options.get("disabled")){var c=a(this),d=c.parent(),f=d.data("data");e.trigger("unselect",{originalEvent:b,data:f})}})},d.prototype.clear=function(){this.$selection.find(".select2-selection__rendered").empty()},d.prototype.display=function(a,b){var c=this.options.get("templateSelection");return this.options.get("escapeMarkup")(c(a,b))},d.prototype.selectionContainer=function(){return a('<li class="select2-selection__choice"><span class="select2-selection__choice__remove" role="presentation">&times;</span></li>')},d.prototype.update=function(a){if(this.clear(),0!==a.length){for(var b=[],d=0;d<a.length;d++){var e=a[d],f=this.selectionContainer(),g=this.display(e,f);f.append(g),f.prop("title",e.title||e.text),f.data("data",e),b.push(f)}var h=this.$selection.find(".select2-selection__rendered");c.appendMany(h,b)}},d}),b.define("select2/selection/placeholder",["../utils"],function(a){function b(a,b,c){this.placeholder=this.normalizePlaceholder(c.get("placeholder")),a.call(this,b,c)}return b.prototype.normalizePlaceholder=function(a,b){return"string"==typeof b&&(b={id:"",text:b}),b},b.prototype.createPlaceholder=function(a,b){var c=this.selectionContainer();return c.html(this.display(b)),c.addClass("select2-selection__placeholder").removeClass("select2-selection__choice"),c},b.prototype.update=function(a,b){var c=1==b.length&&b[0].id!=this.placeholder.id;if(b.length>1||c)return a.call(this,b);this.clear();var d=this.createPlaceholder(this.placeholder);this.$selection.find(".select2-selection__rendered").append(d)},b}),b.define("select2/selection/allowClear",["jquery","../keys"],function(a,b){function c(){}return c.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),this.placeholder,this.$selection.on("mousedown",".select2-selection__clear",function(a){d._handleClear(a)}),b.on("keypress",function(a){d._handleKeyboardClear(a,b)})},c.prototype._handleClear=function(a,b){if(!this.options.get("disabled")){var c=this.$selection.find(".select2-selection__clear");if(0!==c.length){b.stopPropagation();for(var d=c.data("data"),e=0;e<d.length;e++){var f={data:d[e]};if(this.trigger("unselect",f),f.prevented)return}this.$element.val(this.placeholder.id).trigger("change"),this.trigger("toggle",{})}}},c.prototype._handleKeyboardClear=function(a,c,d){d.isOpen()||c.which!=b.DELETE&&c.which!=b.BACKSPACE||this._handleClear(c)},c.prototype.update=function(b,c){if(b.call(this,c),!(this.$selection.find(".select2-selection__placeholder").length>0||0===c.length)){var d=a('<span class="select2-selection__clear">&times;</span>');d.data("data",c),this.$selection.find(".select2-selection__rendered").prepend(d)}},c}),b.define("select2/selection/search",["jquery","../utils","../keys"],function(a,b,c){function d(a,b,c){a.call(this,b,c)}return d.prototype.render=function(b){var c=a('<li class="select2-search select2-search--inline"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" aria-autocomplete="list" /></li>');this.$searchContainer=c,this.$search=c.find("input");var d=b.call(this);return this._transferTabIndex(),d},d.prototype.bind=function(a,b,d){var e=this;a.call(this,b,d),b.on("open",function(){e.$search.trigger("focus")}),b.on("close",function(){e.$search.val(""),e.$search.removeAttr("aria-activedescendant"),e.$search.trigger("focus")}),b.on("enable",function(){e.$search.prop("disabled",!1),e._transferTabIndex()}),b.on("disable",function(){e.$search.prop("disabled",!0)}),b.on("focus",function(a){e.$search.trigger("focus")}),b.on("results:focus",function(a){e.$search.attr("aria-activedescendant",a.id)}),this.$selection.on("focusin",".select2-search--inline",function(a){e.trigger("focus",a)}),this.$selection.on("focusout",".select2-search--inline",function(a){e._handleBlur(a)}),this.$selection.on("keydown",".select2-search--inline",function(a){if(a.stopPropagation(),e.trigger("keypress",a),e._keyUpPrevented=a.isDefaultPrevented(),a.which===c.BACKSPACE&&""===e.$search.val()){var b=e.$searchContainer.prev(".select2-selection__choice");if(b.length>0){var d=b.data("data");e.searchRemoveChoice(d),a.preventDefault()}}});var f=document.documentMode,g=f&&f<=11;this.$selection.on("input.searchcheck",".select2-search--inline",function(a){if(g)return void e.$selection.off("input.search input.searchcheck");e.$selection.off("keyup.search")}),this.$selection.on("keyup.search input.search",".select2-search--inline",function(a){if(g&&"input"===a.type)return void e.$selection.off("input.search input.searchcheck");var b=a.which;b!=c.SHIFT&&b!=c.CTRL&&b!=c.ALT&&b!=c.TAB&&e.handleSearch(a)})},d.prototype._transferTabIndex=function(a){this.$search.attr("tabindex",this.$selection.attr("tabindex")),this.$selection.attr("tabindex","-1")},d.prototype.createPlaceholder=function(a,b){this.$search.attr("placeholder",b.text)},d.prototype.update=function(a,b){var c=this.$search[0]==document.activeElement;this.$search.attr("placeholder",""),a.call(this,b),this.$selection.find(".select2-selection__rendered").append(this.$searchContainer),this.resizeSearch(),c&&this.$search.focus()},d.prototype.handleSearch=function(){if(this.resizeSearch(),!this._keyUpPrevented){var a=this.$search.val();this.trigger("query",{term:a})}this._keyUpPrevented=!1},d.prototype.searchRemoveChoice=function(a,b){this.trigger("unselect",{data:b}),this.$search.val(b.text),this.handleSearch()},d.prototype.resizeSearch=function(){this.$search.css("width","25px");var a="";if(""!==this.$search.attr("placeholder"))a=this.$selection.find(".select2-selection__rendered").innerWidth();else{a=.75*(this.$search.val().length+1)+"em"}this.$search.css("width",a)},d}),b.define("select2/selection/eventRelay",["jquery"],function(a){function b(){}return b.prototype.bind=function(b,c,d){var e=this,f=["open","opening","close","closing","select","selecting","unselect","unselecting"],g=["opening","closing","selecting","unselecting"];b.call(this,c,d),c.on("*",function(b,c){if(-1!==a.inArray(b,f)){c=c||{};var d=a.Event("select2:"+b,{params:c});e.$element.trigger(d),-1!==a.inArray(b,g)&&(c.prevented=d.isDefaultPrevented())}})},b}),b.define("select2/translation",["jquery","require"],function(a,b){function c(a){this.dict=a||{}}return c.prototype.all=function(){return this.dict},c.prototype.get=function(a){return this.dict[a]},c.prototype.extend=function(b){this.dict=a.extend({},b.all(),this.dict)},c._cache={},c.loadPath=function(a){if(!(a in c._cache)){var d=b(a);c._cache[a]=d}return new c(c._cache[a])},c}),b.define("select2/diacritics",[],function(){return{"Ⓐ":"A","Ａ":"A","À":"A","Á":"A","Â":"A","Ầ":"A","Ấ":"A","Ẫ":"A","Ẩ":"A","Ã":"A","Ā":"A","Ă":"A","Ằ":"A","Ắ":"A","Ẵ":"A","Ẳ":"A","Ȧ":"A","Ǡ":"A","Ä":"A","Ǟ":"A","Ả":"A","Å":"A","Ǻ":"A","Ǎ":"A","Ȁ":"A","Ȃ":"A","Ạ":"A","Ậ":"A","Ặ":"A","Ḁ":"A","Ą":"A","Ⱥ":"A","Ɐ":"A","Ꜳ":"AA","Æ":"AE","Ǽ":"AE","Ǣ":"AE","Ꜵ":"AO","Ꜷ":"AU","Ꜹ":"AV","Ꜻ":"AV","Ꜽ":"AY","Ⓑ":"B","Ｂ":"B","Ḃ":"B","Ḅ":"B","Ḇ":"B","Ƀ":"B","Ƃ":"B","Ɓ":"B","Ⓒ":"C","Ｃ":"C","Ć":"C","Ĉ":"C","Ċ":"C","Č":"C","Ç":"C","Ḉ":"C","Ƈ":"C","Ȼ":"C","Ꜿ":"C","Ⓓ":"D","Ｄ":"D","Ḋ":"D","Ď":"D","Ḍ":"D","Ḑ":"D","Ḓ":"D","Ḏ":"D","Đ":"D","Ƌ":"D","Ɗ":"D","Ɖ":"D","Ꝺ":"D","Ǳ":"DZ","Ǆ":"DZ","ǲ":"Dz","ǅ":"Dz","Ⓔ":"E","Ｅ":"E","È":"E","É":"E","Ê":"E","Ề":"E","Ế":"E","Ễ":"E","Ể":"E","Ẽ":"E","Ē":"E","Ḕ":"E","Ḗ":"E","Ĕ":"E","Ė":"E","Ë":"E","Ẻ":"E","Ě":"E","Ȅ":"E","Ȇ":"E","Ẹ":"E","Ệ":"E","Ȩ":"E","Ḝ":"E","Ę":"E","Ḙ":"E","Ḛ":"E","Ɛ":"E","Ǝ":"E","Ⓕ":"F","Ｆ":"F","Ḟ":"F","Ƒ":"F","Ꝼ":"F","Ⓖ":"G","Ｇ":"G","Ǵ":"G","Ĝ":"G","Ḡ":"G","Ğ":"G","Ġ":"G","Ǧ":"G","Ģ":"G","Ǥ":"G","Ɠ":"G","Ꞡ":"G","Ᵹ":"G","Ꝿ":"G","Ⓗ":"H","Ｈ":"H","Ĥ":"H","Ḣ":"H","Ḧ":"H","Ȟ":"H","Ḥ":"H","Ḩ":"H","Ḫ":"H","Ħ":"H","Ⱨ":"H","Ⱶ":"H","Ɥ":"H","Ⓘ":"I","Ｉ":"I","Ì":"I","Í":"I","Î":"I","Ĩ":"I","Ī":"I","Ĭ":"I","İ":"I","Ï":"I","Ḯ":"I","Ỉ":"I","Ǐ":"I","Ȉ":"I","Ȋ":"I","Ị":"I","Į":"I","Ḭ":"I","Ɨ":"I","Ⓙ":"J","Ｊ":"J","Ĵ":"J","Ɉ":"J","Ⓚ":"K","Ｋ":"K","Ḱ":"K","Ǩ":"K","Ḳ":"K","Ķ":"K","Ḵ":"K","Ƙ":"K","Ⱪ":"K","Ꝁ":"K","Ꝃ":"K","Ꝅ":"K","Ꞣ":"K","Ⓛ":"L","Ｌ":"L","Ŀ":"L","Ĺ":"L","Ľ":"L","Ḷ":"L","Ḹ":"L","Ļ":"L","Ḽ":"L","Ḻ":"L","Ł":"L","Ƚ":"L","Ɫ":"L","Ⱡ":"L","Ꝉ":"L","Ꝇ":"L","Ꞁ":"L","Ǉ":"LJ","ǈ":"Lj","Ⓜ":"M","Ｍ":"M","Ḿ":"M","Ṁ":"M","Ṃ":"M","Ɱ":"M","Ɯ":"M","Ⓝ":"N","Ｎ":"N","Ǹ":"N","Ń":"N","Ñ":"N","Ṅ":"N","Ň":"N","Ṇ":"N","Ņ":"N","Ṋ":"N","Ṉ":"N","Ƞ":"N","Ɲ":"N","Ꞑ":"N","Ꞥ":"N","Ǌ":"NJ","ǋ":"Nj","Ⓞ":"O","Ｏ":"O","Ò":"O","Ó":"O","Ô":"O","Ồ":"O","Ố":"O","Ỗ":"O","Ổ":"O","Õ":"O","Ṍ":"O","Ȭ":"O","Ṏ":"O","Ō":"O","Ṑ":"O","Ṓ":"O","Ŏ":"O","Ȯ":"O","Ȱ":"O","Ö":"O","Ȫ":"O","Ỏ":"O","Ő":"O","Ǒ":"O","Ȍ":"O","Ȏ":"O","Ơ":"O","Ờ":"O","Ớ":"O","Ỡ":"O","Ở":"O","Ợ":"O","Ọ":"O","Ộ":"O","Ǫ":"O","Ǭ":"O","Ø":"O","Ǿ":"O","Ɔ":"O","Ɵ":"O","Ꝋ":"O","Ꝍ":"O","Ƣ":"OI","Ꝏ":"OO","Ȣ":"OU","Ⓟ":"P","Ｐ":"P","Ṕ":"P","Ṗ":"P","Ƥ":"P","Ᵽ":"P","Ꝑ":"P","Ꝓ":"P","Ꝕ":"P","Ⓠ":"Q","Ｑ":"Q","Ꝗ":"Q","Ꝙ":"Q","Ɋ":"Q","Ⓡ":"R","Ｒ":"R","Ŕ":"R","Ṙ":"R","Ř":"R","Ȑ":"R","Ȓ":"R","Ṛ":"R","Ṝ":"R","Ŗ":"R","Ṟ":"R","Ɍ":"R","Ɽ":"R","Ꝛ":"R","Ꞧ":"R","Ꞃ":"R","Ⓢ":"S","Ｓ":"S","ẞ":"S","Ś":"S","Ṥ":"S","Ŝ":"S","Ṡ":"S","Š":"S","Ṧ":"S","Ṣ":"S","Ṩ":"S","Ș":"S","Ş":"S","Ȿ":"S","Ꞩ":"S","Ꞅ":"S","Ⓣ":"T","Ｔ":"T","Ṫ":"T","Ť":"T","Ṭ":"T","Ț":"T","Ţ":"T","Ṱ":"T","Ṯ":"T","Ŧ":"T","Ƭ":"T","Ʈ":"T","Ⱦ":"T","Ꞇ":"T","Ꜩ":"TZ","Ⓤ":"U","Ｕ":"U","Ù":"U","Ú":"U","Û":"U","Ũ":"U","Ṹ":"U","Ū":"U","Ṻ":"U","Ŭ":"U","Ü":"U","Ǜ":"U","Ǘ":"U","Ǖ":"U","Ǚ":"U","Ủ":"U","Ů":"U","Ű":"U","Ǔ":"U","Ȕ":"U","Ȗ":"U","Ư":"U","Ừ":"U","Ứ":"U","Ữ":"U","Ử":"U","Ự":"U","Ụ":"U","Ṳ":"U","Ų":"U","Ṷ":"U","Ṵ":"U","Ʉ":"U","Ⓥ":"V","Ｖ":"V","Ṽ":"V","Ṿ":"V","Ʋ":"V","Ꝟ":"V","Ʌ":"V","Ꝡ":"VY","Ⓦ":"W","Ｗ":"W","Ẁ":"W","Ẃ":"W","Ŵ":"W","Ẇ":"W","Ẅ":"W","Ẉ":"W","Ⱳ":"W","Ⓧ":"X","Ｘ":"X","Ẋ":"X","Ẍ":"X","Ⓨ":"Y","Ｙ":"Y","Ỳ":"Y","Ý":"Y","Ŷ":"Y","Ỹ":"Y","Ȳ":"Y","Ẏ":"Y","Ÿ":"Y","Ỷ":"Y","Ỵ":"Y","Ƴ":"Y","Ɏ":"Y","Ỿ":"Y","Ⓩ":"Z","Ｚ":"Z","Ź":"Z","Ẑ":"Z","Ż":"Z","Ž":"Z","Ẓ":"Z","Ẕ":"Z","Ƶ":"Z","Ȥ":"Z","Ɀ":"Z","Ⱬ":"Z","Ꝣ":"Z","ⓐ":"a","ａ":"a","ẚ":"a","à":"a","á":"a","â":"a","ầ":"a","ấ":"a","ẫ":"a","ẩ":"a","ã":"a","ā":"a","ă":"a","ằ":"a","ắ":"a","ẵ":"a","ẳ":"a","ȧ":"a","ǡ":"a","ä":"a","ǟ":"a","ả":"a","å":"a","ǻ":"a","ǎ":"a","ȁ":"a","ȃ":"a","ạ":"a","ậ":"a","ặ":"a","ḁ":"a","ą":"a","ⱥ":"a","ɐ":"a","ꜳ":"aa","æ":"ae","ǽ":"ae","ǣ":"ae","ꜵ":"ao","ꜷ":"au","ꜹ":"av","ꜻ":"av","ꜽ":"ay","ⓑ":"b","ｂ":"b","ḃ":"b","ḅ":"b","ḇ":"b","ƀ":"b","ƃ":"b","ɓ":"b","ⓒ":"c","ｃ":"c","ć":"c","ĉ":"c","ċ":"c","č":"c","ç":"c","ḉ":"c","ƈ":"c","ȼ":"c","ꜿ":"c","ↄ":"c","ⓓ":"d","ｄ":"d","ḋ":"d","ď":"d","ḍ":"d","ḑ":"d","ḓ":"d","ḏ":"d","đ":"d","ƌ":"d","ɖ":"d","ɗ":"d","ꝺ":"d","ǳ":"dz","ǆ":"dz","ⓔ":"e","ｅ":"e","è":"e","é":"e","ê":"e","ề":"e","ế":"e","ễ":"e","ể":"e","ẽ":"e","ē":"e","ḕ":"e","ḗ":"e","ĕ":"e","ė":"e","ë":"e","ẻ":"e","ě":"e","ȅ":"e","ȇ":"e","ẹ":"e","ệ":"e","ȩ":"e","ḝ":"e","ę":"e","ḙ":"e","ḛ":"e","ɇ":"e","ɛ":"e","ǝ":"e","ⓕ":"f","ｆ":"f","ḟ":"f","ƒ":"f","ꝼ":"f","ⓖ":"g","ｇ":"g","ǵ":"g","ĝ":"g","ḡ":"g","ğ":"g","ġ":"g","ǧ":"g","ģ":"g","ǥ":"g","ɠ":"g","ꞡ":"g","ᵹ":"g","ꝿ":"g","ⓗ":"h","ｈ":"h","ĥ":"h","ḣ":"h","ḧ":"h","ȟ":"h","ḥ":"h","ḩ":"h","ḫ":"h","ẖ":"h","ħ":"h","ⱨ":"h","ⱶ":"h","ɥ":"h","ƕ":"hv","ⓘ":"i","ｉ":"i","ì":"i","í":"i","î":"i","ĩ":"i","ī":"i","ĭ":"i","ï":"i","ḯ":"i","ỉ":"i","ǐ":"i","ȉ":"i","ȋ":"i","ị":"i","į":"i","ḭ":"i","ɨ":"i","ı":"i","ⓙ":"j","ｊ":"j","ĵ":"j","ǰ":"j","ɉ":"j","ⓚ":"k","ｋ":"k","ḱ":"k","ǩ":"k","ḳ":"k","ķ":"k","ḵ":"k","ƙ":"k","ⱪ":"k","ꝁ":"k","ꝃ":"k","ꝅ":"k","ꞣ":"k","ⓛ":"l","ｌ":"l","ŀ":"l","ĺ":"l","ľ":"l","ḷ":"l","ḹ":"l","ļ":"l","ḽ":"l","ḻ":"l","ſ":"l","ł":"l","ƚ":"l","ɫ":"l","ⱡ":"l","ꝉ":"l","ꞁ":"l","ꝇ":"l","ǉ":"lj","ⓜ":"m","ｍ":"m","ḿ":"m","ṁ":"m","ṃ":"m","ɱ":"m","ɯ":"m","ⓝ":"n","ｎ":"n","ǹ":"n","ń":"n","ñ":"n","ṅ":"n","ň":"n","ṇ":"n","ņ":"n","ṋ":"n","ṉ":"n","ƞ":"n","ɲ":"n","ŉ":"n","ꞑ":"n","ꞥ":"n","ǌ":"nj","ⓞ":"o","ｏ":"o","ò":"o","ó":"o","ô":"o","ồ":"o","ố":"o","ỗ":"o","ổ":"o","õ":"o","ṍ":"o","ȭ":"o","ṏ":"o","ō":"o","ṑ":"o","ṓ":"o","ŏ":"o","ȯ":"o","ȱ":"o","ö":"o","ȫ":"o","ỏ":"o","ő":"o","ǒ":"o","ȍ":"o","ȏ":"o","ơ":"o","ờ":"o","ớ":"o","ỡ":"o","ở":"o","ợ":"o","ọ":"o","ộ":"o","ǫ":"o","ǭ":"o","ø":"o","ǿ":"o","ɔ":"o","ꝋ":"o","ꝍ":"o","ɵ":"o","ƣ":"oi","ȣ":"ou","ꝏ":"oo","ⓟ":"p","ｐ":"p","ṕ":"p","ṗ":"p","ƥ":"p","ᵽ":"p","ꝑ":"p","ꝓ":"p","ꝕ":"p","ⓠ":"q","ｑ":"q","ɋ":"q","ꝗ":"q","ꝙ":"q","ⓡ":"r","ｒ":"r","ŕ":"r","ṙ":"r","ř":"r","ȑ":"r","ȓ":"r","ṛ":"r","ṝ":"r","ŗ":"r","ṟ":"r","ɍ":"r","ɽ":"r","ꝛ":"r","ꞧ":"r","ꞃ":"r","ⓢ":"s","ｓ":"s","ß":"s","ś":"s","ṥ":"s","ŝ":"s","ṡ":"s","š":"s","ṧ":"s","ṣ":"s","ṩ":"s","ș":"s","ş":"s","ȿ":"s","ꞩ":"s","ꞅ":"s","ẛ":"s","ⓣ":"t","ｔ":"t","ṫ":"t","ẗ":"t","ť":"t","ṭ":"t","ț":"t","ţ":"t","ṱ":"t","ṯ":"t","ŧ":"t","ƭ":"t","ʈ":"t","ⱦ":"t","ꞇ":"t","ꜩ":"tz","ⓤ":"u","ｕ":"u","ù":"u","ú":"u","û":"u","ũ":"u","ṹ":"u","ū":"u","ṻ":"u","ŭ":"u","ü":"u","ǜ":"u","ǘ":"u","ǖ":"u","ǚ":"u","ủ":"u","ů":"u","ű":"u","ǔ":"u","ȕ":"u","ȗ":"u","ư":"u","ừ":"u","ứ":"u","ữ":"u","ử":"u","ự":"u","ụ":"u","ṳ":"u","ų":"u","ṷ":"u","ṵ":"u","ʉ":"u","ⓥ":"v","ｖ":"v","ṽ":"v","ṿ":"v","ʋ":"v","ꝟ":"v","ʌ":"v","ꝡ":"vy","ⓦ":"w","ｗ":"w","ẁ":"w","ẃ":"w","ŵ":"w","ẇ":"w","ẅ":"w","ẘ":"w","ẉ":"w","ⱳ":"w","ⓧ":"x","ｘ":"x","ẋ":"x","ẍ":"x","ⓨ":"y","ｙ":"y","ỳ":"y","ý":"y","ŷ":"y","ỹ":"y","ȳ":"y","ẏ":"y","ÿ":"y","ỷ":"y","ẙ":"y","ỵ":"y","ƴ":"y","ɏ":"y","ỿ":"y","ⓩ":"z","ｚ":"z","ź":"z","ẑ":"z","ż":"z","ž":"z","ẓ":"z","ẕ":"z","ƶ":"z","ȥ":"z","ɀ":"z","ⱬ":"z","ꝣ":"z","Ά":"Α","Έ":"Ε","Ή":"Η","Ί":"Ι","Ϊ":"Ι","Ό":"Ο","Ύ":"Υ","Ϋ":"Υ","Ώ":"Ω","ά":"α","έ":"ε","ή":"η","ί":"ι","ϊ":"ι","ΐ":"ι","ό":"ο","ύ":"υ","ϋ":"υ","ΰ":"υ","ω":"ω","ς":"σ"}}),b.define("select2/data/base",["../utils"],function(a){function b(a,c){b.__super__.constructor.call(this)}return a.Extend(b,a.Observable),b.prototype.current=function(a){throw new Error("The `current` method must be defined in child classes.")},b.prototype.query=function(a,b){throw new Error("The `query` method must be defined in child classes.")},b.prototype.bind=function(a,b){},b.prototype.destroy=function(){},b.prototype.generateResultId=function(b,c){var d=b.id+"-result-";return d+=a.generateChars(4),null!=c.id?d+="-"+c.id.toString():d+="-"+a.generateChars(4),d},b}),b.define("select2/data/select",["./base","../utils","jquery"],function(a,b,c){function d(a,b){this.$element=a,this.options=b,d.__super__.constructor.call(this)}return b.Extend(d,a),d.prototype.current=function(a){var b=[],d=this;this.$element.find(":selected").each(function(){var a=c(this),e=d.item(a);b.push(e)}),a(b)},d.prototype.select=function(a){var b=this;if(a.selected=!0,c(a.element).is("option"))return a.element.selected=!0,void this.$element.trigger("change");if(this.$element.prop("multiple"))this.current(function(d){var e=[];a=[a],a.push.apply(a,d);for(var f=0;f<a.length;f++){var g=a[f].id;-1===c.inArray(g,e)&&e.push(g)}b.$element.val(e),b.$element.trigger("change")});else{var d=a.id;this.$element.val(d),this.$element.trigger("change")}},d.prototype.unselect=function(a){var b=this;if(this.$element.prop("multiple")){if(a.selected=!1,c(a.element).is("option"))return a.element.selected=!1,void this.$element.trigger("change");this.current(function(d){for(var e=[],f=0;f<d.length;f++){var g=d[f].id;g!==a.id&&-1===c.inArray(g,e)&&e.push(g)}b.$element.val(e),b.$element.trigger("change")})}},d.prototype.bind=function(a,b){var c=this;this.container=a,a.on("select",function(a){c.select(a.data)}),a.on("unselect",function(a){c.unselect(a.data)})},d.prototype.destroy=function(){this.$element.find("*").each(function(){c.removeData(this,"data")})},d.prototype.query=function(a,b){var d=[],e=this;this.$element.children().each(function(){var b=c(this);if(b.is("option")||b.is("optgroup")){var f=e.item(b),g=e.matches(a,f);null!==g&&d.push(g)}}),b({results:d})},d.prototype.addOptions=function(a){b.appendMany(this.$element,a)},d.prototype.option=function(a){var b;a.children?(b=document.createElement("optgroup"),b.label=a.text):(b=document.createElement("option"),void 0!==b.textContent?b.textContent=a.text:b.innerText=a.text),a.id&&(b.value=a.id),a.disabled&&(b.disabled=!0),a.selected&&(b.selected=!0),a.title&&(b.title=a.title);var d=c(b),e=this._normalizeItem(a);return e.element=b,c.data(b,"data",e),d},d.prototype.item=function(a){var b={};if(null!=(b=c.data(a[0],"data")))return b;if(a.is("option"))b={id:a.val(),text:a.text(),disabled:a.prop("disabled"),selected:a.prop("selected"),title:a.prop("title")};else if(a.is("optgroup")){b={text:a.prop("label"),children:[],title:a.prop("title")};for(var d=a.children("option"),e=[],f=0;f<d.length;f++){var g=c(d[f]),h=this.item(g);e.push(h)}b.children=e}return b=this._normalizeItem(b),b.element=a[0],c.data(a[0],"data",b),b},d.prototype._normalizeItem=function(a){c.isPlainObject(a)||(a={id:a,text:a}),a=c.extend({},{text:""},a);var b={selected:!1,disabled:!1};return null!=a.id&&(a.id=a.id.toString()),null!=a.text&&(a.text=a.text.toString()),null==a._resultId&&a.id&&null!=this.container&&(a._resultId=this.generateResultId(this.container,a)),c.extend({},b,a)},d.prototype.matches=function(a,b){return this.options.get("matcher")(a,b)},d}),b.define("select2/data/array",["./select","../utils","jquery"],function(a,b,c){function d(a,b){var c=b.get("data")||[];d.__super__.constructor.call(this,a,b),this.addOptions(this.convertToOptions(c))}return b.Extend(d,a),d.prototype.select=function(a){var b=this.$element.find("option").filter(function(b,c){return c.value==a.id.toString()});0===b.length&&(b=this.option(a),this.addOptions(b)),d.__super__.select.call(this,a)},d.prototype.convertToOptions=function(a){function d(a){return function(){return c(this).val()==a.id}}for(var e=this,f=this.$element.find("option"),g=f.map(function(){return e.item(c(this)).id}).get(),h=[],i=0;i<a.length;i++){var j=this._normalizeItem(a[i]);if(c.inArray(j.id,g)>=0){var k=f.filter(d(j)),l=this.item(k),m=c.extend(!0,{},j,l),n=this.option(m);k.replaceWith(n)}else{var o=this.option(j);if(j.children){var p=this.convertToOptions(j.children);b.appendMany(o,p)}h.push(o)}}return h},d}),b.define("select2/data/ajax",["./array","../utils","jquery"],function(a,b,c){function d(a,b){this.ajaxOptions=this._applyDefaults(b.get("ajax")),null!=this.ajaxOptions.processResults&&(this.processResults=this.ajaxOptions.processResults),d.__super__.constructor.call(this,a,b)}return b.Extend(d,a),d.prototype._applyDefaults=function(a){var b={data:function(a){return c.extend({},a,{q:a.term})},transport:function(a,b,d){var e=c.ajax(a);return e.then(b),e.fail(d),e}};return c.extend({},b,a,!0)},d.prototype.processResults=function(a){return a},d.prototype.query=function(a,b){function d(){var c=f.transport(f,function(c){var d=e.processResults(c,a);b(d)},function(){e.trigger("results:message",{message:"errorLoading"})});e._request=c}var e=this;null!=this._request&&(c.isFunction(this._request.abort)&&this._request.abort(),this._request=null);var f=c.extend({type:"GET"},this.ajaxOptions);"function"==typeof f.url&&(f.url=f.url.call(this.$element,a)),"function"==typeof f.data&&(f.data=f.data.call(this.$element,a)),this.ajaxOptions.delay&&""!==a.term?(this._queryTimeout&&window.clearTimeout(this._queryTimeout),this._queryTimeout=window.setTimeout(d,this.ajaxOptions.delay)):d()},d}),b.define("select2/data/tags",["jquery"],function(a){function b(b,c,d){var e=d.get("tags"),f=d.get("createTag");void 0!==f&&(this.createTag=f);var g=d.get("insertTag");if(void 0!==g&&(this.insertTag=g),b.call(this,c,d),a.isArray(e))for(var h=0;h<e.length;h++){var i=e[h],j=this._normalizeItem(i),k=this.option(j);this.$element.append(k)}}return b.prototype.query=function(a,b,c){function d(a,f){for(var g=a.results,h=0;h<g.length;h++){var i=g[h],j=null!=i.children&&!d({results:i.children},!0);if(i.text===b.term||j)return!f&&(a.data=g,void c(a))}if(f)return!0;var k=e.createTag(b);if(null!=k){var l=e.option(k);l.attr("data-select2-tag",!0),e.addOptions([l]),e.insertTag(g,k)}a.results=g,c(a)}var e=this;if(this._removeOldTags(),null==b.term||null!=b.page)return void a.call(this,b,c);a.call(this,b,d)},b.prototype.createTag=function(b,c){var d=a.trim(c.term);return""===d?null:{id:d,text:d}},b.prototype.insertTag=function(a,b,c){b.unshift(c)},b.prototype._removeOldTags=function(b){this._lastTag;this.$element.find("option[data-select2-tag]").each(function(){this.selected||a(this).remove()})},b}),b.define("select2/data/tokenizer",["jquery"],function(a){function b(a,b,c){var d=c.get("tokenizer");void 0!==d&&(this.tokenizer=d),a.call(this,b,c)}return b.prototype.bind=function(a,b,c){a.call(this,b,c),this.$search=b.dropdown.$search||b.selection.$search||c.find(".select2-search__field")},b.prototype.query=function(a,b,c){function d(a){e.trigger("select",{data:a})}var e=this;b.term=b.term||"";var f=this.tokenizer(b,this.options,d);f.term!==b.term&&(this.$search.length&&(this.$search.val(f.term),this.$search.focus()),b.term=f.term),a.call(this,b,c)},b.prototype.tokenizer=function(b,c,d,e){for(var f=d.get("tokenSeparators")||[],g=c.term,h=0,i=this.createTag||function(a){return{id:a.term,text:a.term}};h<g.length;){var j=g[h];if(-1!==a.inArray(j,f)){var k=g.substr(0,h),l=a.extend({},c,{term:k}),m=i(l);null!=m?(e(m),g=g.substr(h+1)||"",h=0):h++}else h++}return{term:g}},b}),b.define("select2/data/minimumInputLength",[],function(){function a(a,b,c){this.minimumInputLength=c.get("minimumInputLength"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){if(b.term=b.term||"",b.term.length<this.minimumInputLength)return void this.trigger("results:message",{message:"inputTooShort",args:{minimum:this.minimumInputLength,input:b.term,params:b}});a.call(this,b,c)},a}),b.define("select2/data/maximumInputLength",[],function(){function a(a,b,c){this.maximumInputLength=c.get("maximumInputLength"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){if(b.term=b.term||"",this.maximumInputLength>0&&b.term.length>this.maximumInputLength)return void this.trigger("results:message",{message:"inputTooLong",args:{maximum:this.maximumInputLength,input:b.term,params:b}});a.call(this,b,c)},a}),b.define("select2/data/maximumSelectionLength",[],function(){function a(a,b,c){this.maximumSelectionLength=c.get("maximumSelectionLength"),a.call(this,b,c)}return a.prototype.query=function(a,b,c){var d=this;this.current(function(e){var f=null!=e?e.length:0;if(d.maximumSelectionLength>0&&f>=d.maximumSelectionLength)return void d.trigger("results:message",{message:"maximumSelected",args:{maximum:d.maximumSelectionLength}});a.call(d,b,c)})},a}),b.define("select2/dropdown",["jquery","./utils"],function(a,b){function c(a,b){this.$element=a,this.options=b,c.__super__.constructor.call(this)}return b.Extend(c,b.Observable),c.prototype.render=function(){var b=a('<span class="select2-dropdown"><span class="select2-results"></span></span>');return b.attr("dir",this.options.get("dir")),this.$dropdown=b,b},c.prototype.bind=function(){},c.prototype.position=function(a,b){},c.prototype.destroy=function(){this.$dropdown.remove()},c}),b.define("select2/dropdown/search",["jquery","../utils"],function(a,b){function c(){}return c.prototype.render=function(b){var c=b.call(this),d=a('<span class="select2-search select2-search--dropdown"><input class="select2-search__field" type="search" tabindex="-1" autocomplete="off" autocorrect="off" autocapitalize="off" spellcheck="false" role="textbox" /></span>');return this.$searchContainer=d,this.$search=d.find("input"),c.prepend(d),c},c.prototype.bind=function(b,c,d){var e=this;b.call(this,c,d),this.$search.on("keydown",function(a){e.trigger("keypress",a),e._keyUpPrevented=a.isDefaultPrevented()}),this.$search.on("input",function(b){a(this).off("keyup")}),this.$search.on("keyup input",function(a){e.handleSearch(a)}),c.on("open",function(){e.$search.attr("tabindex",0),e.$search.focus(),window.setTimeout(function(){e.$search.focus()},0)}),c.on("close",function(){e.$search.attr("tabindex",-1),e.$search.val("")}),c.on("results:all",function(a){if(null==a.query.term||""===a.query.term){e.showSearch(a)?e.$searchContainer.removeClass("select2-search--hide"):e.$searchContainer.addClass("select2-search--hide")}})},c.prototype.handleSearch=function(a){if(!this._keyUpPrevented){var b=this.$search.val();this.trigger("query",{term:b})}this._keyUpPrevented=!1},c.prototype.showSearch=function(a,b){return!0},c}),b.define("select2/dropdown/hidePlaceholder",[],function(){function a(a,b,c,d){this.placeholder=this.normalizePlaceholder(c.get("placeholder")),a.call(this,b,c,d)}return a.prototype.append=function(a,b){b.results=this.removePlaceholder(b.results),a.call(this,b)},a.prototype.normalizePlaceholder=function(a,b){return"string"==typeof b&&(b={id:"",text:b}),b},a.prototype.removePlaceholder=function(a,b){for(var c=b.slice(0),d=b.length-1;d>=0;d--){var e=b[d];this.placeholder.id===e.id&&c.splice(d,1)}return c},a}),b.define("select2/dropdown/infiniteScroll",["jquery"],function(a){function b(a,b,c,d){this.lastParams={},a.call(this,b,c,d),this.$loadingMore=this.createLoadingMore(),this.loading=!1}return b.prototype.append=function(a,b){this.$loadingMore.remove(),this.loading=!1,a.call(this,b),this.showLoadingMore(b)&&this.$results.append(this.$loadingMore)},b.prototype.bind=function(b,c,d){var e=this;b.call(this,c,d),c.on("query",function(a){e.lastParams=a,e.loading=!0}),c.on("query:append",function(a){e.lastParams=a,e.loading=!0}),this.$results.on("scroll",function(){var b=a.contains(document.documentElement,e.$loadingMore[0]);if(!e.loading&&b){e.$results.offset().top+e.$results.outerHeight(!1)+50>=e.$loadingMore.offset().top+e.$loadingMore.outerHeight(!1)&&e.loadMore()}})},b.prototype.loadMore=function(){this.loading=!0;var b=a.extend({},{page:1},this.lastParams);b.page++,this.trigger("query:append",b)},b.prototype.showLoadingMore=function(a,b){return b.pagination&&b.pagination.more},b.prototype.createLoadingMore=function(){var b=a('<li class="select2-results__option select2-results__option--load-more"role="treeitem" aria-disabled="true"></li>'),c=this.options.get("translations").get("loadingMore");return b.html(c(this.lastParams)),b},b}),b.define("select2/dropdown/attachBody",["jquery","../utils"],function(a,b){function c(b,c,d){this.$dropdownParent=d.get("dropdownParent")||a(document.body),b.call(this,c,d)}return c.prototype.bind=function(a,b,c){var d=this,e=!1;a.call(this,b,c),b.on("open",function(){d._showDropdown(),d._attachPositioningHandler(b),e||(e=!0,b.on("results:all",function(){d._positionDropdown(),d._resizeDropdown()}),b.on("results:append",function(){d._positionDropdown(),d._resizeDropdown()}))}),b.on("close",function(){d._hideDropdown(),d._detachPositioningHandler(b)}),this.$dropdownContainer.on("mousedown",function(a){a.stopPropagation()})},c.prototype.destroy=function(a){a.call(this),this.$dropdownContainer.remove()},c.prototype.position=function(a,b,c){b.attr("class",c.attr("class")),b.removeClass("select2"),b.addClass("select2-container--open"),b.css({position:"absolute",top:-999999}),this.$container=c},c.prototype.render=function(b){var c=a("<span></span>"),d=b.call(this);return c.append(d),this.$dropdownContainer=c,c},c.prototype._hideDropdown=function(a){this.$dropdownContainer.detach()},c.prototype._attachPositioningHandler=function(c,d){var e=this,f="scroll.select2."+d.id,g="resize.select2."+d.id,h="orientationchange.select2."+d.id,i=this.$container.parents().filter(b.hasScroll);i.each(function(){a(this).data("select2-scroll-position",{x:a(this).scrollLeft(),y:a(this).scrollTop()})}),i.on(f,function(b){var c=a(this).data("select2-scroll-position");a(this).scrollTop(c.y)}),a(window).on(f+" "+g+" "+h,function(a){e._positionDropdown(),e._resizeDropdown()})},c.prototype._detachPositioningHandler=function(c,d){var e="scroll.select2."+d.id,f="resize.select2."+d.id,g="orientationchange.select2."+d.id;this.$container.parents().filter(b.hasScroll).off(e),a(window).off(e+" "+f+" "+g)},c.prototype._positionDropdown=function(){var b=a(window),c=this.$dropdown.hasClass("select2-dropdown--above"),d=this.$dropdown.hasClass("select2-dropdown--below"),e=null,f=this.$container.offset();f.bottom=f.top+this.$container.outerHeight(!1);var g={height:this.$container.outerHeight(!1)};g.top=f.top,g.bottom=f.top+g.height;var h={height:this.$dropdown.outerHeight(!1)},i={top:b.scrollTop(),bottom:b.scrollTop()+b.height()},j=i.top<f.top-h.height,k=i.bottom>f.bottom+h.height,l={left:f.left,top:g.bottom},m=this.$dropdownParent;"static"===m.css("position")&&(m=m.offsetParent());var n=m.offset();l.top-=n.top,l.left-=n.left,c||d||(e="below"),k||!j||c?!j&&k&&c&&(e="below"):e="above",("above"==e||c&&"below"!==e)&&(l.top=g.top-h.height),null!=e&&(this.$dropdown.removeClass("select2-dropdown--below select2-dropdown--above").addClass("select2-dropdown--"+e),this.$container.removeClass("select2-container--below select2-container--above").addClass("select2-container--"+e)),this.$dropdownContainer.css(l)},c.prototype._resizeDropdown=function(){var a={width:this.$container.outerWidth(!1)+"px"};this.options.get("dropdownAutoWidth")&&(a.minWidth=a.width,a.width="auto"),this.$dropdown.css(a)},c.prototype._showDropdown=function(a){this.$dropdownContainer.appendTo(this.$dropdownParent),this._positionDropdown(),this._resizeDropdown()},c}),b.define("select2/dropdown/minimumResultsForSearch",[],function(){function a(b){for(var c=0,d=0;d<b.length;d++){var e=b[d];e.children?c+=a(e.children):c++}return c}function b(a,b,c,d){this.minimumResultsForSearch=c.get("minimumResultsForSearch"),this.minimumResultsForSearch<0&&(this.minimumResultsForSearch=1/0),a.call(this,b,c,d)}return b.prototype.showSearch=function(b,c){return!(a(c.data.results)<this.minimumResultsForSearch)&&b.call(this,c)},b}),b.define("select2/dropdown/selectOnClose",[],function(){function a(){}return a.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),b.on("close",function(){d._handleSelectOnClose()})},a.prototype._handleSelectOnClose=function(){var a=this.getHighlightedResults();if(!(a.length<1)){var b=a.data("data");null!=b.element&&b.element.selected||null==b.element&&b.selected||this.trigger("select",{data:b})}},a}),b.define("select2/dropdown/closeOnSelect",[],function(){function a(){}return a.prototype.bind=function(a,b,c){var d=this;a.call(this,b,c),b.on("select",function(a){d._selectTriggered(a)}),b.on("unselect",function(a){d._selectTriggered(a)})},a.prototype._selectTriggered=function(a,b){var c=b.originalEvent;c&&c.ctrlKey||this.trigger("close",{})},a}),b.define("select2/i18n/en",[],function(){return{errorLoading:function(){return"The results could not be loaded."},inputTooLong:function(a){var b=a.input.length-a.maximum,c="Please delete "+b+" character";return 1!=b&&(c+="s"),c},inputTooShort:function(a){return"Please enter "+(a.minimum-a.input.length)+" or more characters"},loadingMore:function(){return"Loading more results…"},maximumSelected:function(a){var b="You can only select "+a.maximum+" item";return 1!=a.maximum&&(b+="s"),b},noResults:function(){return _.langs("common","noData")},searching:function(){return"Searching…"}}}),b.define("select2/defaults",["jquery","require","./results","./selection/single","./selection/multiple","./selection/placeholder","./selection/allowClear","./selection/search","./selection/eventRelay","./utils","./translation","./diacritics","./data/select","./data/array","./data/ajax","./data/tags","./data/tokenizer","./data/minimumInputLength","./data/maximumInputLength","./data/maximumSelectionLength","./dropdown","./dropdown/search","./dropdown/hidePlaceholder","./dropdown/infiniteScroll","./dropdown/attachBody","./dropdown/minimumResultsForSearch","./dropdown/selectOnClose","./dropdown/closeOnSelect","./i18n/en"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w,x,y,z,A,B,C){function D(){this.reset()}return D.prototype.apply=function(l){if(l=a.extend(!0,{},this.defaults,l),null==l.dataAdapter){if(null!=l.ajax?l.dataAdapter=o:null!=l.data?l.dataAdapter=n:l.dataAdapter=m,l.minimumInputLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,r)),l.maximumInputLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,s)),l.maximumSelectionLength>0&&(l.dataAdapter=j.Decorate(l.dataAdapter,t)),l.tags&&(l.dataAdapter=j.Decorate(l.dataAdapter,p)),null==l.tokenSeparators&&null==l.tokenizer||(l.dataAdapter=j.Decorate(l.dataAdapter,q)),null!=l.query){var C=b(l.amdBase+"compat/query");l.dataAdapter=j.Decorate(l.dataAdapter,C)}if(null!=l.initSelection){var D=b(l.amdBase+"compat/initSelection");l.dataAdapter=j.Decorate(l.dataAdapter,D)}}if(null==l.resultsAdapter&&(l.resultsAdapter=c,null!=l.ajax&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,x)),null!=l.placeholder&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,w)),l.selectOnClose&&(l.resultsAdapter=j.Decorate(l.resultsAdapter,A))),null==l.dropdownAdapter){if(l.multiple)l.dropdownAdapter=u;else{var E=j.Decorate(u,v);l.dropdownAdapter=E}if(0!==l.minimumResultsForSearch&&(l.dropdownAdapter=j.Decorate(l.dropdownAdapter,z)),l.closeOnSelect&&(l.dropdownAdapter=j.Decorate(l.dropdownAdapter,B)),null!=l.dropdownCssClass||null!=l.dropdownCss||null!=l.adaptDropdownCssClass){var F=b(l.amdBase+"compat/dropdownCss");l.dropdownAdapter=j.Decorate(l.dropdownAdapter,F)}l.dropdownAdapter=j.Decorate(l.dropdownAdapter,y)}if(null==l.selectionAdapter){if(l.multiple?l.selectionAdapter=e:l.selectionAdapter=d,null!=l.placeholder&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,f)),l.allowClear&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,g)),l.multiple&&(l.selectionAdapter=j.Decorate(l.selectionAdapter,h)),null!=l.containerCssClass||null!=l.containerCss||null!=l.adaptContainerCssClass){var G=b(l.amdBase+"compat/containerCss");l.selectionAdapter=j.Decorate(l.selectionAdapter,G)}l.selectionAdapter=j.Decorate(l.selectionAdapter,i)}if("string"==typeof l.language)if(l.language.indexOf("-")>0){var H=l.language.split("-"),I=H[0];l.language=[l.language,I]}else l.language=[l.language];if(a.isArray(l.language)){var J=new k;l.language.push("en");for(var K=l.language,L=0;L<K.length;L++){var M=K[L],N={};try{N=k.loadPath(M)}catch(a){try{M=this.defaults.amdLanguageBase+M,N=k.loadPath(M)}catch(a){continue}}J.extend(N)}l.translations=J}else{var O=k.loadPath(this.defaults.amdLanguageBase+"en"),P=new k(l.language);P.extend(O),l.translations=P}return l},D.prototype.reset=function(){function b(a){function b(a){return l[a]||a}return a.replace(/[^\u0000-\u007E]/g,b)}function c(d,e){if(""===a.trim(d.term))return e;if(e.children&&e.children.length>0){for(var f=a.extend(!0,{},e),g=e.children.length-1;g>=0;g--){null==c(d,e.children[g])&&f.children.splice(g,1)}return f.children.length>0?f:c(d,f)}var h=b(e.text).toUpperCase(),i=b(d.term).toUpperCase();return h.indexOf(i)>-1?e:null}this.defaults={amdBase:"./",amdLanguageBase:"./i18n/",closeOnSelect:!0,debug:!1,dropdownAutoWidth:!1,escapeMarkup:j.escapeMarkup,language:C,matcher:c,minimumInputLength:0,maximumInputLength:0,maximumSelectionLength:0,minimumResultsForSearch:0,selectOnClose:!1,sorter:function(a){return a},templateResult:function(a){return a.text},templateSelection:function(a){return a.text},theme:"default",width:"resolve"}},D.prototype.set=function(b,c){var d=a.camelCase(b),e={};e[d]=c;var f=j._convertData(e);a.extend(this.defaults,f)},new D}),b.define("select2/options",["require","jquery","./defaults","./utils"],function(a,b,c,d){function e(b,e){if(this.options=b,null!=e&&this.fromElement(e),this.options=c.apply(this.options),e&&e.is("input")){var f=a(this.get("amdBase")+"compat/inputData");this.options.dataAdapter=d.Decorate(this.options.dataAdapter,f)}}return e.prototype.fromElement=function(a){var c=["select2"];null==this.options.multiple&&(this.options.multiple=a.prop("multiple")),null==this.options.disabled&&(this.options.disabled=a.prop("disabled")),null==this.options.language&&(a.prop("lang")?this.options.language=a.prop("lang").toLowerCase():a.closest("[lang]").prop("lang")&&(this.options.language=a.closest("[lang]").prop("lang"))),null==this.options.dir&&(a.prop("dir")?this.options.dir=a.prop("dir"):a.closest("[dir]").prop("dir")?this.options.dir=a.closest("[dir]").prop("dir"):this.options.dir="ltr"),a.prop("disabled",this.options.disabled),a.prop("multiple",this.options.multiple),a.data("select2Tags")&&(a.data("data",a.data("select2Tags")),a.data("tags",!0)),a.data("ajaxUrl")&&(a.attr("ajax--url",a.data("ajaxUrl")),a.data("ajax--url",a.data("ajaxUrl")));var e={};e=b.fn.jquery&&"1."==b.fn.jquery.substr(0,2)&&a[0].dataset?b.extend(!0,{},a[0].dataset,a.data()):a.data();var f=b.extend(!0,{},e);f=d._convertData(f);for(var g in f)b.inArray(g,c)>-1||(b.isPlainObject(this.options[g])?b.extend(this.options[g],f[g]):this.options[g]=f[g]);return this},e.prototype.get=function(a){return this.options[a]},e.prototype.set=function(a,b){this.options[a]=b},e}),b.define("select2/core",["jquery","./options","./utils","./keys"],function(a,b,c,d){var e=function(a,c){null!=a.data("select2")&&a.data("select2").destroy(),this.$element=a,this.id=this._generateId(a),c=c||{},this.options=new b(c,a),e.__super__.constructor.call(this);var d=a.attr("tabindex")||0;a.data("old-tabindex",d),a.attr("tabindex","-1");var f=this.options.get("dataAdapter");this.dataAdapter=new f(a,this.options);var g=this.render();this._placeContainer(g);var h=this.options.get("selectionAdapter");this.selection=new h(a,this.options),this.$selection=this.selection.render(),this.selection.position(this.$selection,g);var i=this.options.get("dropdownAdapter");this.dropdown=new i(a,this.options),this.$dropdown=this.dropdown.render(),this.dropdown.position(this.$dropdown,g);var j=this.options.get("resultsAdapter");this.results=new j(a,this.options,this.dataAdapter),this.$results=this.results.render(),this.results.position(this.$results,this.$dropdown);var k=this;this._bindAdapters(),this._registerDomEvents(),this._registerDataEvents(),this._registerSelectionEvents(),this._registerDropdownEvents(),this._registerResultsEvents(),this._registerEvents(),this.dataAdapter.current(function(a){k.trigger("selection:update",{data:a})}),a.addClass("select2-hidden-accessible"),a.attr("aria-hidden","true"),this._syncAttributes(),a.data("select2",this)};return c.Extend(e,c.Observable),e.prototype._generateId=function(a){var b="";return b=null!=a.attr("id")?a.attr("id"):null!=a.attr("name")?a.attr("name")+"-"+c.generateChars(2):c.generateChars(4),b=b.replace(/(:|\.|\[|\]|,)/g,""),b="select2-"+b},e.prototype._placeContainer=function(a){a.insertAfter(this.$element);var b=this._resolveWidth(this.$element,this.options.get("width"));null!=b&&a.css("width",b)},e.prototype._resolveWidth=function(a,b){var c=/^width:(([-+]?([0-9]*\.)?[0-9]+)(px|em|ex|%|in|cm|mm|pt|pc))/i;if("resolve"==b){var d=this._resolveWidth(a,"style");return null!=d?d:this._resolveWidth(a,"element")}if("element"==b){var e=a.outerWidth(!1);return e<=0?"auto":e+"px"}if("style"==b){var f=a.attr("style");if("string"!=typeof f)return null;for(var g=f.split(";"),h=0,i=g.length;h<i;h+=1){var j=g[h].replace(/\s/g,""),k=j.match(c);if(null!==k&&k.length>=1)return k[1]}return null}return b},e.prototype._bindAdapters=function(){this.dataAdapter.bind(this,this.$container),this.selection.bind(this,this.$container),this.dropdown.bind(this,this.$container),this.results.bind(this,this.$container)},e.prototype._registerDomEvents=function(){var b=this;this.$element.on("change.select2",function(){b.dataAdapter.current(function(a){b.trigger("selection:update",{data:a})})}),this._sync=c.bind(this._syncAttributes,this),this.$element[0].attachEvent&&this.$element[0].attachEvent("onpropertychange",this._sync);var d=window.MutationObserver||window.WebKitMutationObserver||window.MozMutationObserver;null!=d?(this._observer=new d(function(c){a.each(c,b._sync)}),this._observer.observe(this.$element[0],{attributes:!0,subtree:!1})):this.$element[0].addEventListener&&this.$element[0].addEventListener("DOMAttrModified",b._sync,!1)},e.prototype._registerDataEvents=function(){var a=this;this.dataAdapter.on("*",function(b,c){a.trigger(b,c)})},e.prototype._registerSelectionEvents=function(){var b=this,c=["toggle","focus"];this.selection.on("toggle",function(){b.toggleDropdown()}),this.selection.on("focus",function(a){b.focus(a)}),this.selection.on("*",function(d,e){-1===a.inArray(d,c)&&b.trigger(d,e)})},e.prototype._registerDropdownEvents=function(){var a=this;this.dropdown.on("*",function(b,c){a.trigger(b,c)})},e.prototype._registerResultsEvents=function(){var a=this;this.results.on("*",function(b,c){a.trigger(b,c)})},e.prototype._registerEvents=function(){var a=this;this.on("open",function(){a.$container.addClass("select2-container--open")}),this.on("close",function(){a.$container.removeClass("select2-container--open")}),this.on("enable",function(){a.$container.removeClass("select2-container--disabled")}),this.on("disable",function(){a.$container.addClass("select2-container--disabled")}),this.on("blur",function(){a.$container.removeClass("select2-container--focus")}),this.on("query",function(b){a.isOpen()||a.trigger("open",{}),this.dataAdapter.query(b,function(c){a.trigger("results:all",{data:c,query:b})})}),this.on("query:append",function(b){this.dataAdapter.query(b,function(c){a.trigger("results:append",{data:c,query:b})})}),this.on("keypress",function(b){var c=b.which;a.isOpen()?c===d.ESC||c===d.TAB||c===d.UP&&b.altKey?(a.close(),b.preventDefault()):c===d.ENTER?(a.trigger("results:select",{}),b.preventDefault()):c===d.SPACE&&b.ctrlKey?(a.trigger("results:toggle",{}),b.preventDefault()):c===d.UP?(a.trigger("results:previous",{}),b.preventDefault()):c===d.DOWN&&(a.trigger("results:next",{}),b.preventDefault()):(c===d.ENTER||c===d.SPACE||c===d.DOWN&&b.altKey)&&(a.open(),b.preventDefault())})},e.prototype._syncAttributes=function(){this.options.set("disabled",this.$element.prop("disabled")),this.options.get("disabled")?(this.isOpen()&&this.close(),this.trigger("disable",{})):this.trigger("enable",{})},e.prototype.trigger=function(a,b){var c=e.__super__.trigger,d={open:"opening",close:"closing",select:"selecting",unselect:"unselecting"};if(void 0===b&&(b={}),a in d){var f=d[a],g={prevented:!1,name:a,args:b};if(c.call(this,f,g),g.prevented)return void(b.prevented=!0)}c.call(this,a,b)},e.prototype.toggleDropdown=function(){this.options.get("disabled")||(this.isOpen()?this.close():this.open())},e.prototype.open=function(){this.isOpen()||this.trigger("query",{})},e.prototype.close=function(){this.isOpen()&&this.trigger("close",{})},e.prototype.isOpen=function(){return this.$container.hasClass("select2-container--open")},e.prototype.hasFocus=function(){return this.$container.hasClass("select2-container--focus")},e.prototype.focus=function(a){this.hasFocus()||(this.$container.addClass("select2-container--focus"),this.trigger("focus",{}))},e.prototype.enable=function(a){null!=a&&0!==a.length||(a=[!0]);var b=!a[0];this.$element.prop("disabled",b)},e.prototype.data=function(){var a=[];return this.dataAdapter.current(function(b){a=b}),a},e.prototype.val=function(b){if(null==b||0===b.length)return this.$element.val();var c=b[0];a.isArray(c)&&(c=a.map(c,function(a){return a.toString()})),this.$element.val(c).trigger("change")},e.prototype.destroy=function(){this.$container.remove(),this.$element[0].detachEvent&&this.$element[0].detachEvent("onpropertychange",this._sync),null!=this._observer?(this._observer.disconnect(),this._observer=null):this.$element[0].removeEventListener&&this.$element[0].removeEventListener("DOMAttrModified",this._sync,!1),this._sync=null,this.$element.off(".select2"),this.$element.attr("tabindex",this.$element.data("old-tabindex")),this.$element.removeClass("select2-hidden-accessible"),this.$element.attr("aria-hidden","false"),this.$element.removeData("select2"),this.dataAdapter.destroy(),this.selection.destroy(),this.dropdown.destroy(),this.results.destroy(),this.dataAdapter=null,this.selection=null,this.dropdown=null,this.results=null},e.prototype.render=function(){var b=a('<span class="select2 select2-container"><span class="selection"></span><span class="dropdown-wrapper" aria-hidden="true"></span></span>');return b.attr("dir",this.options.get("dir")),this.$container=b,this.$container.addClass("select2-container--"+this.options.get("theme")),b.data("element",this.$element),b},e}),b.define("jquery-mousewheel",["jquery"],function(a){return a}),b.define("jquery.select2",["jquery","jquery-mousewheel","./select2/core","./select2/defaults"],function(a,b,c,d){if(null==a.fn.select2){var e=["open","close","destroy"];a.fn.select2=function(b){if("object"==typeof(b=b||{}))return this.each(function(){var d=a.extend(!0,{},b);new c(a(this),d)}),this;if("string"==typeof b){var d;return this.each(function(){var c=a(this).data("select2");if(null==c)throw new Error("xx");var e=Array.prototype.slice.call(arguments,1);d=c[b].apply(c,e)}),a.inArray(b,e)>-1?this:d}throw new Error("Invalid arguments for Select2: "+b)}}return null==a.fn.select2.defaults&&(a.fn.select2.defaults=d),c}),{define:b.define,require:b.require}}(),c=b.require("jquery.select2");return a.fn.select2.amd=b,c}),define("views/common/autocomplete/autocomplete-item-view",["talent","templates/common","select2"],function(a,b,c){return a.ItemView.extend({template:b["common/autocomplete/autocomplete-item-view"],initialize:function(a){this.defaultsOptions={style:{},dataSetting:null,url:void 0,mode:"local",data:[],value:null,minimumResultsForSearch:1/0},this.model.set(_.extend({},this.defaultsOptions,a))},formatState:function(a){if(""==a.id||void 0==a.id||null==a.id)return!1;var b=[],c=this.model.toJSON(),d=c.dataSetting,e=_.find(d,function(a){return 0==a.DisplayType})||{},f=e.DisplayFields;this._showField(f);return b.push('<span class="epm-select2-name epm-select2-item">'+a.Name+"</span>"),$(b.join(""))},_showField:function(a){var b={Name:!1,Description:!1,Value:!1};return-1!=_.indexOf(a,"Value")&&(b.Value=!0),-1!=_.indexOf(a,"Name")&&(b.Name=!0),-1!=_.indexOf(a,"Description")&&(b.Description=!0),b},setValue:function(a){this.model.toJSON();if(null===a||void 0===a)return!1;this.$select2.val(a).trigger("change")},renderLocalView:function(a){var b=a.data,c={data:b,value:a.value,minimumResultsForSearch:a.minimumResultsForSearch};return a.dataSetting&&(c.templateResult=_.bind(this.formatState,this)),this.$(".select2-select").select2(c)},getData:function(a){return this.$select2.val()},onRender:function(){var a=this,b=a.model.toJSON(),c=b.value;a.$select2="local"==b.mode?a.renderLocalView(b):a.renderRemoteView(b),a.$select2.on("select2:select",function(c){var d=c.params.data||{};a.trigger("optionChange",{formName:b.formName,value:d.id,moduleType:d.moduleType,text:d.text,weightType:d.weightType})}),a.setValue(c)}})}),define("views/common/viewHelper",["talent","views/common/autocomplete/autocomplete-item-view"],function(a,b){function c(a,c){var d=a.renderTo,e=$(a.renderTo);_.isString(d)&&(e=c.$(d));var f=a.listenEvents,g=new b({formName:a.formName,style:a.style||{width:"150px"},minimumResultsForSearch:a.minimumResultsForSearch||1/0,value:a.value+"",data:a.data});return f&&_.each(_.keys(f),function(a){c.listenTo(g,a,_.bind(f[a],c))}),e[0]&&e.html(g.render().el),g}function d(a,b){b||(b=this);var c=(a.strpre&&a.strpre,a.id?a.id:_.uniqueId(i));return _.extend({},j,{id:c,sName:c,sWidth:a.sWidth,sClass:a.sClass,mData:a.mData,sTitle:a.sTitle,mRender:_.bind(a.mRender,b)})}function e(a,b){return b||(b=this),_.map(a,function(a){return d(a,b)})}function f(){return""}function g(a,b,c){var d;return c.UserAvatar?(c.bgColor=c.UserAvatar.Color,c.src=c.UserAvatar.Small,c.shape="radius",c.size="30",c.name=c.UserAvatar.Name,c.HasAvatar=c.UserAvatar.HasAvatar,d=_.convertImage(c)):(c.name=c.UserName,d=_.convertImagePerDefault(c)),d+=_.escape(c.UserName)}function h(a,b,c){var d;return c.UserAvatar?(c.bgColor=c.UserAvatar.Color,c.src=c.UserAvatar.Small,c.shape="radius",c.size="30",c.name=c.UserAvatar.Name,c.HasAvatar=c.UserAvatar.HasAvatar,d=_.convertImage(c)):(c.name=c.UserName,d=_.convertImagePerDefault(c)),d+="<a  href='javascript:;' activity-stepTypeId="+c.StepTypeId+" activity-assessmentId="+c.AssessmentId+" activity-userId="+c.UserId+" activity-appraiserId="+c.AppraiserId+" class='link activity-name js-to-assessmentdetail' title='"+_.escape(a)+"'>"+_.escape(c.UserName)+"</a>"}var i=(a.app,"performance"),j={bSortable:!1,sTitle:"",sClass:"taleft"};return{createDropList:c,createColumnItem:d,createMutiColumn:e,formatUserName:g,formatEmpty:f,formatUserNameForTodoList:h,paceStart:function(){require(["pace"],function(b){a.client.isAdvance()&&b.restart()})},pageHide:function(){require(["pace"],function(b){a.client.isAdvance()&&b.stop()})}}}),function(a){function b(a,b){return"function"==typeof a?a.call(b):a}function c(a){for(;a=a.parentNode;)if(a==document)return!0;return!1}function d(b,c){this.$element=a(b),this.options=c,this.enabled=!0,this.fixTitle()}d.prototype={show:function(){var c=this.getTitle();if(c&&this.enabled){var d=this.tip();d.find(".tipsy-inner")[this.options.html?"html":"text"](c),d[0].className="tipsy",d.remove().css({top:0,left:0,visibility:"hidden",display:"block"}).prependTo(document.body);var e,f=a.extend({},this.$element.offset(),{width:this.$element[0].offsetWidth,height:this.$element[0].offsetHeight}),g=d[0].offsetWidth,h=d[0].offsetHeight,i=b(this.options.gravity,this.$element[0]);switch(i.charAt(0)){case"n":e={top:f.top+f.height+this.options.offset,left:f.left+f.width/2-g/2};break;case"s":e={top:f.top-h-this.options.offset,left:f.left+f.width/2-g/2};break;case"e":e={top:f.top+f.height/2-h/2,left:f.left-g-this.options.offset};break;case"w":e={top:f.top+f.height/2-h/2,left:f.left+f.width+this.options.offset}}2==i.length&&("w"==i.charAt(1)?e.left=f.left+f.width/2-15:e.left=f.left+f.width/2-g+15),d.css(e).addClass("tipsy-"+i),d.find(".tipsy-arrow")[0].className="tipsy-arrow tipsy-arrow-"+i.charAt(0),this.options.className&&d.addClass(b(this.options.className,this.$element[0])),this.options.fade?d.stop().css({opacity:0,display:"block",visibility:"visible"}).animate({opacity:this.options.opacity}):d.css({visibility:"visible",opacity:this.options.opacity})}},hide:function(){this.options.fade?this.tip().stop().fadeOut(function(){a(this).remove()}):this.tip().remove()},fixTitle:function(){var a=this.$element;(a.attr("title")||"string"!=typeof a.attr("original-title"))&&a.attr("original-title",a.attr("title")||"").removeAttr("title")},getTitle:function(){var a,b=this.$element,c=this.options;this.fixTitle();var a,c=this.options;return"string"==typeof c.title?a=b.attr("title"==c.title?"original-title":c.title):"function"==typeof c.title&&(a=c.title.call(b[0])),(a=(""+a).replace(/(^\s*|\s*$)/,""))||c.fallback},tip:function(){return this.$tip||(this.$tip=a('<div class="tipsy"></div>').html('<div class="tipsy-arrow"></div><div class="tipsy-inner"></div>'),this.$tip.data("tipsy-pointee",this.$element[0])),this.$tip},validate:function(){this.$element[0].parentNode||(this.hide(),this.$element=null,this.options=null)},enable:function(){this.enabled=!0},disable:function(){this.enabled=!1},toggleEnabled:function(){this.enabled=!this.enabled}},a.fn.tipsy=function(b){function c(c){var e=a.data(c,"tipsy");return e||(e=new d(c,a.fn.tipsy.elementOptions(c,b)),a.data(c,"tipsy",e)),e}function e(){var a=c(this);a.hoverState="in",0==b.delayIn?a.show():(a.fixTitle(),setTimeout(function(){"in"==a.hoverState&&a.show()},b.delayIn))}function f(){var a=c(this);a.hoverState="out",0==b.delayOut?a.hide():setTimeout(function(){"out"==a.hoverState&&a.hide()},b.delayOut)}if(!0===b)return this.data("tipsy");if("string"==typeof b){var g=this.data("tipsy");return g&&g[b](),this}if(b=a.extend({},a.fn.tipsy.defaults,b),b.live||this.each(function(){c(this)}),"manual"!=b.trigger){var h=b.live?"live":"bind",i="hover"==b.trigger?"mouseenter":"focus",j="hover"==b.trigger?"mouseleave":"blur";this[h](i,e)[h](j,f)}return this},a.fn.tipsy.defaults={className:null,delayIn:0,delayOut:0,fade:!1,fallback:"",gravity:"n",html:!1,live:!1,offset:0,opacity:.8,title:"title",trigger:"hover"},a.fn.tipsy.revalidate=function(){a(".tipsy").each(function(){var b=a.data(this,"tipsy-pointee");b&&c(b)||a(this).remove()})},a.fn.tipsy.elementOptions=function(b,c){return a.metadata?a.extend({},c,a(b).metadata()):c},a.fn.tipsy.autoNS=function(){return a(this).offset().top>a(document).scrollTop()+a(window).height()/2?"s":"n"},a.fn.tipsy.autoWE=function(){return a(this).offset().left>a(document).scrollLeft()+a(window).width()/2?"e":"w"},a.fn.tipsy.autoBounds=function(b,c){return function(){var d={ns:c[0],ew:c.length>1&&c[1]},e=a(document).scrollTop()+b,f=a(document).scrollLeft()+b,g=a(this);return g.offset().top<e&&(d.ns="n"),g.offset().left<f&&(d.ew="w"),a(window).width()+a(document).scrollLeft()-g.offset().left<b&&(d.ew="e"),a(window).height()+a(document).scrollTop()-g.offset().top<b&&(d.ns="s"),d.ns+(d.ew?d.ew:"")}}}(jQuery),define("$.tipsy",function(){}),function(a){"function"==typeof define&&define.amd?define("jquery.ui.effect",["jquery"],a):a(jQuery)}(function(a){var b="ui-effects-",c=a;a.effects={effect:{}},function(a,b){function c(a,b,c){var d=k[b.type]||{};return null==a?c||!b.def?null:b.def:(a=d.floor?~~a:parseFloat(a),isNaN(a)?b.def:d.mod?(a+d.mod)%d.mod:0>a?0:a>d.max?d.max:a)}function d(c){var d=i(),e=d._rgba=[];return c=c.toLowerCase(),n(h,function(a,f){var g,h=f.re.exec(c),i=h&&f.parse(h),k=f.space||"rgba";return i?(g=d[k](i),d[j[k].cache]=g[j[k].cache],e=d._rgba=g._rgba,!1):b}),e.length?("0,0,0,0"===e.join()&&a.extend(e,f.transparent),d):f[c]}function e(a,b,c){return c=(c+1)%1,1>6*c?a+6*(b-a)*c:1>2*c?b:2>3*c?a+6*(b-a)*(2/3-c):a}var f,g=/^([\-+])=\s*(\d+\.?\d*)/,h=[{re:/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[a[1],a[2],a[3],a[4]]}},{re:/rgba?\(\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,parse:function(a){return[2.55*a[1],2.55*a[2],2.55*a[3],a[4]]}},{re:/#([a-f0-9]{2})([a-f0-9]{2})([a-f0-9]{2})/,parse:function(a){return[parseInt(a[1],16),parseInt(a[2],16),parseInt(a[3],16)]}},{re:/#([a-f0-9])([a-f0-9])([a-f0-9])/,parse:function(a){return[parseInt(a[1]+a[1],16),parseInt(a[2]+a[2],16),parseInt(a[3]+a[3],16)]}},{re:/hsla?\(\s*(\d+(?:\.\d+)?)\s*,\s*(\d+(?:\.\d+)?)\%\s*,\s*(\d+(?:\.\d+)?)\%\s*(?:,\s*(\d?(?:\.\d+)?)\s*)?\)/,space:"hsla",parse:function(a){return[a[1],a[2]/100,a[3]/100,a[4]]}}],i=a.Color=function(b,c,d,e){return new a.Color.fn.parse(b,c,d,e)},j={rgba:{props:{red:{idx:0,type:"byte"},green:{idx:1,type:"byte"},blue:{idx:2,type:"byte"}}},hsla:{props:{hue:{idx:0,type:"degrees"},saturation:{idx:1,type:"percent"},lightness:{idx:2,type:"percent"}}}},k={byte:{floor:!0,max:255},percent:{max:1},degrees:{mod:360,floor:!0}},l=i.support={},m=a("<p>")[0],n=a.each;m.style.cssText="background-color:rgba(1,1,1,.5)",l.rgba=m.style.backgroundColor.indexOf("rgba")>-1,n(j,function(a,b){b.cache="_"+a,b.props.alpha={idx:3,type:"percent",def:1}}),i.fn=a.extend(i.prototype,{parse:function(e,g,h,k){if(e===b)return this._rgba=[null,null,null,null],this;(e.jquery||e.nodeType)&&(e=a(e).css(g),g=b);var l=this,m=a.type(e),o=this._rgba=[];return g!==b&&(e=[e,g,h,k],m="array"),"string"===m?this.parse(d(e)||f._default):"array"===m?(n(j.rgba.props,function(a,b){o[b.idx]=c(e[b.idx],b)}),this):"object"===m?(e instanceof i?n(j,function(a,b){e[b.cache]&&(l[b.cache]=e[b.cache].slice())}):n(j,function(b,d){var f=d.cache;n(d.props,function(a,b){if(!l[f]&&d.to){if("alpha"===a||null==e[a])return;l[f]=d.to(l._rgba)}l[f][b.idx]=c(e[a],b,!0)}),l[f]&&0>a.inArray(null,l[f].slice(0,3))&&(l[f][3]=1,d.from&&(l._rgba=d.from(l[f])))}),this):b},is:function(a){var c=i(a),d=!0,e=this;return n(j,function(a,f){var g,h=c[f.cache];return h&&(g=e[f.cache]||f.to&&f.to(e._rgba)||[],n(f.props,function(a,c){return null!=h[c.idx]?d=h[c.idx]===g[c.idx]:b})),d}),d},_space:function(){var a=[],b=this;return n(j,function(c,d){b[d.cache]&&a.push(c)}),a.pop()},transition:function(a,b){var d=i(a),e=d._space(),f=j[e],g=0===this.alpha()?i("transparent"):this,h=g[f.cache]||f.to(g._rgba),l=h.slice();return d=d[f.cache],n(f.props,function(a,e){var f=e.idx,g=h[f],i=d[f],j=k[e.type]||{};null!==i&&(null===g?l[f]=i:(j.mod&&(i-g>j.mod/2?g+=j.mod:g-i>j.mod/2&&(g-=j.mod)),l[f]=c((i-g)*b+g,e)))}),this[e](l)},blend:function(b){if(1===this._rgba[3])return this;var c=this._rgba.slice(),d=c.pop(),e=i(b)._rgba;return i(a.map(c,function(a,b){return(1-d)*e[b]+d*a}))},toRgbaString:function(){var b="rgba(",c=a.map(this._rgba,function(a,b){return null==a?b>2?1:0:a});return 1===c[3]&&(c.pop(),b="rgb("),b+c.join()+")"},toHslaString:function(){var b="hsla(",c=a.map(this.hsla(),function(a,b){return null==a&&(a=b>2?1:0),b&&3>b&&(a=Math.round(100*a)+"%"),a});return 1===c[3]&&(c.pop(),b="hsl("),b+c.join()+")"},toHexString:function(b){var c=this._rgba.slice(),d=c.pop();return b&&c.push(~~(255*d)),"#"+a.map(c,function(a){return a=(a||0).toString(16),1===a.length?"0"+a:a}).join("")},toString:function(){return 0===this._rgba[3]?"transparent":this.toRgbaString()}}),i.fn.parse.prototype=i.fn,j.hsla.to=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b,c,d=a[0]/255,e=a[1]/255,f=a[2]/255,g=a[3],h=Math.max(d,e,f),i=Math.min(d,e,f),j=h-i,k=h+i,l=.5*k;return b=i===h?0:d===h?60*(e-f)/j+360:e===h?60*(f-d)/j+120:60*(d-e)/j+240,c=0===j?0:.5>=l?j/k:j/(2-k),[Math.round(b)%360,c,l,null==g?1:g]},j.hsla.from=function(a){if(null==a[0]||null==a[1]||null==a[2])return[null,null,null,a[3]];var b=a[0]/360,c=a[1],d=a[2],f=a[3],g=.5>=d?d*(1+c):d+c-d*c,h=2*d-g;return[Math.round(255*e(h,g,b+1/3)),Math.round(255*e(h,g,b)),Math.round(255*e(h,g,b-1/3)),f]},n(j,function(d,e){var f=e.props,h=e.cache,j=e.to,k=e.from;i.fn[d]=function(d){if(j&&!this[h]&&(this[h]=j(this._rgba)),d===b)return this[h].slice();var e,g=a.type(d),l="array"===g||"object"===g?d:arguments,m=this[h].slice();return n(f,function(a,b){var d=l["object"===g?a:b.idx];null==d&&(d=m[b.idx]),m[b.idx]=c(d,b)}),k?(e=i(k(m)),e[h]=m,e):i(m)},n(f,function(b,c){i.fn[b]||(i.fn[b]=function(e){var f,h=a.type(e),i="alpha"===b?this._hsla?"hsla":"rgba":d,j=this[i](),k=j[c.idx];return"undefined"===h?k:("function"===h&&(e=e.call(this,k),h=a.type(e)),null==e&&c.empty?this:("string"===h&&(f=g.exec(e))&&(e=k+parseFloat(f[2])*("+"===f[1]?1:-1)),j[c.idx]=e,this[i](j)))})})}),i.hook=function(b){var c=b.split(" ");n(c,function(b,c){a.cssHooks[c]={set:function(b,e){var f,g,h="";if("transparent"!==e&&("string"!==a.type(e)||(f=d(e)))){if(e=i(f||e),!l.rgba&&1!==e._rgba[3]){for(g="backgroundColor"===c?b.parentNode:b;(""===h||"transparent"===h)&&g&&g.style;)try{h=a.css(g,"backgroundColor"),g=g.parentNode}catch(a){}e=e.blend(h&&"transparent"!==h?h:"_default")}e=e.toRgbaString()}try{b.style[c]=e}catch(a){}}},a.fx.step[c]=function(b){b.colorInit||(b.start=i(b.elem,c),b.end=i(b.end),b.colorInit=!0),a.cssHooks[c].set(b.elem,b.start.transition(b.end,b.pos))}})},i.hook("backgroundColor borderBottomColor borderLeftColor borderRightColor borderTopColor color columnRuleColor outlineColor textDecorationColor textEmphasisColor"),a.cssHooks.borderColor={expand:function(a){var b={};return n(["Top","Right","Bottom","Left"],function(c,d){b["border"+d+"Color"]=a}),b}},f=a.Color.names={aqua:"#00ffff",black:"#000000",blue:"#0000ff",fuchsia:"#ff00ff",gray:"#808080",green:"#008000",lime:"#00ff00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#ff0000",silver:"#c0c0c0",teal:"#008080",white:"#ffffff",yellow:"#ffff00",transparent:[null,null,null,0],_default:"#ffffff"}}(c),function(){function b(b){var c,d,e=b.ownerDocument.defaultView?b.ownerDocument.defaultView.getComputedStyle(b,null):b.currentStyle,f={};if(e&&e.length&&e[0]&&e[e[0]])for(d=e.length;d--;)c=e[d],"string"==typeof e[c]&&(f[a.camelCase(c)]=e[c]);else for(c in e)"string"==typeof e[c]&&(f[c]=e[c]);return f}function d(b,c){var d,e,g={};for(d in c)e=c[d],b[d]!==e&&(f[d]||(a.fx.step[d]||!isNaN(parseFloat(e)))&&(g[d]=e));return g}var e=["add","remove","toggle"],f={border:1,borderBottom:1,borderColor:1,borderLeft:1,borderRight:1,borderTop:1,borderWidth:1,margin:1,padding:1};a.each(["borderLeftStyle","borderRightStyle","borderBottomStyle","borderTopStyle"],function(b,d){a.fx.step[d]=function(a){("none"!==a.end&&!a.setAttr||1===a.pos&&!a.setAttr)&&(c.style(a.elem,d,a.end),a.setAttr=!0)}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a.effects.animateClass=function(c,f,g,h){var i=a.speed(f,g,h);return this.queue(function(){var f,g=a(this),h=g.attr("class")||"",j=i.children?g.find("*").addBack():g;j=j.map(function(){return{el:a(this),start:b(this)}}),f=function(){a.each(e,function(a,b){c[b]&&g[b+"Class"](c[b])})},f(),j=j.map(function(){return this.end=b(this.el[0]),this.diff=d(this.start,this.end),this}),g.attr("class",h),j=j.map(function(){var b=this,c=a.Deferred(),d=a.extend({},i,{queue:!1,complete:function(){c.resolve(b)}});return this.el.animate(this.diff,d),c.promise()}),a.when.apply(a,j.get()).done(function(){f(),a.each(arguments,function(){var b=this.el;a.each(this.diff,function(a){b.css(a,"")})}),i.complete.call(g[0])})})},a.fn.extend({addClass:function(b){return function(c,d,e,f){return d?a.effects.animateClass.call(this,{add:c},d,e,f):b.apply(this,arguments)}}(a.fn.addClass),removeClass:function(b){return function(c,d,e,f){return arguments.length>1?a.effects.animateClass.call(this,{remove:c},d,e,f):b.apply(this,arguments)}}(a.fn.removeClass),toggleClass:function(b){return function(c,d,e,f,g){return"boolean"==typeof d||void 0===d?e?a.effects.animateClass.call(this,d?{add:c}:{remove:c},e,f,g):b.apply(this,arguments):a.effects.animateClass.call(this,{toggle:c},d,e,f)}}(a.fn.toggleClass),switchClass:function(b,c,d,e,f){return a.effects.animateClass.call(this,{add:c,remove:b},d,e,f)}})}(),function(){function c(b,c,d,e){return a.isPlainObject(b)&&(c=b,b=b.effect),b={effect:b},null==c&&(c={}),a.isFunction(c)&&(e=c,d=null,c={}),("number"==typeof c||a.fx.speeds[c])&&(e=d,d=c,c={}),a.isFunction(d)&&(e=d,d=null),c&&a.extend(b,c),d=d||c.duration,b.duration=a.fx.off?0:"number"==typeof d?d:d in a.fx.speeds?a.fx.speeds[d]:a.fx.speeds._default,b.complete=e||c.complete,b}function d(b){return!(b&&"number"!=typeof b&&!a.fx.speeds[b])||("string"==typeof b&&!a.effects.effect[b]||(!!a.isFunction(b)||"object"==typeof b&&!b.effect))}a.extend(a.effects,{version:"1.11.4",save:function(a,c){for(var d=0;c.length>d;d++)null!==c[d]&&a.data(b+c[d],a[0].style[c[d]])},restore:function(a,c){var d,e;for(e=0;c.length>e;e++)null!==c[e]&&(d=a.data(b+c[e]),void 0===d&&(d=""),a.css(c[e],d))},setMode:function(a,b){return"toggle"===b&&(b=a.is(":hidden")?"show":"hide"),b},getBaseline:function(a,b){var c,d;switch(a[0]){case"top":c=0;break;case"middle":c=.5;break;case"bottom":c=1;break;default:c=a[0]/b.height}switch(a[1]){case"left":d=0;break;case"center":d=.5;break;case"right":d=1;break;default:d=a[1]/b.width}return{x:d,y:c}},createWrapper:function(b){if(b.parent().is(".ui-effects-wrapper"))return b.parent();var c={width:b.outerWidth(!0),height:b.outerHeight(!0),float:b.css("float")},d=a("<div></div>").addClass("ui-effects-wrapper").css({fontSize:"100%",background:"transparent",border:"none",margin:0,padding:0}),e={width:b.width(),height:b.height()},f=document.activeElement;try{f.id}catch(a){f=document.body}return b.wrap(d),(b[0]===f||a.contains(b[0],f))&&a(f).focus(),d=b.parent(),"static"===b.css("position")?(d.css({position:"relative"}),b.css({position:"relative"})):(a.extend(c,{position:b.css("position"),zIndex:b.css("z-index")}),a.each(["top","left","bottom","right"],function(a,d){c[d]=b.css(d),isNaN(parseInt(c[d],10))&&(c[d]="auto")}),b.css({position:"relative",top:0,left:0,right:"auto",bottom:"auto"})),b.css(e),d.css(c).show()},removeWrapper:function(b){var c=document.activeElement;return b.parent().is(".ui-effects-wrapper")&&(b.parent().replaceWith(b),(b[0]===c||a.contains(b[0],c))&&a(c).focus()),b},setTransition:function(b,c,d,e){return e=e||{},a.each(c,function(a,c){var f=b.cssUnit(c);f[0]>0&&(e[c]=f[0]*d+f[1])}),e}}),a.fn.extend({effect:function(){function b(b){function c(){a.isFunction(f)&&f.call(e[0]),a.isFunction(b)&&b()}var e=a(this),f=d.complete,h=d.mode;(e.is(":hidden")?"hide"===h:"show"===h)?(e[h](),c()):g.call(e[0],d,c)}var d=c.apply(this,arguments),e=d.mode,f=d.queue,g=a.effects.effect[d.effect];return a.fx.off||!g?e?this[e](d.duration,d.complete):this.each(function(){d.complete&&d.complete.call(this)}):!1===f?this.each(b):this.queue(f||"fx",b)},show:function(a){return function(b){if(d(b))return a.apply(this,arguments);var e=c.apply(this,arguments);return e.mode="show",this.effect.call(this,e)}}(a.fn.show),hide:function(a){return function(b){if(d(b))return a.apply(this,arguments);var e=c.apply(this,arguments);return e.mode="hide",this.effect.call(this,e)}}(a.fn.hide),toggle:function(a){return function(b){if(d(b)||"boolean"==typeof b)return a.apply(this,arguments);var e=c.apply(this,arguments);return e.mode="toggle",this.effect.call(this,e)}}(a.fn.toggle),cssUnit:function(b){var c=this.css(b),d=[];return a.each(["em","px","%","pt"],function(a,b){c.indexOf(b)>0&&(d=[parseFloat(c),b])}),d}})}(),function(){var b={};a.each(["Quad","Cubic","Quart","Quint","Expo"],function(a,c){b[c]=function(b){return Math.pow(b,a+2)}}),a.extend(b,{Sine:function(a){return 1-Math.cos(a*Math.PI/2)},Circ:function(a){return 1-Math.sqrt(1-a*a)},Elastic:function(a){return 0===a||1===a?a:-Math.pow(2,8*(a-1))*Math.sin((80*(a-1)-7.5)*Math.PI/15)},Back:function(a){return a*a*(3*a-2)},Bounce:function(a){for(var b,c=4;((b=Math.pow(2,--c))-1)/11>a;);return 1/Math.pow(4,3-c)-7.5625*Math.pow((3*b-2)/22-a,2)}}),a.each(b,function(b,c){a.easing["easeIn"+b]=c,a.easing["easeOut"+b]=function(a){return 1-c(1-a)},a.easing["easeInOut"+b]=function(a){return.5>a?c(2*a)/2:1-c(-2*a+2)/2}})}(),a.effects,a.effects.effect.blind=function(b,c){var d,e,f,g=a(this),h=/up|down|vertical/,i=/up|left|vertical|horizontal/,j=["position","top","bottom","left","right","height","width"],k=a.effects.setMode(g,b.mode||"hide"),l=b.direction||"up",m=h.test(l),n=m?"height":"width",o=m?"top":"left",p=i.test(l),q={},r="show"===k;g.parent().is(".ui-effects-wrapper")?a.effects.save(g.parent(),j):a.effects.save(g,j),g.show(),d=a.effects.createWrapper(g).css({overflow:"hidden"}),e=d[n](),f=parseFloat(d.css(o))||0,q[n]=r?e:0,p||(g.css(m?"bottom":"right",0).css(m?"top":"left","auto").css({position:"absolute"}),q[o]=r?f:e+f),r&&(d.css(n,0),p||d.css(o,f+e)),d.animate(q,{duration:b.duration,easing:b.easing,queue:!1,complete:function(){"hide"===k&&g.hide(),a.effects.restore(g,j),a.effects.removeWrapper(g),c()}})},a.effects.effect.bounce=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","height","width"],i=a.effects.setMode(g,b.mode||"effect"),j="hide"===i,k="show"===i,l=b.direction||"up",m=b.distance,n=b.times||5,o=2*n+(k||j?1:0),p=b.duration/o,q=b.easing,r="up"===l||"down"===l?"top":"left",s="up"===l||"left"===l,t=g.queue(),u=t.length;for((k||j)&&h.push("opacity"),a.effects.save(g,h),g.show(),a.effects.createWrapper(g),m||(m=g["top"===r?"outerHeight":"outerWidth"]()/3),k&&(f={opacity:1},f[r]=0,g.css("opacity",0).css(r,s?2*-m:2*m).animate(f,p,q)),j&&(m/=Math.pow(2,n-1)),f={},f[r]=0,d=0;n>d;d++)e={},e[r]=(s?"-=":"+=")+m,g.animate(e,p,q).animate(f,p,q),m=j?2*m:m/2;j&&(e={opacity:0},e[r]=(s?"-=":"+=")+m,g.animate(e,p,q)),g.queue(function(){j&&g.hide(),a.effects.restore(g,h),a.effects.removeWrapper(g),c()}),u>1&&t.splice.apply(t,[1,0].concat(t.splice(u,o+1))),g.dequeue()},a.effects.effect.clip=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","height","width"],i=a.effects.setMode(g,b.mode||"hide"),j="show"===i,k=b.direction||"vertical",l="vertical"===k,m=l?"height":"width",n=l?"top":"left",o={};a.effects.save(g,h),g.show(),d=a.effects.createWrapper(g).css({overflow:"hidden"}),e="IMG"===g[0].tagName?d:g,f=e[m](),j&&(e.css(m,0),e.css(n,f/2)),o[m]=j?f:0,o[n]=j?0:f/2,e.animate(o,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){j||g.hide(),a.effects.restore(g,h),a.effects.removeWrapper(g),c()}})},a.effects.effect.drop=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","opacity","height","width"],g=a.effects.setMode(e,b.mode||"hide"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i?"pos":"neg",l={opacity:h?1:0};a.effects.save(e,f),e.show(),a.effects.createWrapper(e),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0)/2,h&&e.css("opacity",0).css(j,"pos"===k?-d:d),l[j]=(h?"pos"===k?"+=":"-=":"pos"===k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}})},a.effects.effect.explode=function(b,c){function d(){t.push(this),t.length===l*m&&e()}function e(){n.css({visibility:"visible"}),a(t).remove(),p||n.hide(),c()}var f,g,h,i,j,k,l=b.pieces?Math.round(Math.sqrt(b.pieces)):3,m=l,n=a(this),o=a.effects.setMode(n,b.mode||"hide"),p="show"===o,q=n.show().css("visibility","hidden").offset(),r=Math.ceil(n.outerWidth()/m),s=Math.ceil(n.outerHeight()/l),t=[];for(f=0;l>f;f++)for(i=q.top+f*s,k=f-(l-1)/2,g=0;m>g;g++)h=q.left+g*r,j=g-(m-1)/2,n.clone().appendTo("body").wrap("<div></div>").css({position:"absolute",visibility:"visible",left:-g*r,top:-f*s}).parent().addClass("ui-effects-explode").css({position:"absolute",overflow:"hidden",width:r,height:s,left:h+(p?j*r:0),top:i+(p?k*s:0),opacity:p?0:1}).animate({left:h+(p?0:j*r),top:i+(p?0:k*s),opacity:p?1:0},b.duration||500,b.easing,d)},a.effects.effect.fade=function(b,c){var d=a(this),e=a.effects.setMode(d,b.mode||"toggle");d.animate({opacity:e},{queue:!1,duration:b.duration,easing:b.easing,complete:c})},a.effects.effect.fold=function(b,c){var d,e,f=a(this),g=["position","top","bottom","left","right","height","width"],h=a.effects.setMode(f,b.mode||"hide"),i="show"===h,j="hide"===h,k=b.size||15,l=/([0-9]+)%/.exec(k),m=!!b.horizFirst,n=i!==m,o=n?["width","height"]:["height","width"],p=b.duration/2,q={},r={};a.effects.save(f,g),f.show(),d=a.effects.createWrapper(f).css({overflow:"hidden"}),e=n?[d.width(),d.height()]:[d.height(),d.width()],l&&(k=parseInt(l[1],10)/100*e[j?0:1]),i&&d.css(m?{height:0,width:k}:{height:k,width:0}),q[o[0]]=i?e[0]:k,r[o[1]]=i?e[1]:0,d.animate(q,p,b.easing).animate(r,p,b.easing,function(){j&&f.hide(),a.effects.restore(f,g),a.effects.removeWrapper(f),c()})},a.effects.effect.highlight=function(b,c){var d=a(this),e=["backgroundImage","backgroundColor","opacity"],f=a.effects.setMode(d,b.mode||"show"),g={backgroundColor:d.css("backgroundColor")};"hide"===f&&(g.opacity=0),a.effects.save(d,e),d.show().css({backgroundImage:"none",backgroundColor:b.color||"#ffff99"}).animate(g,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===f&&d.hide(),a.effects.restore(d,e),c()}})},a.effects.effect.size=function(b,c){var d,e,f,g=a(this),h=["position","top","bottom","left","right","width","height","overflow","opacity"],i=["position","top","bottom","left","right","overflow","opacity"],j=["width","height","overflow"],k=["fontSize"],l=["borderTopWidth","borderBottomWidth","paddingTop","paddingBottom"],m=["borderLeftWidth","borderRightWidth","paddingLeft","paddingRight"],n=a.effects.setMode(g,b.mode||"effect"),o=b.restore||"effect"!==n,p=b.scale||"both",q=b.origin||["middle","center"],r=g.css("position"),s=o?h:i,t={height:0,width:0,outerHeight:0,outerWidth:0};"show"===n&&g.show(),d={height:g.height(),width:g.width(),outerHeight:g.outerHeight(),outerWidth:g.outerWidth()},"toggle"===b.mode&&"show"===n?(g.from=b.to||t,g.to=b.from||d):(g.from=b.from||("show"===n?t:d),g.to=b.to||("hide"===n?t:d)),f={from:{y:g.from.height/d.height,x:g.from.width/d.width},to:{y:g.to.height/d.height,x:g.to.width/d.width}},("box"===p||"both"===p)&&(f.from.y!==f.to.y&&(s=s.concat(l),g.from=a.effects.setTransition(g,l,f.from.y,g.from),g.to=a.effects.setTransition(g,l,f.to.y,g.to)),f.from.x!==f.to.x&&(s=s.concat(m),g.from=a.effects.setTransition(g,m,f.from.x,g.from),g.to=a.effects.setTransition(g,m,f.to.x,g.to))),("content"===p||"both"===p)&&f.from.y!==f.to.y&&(s=s.concat(k).concat(j),g.from=a.effects.setTransition(g,k,f.from.y,g.from),g.to=a.effects.setTransition(g,k,f.to.y,g.to)),a.effects.save(g,s),g.show(),a.effects.createWrapper(g),g.css("overflow","hidden").css(g.from),q&&(e=a.effects.getBaseline(q,d),g.from.top=(d.outerHeight-g.outerHeight())*e.y,g.from.left=(d.outerWidth-g.outerWidth())*e.x,g.to.top=(d.outerHeight-g.to.outerHeight)*e.y,g.to.left=(d.outerWidth-g.to.outerWidth)*e.x),g.css(g.from),("content"===p||"both"===p)&&(l=l.concat(["marginTop","marginBottom"]).concat(k),m=m.concat(["marginLeft","marginRight"]),j=h.concat(l).concat(m),g.find("*[width]").each(function(){var c=a(this),d={height:c.height(),width:c.width(),outerHeight:c.outerHeight(),outerWidth:c.outerWidth()};o&&a.effects.save(c,j),c.from={height:d.height*f.from.y,width:d.width*f.from.x,outerHeight:d.outerHeight*f.from.y,outerWidth:d.outerWidth*f.from.x},c.to={height:d.height*f.to.y,width:d.width*f.to.x,outerHeight:d.height*f.to.y,outerWidth:d.width*f.to.x},f.from.y!==f.to.y&&(c.from=a.effects.setTransition(c,l,f.from.y,c.from),c.to=a.effects.setTransition(c,l,f.to.y,c.to)),f.from.x!==f.to.x&&(c.from=a.effects.setTransition(c,m,f.from.x,c.from),c.to=a.effects.setTransition(c,m,f.to.x,c.to)),c.css(c.from),c.animate(c.to,b.duration,b.easing,function(){o&&a.effects.restore(c,j)})})),g.animate(g.to,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){0===g.to.opacity&&g.css("opacity",g.from.opacity),"hide"===n&&g.hide(),a.effects.restore(g,s),o||("static"===r?g.css({position:"relative",top:g.to.top,left:g.to.left}):a.each(["top","left"],function(a,b){g.css(b,function(b,c){var d=parseInt(c,10),e=a?g.to.left:g.to.top;return"auto"===c?e+"px":d+e+"px"})})),a.effects.removeWrapper(g),c()}})},a.effects.effect.scale=function(b,c){var d=a(this),e=a.extend(!0,{},b),f=a.effects.setMode(d,b.mode||"effect"),g=parseInt(b.percent,10)||(0===parseInt(b.percent,10)?0:"hide"===f?0:100),h=b.direction||"both",i=b.origin,j={height:d.height(),width:d.width(),outerHeight:d.outerHeight(),outerWidth:d.outerWidth()},k={y:"horizontal"!==h?g/100:1,x:"vertical"!==h?g/100:1};e.effect="size",e.queue=!1,e.complete=c,"effect"!==f&&(e.origin=i||["middle","center"],e.restore=!0),e.from=b.from||("show"===f?{height:0,width:0,outerHeight:0,outerWidth:0}:j),e.to={height:j.height*k.y,width:j.width*k.x,outerHeight:j.outerHeight*k.y,outerWidth:j.outerWidth*k.x},e.fade&&("show"===f&&(e.from.opacity=0,e.to.opacity=1),"hide"===f&&(e.from.opacity=1,e.to.opacity=0)),d.effect(e)},a.effects.effect.puff=function(b,c){var d=a(this),e=a.effects.setMode(d,b.mode||"hide"),f="hide"===e,g=parseInt(b.percent,10)||150,h=g/100,i={height:d.height(),width:d.width(),outerHeight:d.outerHeight(),outerWidth:d.outerWidth()};a.extend(b,{effect:"scale",queue:!1,fade:!0,mode:e,complete:c,percent:f?g:100,from:f?i:{height:i.height*h,width:i.width*h,outerHeight:i.outerHeight*h,outerWidth:i.outerWidth*h}}),d.effect(b)},a.effects.effect.pulsate=function(b,c){var d,e=a(this),f=a.effects.setMode(e,b.mode||"show"),g="show"===f,h="hide"===f,i=g||"hide"===f,j=2*(b.times||5)+(i?1:0),k=b.duration/j,l=0,m=e.queue(),n=m.length;for((g||!e.is(":visible"))&&(e.css("opacity",0).show(),l=1),d=1;j>d;d++)e.animate({opacity:l},k,b.easing),l=1-l;e.animate({opacity:l},k,b.easing),e.queue(function(){h&&e.hide(),c()}),n>1&&m.splice.apply(m,[1,0].concat(m.splice(n,j+1))),e.dequeue()},a.effects.effect.shake=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","height","width"],g=a.effects.setMode(e,b.mode||"effect"),h=b.direction||"left",i=b.distance||20,j=b.times||3,k=2*j+1,l=Math.round(b.duration/k),m="up"===h||"down"===h?"top":"left",n="up"===h||"left"===h,o={},p={},q={},r=e.queue(),s=r.length;for(a.effects.save(e,f),e.show(),a.effects.createWrapper(e),o[m]=(n?"-=":"+=")+i,p[m]=(n?"+=":"-=")+2*i,q[m]=(n?"-=":"+=")+2*i,e.animate(o,l,b.easing),d=1;j>d;d++)e.animate(p,l,b.easing).animate(q,l,b.easing);e.animate(p,l,b.easing).animate(o,l/2,b.easing).queue(function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}),s>1&&r.splice.apply(r,[1,0].concat(r.splice(s,k+1))),e.dequeue()},a.effects.effect.slide=function(b,c){var d,e=a(this),f=["position","top","bottom","left","right","width","height"],g=a.effects.setMode(e,b.mode||"show"),h="show"===g,i=b.direction||"left",j="up"===i||"down"===i?"top":"left",k="up"===i||"left"===i,l={};a.effects.save(e,f),e.show(),d=b.distance||e["top"===j?"outerHeight":"outerWidth"](!0),a.effects.createWrapper(e).css({overflow:"hidden"}),h&&e.css(j,k?isNaN(d)?"-"+d:-d:d),l[j]=(h?k?"+=":"-=":k?"-=":"+=")+d,e.animate(l,{queue:!1,duration:b.duration,easing:b.easing,complete:function(){"hide"===g&&e.hide(),a.effects.restore(e,f),a.effects.removeWrapper(e),c()}})},a.effects.effect.transfer=function(b,c){var d=a(this),e=a(b.to),f="fixed"===e.css("position"),g=a("body"),h=f?g.scrollTop():0,i=f?g.scrollLeft():0,j=e.offset(),k={top:j.top-h,left:j.left-i,height:e.innerHeight(),width:e.innerWidth()},l=d.offset(),m=a("<div class='ui-effects-transfer'></div>").appendTo(document.body).addClass(b.className).css({top:l.top-h,left:l.left-i,height:d.innerHeight(),width:d.innerWidth(),position:f?"fixed":"absolute"}).animate(k,b.duration,b.easing,function(){m.remove(),c()})}}),define("simplemodal",["_","$","backbone"],function(a,b,c){var d=b(document),e=navigator.userAgent.toLowerCase(),f=b(window),g={ieQuirks:null,msie:/msie/.test(e)&&!/opera/.test(e),opera:/opera/.test(e)};g.ie6=g.msie&&/msie 6./.test(e)&&"object"!=typeof window.XMLHttpRequest,g.ie7=g.msie&&/msie 7.0/.test(e);var h={focus:!1,opacity:0,overlayId:"simplemodal-overlay",overlayCss:{backgroundColor:"black"},containerId:"simplemodal-container",containerCss:{},dataId:"simplemodal-data",dataCss:{},minHeight:null,minWidth:null,maxHeight:null,maxWidth:null,autoResize:!1,autoPosition:!0,zIndex:1e3,close:!0,closeHTML:'<a class="modalCloseImg" title="Close"></a>',closeClass:"simplemodal-close",escClose:!1,overlayClose:!1,fixed:!0,position:null,persist:!1,modal:!0,onOpen:null,onShow:null,onClose:null},i=0;return c.View.extend({ui:{},events:function(){return{}},initialize:function(){this.d=[],this.dTemp=[],this.wTemp=[],g.ieQuirks=g.msie&&!b.support.boxModel;var a=b.extend({},h),c=i++;a.overlayId=h.overlayId+"-"+c,a.containerId=h.containerId+"-"+c,a.dataId=h.dataId+"-"+c,this.o=b.extend(a,this.options),this.zIndex=this.o.zIndex,this.occb=!1},render:function(a){return a?this.o.data=a:a=this.options.data,"object"==typeof a?(a=a instanceof b?a:b(a),this.d.placeholder=!1,a.parent().parent().size()>0&&(a.before(b("<span></span>").attr("id","simplemodal-placeholder").css({display:"none"})),this.d.placeholder=!0,this.display=a.css("display"),this.o.persist||(this.d.orig=a.clone(!0)))):"string"==typeof a||"number"==typeof a?a=b("<div></div>").html(a):alert("SimpleModal Error: Unsupported data type: "+typeof a),this.create(a),this.open(),b.isFunction(this.o.onShow)&&this.o.onShow.apply(this,[this.d]),this.$el},create:function(a){this.getDimensions();var c=this,d=this.dTemp,e=this.wTemp;c.o.modal&&g.ie6&&(c.d.iframe=b('<iframe src="javascript:false;"></iframe>').css(b.extend(c.o.iframeCss,{display:"none",opacity:0,position:"fixed",height:e[0],width:e[1],zIndex:c.o.zIndex,top:0,left:0})).appendTo(c.$el)),c.d.overlay=b("<div></div>").attr("id",c.o.overlayId).addClass("simplemodal-overlay").css(b.extend(c.o.overlayCss,{display:"none",opacity:c.o.opacity/100,filter:"alpha(opacity="+c.o.opacity+")",height:"100%",width:c.o.modal?d[1]:0,position:"fixed",left:0,top:0,zIndex:c.o.zIndex+1})).appendTo(c.$el),c.d.container=b("<div></div>").attr("id",c.o.containerId).addClass("simplemodal-container").css(b.extend({position:c.o.fixed?"fixed":"absolute"},c.o.containerCss,{display:"none",zIndex:c.o.zIndex+2})).append(c.o.close&&c.o.closeHTML?b(c.o.closeHTML).addClass(c.o.closeClass):"").appendTo(c.$el),c.d.wrap=b("<div></div>").attr("tabIndex",-1).addClass("simplemodal-wrap").css({height:"100%",outline:0,width:"100%"}).appendTo(c.d.container),c.d.data=a.attr("id",a.attr("id")||c.o.dataId).addClass("simplemodal-data").css(b.extend(c.o.dataCss,{display:"none"})).appendTo("body"),a=null,c.setContainerDimensions(),c.d.data.appendTo(c.d.wrap),(g.ie6||g.ieQuirks)&&c.fixIE()},bindEvents:function(){var a=this,b=this.dTemp,c=this.wTemp;a.$el.find("."+a.o.closeClass).bind("click.simplemodal",function(b){b.preventDefault(),setTimeout(function(){a.close()},10)}),a.o.modal&&a.o.close&&a.o.overlayClose&&a.d.overlay.bind("click.simplemodal",function(b){b.preventDefault(),a.close()}),d.bind("keydown.simplemodal",function(b){a.o.modal&&9===b.keyCode?a.watchTab(b):a.o.close&&a.o.escClose&&27===b.keyCode&&(b.preventDefault(),a.close())}),f.bind("resize.simplemodal orientationchange.simplemodal",function(){a.getDimensions(),a.o.autoResize?a.setContainerDimensions():a.o.autoPosition&&a.setPosition(),g.ie6||g.ieQuirks?a.fixIE():a.o.modal&&(a.d.iframe&&a.d.iframe.css({height:c[0],width:c[1]}),a.d.overlay.css({height:b[0],width:b[1]}))})},unbindEvents:function(){b("."+this.o.closeClass).unbind("click.simplemodal"),d.unbind("keydown.simplemodal"),f.unbind(".simplemodal"),this.d.overlay.unbind("click.simplemodal")},fixIE:function(){if(g.ie6&&g.ie7){var a=this,c=a.o.position;this.dTemp,this.wTemp;b.each([a.d.iframe||null,a.o.modal?a.d.overlay:null,"fixed"===a.d.container.css("position")?a.d.container:null],function(a,b){if(b){var d="document.body.clientHeight",e="document.body.clientWidth",f="document.body.scrollHeight",g="document.body.scrollLeft",h="document.body.scrollTop",i="document.body.scrollWidth",j="document.documentElement.clientHeight",k="document.documentElement.clientWidth",l="document.documentElement.scrollLeft",m="document.documentElement.scrollTop",n=b[0].style;if(n.position="absolute",a<2)n.removeExpression("height"),n.removeExpression("width"),n.setExpression("height",f+" > "+d+" ? "+f+" : "+d+' + "px"'),n.setExpression("width",i+" > "+e+" ? "+i+" : "+e+' + "px"');else{var o,p;if(c&&c.constructor===Array){var q=c[0]?"number"==typeof c[0]?c[0].toString():c[0].replace(/px/,""):b.css("top").replace(/px/,"");if(o=-1===q.indexOf("%")?q+" + (t = "+m+" ? "+m+" : "+h+') + "px"':parseInt(q.replace(/%/,""))+" * (("+j+" || "+d+") / 100) + (t = "+m+" ? "+m+" : "+h+') + "px"',c[1]){var r="number"==typeof c[1]?c[1].toString():c[1].replace(/px/,"");p=-1===r.indexOf("%")?r+" + (t = "+l+" ? "+l+" : "+g+') + "px"':parseInt(r.replace(/%/,""))+" * (("+k+" || "+e+") / 100) + (t = "+l+" ? "+l+" : "+g+') + "px"'}}else o="("+j+" || "+d+") / 2 - (this.offsetHeight / 2) + (t = "+m+" ? "+m+" : "+h+') + "px"',p="("+k+" || "+e+") / 2 - (this.offsetWidth / 2) + (t = "+l+" ? "+l+" : "+g+') + "px"';n.removeExpression("top"),n.removeExpression("left"),n.setExpression("top",o),n.setExpression("left",p)}}})}},focus:function(a){var c=this,d=a&&-1!==b.inArray(a,["first","last"])?a:"first",e=b(":input:enabled:visible:"+d,c.d.wrap);setTimeout(function(){e.length>0?e.focus():c.d.wrap.focus()},10)},getDimensions:function(){var a=void 0===window.innerHeight?f.height():window.innerHeight;this.dTemp=[d.height(),d.width()],this.wTemp=[a,f.width()]},getVal:function(a,b){var c=this.wTemp;return a?"number"==typeof a?a:"auto"===a?0:a.indexOf("%")>0?parseInt(a.replace(/%/,""))/100*("h"===b?c[0]:c[1]):parseInt(a.replace(/px/,"")):null},update:function(a,b){var c=this;if(!c.d.data)return!1;c.d.origHeight=c.getVal(a,"h"),c.d.origWidth=c.getVal(b,"w"),c.d.data.hide(),a&&c.d.container.css("height",a),b&&c.d.container.css("width",b),c.setContainerDimensions(),c.d.data.show(),c.o.focus&&c.focus(),c.unbindEvents(),c.bindEvents()},setContainerDimensions:function(){var a=this,b=g.ie6||g.ie7,c=(a.o.position,this.dTemp,this.wTemp),d=a.d.origHeight?a.d.origHeight:g.opera?a.d.container.height():a.getVal(b?a.d.container[0].currentStyle.height:a.d.container.css("height"),"h"),e=a.d.origWidth?a.d.origWidth:g.opera?a.d.container.width():a.getVal(b?a.d.container[0].currentStyle.width:a.d.container.css("width"),"w"),f=a.d.data.outerHeight(!0),h=a.d.data.outerWidth(!0);a.d.origHeight=a.d.origHeight||d,a.d.origWidth=a.d.origWidth||e;var i=a.o.maxHeight?a.getVal(a.o.maxHeight,"h"):null,j=a.o.maxWidth?a.getVal(a.o.maxWidth,"w"):null,k=i&&i<c[0]?i:c[0],l=j&&j<c[1]?j:c[1],m=a.o.minHeight?a.getVal(a.o.minHeight,"h"):"auto";d=d?a.o.autoResize&&d>k?k:d<m?m:d:f?f>k?k:a.o.minHeight&&"auto"!==m&&f<m?m:f:m;var n=a.o.minWidth?a.getVal(a.o.minWidth,"w"):"auto";e=e?a.o.autoResize&&e>l?l:e<n?n:e:h?h>l?l:a.o.minWidth&&"auto"!==n&&h<n?n:h:n,a.d.container.css({height:d,width:e}),a.o.autoPosition&&a.setPosition()},setPosition:function(){var a,b,c=(this.dTemp,this.wTemp),d=this,e=c[0]/2-d.d.container.outerHeight(!0)/2,g=c[1]/2-d.d.container.outerWidth(!0)/2,h="fixed"!==d.d.container.css("position")?f.scrollTop():0;d.o.position&&"[object Array]"===Object.prototype.toString.call(d.o.position)?(a=h+(d.o.position[0]||e),b=d.o.position[1]||g):(a=h+e,b=g),d.d.container.css({left:b,top:a})},watchTab:function(a){var c=this;if(b(a.target).parents(".simplemodal-container").length>0){if(c.inputs=b(":input:enabled:visible:first, :input:enabled:visible:last",c.d.data[0]),!a.shiftKey&&a.target===c.inputs[c.inputs.length-1]||a.shiftKey&&a.target===c.inputs[0]||0===c.inputs.length){a.preventDefault();var d=a.shiftKey?"last":"first";c.focus(d)}}else a.preventDefault(),c.focus()},open:function(){var a=this;a.d.iframe&&a.d.iframe.show(),b.isFunction(a.o.onOpen)?a.o.onOpen.apply(a,[a.d]):(a.d.overlay.show(),a.d.container.show(),a.d.data.show()),a.o.focus&&a.focus(),a.bindEvents()},close:function(){var a=this;if(!a.d.data)return!1;a.unbindEvents(),b.isFunction(a.o.onClose)&&!a.occb?(a.occb=!0,a.o.onClose.apply(a,[a.d])):setTimeout(function(){if(a.d.placeholder){var c=b("#simplemodal-placeholder");a.o.persist?c.replaceWith(a.d.data.removeClass("simplemodal-data").css("display",a.display)):(a.d.data.hide().remove(),c.replaceWith(a.d.orig))}else a.d.data.hide().remove();a.d.container.hide().remove(),a.d.overlay.hide(),a.d.iframe&&a.d.iframe.hide().remove(),a.d.overlay.remove(),a.d={}},0)}})}),define("collections/user-selector-group-collection",["talent"],function(a){return a.Collection.extend({getContact:function(){var b=new $.Deferred;return $.ajax({url:a.Context.getEpmApiUrl("Appraiser/SearchUser?filer=&v="+(new Date).getTime()),type:"GET",success:function(c){if(0!=c.length&&0!=c.Total){var d=a._.values(c);a._.map(d,function(a){a.subName=a.Name;var b={className:"radius_img30",bgColor:a.UserAvatar.Color,src:a.UserAvatar.Small,shape:"radius",size:"30",name:a.UserAvatar.Name,HasAvatar:a.UserAvatar.HasAvatar};return a.imgTemplate=_.convertImagePer(b)}),d.length>0?b.resolve(d):b.resolve([])}else b.resolve([])}}),b.promise()},getSubordinate:function(){var b=new $.Deferred;return $.ajax({url:a.Context.getEpmApiUrl("org/Subordinates?lv=2"),type:"GET",success:function(c){if(c&&1==c.Code){var d=a._.values(c.Data);d.length>0?(d=a._.pluck(d,"User"),a._.map(d,function(a){return a.imgTemplate='<img src="'+a.MidAvatar+'"/>'}),b.resolve(d)):b.resolve([])}else b.resolve([])}}),b.promise()},getSearch:function(b){var c=new $.Deferred,d=b&&b.searchCondition||{},e=a.Context.getEpmApiUrl("Appraiser/SearchUser?v="+(new Date).getTime()+"&filer="+(d.name||""));return""==d.name?c.resolve([]):$.ajax({url:e,type:"GET",success:function(b){if(0!=b.length&&0!=b.Total){var d=a._.values(b);a._.map(d,function(a){var b={className:"radius_img30",bgColor:a.UserAvatar.Color,src:a.UserAvatar.Small,shape:"radius",size:"30",name:a.UserAvatar.Name,HasAvatar:a.UserAvatar.HasAvatar};return a.imgTemplate=_.convertImagePer(b)}),c.resolve(d)}else c.resolve([])}}),c.promise()},getDepartment:function(){var b=new $.Deferred;return $.ajax({url:a.Context.getEpmApiUrl("department/All"),type:"GET",success:function(c){if(c&&1==c.Code){var d=c.Data||[];d=a._.filter(d,function(a,b){return 0==a.PId}),a._.map(d,function(a,b){a.count=a.TotalUserCount,a.Data=[],a.type="department"}),b.resolve(d)}else b.resolve([])}}),b.promise()},getDepartmentDetail:function(b){var c=new $.Deferred,d=parseInt(b.id);return this.getDepartment().done(function(e){var f=e;f=a._.filter(f,function(a,b){return a.PId==d}),a._.map(f,function(a,b){a.count=a.TotalUserCount,a.Data=[],a.type="department"}),f=f||[],$.ajax({url:a.Context.getEpmApiUrl("department/DepartmentOfUser?department_id=")+b.id,type:"GET",success:function(b){a._.map(b.Data,function(a){return a.imgTemplate='<img src="'+a.MidAvatar+'"/>'}),f=f.concat(b.Data||[]),c.resolve(f)}})}),c.promise()}})}),define("UserSelector",["talent"],function(talent){var jst=function(){return this.JST=this.JST||{},this.JST["smember/smember-component"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)"single"==viewType?(__p+='\n<div class="smember_simple_container">\n\t<div class="smember_condition"></div>\n\t<div class="smember_search_content">\n\t\t<div class="smember_search_content_left">\n\t\t\t',(showTab||"muti"==viewType)&&(__p+='\n\t\t\t<div class="smember_tab"></div>\n\t\t\t'),__p+='\n\t\t\t<div class="smember_list_container"></div>\n\t\t\t<div class="smember_search_content_left_footer"></div>\n\t\t</div>\n\t</div>\n\t',showFoot&&(__p+='\n\t<div class="smember_footer">\n\t\t<div class="smember_footer_group">\n\t\t\t',muti&&(__p+='\n\t\t\t<a href="javascript:void(0)" class="smember_btn_default" data-handler="More">高级模式</a>\n\t\t\t'),__p+='\n\t\t\t<a href="javascript:void(0)" class="smember_btn_default" data-handler="Close">关闭</a>\n\t\t</div>\n\t</div>\n\t'),__p+="\n</div>\n"):(__p+='\n<div class="smember_muti_container">\n\t<div class="smember_header">\n\t\t选择人员\n\t\t<a href="javascript:void(0)" class="smember_btn_close" data-handler="Close"></a>\n\t</div>\n\t<div class="smember_condition"></div>\n\t<div class="smember_search_content">\n\t\t<div class="smember_search_content_left">\t\t\n\t\t\t<div class="smember_tab"></div>\n\t\t\t<div class="smember_list_container"></div>\n\t\t\t<div class="smember_search_content_left_footer"></div>\n\t\t</div>\n\t\t<div class="smember_search_content_center">\t\n\t\t\t<span class="smember_search_arrow_icon"></span>\n\t\t</div>\n\t\t<div class="smember_search_content_right">\n\t\t\t<div class="smember_after_search_title">\n\t\t\t\t已选人员\n\t\t\t</div>\n\t\t\t<div class="smember_after_search_list_container"></div>\n\t\t</div>\n\t</div>\n\t',showFoot&&(__p+='\n\t<div class="smember_footer">\n\t\t<div class="smember_footer_group">\n\t\t\t<a href="javascript:void(0)" class="smember_btn_blue" data-handler="Submit">确定</a>\n\t\t\t<a href="javascript:void(0)" class="smember_btn_default" data-handler="Cancel">取消</a>\n\t\t</div>\n\t</div>\n\t'),__p+="\n</div>\n");return __p},this.JST["smember/smember-composite"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)title?(__p+='\n\t<div class="smember_list_title" list-type="title">\n\t',"added"!=listType?(__p+="\n\t\t","all"==type?(__p+="\n\t\t\t<span>"+__e(name),"null"!=count&&(__p+="&nbsp;&nbsp;"+__e(count)),__p+="</span>","null"!=count&&(__p+="<span>人</span>"),__p+='\n\t\t\t<a href="javascript:void(0)" data-handler="Add" class="smember_btn_add"><span></span></a>\n\t\t'):(__p+='\n\t\t\t<a  href="javascript:void(0)" data-handler="Open" class="smember_btn_fold"></a>\n\t\t\t<span title='+__e(DepartmentName)+">"+__e(subDepartmentName)+"</span>","null"!=count&&(__p+="<span>&nbsp;&nbsp;"+(null==(__t=count)?"":__t)+"人</span>"),__p+='\n\t\t\t<a href="javascript:void(0)" data-handler="Add" class="smember_btn_add"><span></span></a>\n\t\t'),__p+="\n\t"):(__p+="\n\t\t","all"==type?(__p+="\n\t\t\t","null"!=count&&0!=count&&(__p+="\n\t\t\t\t<span>"+(null==(__t=name)?"":__t),"null"!=count&&(__p+="&nbsp;&nbsp;"+(null==(__t=count)?"":__t)+"人"),__p+="</span>\n\t\t\t"),0!=orginCount&&(__p+="\n\t\t\t\t<span>组"+(null==(__t=orginCount)?"":__t)+"个</span>\n\t\t\t"),__p+='\n\t\t\t<a href="javascript:void(0)" data-handler="Delete" class="smember_btn_reduce"><span></span></a>\n\t\t'):(__p+='\n\t\t\t<a  href="javascript:void(0)" data-handler="Open" class="smember_btn_fold"></a>\n\t\t\t<span title='+__e(DepartmentName)+" >"+__e(subDepartmentName)+"</span>","null"!=count&&(__p+="<span>&nbsp;&nbsp;"+(null==(__t=count)?"":__t)+"人</span>"),__p+='\n\t\t\t<a href="javascript:void(0)" data-handler="Delete" class="smember_btn_reduce"><span></span></a>\n\t\t'),__p+="\n\t"),__p+="\n\t</div>\n"):(__p+='\n\t<div class="smember_list_item" list-type="item">\n\t\t'+(null==(__t=imgTemplate)?"":__t)+'\n\t\t<div class="smember_list_info">\n\t\t\t<div class="member_list_item_one">\n\t\t\t\t<div class="smember_list_item_name" title='+__e(Name)+">"+__e(Name)+"</div>\n\t\t\t\t","added"!=listType&&(__p+="\n\t\t\t\t\t",!showDepartment||"Contact"!=listType&&"Search"!=listType||(__p+='\n\t\t\t\t\t\t<div class="smember_list_item_department" title='+__e(Name)+">"+__e(Department)+"</div>\n\t\t\t\t\t"),__p+="\n\t\t\t\t"),__p+='\t\n\t\t\t</div>\n\t\t\t<div class="smember_list_item_email" title='+__e(Email)+" >"+__e(subEmail)+"</div>\n\t\t</div>\n\t\t","added"==listType&&(__p+='\n\t\t\t<a href="javascript:void(0)" data-handler="Delete" class="smember_btn_reduce">\n\t\t\t\t<span></span>\n\t\t\t</a>\n\t\t'),__p+="\n\t</div>\n"),__p+='\n<ul class="list_container clearfloat"></ul>';return __p},this.JST["smember/smember-set-condition-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)"single"==viewType&&(__p+='\n<div class="smember_header_input">\n\t<label class="smember_condition_label">'+(null==(__t=title)?"":__t)+"</label>\n\t",hasSerchBtn?__p+='\n\t\t<input autocomplete="off" class="smember_condition_input smember_condition_input_small" type="text" name="content"></input>\n\t\t<button class=\'sear_btn\'>搜索</button>\n\t':__p+='\n\t\t<input autocomplete="off" class="smember_condition_input" type="text" name="content"></input>\n\t',__p+="\n</div>\n"),__p+="\n","muti"==viewType&&(__p+='\n<div class="smember_form_container">\n\t<div class="smember_header_input">\n\t\t<label class="smember_condition_label">'+(null==(__t=title)?"":__t)+"</label>\n\t\t",hasSerchBtn?__p+='\n\t\t\t<input autocomplete="off" class="smember_condition_input smember_condition_input_small" type="text" name="content"></input>\n\t\t\t<button class=\'sear_btn\'>搜索</button>\n\t\t':__p+='\n\t\t\t<input autocomplete="off" class="smember_condition_input" type="text" name="content"></input>\n\t\t',__p+="\n\t</div>\n</div>\n"),__p+="\n","mutiPower"==viewType&&(__p+='\n\t<div class="smember_form_search">\n\t\t<a href="javascript:void(0)" class="smember_btn_default">搜索</a>\n\t</div>\n\t<div class="smember_search_filter_content">\n\t\t<span class="smember_search_btn_down"></span>\n\t</div>\n');return __p},this.JST["smember/smember-tab-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)_.each(tab,function(a,b){__p+='\n\t<li style="float: left"> <a data-type='+(null==(__t=a.type)?"":__t)+' href="javascript:void(0)">'+(null==(__t=a.text)?"":__t)+"</a></li>\n"});return __p},this.JST}(),ListCompositeView=talent.CompositeView.extend({template:jst["smember/smember-composite"],tagName:"li",className:"clearfix",itemViewContainer:".list_container",initialize:function(a){var b=this;this.options=talent.$.extend({},a),this.parentView=this.options.parentView,this.model.get("Data")&&(this.collection=new talent.Collection(this.model.get("Data")));this.model.get("count");this.templateHelpers={title:!(!this.model.get("count")&&0!=this.model.get("count")),listType:this.options.listType,viewType:this.options.viewType,showDepartment:this.options.showDepartment},this.itemViewOptions={listType:this.options.listType,viewType:this.options.viewType,parentView:this,eventId:this.options.eventId,showDepartment:this.options.showDepartment},this.on("composite:collection:rendered",function(){b.$el.find(".smember_loading").remove()})},events:{"click a":"onHandler","click .smember_list_title":"dealDepartmentAdd"},modelEvents:{"change:count":"render","change:orginCount":"render"},onRender:function(){var a=this,b=this.model.get("count"),c=this.options.listType;b||0==b||"added"==c||this.$el.find('[list-type="item"]').on("click",function(b){b.stopPropagation(),a.onAfterAdd()}),"department"==this.model.get("type")&&this.model.get("Data").length>0&&this.$el.find(".smember_btn_fold:first-child").addClass("smember_btn_unfold")},onHandler:function(a){a.stopPropagation();var b=talent.$(a.currentTarget).attr("data-handler");this["onAfter"+b]&&this["onAfter"+b](a)},onAfterAdd:function(a){talent.app.vent.trigger("smember"+this.options.eventId,{view:this,type:"Add"})},dealDepartmentAdd:function(a){if(a.stopPropagation(),"Department"!=this.options.listType&&"added"!=this.options.listType)return!1;this.onAfterOpen($(a.currentTarget).find(".smember_btn_fold"))},onAfterOpen:function(a){var b=a.target?talent.$(a.target):a;if(b.removeClass("smember_btn_unfold"),this.openChild)b.removeClass("smember_btn_unfold"),this.openChild=!1,this.$el.find(".list_container").hide();else if(b.addClass("smember_btn_unfold"),this.openChild=!0,0==this.collection.models.length){var c=new LoadingView;talent.app.vent.trigger("smember"+this.options.eventId,{type:"Open",view:this}),this.$el.find(".list_container").append(c.render().$el)}else this.$el.find(".list_container").show()},onAfterDelete:function(a){talent.app.vent.trigger("smember"+this.options.eventId,{type:"Delete",view:this})}}),SmemberItemView=talent.ItemView.extend({template:talent._.template('<div class="smember_list_empty"><%= emptyText  %></div>'),initialize:function(a){this.templateHelpers=a}}),SMemberListCompositeView=talent.CompositeView.extend({template:talent._.template('<ul class="smember_list_parent"></ul>'),itemView:ListCompositeView,itemViewContainer:".smember_list_parent",emptyView:SmemberItemView,defaults:{ContactEmptyText:"输入同事姓名或邮箱",SubordinateEmptyText:"未设置下属，请在个人设置的计划设置下添加。",DepartmentEmptyText:"未设置部门人员，请联系企业超管在后台的组织架构和员工管理下设置",SearchEmptyText:"输入同事姓名或邮箱",addedEmptyText:"请从左侧点击选择"},initialize:function(a){this.options=a||{}},itemViewOptions:function(){return{emptyText:"added"!=this.model.get("listType")&&this.model.get("emptyText")?this.model.get("emptyText"):this.defaults[this.model.get("listType")+"EmptyText"],listType:this.model.get("listType"),viewType:this.model.get("viewType"),showDepartment:this.model.get("showDepartment"),parentView:this,eventId:this.options.eventId}},onShow:function(){this.bindItemEvents(),this.bindTitleEvents();var a=this.model.get("listType"),b=this.model.get("viewType");("Search"==a||"single"==b&&"Contact"==a)&&this.focusFirst()},bindItemEvents:function(){var a=this;this.$el.on("mouseover",'[list-type="item"]',function(b){a.$el.find(".smember_cur").removeClass("smember_cur"),a.node=talent.$(b.currentTarget).parent(),a.node.addClass("smember_cur")}).on("mouseleave",'[list-type="item"]',function(a){talent.$(a.currentTarget).parent().removeClass("smember_cur")})},bindTitleEvents:function(){var a=this;this.$el.on("mouseover",'[list-type="title"]',function(b){a.$el.find(".smember_cur").removeClass("smember_cur"),a.node=talent.$(b.currentTarget),a.node.addClass("smember_cur")}).on("mouseleave",'[list-type="item"]',function(a){talent.$(a.currentTarget).removeClass("smember_cur")})},focusPrev:function(){if(0==this.$el.find(".smember_cur").length)return void this.focusFirst();var a=this.node.prev();if(0==a.find('[list-type="item"]').length)return void this.focusLast();a.find('[list-type="item"]').trigger("mouseover"),this.setVisible(a)},focusNext:function(){if(0==this.$el.find(".smember_cur").length)return void this.focusFirst();var a=this.node.next();if(0==a.find(".smember_list_item").length)return void this.focusFirst();a.find('[list-type="item"]').trigger("mouseover"),this.setVisible(a)},setVisible:function(a){var b=a.offset().top-(this.$el.offset().top+this.$el.outerHeight()),c=a.offset().top-this.$el.offset().top,d=this.$el.find(".smember_list_parent")[0];b>=0?d.scrollTop=d.scrollTop+45:c>=45&&(d.scrollTop=d.scrollTop-45)},focusFirst:function(){this.$el.find(".smember_list_item").first().trigger("mouseover"),this.$el.find(".smember_list_parent")[0].scrollTop=0},focusLast:function(){this.$el.find(".smember_list_item").last().trigger("mouseover");var a=this.$el.find(".smember_list_parent");a[0].scrollTop=a[0].scrollHeight-a.height()},triggerClick:function(){this.$el.find(".smember_cur").find(".smember_list_item").trigger("click")}}),LoadingView=talent.ItemView.extend({className:"smember_loading",template:talent._.template("loading...")}),SMemberSetConditionItemView=talent.ItemView.extend({template:jst["smember/smember-set-condition-item"],className:"smember_condition_all",events:{"click .smember_condition_label":"onLabelClick","click .sear_btn":"onsearUser","focusout .smember_condition_input":"onInputFocusOut","focusin .smember_condition_input":"onInputFocusin","click a":"changeSearchCondition"},ui:{content:".smember_condition_input",contentHolder:".smember_condition_label"},initialize:function(){var a=this;this.changeSearchConditionDelay=_.debounce(function(b){var c=talent.$.trim(talent.$(b.currentTarget).val());""==c?a.model.set({searchCondition:{name:c},listType:"Contact"}):a.model.set({searchCondition:{name:c},listType:"Search"}),a.trigger("showDialog",talent.$(b.currentTarget))},100,!1)},onRender:function(){},onsearUser:function(a){a.stopPropagation(),a.preventDefault(),this.ui.contentHolder.hide();var b=talent.$.trim(this.ui.content.val());this.ui.content.parent(".smember_header_input").addClass("smember_header_input_focus"),""!=b?this.model.set({searchCondition:{name:b},listType:"Search"}):this.model.set({searchCondition:{name:b},listType:"Contact"})},onInputFocusin:function(a){if(a.stopPropagation(),a.preventDefault(),this.ui.contentHolder.hide(),!this.model.get("hasSerchBtn")){var b=talent.$.trim(this.ui.content.val());this.ui.content.parent(".smember_header_input").addClass("smember_header_input_focus"),""!=b?this.model.set({searchCondition:{name:b},listType:"Search"}):this.model.set({searchCondition:{name:b},listType:"Contact"})}},onLabelClick:function(a){a.stopPropagation(),this.ui.content.focus()},onInputFocusOut:function(a){a.stopPropagation(),""==this.ui.content.val()&&this.ui.contentHolder.show(),this.ui.content.parent(".smember_header_input").removeClass("smember_header_input_focus")},resetInput:function(){0==this.model.get("input")&&(this.$el.find(".smember_condition_input").val(""),this.$el.find(".smember_condition_label").show())},changeSearchCondition:function(a){var b=this;a.stopPropagation();var c=this.$el.find(".smember_condition_input").val();b.model.set("searchCondition",{name:c})},setInputFocus:function(){this.model.get("input")&&this.$el.find(".smember_condition_input").focus()},getInput:function(){return this.ui.content},onShow:function(){this.setInputFocus()}}),SMemberTabItemView=talent.ItemView.extend({template:jst["smember/smember-tab-item"],tagName:"ul",className:"clearfix",events:{"click a":"onTabClick"},modelEvents:{"change listType":"setActive"},defaults:{Contact:"常用",Search:"搜索",Subordinate:"下属",Department:"部门",TalentPool:"人才池"},initialize:function(a){var b=this.model.get("tab"),c=[],d=this.defaults;talent._.each(b,function(a){c.push({type:a,text:d[a]})}),this.model.set("tab",c)},onShow:function(){this.setActive()},onTabClick:function(a){a.stopPropagation();var b=talent.$(a.target);if(!b.parent().hasClass("active")){this.$el.find(".active").removeClass("active"),b.parent().addClass("active");var c=talent.$(a.target).attr("data-type");this.model.set("listType",c)}},setActive:function(){var a=this.model.get("listType");this.$el.find(".active").removeClass("active"),this.$el.find('a[data-type="'+a+'"]').parent().addClass("active")}}),keyCode={down:40,up:38,esc:27,tab:9,enter:13},SmemberComponetView=talent.Layout.extend({template:jst["smember/smember-component"],className:"smember_container",className2:"smember_container",regions:{condition:".smember_condition",tab:".smember_tab",main:".smember_list_container",addList:".smember_after_search_list_container"},events:{"click a":"onHandler"},modelEvents:{"change:listType":"renderListByType","change:searchCondition":"onSearchConditionChange"},defaults:{allListType:["Search","Contact","Subordinate","Department","TalentPool"],tab:["Contact","Search","Subordinate","Department"],viewType:"single",listType:"Contact",searchCondition:{name:""},showDepartment:!1,input:!0,muti:!1,showFoot:!0,showTab:!1,title:"输入同事姓名或邮箱",hasSerchBtn:!1,bias:{left:0,top:0},stringLen:{Name:34,Email:32,DepartmentName:30},triggerChar:null,visibleMode:1},initialize:function(a){this.inputs=[],this.addedData=a.addedData,this.nodes=[],this.atNodes=[],this.activeNode="",this.eventId=parseInt(1e3*Math.random()),this.dialogIsShow=!1,this.getDataCollection=a.collection,talent.app.vent.on("smember"+this.eventId,this.onOperate,this)},renderListByType:function(){var a=this,b=this.model.get("listType"),c=this.model.get("allListType");if(-1!=talent._.indexOf(c,b)){var d="get"+b,e=this.model.toJSON();a.main.show(new LoadingView);this.getDataCollection[d](e).done(function(c){var d=a.dealData(c,b);a.smemberListCompositeView=new SMemberListCompositeView({collection:new talent.Collection(d),model:a.model,eventId:a.eventId}),a.main.show(a.smemberListCompositeView),0!=c.length&&a.$el.find(".smember_list_parent").height(a.$el.find(".smember_list_container").height())})}},renderTabView:function(){this.options.showTab?(this.smemberTabItemView=new SMemberTabItemView({model:this.model}),this.tab.show(this.smemberTabItemView)):"muti"==this.model.get("viewType")&&(this.smemberTabItemView=new SMemberTabItemView({model:this.model}),this.tab.show(this.smemberTabItemView))},renderSetConditionView:function(){if(1==this.model.get("input")){this.smemberSetConditionItemView=new SMemberSetConditionItemView({model:this.model}),this.condition.show(this.smemberSetConditionItemView);var a={node:this.smemberSetConditionItemView.getInput()};this.bindInputEvents(a)}},renderAddedListView:function(){this.smemberListAddCompositeView=new SMemberListCompositeView({collection:this.addCollection,model:new talent.Model({listType:"added",showDepartment:!1}),eventId:this.eventId}),this.addList.show(this.smemberListAddCompositeView)},onRender:function(){this.renderSetConditionView(),this.undelegateEvents(),this.delegateEvents();var a=this;setTimeout(function(){a.$el.appendTo("body"),a.renderTabView(),a.renderAddedListView(),a.renderListByType(),a.$el.off("click.smember"),a.$el.on("click.smember",function(a){a.stopPropagation()})},0),talent.$("body").off("click.smember"),talent.$("body").on("click.smember",function(){a.deleteView()})},addInput:function(a,b){var b=talent._.extend({},{input:!1},b),c={node:a,nodeId:"smember_"+parseInt(1e4*Math.random()),options:b};this.inputs.push(c),this.bindNodeEvents(c),this.bindInputEvents(c)},addNode:function(a,b){var c={node:a,nodeId:"smember_"+parseInt(1e4*Math.random()),options:b};this.nodes.push(c),this.bindNodeEvents(c)},addAtNode:function(a,b,c){var a=talent.$(a),b=talent.$(b),d={node:a,btnNode:b,nodeId:"smember_"+parseInt(1e4*Math.random()),options:c};this.atNodes.push(d),a.attr("data-smemberid",d.nodeId),b.attr("data-smemberid",d.nodeId),this.bindAtNodeEvents(a,b)},bindAtNodeEvents:function(a,b){var c=this;a.off("keyup.smember keydown.smember scroll.smember blur.smember submit click.smember input.smember propertychange.smember"),a.on("keyup.smember",function(a){c.onKeyUpElHanlder(a)||(c.atTarget=a?talent.$(a.currentTarget):c.atTarget,c.atCatchQuery())}).on("keydown.smember",function(a){c.onKeyDownElHandler(a)}).on("scroll.smember",function(a){c.deleteView()}).on("blur.smember",function(a){}).on("submit",function(a,b){var d="";if(!b)return!1;b.data?talent._.each(b.data,function(a){"department"==a.type?d+="@["+a.name+":"+a.id+":dep_members] ":d+="@["+a.Name+":"+a.Email+"] "}):d="@["+b.Name+":"+b.Email+"] ",c.atInsert(d,!0)}).on("click.smember",function(a,b){a.stopPropagation()}).on("input.smember propertychange.smember",function(a){a.stopPropagation(),a.preventDefault(),c.dialogIsShow&&(c.atTarget=a?talent.$(a.currentTarget):c.atTarget,c.atCatchQuery())}),b.off("click.smember"),b.on("click.smember",function(a){a.stopPropagation();var b=talent.$(a.currentTarget).attr("data-smemberid"),d=talent._.where(c.atNodes,{nodeId:b})[0]||{},e=talent.$(d.node),f=d.options;e.focus();var g=talent.$(e).caret("pos");c.atTarget=e,c.pos=g,c.query={text:"",head_pos:g,end_pos:g},c.atInsert(f.triggerChar,!1),e.trigger("keyup.smember")})},bindInputEvents:function(a){var b=this;talent.$(a.node).off("keyup.smember"),talent.$(a.node).on("keyup.smember",function(a){b.onKeyUpElHanlder(a)||b.changeSearchConditionDelay(a)}),talent.$(a.node).off("keydown.smember"),talent.$(a.node).on("keydown.smember",function(a){b.onKeyDownElHandler(a)}).off("input.smember propertychange.smember").on("input.smember propertychange.smember",function(a){b.dialogIsShow&&this.model&&(this.model.get("hasSerchBtn")||b.changeSearchConditionDelay(a))}),this.changeSearchConditionDelay=_.debounce(function(a){b.setInputSearchCondition(talent.$(a.currentTarget))},100,!1)},setInputSearchCondition:function(a){var b=talent.$(a).val()||"";b=b.replace(/^\s+|\s+$/g,""),""==b?this.model.set({searchCondition:{name:b},listType:"Contact"}):this.model.set({searchCondition:{name:b},listType:"Search"})},bindNodeEvents:function(a){var b=this,a=a||{};talent.$(a.node).attr("data-smemberid",a.nodeId),talent.$(a.node).off("click.smember"),talent.$(a.node).on("click.smember",function(a){b.onEventTrigger(a)}),talent.$(a.node).off("focusin.smember"),talent.$(a.node).on("focusin.smember",function(a){b.onEventTrigger(a),function(a){setTimeout(function(){b.onSecondTrigger(a)},300)}(a)})},onSecondTrigger:function(a){var b=this,c=talent.$(a.currentTarget),d=c.attr("data-smemberid"),e=talent._.union(this.inputs,this.nodes),f=talent._.where(e,{nodeId:d})[0]||{},g=f.options,h=this.getNodeOffset(c);b.showDialog(g,c,h)},onEventTrigger:function(a){a.stopPropagation();var b=this,c=talent.$(a.currentTarget),d=c.attr("data-smemberid"),e=talent._.union(this.inputs,this.nodes),f=talent._.where(e,{nodeId:d})[0]||{},g=f.options,h=this.getNodeOffset(c);b.showDialog(g,c,h)},unBindAllInputEvents:function(){var a=this.inputs,b=this;talent._.each(a,function(a){a.node&&b.unBindInputEvents(a.node)})},unBindAllNodeEvents:function(){var a=this.nodes,b=this;talent._.each(a,function(a){a.node&&b.unBindNodeEvents(a.node)})},unBindNodeEvents:function(a){talent.$(a).off("click.smember focusin.smember")},unBindInputEvents:function(a){talent.$(a).off("click.smember keyup.smember focusin.smember keydown.smember input.smember propertychange.smember")},unBindAtNodeEvents:function(a){talent.$(a).off("keydown.smember keyup.smember scroll.smember blur.smember click.smember input.smember propertychange.smember")},organizationData:function(a,b){this.options=talent.$.extend({},this.defaults,a);var c=this.options.input;if(this.activeNode=talent.$(b),this.model=new talent.Model(this.options),c||this.setInputSearchCondition(this.activeNode),this.options.triggerChar&&this.atCatchQuery(),this.addedData&&this.addedData.length>0){var d=[],e={name:"全部",type:"all",Data:[],count:0,orginCount:0};d.push(e);for(var f=[],g=null,h=0,i=this.addedData.length;h<i;h++){var j=this.addedData[h];g=this.joinArr(e.Data,j),f.push(g[0])}e.Data=f,e.count=f.length,this.addCollection=new talent.Collection(d)}else this.addCollection=new talent.Collection([])},showDialog:function(a,b,c){if(talent.$(this.activeNode).attr("data-smemberid")==talent.$(b).attr("data-smemberid")&&this.dialogIsShow)return this.setPosition(b,c),void(this.smemberSetConditionItemView&&this.smemberSetConditionItemView.setInputFocus());c&&(this.$el.attr("offset-left",c.left),this.$el.attr("offset-top",c.top)),this.dialogIsShow=!0,this.organizationData(a,b),this.render(),this.setPosition(b,c),this.$el.show(),this.onAfterShow(a,b)},onAfterShow:function(){var a=this;if("single"==this.model.get("viewType")&&this.smemberSetConditionItemView&&this.model.get("input"))var b=setTimeout(function(){a.smemberSetConditionItemView.setInputFocus(),clearTimeout(b)},300)},setPosition:function(a,b){var c,d,e=this.model.get("bias");1==this.options.visibleMode?(c=talent.$("body").height(),d=talent.$("body").width()):(c=document.body.scrollHeight,d=document.body.scrollWidth),this.oldW||(this.oldW=d),this.oldH||(this.oldH=c);var f=this.$el.outerHeight(),g=this.$el.outerWidth(),h=b||a.offset();if(b){var i=parseInt(b.top),j=parseInt(b.left);i+f>c&&(i-=i+f-c)<0&&(i=0),j+g>d&&(j-=j+g-d)<0&&(j=0),this.$el.css({top:i,left:j})}else{var i=h.top+a.outerHeight()+10+e.top,j=h.left+e.left;this.oldH&&i+f>this.oldH&&(i-=i+f-this.oldH)<0&&(i=0),this.oldW&&j+g>this.oldW&&(j-=j+g-this.oldW)<0&&(j=0),this.$el.css({top:i,left:j})}},onHandler:function(a){var b=talent.$(a.target).attr("data-handler");this["on"+b+"Handler"]&&this["on"+b+"Handler"](a)},onMoreHandler:function(a){a.stopPropagation(),this.model.set({viewType:"muti",listType:"Contact",searchCondition:{name:""}}),this.render(),this.trigger("more");var b=talent.$(this.activeNode),c="";this.$el.attr("offset-top")&&this.$el.attr("offset-left")&&(c={},c.top=this.$el.attr("offset-top"),c.left=this.$el.attr("offset-left")),this.setPosition(b,c)},onSubmitHandler:function(){var a=this.addCollection.toJSON(),b=[];talent._.each(a,function(a){"department"!=a.type&&"talentPool"!=a.type?b=talent._.union(b,a.Data):"department"==a.type?b.push({type:"department",name:a.DepartmentName,id:a.Id,totalUserCount:a.TotalUserCount,allItem:a}):"talentPool"==a.type&&b.push({type:"talentPool",name:a.DepartmentName,id:a.Id,totalUserCount:a.TotalUserCount,allItem:a})}),talent.$(this.activeNode).trigger("submit",{data:b}),this.trigger("submit",{data:b}),this.deleteView()},onCancelHandler:function(){this.trigger("cancel"),this.deleteView()},onCloseHandler:function(){this.trigger("close"),this.deleteView()},onKeyUpElHanlder:function(a){var b=!1;return this.model.get("hasSerchBtn")?a.keyCode!=keyCode.enter&&(b=!0):a.keyCode!=keyCode.esc&&a.keyCode!=keyCode.down&&a.keyCode!=keyCode.up&&a.keyCode!=keyCode.tab||(b=!0),b},onKeyDownElHandler:function(a){var b=!1,c=this;switch(a.keyCode){case keyCode.esc:c.deleteView(),b=!0;break;case keyCode.down:c.onDownKeyCode(a),b=!0;break;case keyCode.up:c.onUpKeyCode(a),b=!0;break;case keyCode.enter:c.onEnterKeyCode(a),b=!0;break;case keyCode.tab:c.onTabKeyCode(a),b=!0}return b},onUpKeyCode:function(a){this.dialogIsShow&&(a.preventDefault(),a.stopPropagation(),this.smemberListCompositeView.focusPrev(a))},onDownKeyCode:function(a){this.dialogIsShow&&(a.preventDefault(),a.stopPropagation(),this.smemberListCompositeView.focusNext(a))},onEnterKeyCode:function(a){this.model.get("hasSerchBtn")||this.dialogIsShow&&(a.preventDefault(),a.stopPropagation(),this.smemberListCompositeView.triggerClick())},onTabKeyCode:function(a){this.dialogIsShow&&(a.preventDefault(),a.stopPropagation(),this.smemberListCompositeView.focusFirst(a))},onOperate:function(a){this["on"+a.type+"Operate"]&&this["on"+a.type+"Operate"](a.view)},onAddOperate:function(a){var b=a.model.toJSON();if("single"==this.model.get("viewType"))return talent.$(this.activeNode).trigger("submit",b),this.trigger("submit",b),void this.deleteView();this.addCollection||(this.addCollection=new talent.Collection([]));var c=this.addCollection.toJSON(),d=talent._.where(c,{type:"all"})[0];if(d||(d={name:"全部",type:"all",Data:[],count:0,orginCount:0},c.push(d)),b.type&&"all"!=b.type){if(talent._.where(c,b)[0])return;d.orginCount=d.orginCount+1,c.push(b)}else{var e;"all"==b.type?e=b.Data:(b.Data=null,e=b);var f=this.joinArr(d.Data,e);d.Data=f,d.count=f.length}this.addCollection.reset(c)},onDeleteOperate:function(a){var a=a,b=a.model.toJSON(),c=this.addCollection.where({type:"all"})[0];if(b.type)if("all"!=b.type){c.set("orginCount",c.get("orginCount")-1);var d=this.addCollection.where(b)[0];this.addCollection.remove(d)}else this.addCollection.reset([]);else{var e=this.addCollection.where(a.parentView.model.toJSON())[0],f=a.parentView.model.toJSON(),g=a.parentView.collection,d=g.where(b)[0];g.remove(d),f.count-1!=0?e.set({Data:g.toJSON(),count:f.count-1}):(c.set("orginCount",c.get("orginCount")-1),this.addCollection.remove(e))}0==c.get("orginCount")&&0==c.get("count")&&this.addCollection.reset([])},onOpenOperate:function(a){var b=a.model.toJSON(),c=b.type;this[c+"Operate"]&&this[c+"Operate"](a)},talentPoolOperate:function(a){var a=a,b=a.model.toJSON(),c=this;this.getDataCollection.getTalentPoolDetail({id:b.Id}).done(function(b){a.collection||(a.collection=new talent.Collection([]));var b=c.dealData(b);a.collection.reset(b)})},departmentOperate:function(a){var a=a,b=a.model.toJSON(),c=this;this.getDataCollection.getDepartmentDetail({id:b.Id}).done(function(b){a.collection||(a.collection=new talent.Collection([]));var b=c.dealData(b);a.collection.reset(b)})},atCatchQuery:function(){var a,b,c,d,e,f=this.atTarget;b=talent.$.trim(talent.$(f).val()),a=talent.$(f).caret("pos"),e=b.slice(0,a);var g=f.attr("data-smemberid"),h=talent._.where(this.atNodes,{nodeId:g})[0]||{},i=h.options;if("string"==typeof(c=this.atCatchMatch(i.triggerChar||i.triggerChar,e,!1))){d+c.length,this.pos=a-c.length,c=c.replace(/\'/g,""),this.query={text:c,head_pos:a-c.length,end_pos:a};var j=this.atGetOffset();i&&(i.searchCondition={name:this.query.text},""==c?this.model.set({searchCondition:{name:this.query.text},listType:"Contact"}):this.model.set({searchCondition:{name:this.query.text},listType:"Search"}),this.showDialog(i,f,j))}else this.deleteView();return this.query},atInsert:function(a,b){var c,a=""+a,d=talent.$(this.atTarget).val();c=b?Math.max(this.query.head_pos-this.options.triggerChar.length,0):Math.max(this.query.head_pos,0);var e=d.slice(0,c);if(b)var f=""+e+a+" "+d.slice(this.query.end_pos||0);else var f=""+e+a+d.slice(this.query.end_pos||0);talent.$(this.atTarget).val(f);var g=e.length+a.length;b&&(g+=1),talent.$(this.atTarget).caret("pos",g),talent.$(this.atTarget).focus()},atCatchMatch:function(a,b,c){var d,e;return a=a.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&"),c&&(a="(?:^|\\s)"+a),e=new RegExp(a+"([A-Za-z0-9_'+-.]*)$|"+a+"([^\\x00-\\xff]*)$","gi"),d=e.exec(b),d?d[2]||d[1]:null},atGetOffset:function(){var a,b;if(a=talent.$(this.atTarget).caret("offset",this.pos-1)){b=document.selection?0:2;var c=a.top+a.height+b,d=talent.$(this.atTarget)[0].scrollTop;return d>0&&(c=c-d+a.height),{left:a.left,top:c}}},getNodeOffset:function(a){var b=talent.$(a).offset(),c=b.top+talent.$(a).height();return{left:b.left,top:c}},onSearchConditionChange:function(){this.trigger("changeSearchCondition",this.model.get("searchCondition")),this.renderListByType()},getTabView:function(){return this.smemberTabItemView},getMainRegion:function(){return this.main},setContentHeight:function(a){var b=this.$el.find(".smember_search_content").outerHeight(),c=this.$el.find(".smember_tab").outerHeight(),d=this.$el.find(".smember_search_content_left_footer").outerHeight(),a=a||b-c-d;"single"==this.model.get("viewType")?a-=20:a-=25,this.$el.find(".smember_list_container").height(a)},deleteView:function(){this.oldW=null,this.oldH=null,this.smemberTabItemView&&this.smemberTabItemView.close(),this.smemberListCompositeView&&this.smemberListCompositeView.close(),this.smemberSetConditionItemView&&this.smemberSetConditionItemView.close(),this.dialogIsShow=!1,this.$el.remove()},onClose:function(){talent.app.vent.off("smember"+this.eventId),this.deleteView(),this.unBindAllInputEvents(),this.unBindAllNodeEvents()},joinArr:function(a,b){var c=[],d=talent._.clone(a)||[],e=talent._.clone(b)||[];d=d.concat(e);var f=talent._.pluck(d,"Id");return f=talent._.uniq(f),talent._.each(f,function(a){c.push(talent._.where(d,{Id:a})[0])}),c},dealData:function(a,b){var c;if(0==a.length)return a;var d=this.model.get("stringLen"),e=this;switch(_.map(a,function(a){return a.DepartmentName&&(a.subDepartmentName=e.getSubString(a.DepartmentName,d.DepartmentName,!0)),a.Name&&(a.subName=e.getSubString(a.Name,d.Name,!0)),a.Email&&(a.subEmail=e.getSubString(a.Email,d.Email,!0)),a}),b){case"Contact":case"Subordinate":c=[{name:"全部",count:a.length,Data:a,type:"all"}];break;case"Search":c="single"==this.model.get("viewType")?a:[{name:"全部",count:a.length,Data:a,type:"all"}];break;case"Department":default:c=a}return"single"==this.model.get("viewType")&&(c=a),c},getSubString:function(a,b,c){for(var d=0,e="",f=/[^\x00-\xff]/g,g="",h=a.replace(f,"**").length,i=0;i<h&&(g=a.charAt(i).toString(),null!=g.match(f)?d+=2:d++,!(d>b));i++)e+=g;return c&&h>b&&(e+="..."),e}});return SmemberComponetView}),define("views/assessment/back-item-view",["talent","templates/assessment","simplemodal","collections/user-selector-group-collection","UserSelector","$.tipsy"],function(a,b,c,d,e,f){return a.ItemView.extend({template:b["assessment/back-item"],ui:{saveBtn:".btn-sure",cancelBtn:".btn-cancel,.btn-close",objdesc:".item_content textarea",appraiserInput:".input-appraiser .person",moduleItem:".form_item_module",objTime:".datetime",checkbox1:".checkbox",radio:".radio"},events:function(){var a={};return a["click "+this.ui.saveBtn]="saveBtnFn",a["dblclick "+this.ui.saveBtn]="dbClikfun",a["click "+this.ui.cancelBtn]="closeBtnFn",a["click "+this.ui.checkbox1]="checkSelect",a["click "+this.ui.radio]="radioSelect",a["click "+this.ui.radio]="radioSelect",a["focus "+this.ui.objdesc]="focusDesc",a["blur "+this.ui.objdesc]="blurDesc",a["keyup "+this.ui.objdesc]="keyupDesc",a["click "+this.ui.appraiserInput]="deleteUser",a["mouseover "+this.ui.appraiserInput]="appraiserInputOver",a["mouseout "+this.ui.appraiserInput]="appraiserInputOut",a},appraiserInputOver:function(a){$(a.currentTarget).find("img").hide()},appraiserInputOut:function(a){$(a.currentTarget).find("img").show()},initialize:function(a){this.DialogView=new c({zIndex:1100}),this.defaultSetting={height:"100",width:"600",inHeight:"154",showHeader:!1,title:"",showFoot:!0,yesColor:"blue",noColor:"white",timeColse:null,showClose:!0},this.defaultSetting=_.extend(this.defaultSetting,this.options,a),this.commitData={targetIds:"",isGrade:!1,emails:"",displayType:0,emailContent:"",userList:[]},this.defaultEmailContext="请您帮"+this.options.userName+"的以下考核目标进行评价，你的评价不会纳入评分结果",this.model.set(this.defaultSetting),this.$el=this.DialogView.$el},render:function(){var b=this,c=this.model.toJSON();b.unbindUIElements&&b.unbindUIElements(),a.app.request("Assessment:getDetailList",{assessmentId:b.model.get("assessmentId"),UserId:b.model.get("UserId"),iscontaincollect:!1}).done(function(a){return c.moduleList=a.Data.Module,b.model.set("moduleList",a.Data.Module),b.bindUIElements&&b.bindUIElements(),b.DialogView.render(b.template(c)).appendTo($("body")),b.memberSmemberView=new e({collection:new d}),b.addNode(),b.$el})},onShow:function(){},radioSelect:function(a){var b=$(a.currentTarget);if(!b.hasClass("radio_uncheck"))return!1;b.siblings(".radio").addClass("radio_uncheck").removeClass("radio_checked"),b.addClass("radio_checked").removeClass("radio_uncheck")},checkSelect:function(a){var b=$(a.currentTarget),c=this.$el.find(".list_data");if(b.hasClass("checkbox_uncheck"))if(b.addClass("checkbox_checked").removeClass("checkbox_uncheck"),1==b.data("parent"))c.find("ul[data-id="+b.data("id")+"]").find(".checkbox_uncheck").addClass("checkbox_checked").removeClass("checkbox_uncheck");else{var d=b.parents(".list_item_back");d.find(".checkbox_checked").length==d.find(".checkbox").length&&$(".checkbox_uncheck[data-id="+d.data("id")+"]").addClass("checkbox_checked").removeClass("checkbox_uncheck")}else if(b.addClass("checkbox_uncheck").removeClass("checkbox_checked"),1==b.data("parent"))c.find("ul[data-id="+b.data("id")+"]").find(".checkbox_checked").addClass("checkbox_uncheck").removeClass("checkbox_checked");else{var d=b.parents(".list_item_back");d.find(".checkbox_checked").length==d.find(".checkbox").length-1&&$(".checkbox_checked[data-id="+d.data("id")+"]").addClass("checkbox_uncheck").removeClass("checkbox_checked")}},keyupDesc:function(a){var b=$(a.currentTarget),c=b.val();b.next(".str-len").text(c.length+"/200"),c.length>200?b.addClass("error"):b.removeClass("error")},focusDesc:function(a){var b=$(a.currentTarget);b.addClass("hasval"),b.val()==this.defaultEmailContext&&b.val("")},blurDesc:function(a){var b=$(a.currentTarget);""==$.trim(b.val())&&(b.removeClass("hasval"),b.val(this.defaultEmailContext))},saveBtnFn:function(){var a=this,b=this.DialogView.$el,c=b.find(".app-content").find(".checkbox_checked");if(0==c.length)return!1;c.each(function(b,c){a.commitData.targetIds=0==b?$(c).attr("data-id"):a.commitData.targetIds+","+$(c).attr("data-id")});var d=b.find(".isScore");if(this.commitData.isGrade=d.hasClass("checkbox_checked"),this.commitData.emails=_.pluck(this.commitData.userList,"Email").join(","),this.commitData.displayType=b.find(".radio_checked").data("value"),this.commitData.emailContent=b.find(".item_content textarea.hasavl").val(),this.commitData.userList=[],""==this.commitData.emails)return this.$el.find(".input-appraiser").addClass("error"),!1;this.trigger("dialogSave",this.commitData),this.$el.remove(),this.trigger("smalledialogClose")},dblSureFn:function(){return!1},closeBtnFn:function(){this.DialogView.$el.remove(),this.trigger("smalledialogClose")},onRender:function(){},addNode:function(){var a=this,b=this.DialogView.$el;this.memberSmemberView.addNode(b.find(".add-person"),{viewType:"single",input:!0}),b.find(".add-person").on("submit",function(b,c){var d=!1;if(_.each(a.commitData.userList,function(a,b){a.UserId==c.UserId&&(d=!0)}),d)return!1;var e="<span class='person' data-userid='"+c.UserId+"' original-title='删除:"+c.Email+"'>";e=e+"<img src='"+c.MidAvatar+"' height='26' width='26'/></span>",a.$el.find(".input-appraiser").append(e),a.$el.find(".person").tipsy({gravity:"s"}),a.commitData.userList.push(c)})},deleteUser:function(a){var b=this,c=$(a.currentTarget).data("userid");_.each(this.commitData.userList,function(a,d){a&&a.UserId==c&&b.commitData.userList.splice(d,1)}),$(a.currentTarget).tipsy("hide").remove()}})}),define("views/common/dialog/transmit-dialog-view",["talent","templates/common","simplemodal","collections/user-selector-group-collection","UserSelector"],function(a,b,c,d,e){return a.ItemView.extend({template:b["common/dialog/transmit-dialog"],events:{"click .btn-sure":"saveBtnFn","click .btn-cancel,.btn-close":"closeBtnFn","dblclick .btn-sure":"dblSureFn"},saveBtnFn:function(){var a=this.$el.find("input").val();""!=a&&(this.trigger("dialogClose",{result:1,email:a}),this.trigger("smalledialogClose"),this.$el.remove())},dblSureFn:function(){return!1},closeBtnFn:function(a){$(a.currentTarget).hasClass("btn-cancel")&&this.trigger("dialogClose",{result:0}),this.trigger("smalledialogClose"),this.$el.remove()},initialize:function(){this.DialogView=new c({zIndex:1100,position:[100,100]}),this.$el=this.DialogView.$el},render:function(){var a=this.model.toJSON();return this.DialogView.render(this.template(a)).appendTo($("body")),this.memberSmemberView=new e({collection:new d}),this.addNode(),this},onRender:function(){},addNode:function(){var a=this;this.memberSmemberView.addNode(this.$el.find(".other-user"),{viewType:"single",input:!0}),this.$el.find(".other-user").on("submit",function(b,c){a.$el.find(".other-user").val(c.Email)})}})}),define("views/common/dialog/dialog-index-view",["talent","templates/common","simplemodal"],function(a,b,c){return a.ItemView.extend({template:b["common/dialog/dialog-index"],events:{"click .btn-sure":"saveBtnFn","click .btn-cancel,.btn-close":"closeBtnFn","dblclick .btn-sure":"dblSureFn"},saveBtnFn:function(){this.trigger("dialogClose",{result:1}),this.trigger("smalledialogClose"),this.$el.remove(),this.close()},dblSureFn:function(){return!1},closeBtnFn:function(a){$(a.currentTarget).hasClass("btn-cancel")&&this.trigger("dialogClose",{result:0}),this.trigger("smalledialogClose"),this.$el.remove(),this.close()},initialize:function(){this.DialogView=new c({zIndex:1100,position:[100,100]}),this.defaultSetting={height:"100",width:"600",inHeight:"154",showHeader:!1,title:"",contentStr:"",contentTip:"",icon:"info",showFoot:!0,yesText:_.langs("common","submit"),noText:_.langs("common","cancel"),yesColor:"blue",noColor:"white",timeColse:null,showClose:!0},_.extend(this.defaultSetting,this.options),this.model.set(this.defaultSetting);var a=this;this.model.get("timeColse")&&setTimeout(function(){a.removePop(a.model.get("timeColse"))},0),this.$el=this.DialogView.$el},render:function(){var a=this.model.toJSON();return this.DialogView.render(this.template(a)).appendTo($("body")),this},onRender:function(){},removePop:function(a){var b=this.DialogView;b.$el.animate({fadeOut:"hide"},{duration:a,complete:function(){b.$el.remove(),b.trigger("smalledialogClose")}})}})}),define("views/assessment/helpers/authority",["talent"],function(){function a(a,b){return 2==a.CurrentStepTypeId?b>1:b>=1}function b(a){var b={showValue:!0,showName:!1,showDescription:!1};if(!a)return b;var c=a.DisplayFields;return _.indexOf(c,"Value")>-1?b.showValue=!0:b.showValue=!1,_.indexOf(c,"Name")>-1?b.showName=!0:b.showName=!1,_.indexOf(c,"Description")>-1?b.showDescription=!0:b.showDescription=!1,b}function c(a,b){return"quickScore"==a&&0!=b.FieldRight.RateScore||"weightChange"==a&&0!=b.FieldRight.Weight&&2!=b.WeightType}function d(){return"104232"!=m.Id&&"105725"!=m.Id&&"105797"!=m.Id}function e(a,b){_.each(a,function(a){a.UserId==l.UserId&&a.WorkflowStepId==b.CurrentStepId&&1==b.FieldRight.RateScore&&b.Assessment.HasTask?a.CanOperate=!0:a.CanOperate=!1})}function f(a,b){a.UserId==l.UserId&&a.WorkflowStepId==b.CurrentStepId&&1==b.FieldRight.RateScore&&b.Assessment.HasTask?a.CanOperate=!0:a.CanOperate=!1}function g(a){return a==n.appraise}function h(a){return a==n.multiple}function i(a){var b=!0;return l.UserId!==a.UserInfo.UserId&&100!==a.CurrentStepTypeId&&6!==a.CurrentStepTypeId&&!1!==a.Assessment.HasTask||(b=!1),b}function j(a){var b=!0;return l.UserId!==a.UserInfo.UserId&&100!==a.CurrentStepTypeId&&6!==a.CurrentStepTypeId&&!1!==a.Assessment.HasTask||(b=!1),b}function k(a){return 1==a.ModuleScoreAuthority||1==a.RelType&&1==a.ScoreVisible||4==a.ModuleType&&1==a.ScoreVisible}var l=Talent.Context.getUserInfo()||{},m=Talent.Context.getTenantInfo()||{},n={plan:1,appraise:2,signature:4,approval:5,multiple:6,hraudit:7};return{isTransmitOther:i,isInviteOther:j,isMultipleStep:h,isAppraiserStep:g,rateScoreCanOperate:e,hideRateScoreForTenants:d,disableEditGoalItem:c,customLevelSetting:b,rateScoreItemCanOperate:f,moduleScoreVisible:k,showAssessmentTodo:a}}),define("views/common/event-name",["talent"],function(){var a={ASSESSMENT_COPYTASK_OK:"ASSESSMENT_COPYTASK_OK",ASSESSMENT_COPYTASK_CANCEL:"ASSESSMENT_COPYTASK_CANCEL",ASSESSMENT_DELETEGOAL_OK:"ASSESSMENT_DELETEGOAL_OK",ASSESSMENT_REJECT_OK:"ASSESSMENT_REJECT_OK",ASSESSMENT_ANDGOAL_OK:"ASSESSMENT_ANDGOAL_OK",ASSESSMENT_EDITGOAL_OK:"ASSESSMENT_EDITGOAL_OK",ASSESSMENT_SELECTORGANIZATION_OK:"ASSESSMENT_SELECTORGANIZATION_OK",ASSESSMENT_COPYGOAL_OK:"ASSESSMENT_COPYGOAL_OK",ASSESSMENT_COPYGOAL_CANCEL:"ASSESSMENT_COPYGOAL_CANCEL",ASSESSMENT_TRANSMIT_OK:"ASSESSMENT_TRANSMIT_OK",ASSESSMENT_TRANSMIT_CANCEL:"ASSESSMENT_TRANSMIT_CANCEL",ASSESSMENT_THIRDRATE_OK:"ASSESSMENT_THIRDRATE_OK",ASSESSMENT_THIRDRATE_CANCEL:"ASSESSMENT_THIRDRATE_CANCEL",ASSESSMENT_CHECKWEIGHT_OK:"ASSESSMENT_CHECKWEIGHT_OK",ASSESSMENT_EDITSUBGOAL_OK:"ASSESSMENT_EDITSUBGOAL_OK",ASSESSMENT_ADDSUBGOAL_OK:"ASSESSMENT_ADDSUBGOAL_OK",ASSESSMENT_COPYGOALFROMOBJECT_OK:"ASSESSMENT_COPYGOALFROMOBJECT_OK",HOME_COMMIT_OK:"HOME_DELETEGOAL_OK"},b={};return function(c,d){void 0===typeof d&&(d="0");var e,f=a[c];if(void 0===typeof f)throw new Error("未找到所配置事件名称");return e="EPM.TITA.COM_"+f+"_"+d,b[c]=e,e}}),define("views/assessment/user-item-view",["talent","templates/assessment","views/assessment/back-item-view","views/common/dialog/transmit-dialog-view","views/common/dialog/dialog-index-view","views/assessment/helpers/authority","$.tipsy","views/common/event-name"],function(a,b,c,d,e,f,g,h){return a.ItemView.extend({template:b["assessment/user-item"],initialize:function(){var b=this,c=this.model.toJSON(),d=c.AppraiserInfo,e=f.isTransmitOther(c),g=f.isInviteOther(c),i=f.isMultipleStep(c.CurrentStepTypeId),j=f.isAppraiserStep(c.CurrentStepTypeId);$(document).on("click",function(){$(".tipsAppraiser").hide()}),this.model.set({CanToOther:e,CanAdd:g,appraiserList:d.AppraiserList,isMultipleStep:i,isAppraiserStep:j,i18n:_.langs("assessment")}),a.inItalent&&(window.iTalentSDK.register({listenEvent:h("ASSESSMENT_TRANSMIT_OK"),cb:_.bind(b.doTransmitAction,b)}),window.iTalentSDK.register({listenEvent:h("ASSESSMENT_THIRDRATE_OK",c.Assessment.Id),cb:_.bind(b.savePerson,b)}))},ui:{add_sendback:".js-sendback",toOther:".js-toOther",back_person:".back-person",list_image:".list-image",pdf_image:".pdf-image",toItalentHome:".current-name",pressAppraiser:".pressAppraiser",deleteAppraiser:".deleteAppraiser"},events:function(){var a={};return a["click "+this.ui.add_sendback]="showBackDialog",a["click "+this.ui.toOther]="showTransmitDialog",a["click "+this.ui.back_person]="showPress",a["click "+this.ui.deleteAppraiser]="deleteAppraiser",a["click "+this.ui.pdf_image]="exportPdf",a["click "+this.ui.toItalentHome]="toItalentHome",a["click "+this.ui.pressAppraiser]="pressAppraiser",a},pressAppraiser:function(b){var c=$(b.currentTarget),d=this;a.app.request("Appraiser:sendAppraiserPress",{appraiserId:c.data("id")}).done(function(a){if(1==a.Result){var b=_.langs("assessment"),c=(_.langs("common"),{contentStr:b.sendAppraiserPressSuccess,icon:"info",showClose:!1,height:64,width:240,inHeight:64,timeColse:2e3,showFoot:!1});d.completeDialog=new e(c),d.completeDialog.render()}})},showPress:function(a){a.stopPropagation(),$(".tipsAppraiser").hide(),$(a.currentTarget).next().show()},toItalentHome:function(a){var b=this.model.toJSON(),c=_.getItalentHomeUrl(b.UserInfo.UserId);window.open(c)},exportPdf:function(){this.exportPdfFunc({assessmentId:this.model.get("Assessment").Id,UserId:this.model.get("UserInfo").UserId,fromType:1})},exportPdfFunc:function(b){var c=$("<form>");c.attr("style","display:none"),c.attr("target",location.href),c.attr("method","post"),c.attr("action",a.Context.getEpmApiUrl("Assessment/GetAssessmentDetailsPdfFile",b.userId));var d=[];for(attr in b){var e=$("<input>");e.attr("type","hidden"),e.attr("name",attr),e.attr("value",b[attr]),d.push(e)}$("body").append(c),c.append(d),c.submit()},deleteAppraiser:function(b){$(".btnWeightChange").removeClass("warn_class");var c=$(b.currentTarget),d=this.model.toJSON(),f=this,g=_.langs("assessment"),h=_.langs("common"),i={contentStr:g.askingdeleteappriseuser,icon:"asking",showClose:!1,height:110,width:240,inHeight:64,yesText:h.submit,noText:h.cancel};this.confirmDialog=new e(i),this.listenTo(this.confirmDialog,"dialogClose",function(b){b.result&&a.app.request("Appraiser:deleteThirdAppraiser",{UserId:d.UserInfo.UserId,appraiserId:c.data("id"),staffRelationId:"00000000-0000-0000-0000-000000000000",assessmentId:d.Assessment.Id}).done(function(b){b.Result>0&&a.app.request("Appraiser:getFeedPhotos",{UserId:d.UserInfo.UserId,assessmentId:d.Assessment.Id}).done(function(a){f.model.set("appraiserList",a.FeedList[0].AppraiserList),f.render()})})}),this.confirmDialog.render()},doTransmitAction:function(b){var c=this,d=this.model.toJSON();b.result&&a.app.request("Activity:transmitTo",{UserId:d.UserInfo.UserId,email:b.email,assessmentId:d.Assessment.Id}).done(function(a){a.Result>0&&c.trigger("refreshPage")})},showTransmitDialog:function(){var b=this,c=this.model.toJSON();$(".btnWeightChange").removeClass("warn_class"),this.transmitDialog=new d,this.listenTo(this.transmitDialog,"dialogClose",function(d){d.result&&a.app.request("Activity:transmitTo",{UserId:c.UserInfo.UserId,email:d.email,assessmentId:c.Assessment.Id}).done(function(a){a.Result>0&&b.trigger("refreshPage")})}),this.transmitDialog.render()},showBackDialog:function(){$(".btnWeightChange").removeClass("warn_class");var b=this.model.toJSON(),d=_.langs("common"),e=_.langs("assessment","askingfeed"),f=_.map(b.ModuleList,function(a){return{Id:a.Id,Name:a.Name,ModuleType:a.ModuleType,RelType:a.RelType,FieldRight:a.FieldRight}}),g={height:"502",width:"600",inHeight:"410",showHeader:!0,title:e.titlePre+b.UserInfo.Name+e.titleSuf,showFoot:!0,yesText:d.submit,noText:d.cancel,yesColor:"blue",noColor:"white",timeColse:null,showClose:!0,assessmentId:b.Assessment.Id,moduleList:f,UserId:b.UserInfo.UserId,UserList:b.AppraiserInfo.AppraiserList,userName:b.UserInfo.Name,i18n:e,Id:b.Assessment.Id};if(a.inItalent){var h=_.getPopUrl("thirdRate","thirdRateDialog");window.iTalentSDK.showPopup(h,601,503,g)}else this.backItemView=new c(g),this.listenTo(this.backItemView,"dialogSave",this.savePerson),this.backItemView.render()},savePerson:function(b){var c=this.model.toJSON(),d=this;b.staffRelationId="00000000-0000-0000-0000-000000000000",b.assessmentId=c.Assessment.Id,b.userId=c.UserInfo.UserId,b.userList=void 0,a.app.request("Appraiser:addThirdAppraiser",b).done(function(b){b.Result>0&&a.app.request("Appraiser:getFeedPhotos",{UserId:c.UserInfo.UserId,assessmentId:c.Assessment.Id}).done(function(a){d.model.set("appraiserList",a.FeedList[0].AppraiserList),d.render()})})},onRender:function(){this.ui.pdf_image.tipsy({gravity:"s"}),this.ui.list_image.tipsy({gravity:"s"}),this.ui.pressAppraiser.tipsy({gravity:"s"}),this.ui.deleteAppraiser.tipsy({gravity:"s"}),$(".btnWeightChange").removeClass("warn_class")},onShow:function(){}})}),define("views/assessment/linkcaret-item-view",["talent","templates/assessment","simplemodal","collections/user-selector-group-collection","UserSelector","$.tipsy"],function(a,b){return a.ItemView.extend({template:b["assessment/linkcaret-item"],initialize:function(){this.model.set("i18n",_.langs("assessment"))}})}),define("views/common/modules/workflow-item-view",["talent","templates/common"],function(a,b){return a.ItemView.extend({template:b["common/modules/workflow-item"],initialize:function(a){this.model.set({i18n:_.langs("assessment","workflow")})}})}),define("views/assessment/assessment-operate-view",["talent","templates/assessment"],function(a,b){return a.ItemView.extend({template:b["assessment/assessment-operate-view"],initialize:function(a){var b=0,c=0,d=0,e=0,f=0,g=0,h=0,i=0;moduleList=a.ModuleList,2!=a.Status&&4!=a.Status?(6==a.CurrentStepTypeId?$(moduleList).each(function(a,c){b+=c.GoalList.length}):$(moduleList).each(function(a,j){4==j.ModuleType&&(i+=1),4!=j.ModuleType&&6!=j.ModuleType&&(b+=j.GoalList.length,0==j.ModuleType&&h++,1!=j.RelType&&5!=j.ModuleType&&2!=j.WeightType&&1==j.FieldRight.Weight&&c++,1!=j.FieldRight.Property||0!=j.ModuleType&&1!=j.ModuleType||1==j.RelType||d++,1==j.FieldRight.Property&&("0"==j.ModuleType||1==j.FieldRight.Delete&&"7"==j.ModuleType)&&e++,1==j.FieldRight.Property&&"0"==j.ModuleType&&f++,1==j.FieldRight.RateScore&&g++)}),this.model.set({showAddKPI:!!d,showBindObject:!!e,showBindObject2:!!f,showAllOpen:!0,showBatchWeight:!!c,CurrentStepTypeId:a.CurrentStepTypeId,Status:a.Status,HasTask:a.HasTask,HasGoal:a.HasGoal,QuickEstimate:a.QuickEstimate,ShowSumMoudule:!(i==moduleList.length),i18n:_.langs("assessment","operationToolbar"),BatchWeightChange:a.BatchWeightChange})):this.model.set({showAllOpen:!0,ShowSumMoudule:!1,Status:a.Status,i18n:_.langs("assessment","operationToolbar")}),window.cacheContainer&&window.cacheContainer.get("InIframe")?this.model.set("InIframe",!0):this.model.set("InIframe",!1)},ui:{btnNewAdd:".btnNewAdd",btnFeedBack:".btnFeedBack",close_communicate:".close_communicate",btnSelectFromObject:".btnSelectFromObject",btnBindObject:".btnBindObject",btnWeightChange:".btnWeightChange",btnScore:".btnScore",btnOpenAll:".btnOpenAll"},events:function(){var a={};return a["click "+this.ui.btnNewAdd]="addDetailItem",a["click "+this.ui.btnFeedBack]="btnFeedBack",a["click "+this.ui.close_communicate]="closeFeedBack",a["click "+this.ui.btnSelectFromObject]="copyFromObjectManagement",a["click "+this.ui.btnBindObject]="btnBindObject",a["click "+this.ui.btnWeightChange]="weightChange",a["click "+this.ui.btnOpenAll]="btnOpenAll",a["click "+this.ui.btn_commit]="commitAssessment",a["click "+this.ui.btn_reback]="backAssessment",a["click "+this.ui.btnScore]="ScoreQuick",a},addDetailItem:function(){this.trigger("newAdd")},btnBindObject:function(){this.trigger("bindObject")},copyFromObjectManagement:function(){this.trigger("copyFromObjectManagement")},weightChange:function(){this.trigger("weightChange")},btnOpenAll:function(a){$(a.currentTarget).hasClass("btn-disabled")||this.trigger("btnOpenAll",a)},ScoreQuick:function(){this.trigger("ScoreQuick")},btnFeedBack:function(){this.trigger("btnFeedBack")},onRender:function(){},onShow:function(){}})}),define("templates/home",[],function(){return this.JST=this.JST||{},this.JST["home/activity/index-page"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="activity-page-title">\n\t'+__e(ActivityManagerName||"")+'\n</div>\n<ul class="status-list">\n\t',_.each(StepTaskList,function(a,b){__p+='\n\t\t<li class="'+__e(a.StepTypeId===CurrentStepId?"active":"item")+' status-item-num"\n\t\t\t data-type="'+__e(a.StepTypeId)+'" >\n\t\t\t<span class="item-status"  status-id="'+__e(a.StepTypeId)+'">\n\t\t\t\t'+__e(2==a.StepTypeId?i18n.allStep[2]:i18n.allStep[a.StepTypeId])+'（<span class="item-count">'+__e(a.TaskCount)+'</span>）\n\t\t\t</span>\n\t\t\t<span class="caret"></span>\n\t\t</li>\n\t\t\t\n\t'}),__p+="\t\t\n</ul>\n",5==CurrentStepId&&null!=ApprovalAssessmentDataInfo&&(__p+='\n\t<div class="status-item-num" id="status-item-num">\n\t\t<span>'+__e(i18n.unApproved)+__e(ApprovalAssessmentDataInfo.UnsubmitNum)+"</span>\n\t\t<span>"+__e(i18n.approved)+__e(ApprovalAssessmentDataInfo.SubmitedNum)+"</span>\n\t</div>\n"),__p+="\n",2!==CurrentStepId&&5!==CurrentStepId&&6!==CurrentStepId||(__p+='\n<div class="forcedResult" id="forcedResult">\n</div>\n<div class="btn-list">\n\t',5===CurrentStepId?__p+='\n\t<span href="javascript:void(0)" data-confirm-msg="'+__e(5===CurrentStepId?i18n.sureApprovalCommit:i18n.sureRateCommit)+'"\n\t\t class="btn btn-blue btn-small btnAllSubmit">\n\t\t '+__e(5===CurrentStepId?i18n.allReslove:i18n.allCommit)+'\n\t</span>\n\t<span href="javascript:void(0)" data-confirm-msg="'+__e(5===CurrentStepId?i18n.sureApprovalCommit:i18n.sureRateCommit)+'"\n\tclass="btn btn-small btnSubmit btn-gray" >\n\t\t '+__e(5===CurrentStepId?i18n.reslove:i18n.commit)+"\n\t</span>\n\t":__p+='\n\n\t<span href="javascript:void(0)" data-confirm-msg="'+__e(5===CurrentStepId?i18n.sureApprovalCommit:i18n.sureRateCommit)+'"\n\tclass="btn btn-small btnSubmit btn-blue" >\n\t\t '+__e(i18n.commit)+"\n\t</span>\n",__p+="\n\t",6!==CurrentStepId&&(__p+='\n\t\t<span href="javascript:void(0)" class="btn btn-gray btn-small btnRestart">'+__e(_.langs("common","reject"))+"</span>\n\t"),__p+='\n\t\n\t<span href="javascript:void(0)" class="btn btn-gray btn-small sortByScorelevel" style="display:none">'+__e(_.langs("common","backAll"))+"</span>\n\t\n\t",6!==CurrentStepId&&(__p+='\n\t\t<span href="javascript:void(0)" class="btn btn-gray btn-small viewForcedResult">\n\t\t\t'+__e(i18n.watchDistribution)+"\n\t\t</span>\n\t"),__p+="\n\t\n\t\n\t",5===CurrentStepId&&(__p+='\n\t\t<span href="javascript:void(0)" class="btn btn-gray btn-small groupModify">\n\t\t '+__e(editableStatus?i18n.saveModify:i18n.groupModify)+'\n\t\t</span>\n\t \t<div class="search-input input-dafault fright" >\n\t \t\t<input type="text" placeholder="'+__e(i18n.components.searchDept)+'" class="search-text" />\n\t \t\t<span class="js-search deptDelete"></span>\n\t \t</div>\n\t \t<div class="organizationTree" style="clear:both;">\n\t \t\t\n\t \t</div>\n \t'),__p+="\n\n</div>\n"),__p+='\n<div class="region_table" style="margin-top:0"></div>\n<div class="page-container pagination"></div>';return __p},this.JST["home/history/index-page"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="header-title">'+(null==(__t=_.langs("home","myDone"))?"":__t)+'</div>\n<div class="search-content">\n\t<div class="search-result" style="display:none;">'+__e(_.langs("home","searchResult"))+'<span class="result-count">0</span>'+__e(_.langs("common","assessmentUnit"))+'</div>\n\t<div class="search-input input-dafault">\n\t\t<input type="text" placeholder="'+__e(_.langs("team","searchPerson"))+'" class="search-text" value="'+__e(_.langs("team","searchPerson"))+'" />\n\t\t<span class="icon-search"></span>\n\t</div>\n</div>\n<div class="region_table">\n</div>\n<div class="page_container pagination">\n</div>';return __p},this.JST["home/home-activity-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="activity-title" title="'+__e(ActivityManagerName)+'">\n\t<a href="javascript:;" class=\'activity-list-item-name\'>\n\t\t'+__e(_.substring(ActivityManagerName,31,!0))+'（<span class="count">'+__e(TaskCount)+'</span>）\n\t</a>\n</div>\n<ul class="activity-content">\n\t',_.each(StepTaskList,function(a,b){b<=2&&(__p+="\n\t\t\t<li data-typeId='"+__e(a.StepTypeId)+'\' class="activity-list-item" item-index="'+__e(b)+'">\n\t\t\t\t<a href="javascript:;" class=\'step-item\' stepId="'+__e(a.StepTypeId)+'">'+__e(a.StepTypeName)+" （"+__e(a.TaskCount)+"）</a>\n\t\t\t</li>\n\t")}),__p+="\n\t",StepTaskList.length>3&&(__p+='\n\t<li class="end" >...</li>\n\t'),__p+="\n</ul>";return __p},this.JST["home/home-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="main-content">\n\t<div class="header-title">'+(null==(__t=_.langs("home","myTodo"))?"":__t)+'</div>\n\t<div class="activity-list">\n\t</div>\n</div>\n<div class="user-content">\n</div>';return __p},this.JST["home/index-page"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div id="epmside-region" style="position:fixed;overflow-y:scroll;"></div>\n<div class="with-table-content" style="margin-left:20%;min-height: 800px">\n</div>\n';return __p},this.JST}),function(a,b){function c(b,c){var e,f,g,h=b.nodeName.toLowerCase();return"area"===h?(e=b.parentNode,f=e.name,!(!b.href||!f||"map"!==e.nodeName.toLowerCase())&&(!!(g=a("img[usemap=#"+f+"]")[0])&&d(g))):(/input|select|textarea|button|object/.test(h)?!b.disabled:"a"===h?b.href||c:c)&&d(b)}function d(b){return a.expr.filters.visible(b)&&!a(b).parents().addBack().filter(function(){return"hidden"===a.css(this,"visibility")}).length}var e=0,f=/^ui-id-\d+$/;a.ui=a.ui||{},a.extend(a.ui,{version:"1.10.4",keyCode:{BACKSPACE:8,COMMA:188,DELETE:46,DOWN:40,END:35,ENTER:13,ESCAPE:27,HOME:36,LEFT:37,NUMPAD_ADD:107,NUMPAD_DECIMAL:110,NUMPAD_DIVIDE:111,NUMPAD_ENTER:108,NUMPAD_MULTIPLY:106,NUMPAD_SUBTRACT:109,PAGE_DOWN:34,PAGE_UP:33,PERIOD:190,RIGHT:39,SPACE:32,TAB:9,UP:38}}),a.fn.extend({focus:function(b){return function(c,d){return"number"==typeof c?this.each(function(){var b=this;setTimeout(function(){a(b).focus(),d&&d.call(b)},c)}):b.apply(this,arguments)}}(a.fn.focus),scrollParent:function(){var b;return b=a.ui.ie&&/(static|relative)/.test(this.css("position"))||/absolute/.test(this.css("position"))?this.parents().filter(function(){return/(relative|absolute|fixed)/.test(a.css(this,"position"))&&/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0):this.parents().filter(function(){return/(auto|scroll)/.test(a.css(this,"overflow")+a.css(this,"overflow-y")+a.css(this,"overflow-x"))}).eq(0),/fixed/.test(this.css("position"))||!b.length?a(document):b},zIndex:function(c){if(c!==b)return this.css("zIndex",c);if(this.length)for(var d,e,f=a(this[0]);f.length&&f[0]!==document;){if(("absolute"===(d=f.css("position"))||"relative"===d||"fixed"===d)&&(e=parseInt(f.css("zIndex"),10),!isNaN(e)&&0!==e))return e;f=f.parent()}return 0},uniqueId:function(){return this.each(function(){this.id||(this.id="ui-id-"+ ++e)})},removeUniqueId:function(){return this.each(function(){f.test(this.id)&&a(this).removeAttr("id")})}}),a.extend(a.expr[":"],{data:a.expr.createPseudo?a.expr.createPseudo(function(b){return function(c){return!!a.data(c,b)}}):function(b,c,d){return!!a.data(b,d[3])},focusable:function(b){return c(b,!isNaN(a.attr(b,"tabindex")))},tabbable:function(b){var d=a.attr(b,"tabindex"),e=isNaN(d);return(e||d>=0)&&c(b,!e)}}),a("<a>").outerWidth(1).jquery||a.each(["Width","Height"],function(c,d){function e(b,c,d,e){return a.each(f,function(){c-=parseFloat(a.css(b,"padding"+this))||0,d&&(c-=parseFloat(a.css(b,"border"+this+"Width"))||0),e&&(c-=parseFloat(a.css(b,"margin"+this))||0)}),c}var f="Width"===d?["Left","Right"]:["Top","Bottom"],g=d.toLowerCase(),h={innerWidth:a.fn.innerWidth,innerHeight:a.fn.innerHeight,outerWidth:a.fn.outerWidth,outerHeight:a.fn.outerHeight};a.fn["inner"+d]=function(c){return c===b?h["inner"+d].call(this):this.each(function(){a(this).css(g,e(this,c)+"px")})},a.fn["outer"+d]=function(b,c){return"number"!=typeof b?h["outer"+d].call(this,b):this.each(function(){a(this).css(g,e(this,b,!0,c)+"px")})}}),a.fn.addBack||(a.fn.addBack=function(a){return this.add(null==a?this.prevObject:this.prevObject.filter(a))}),a("<a>").data("a-b","a").removeData("a-b").data("a-b")&&(a.fn.removeData=function(b){return function(c){return arguments.length?b.call(this,a.camelCase(c)):b.call(this)}}(a.fn.removeData)),a.ui.ie=!!/msie [\w.]+/.exec(navigator.userAgent.toLowerCase()),a.support.selectstart="onselectstart"in document.createElement("div"),a.fn.extend({disableSelection:function(){return this.bind((a.support.selectstart?"selectstart":"mousedown")+".ui-disableSelection",function(a){a.preventDefault()})},enableSelection:function(){return this.unbind(".ui-disableSelection")}}),a.extend(a.ui,{plugin:{add:function(b,c,d){var e,f=a.ui[b].prototype;for(e in d)f.plugins[e]=f.plugins[e]||[],f.plugins[e].push([c,d[e]])},call:function(a,b,c){var d,e=a.plugins[b];if(e&&a.element[0].parentNode&&11!==a.element[0].parentNode.nodeType)for(d=0;d<e.length;d++)a.options[e[d][0]]&&e[d][1].apply(a.element,c)}},hasScroll:function(b,c){if("hidden"===a(b).css("overflow"))return!1;var d=c&&"left"===c?"scrollLeft":"scrollTop",e=!1;return b[d]>0||(b[d]=1,e=b[d]>0,b[d]=0,e)}})}(jQuery),function(a,b){var c=0,d=Array.prototype.slice,e=a.cleanData;a.cleanData=function(b){for(var c,d=0;null!=(c=b[d]);d++)try{a(c).triggerHandler("remove")}catch(a){}e(b)},a.widget=function(b,c,d){var e,f,g,h,i={},j=b.split(".")[0];b=b.split(".")[1],e=j+"-"+b,d||(d=c,c=a.Widget),a.expr[":"][e.toLowerCase()]=function(b){return!!a.data(b,e)},a[j]=a[j]||{},f=a[j][b],g=a[j][b]=function(a,b){if(!this._createWidget)return new g(a,b);arguments.length&&this._createWidget(a,b)},a.extend(g,f,{version:d.version,_proto:a.extend({},d),_childConstructors:[]}),h=new c,h.options=a.widget.extend({},h.options),a.each(d,function(b,d){if(!a.isFunction(d))return void(i[b]=d);i[b]=function(){var a=function(){return c.prototype[b].apply(this,arguments)},e=function(a){return c.prototype[b].apply(this,a)};return function(){var b,c=this._super,f=this._superApply;return this._super=a,this._superApply=e,b=d.apply(this,arguments),this._super=c,this._superApply=f,b}}()}),g.prototype=a.widget.extend(h,{widgetEventPrefix:f?h.widgetEventPrefix||b:b},i,{constructor:g,namespace:j,widgetName:b,widgetFullName:e}),f?(a.each(f._childConstructors,function(b,c){var d=c.prototype;a.widget(d.namespace+"."+d.widgetName,g,c._proto)}),delete f._childConstructors):c._childConstructors.push(g),a.widget.bridge(b,g)},a.widget.extend=function(c){for(var e,f,g=d.call(arguments,1),h=0,i=g.length;h<i;h++)for(e in g[h])f=g[h][e],g[h].hasOwnProperty(e)&&f!==b&&(a.isPlainObject(f)?c[e]=a.isPlainObject(c[e])?a.widget.extend({},c[e],f):a.widget.extend({},f):c[e]=f);return c},a.widget.bridge=function(c,e){var f=e.prototype.widgetFullName||c;a.fn[c]=function(g){var h="string"==typeof g,i=d.call(arguments,1),j=this;return g=!h&&i.length?a.widget.extend.apply(null,[g].concat(i)):g,h?this.each(function(){var d,e=a.data(this,f);return e?a.isFunction(e[g])&&"_"!==g.charAt(0)?(d=e[g].apply(e,i),d!==e&&d!==b?(j=d&&d.jquery?j.pushStack(d.get()):d,!1):void 0):a.error("no such method '"+g+"' for "+c+" widget instance"):a.error("cannot call methods on "+c+" prior to initialization; attempted to call method '"+g+"'")}):this.each(function(){var b=a.data(this,f);b?b.option(g||{})._init():a.data(this,f,new e(g,this))}),j}},a.Widget=function(){},a.Widget._childConstructors=[],a.Widget.prototype={widgetName:"widget",widgetEventPrefix:"",defaultElement:"<div>",options:{disabled:!1,create:null},_createWidget:function(b,d){d=a(d||this.defaultElement||this)[0],this.element=a(d),this.uuid=c++,this.eventNamespace="."+this.widgetName+this.uuid,this.options=a.widget.extend({},this.options,this._getCreateOptions(),b),this.bindings=a(),this.hoverable=a(),this.focusable=a(),d!==this&&(a.data(d,this.widgetFullName,this),this._on(!0,this.element,{remove:function(a){a.target===d&&this.destroy()}}),this.document=a(d.style?d.ownerDocument:d.document||d),this.window=a(this.document[0].defaultView||this.document[0].parentWindow)),this._create(),this._trigger("create",null,this._getCreateEventData()),this._init()},_getCreateOptions:a.noop,_getCreateEventData:a.noop,_create:a.noop,_init:a.noop,destroy:function(){this._destroy(),this.element.unbind(this.eventNamespace).removeData(this.widgetName).removeData(this.widgetFullName).removeData(a.camelCase(this.widgetFullName)),this.widget().unbind(this.eventNamespace).removeAttr("aria-disabled").removeClass(this.widgetFullName+"-disabled ui-state-disabled"),this.bindings.unbind(this.eventNamespace),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")},_destroy:a.noop,widget:function(){return this.element},option:function(c,d){var e,f,g,h=c;if(0===arguments.length)return a.widget.extend({},this.options);if("string"==typeof c)if(h={},e=c.split("."),c=e.shift(),e.length){for(f=h[c]=a.widget.extend({},this.options[c]),g=0;g<e.length-1;g++)f[e[g]]=f[e[g]]||{},f=f[e[g]];if(c=e.pop(),1===arguments.length)return f[c]===b?null:f[c];f[c]=d}else{if(1===arguments.length)return this.options[c]===b?null:this.options[c];h[c]=d}return this._setOptions(h),this},_setOptions:function(a){var b;for(b in a)this._setOption(b,a[b]);return this},_setOption:function(a,b){return this.options[a]=b,"disabled"===a&&(this.widget().toggleClass(this.widgetFullName+"-disabled ui-state-disabled",!!b).attr("aria-disabled",b),this.hoverable.removeClass("ui-state-hover"),this.focusable.removeClass("ui-state-focus")),this},enable:function(){return this._setOption("disabled",!1)},disable:function(){return this._setOption("disabled",!0)},_on:function(b,c,d){var e,f=this;"boolean"!=typeof b&&(d=c,c=b,b=!1),d?(c=e=a(c),this.bindings=this.bindings.add(c)):(d=c,c=this.element,e=this.widget()),a.each(d,function(d,g){function h(){if(b||!0!==f.options.disabled&&!a(this).hasClass("ui-state-disabled"))return("string"==typeof g?f[g]:g).apply(f,arguments)}"string"!=typeof g&&(h.guid=g.guid=g.guid||h.guid||a.guid++);var i=d.match(/^(\w+)\s*(.*)$/),j=i[1]+f.eventNamespace,k=i[2];k?e.delegate(k,j,h):c.bind(j,h)})},_off:function(a,b){b=(b||"").split(" ").join(this.eventNamespace+" ")+this.eventNamespace,a.unbind(b).undelegate(b)},_delay:function(a,b){function c(){return("string"==typeof a?d[a]:a).apply(d,arguments)}var d=this;return setTimeout(c,b||0)},_hoverable:function(b){this.hoverable=this.hoverable.add(b),this._on(b,{mouseenter:function(b){a(b.currentTarget).addClass("ui-state-hover")},mouseleave:function(b){a(b.currentTarget).removeClass("ui-state-hover")}})},_focusable:function(b){this.focusable=this.focusable.add(b),this._on(b,{focusin:function(b){a(b.currentTarget).addClass("ui-state-focus")},focusout:function(b){a(b.currentTarget).removeClass("ui-state-focus")}})},_trigger:function(b,c,d){var e,f,g=this.options[b];if(d=d||{},c=a.Event(c),c.type=(b===this.widgetEventPrefix?b:this.widgetEventPrefix+b).toLowerCase(),c.target=this.element[0],f=c.originalEvent)for(e in f)e in c||(c[e]=f[e]);return this.element.trigger(c,d),!(a.isFunction(g)&&!1===g.apply(this.element[0],[c].concat(d))||c.isDefaultPrevented())}},a.each({show:"fadeIn",hide:"fadeOut"},function(b,c){a.Widget.prototype["_"+b]=function(d,e,f){"string"==typeof e&&(e={effect:e});var g,h=e?!0===e||"number"==typeof e?c:e.effect||c:b;e=e||{},"number"==typeof e&&(e={duration:e}),g=!a.isEmptyObject(e),e.complete=f,e.delay&&d.delay(e.delay),g&&a.effects&&a.effects.effect[h]?d[b](e):h!==b&&d[h]?d[h](e.duration,e.easing,f):d.queue(function(c){a(this)[b](),f&&f.call(d[0]),c()})}})}(jQuery),function(a,b){var c=!1;a(document).mouseup(function(){c=!1}),a.widget("ui.mouse",{version:"1.10.4",options:{cancel:"input,textarea,button,select,option",distance:1,delay:0},_mouseInit:function(){var b=this;this.element.bind("mousedown."+this.widgetName,function(a){return b._mouseDown(a)}).bind("click."+this.widgetName,function(c){if(!0===a.data(c.target,b.widgetName+".preventClickEvent"))return a.removeData(c.target,b.widgetName+".preventClickEvent"),c.stopImmediatePropagation(),!1}),this.started=!1},_mouseDestroy:function(){this.element.unbind("."+this.widgetName),this._mouseMoveDelegate&&a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate)},_mouseDown:function(b){if(!c){this._mouseStarted&&this._mouseUp(b),this._mouseDownEvent=b;var d=this,e=1===b.which,f=!("string"!=typeof this.options.cancel||!b.target.nodeName)&&a(b.target).closest(this.options.cancel).length;return!(e&&!f&&this._mouseCapture(b))||(this.mouseDelayMet=!this.options.delay,this.mouseDelayMet||(this._mouseDelayTimer=setTimeout(function(){d.mouseDelayMet=!0},this.options.delay)),this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(b),!this._mouseStarted)?(b.preventDefault(),!0):(!0===a.data(b.target,this.widgetName+".preventClickEvent")&&a.removeData(b.target,this.widgetName+".preventClickEvent"),this._mouseMoveDelegate=function(a){return d._mouseMove(a)},this._mouseUpDelegate=function(a){return d._mouseUp(a)},a(document).bind("mousemove."+this.widgetName,this._mouseMoveDelegate).bind("mouseup."+this.widgetName,this._mouseUpDelegate),b.preventDefault(),c=!0,!0))}},_mouseMove:function(b){return a.ui.ie&&(!document.documentMode||document.documentMode<9)&&!b.button?this._mouseUp(b):this._mouseStarted?(this._mouseDrag(b),b.preventDefault()):(this._mouseDistanceMet(b)&&this._mouseDelayMet(b)&&(this._mouseStarted=!1!==this._mouseStart(this._mouseDownEvent,b),this._mouseStarted?this._mouseDrag(b):this._mouseUp(b)),!this._mouseStarted)},_mouseUp:function(b){return a(document).unbind("mousemove."+this.widgetName,this._mouseMoveDelegate).unbind("mouseup."+this.widgetName,this._mouseUpDelegate),this._mouseStarted&&(this._mouseStarted=!1,b.target===this._mouseDownEvent.target&&a.data(b.target,this.widgetName+".preventClickEvent",!0),this._mouseStop(b)),!1},_mouseDistanceMet:function(a){return Math.max(Math.abs(this._mouseDownEvent.pageX-a.pageX),Math.abs(this._mouseDownEvent.pageY-a.pageY))>=this.options.distance},_mouseDelayMet:function(){return this.mouseDelayMet},_mouseStart:function(){},_mouseDrag:function(){},_mouseStop:function(){},_mouseCapture:function(){return!0}})}(jQuery),function(a,b){function c(a,b,c){return[parseFloat(a[0])*(n.test(a[0])?b/100:1),parseFloat(a[1])*(n.test(a[1])?c/100:1)]}function d(b,c){return parseInt(a.css(b,c),10)||0}function e(b){var c=b[0];return 9===c.nodeType?{width:b.width(),height:b.height(),offset:{top:0,left:0}}:a.isWindow(c)?{width:b.width(),height:b.height(),offset:{top:b.scrollTop(),left:b.scrollLeft()}}:c.preventDefault?{width:0,height:0,offset:{top:c.pageY,left:c.pageX}}:{width:b.outerWidth(),height:b.outerHeight(),offset:b.offset()}}a.ui=a.ui||{};var f,g=Math.max,h=Math.abs,i=Math.round,j=/left|center|right/,k=/top|center|bottom/,l=/[\+\-]\d+(\.[\d]+)?%?/,m=/^\w+/,n=/%$/,o=a.fn.position;a.position={scrollbarWidth:function(){if(f!==b)return f;var c,d,e=a("<div style='display:block;position:absolute;width:50px;height:50px;overflow:hidden;'><div style='height:100px;width:auto;'></div></div>"),g=e.children()[0];return a("body").append(e),c=g.offsetWidth,e.css("overflow","scroll"),d=g.offsetWidth,c===d&&(d=e[0].clientWidth),e.remove(),f=c-d},getScrollInfo:function(b){var c=b.isWindow||b.isDocument?"":b.element.css("overflow-x"),d=b.isWindow||b.isDocument?"":b.element.css("overflow-y"),e="scroll"===c||"auto"===c&&b.width<b.element[0].scrollWidth;return{width:"scroll"===d||"auto"===d&&b.height<b.element[0].scrollHeight?a.position.scrollbarWidth():0,height:e?a.position.scrollbarWidth():0}},getWithinInfo:function(b){var c=a(b||window),d=a.isWindow(c[0]);return{element:c,isWindow:d,isDocument:!!c[0]&&9===c[0].nodeType,offset:c.offset()||{left:0,top:0},scrollLeft:c.scrollLeft(),scrollTop:c.scrollTop(),width:d?c.width():c.outerWidth(),height:d?c.height():c.outerHeight()}}},a.fn.position=function(b){if(!b||!b.of)return o.apply(this,arguments);b=a.extend({},b);var f,n,p,q,r,s,t=a(b.of),u=a.position.getWithinInfo(b.within),v=a.position.getScrollInfo(u),w=(b.collision||"flip").split(" "),x={};return s=e(t),t[0].preventDefault&&(b.at="left top"),n=s.width,p=s.height,q=s.offset,r=a.extend({},q),a.each(["my","at"],function(){var a,c,d=(b[this]||"").split(" ");1===d.length&&(d=j.test(d[0])?d.concat(["center"]):k.test(d[0])?["center"].concat(d):["center","center"]),d[0]=j.test(d[0])?d[0]:"center",d[1]=k.test(d[1])?d[1]:"center",a=l.exec(d[0]),c=l.exec(d[1]),x[this]=[a?a[0]:0,c?c[0]:0],b[this]=[m.exec(d[0])[0],m.exec(d[1])[0]]}),1===w.length&&(w[1]=w[0]),"right"===b.at[0]?r.left+=n:"center"===b.at[0]&&(r.left+=n/2),"bottom"===b.at[1]?r.top+=p:"center"===b.at[1]&&(r.top+=p/2),f=c(x.at,n,p),r.left+=f[0],r.top+=f[1],this.each(function(){var e,j,k=a(this),l=k.outerWidth(),m=k.outerHeight(),o=d(this,"marginLeft"),s=d(this,"marginTop"),y=l+o+d(this,"marginRight")+v.width,z=m+s+d(this,"marginBottom")+v.height,A=a.extend({},r),B=c(x.my,k.outerWidth(),k.outerHeight());"right"===b.my[0]?A.left-=l:"center"===b.my[0]&&(A.left-=l/2),"bottom"===b.my[1]?A.top-=m:"center"===b.my[1]&&(A.top-=m/2),A.left+=B[0],A.top+=B[1],a.support.offsetFractions||(A.left=i(A.left),A.top=i(A.top)),e={marginLeft:o,marginTop:s},a.each(["left","top"],function(c,d){a.ui.position[w[c]]&&a.ui.position[w[c]][d](A,{targetWidth:n,targetHeight:p,elemWidth:l,elemHeight:m,collisionPosition:e,collisionWidth:y,collisionHeight:z,offset:[f[0]+B[0],f[1]+B[1]],my:b.my,at:b.at,within:u,elem:k})}),b.using&&(j=function(a){var c=q.left-A.left,d=c+n-l,e=q.top-A.top,f=e+p-m,i={target:{element:t,left:q.left,top:q.top,width:n,height:p},element:{element:k,left:A.left,top:A.top,width:l,height:m},horizontal:d<0?"left":c>0?"right":"center",vertical:f<0?"top":e>0?"bottom":"middle"};n<l&&h(c+d)<n&&(i.horizontal="center"),p<m&&h(e+f)<p&&(i.vertical="middle"),g(h(c),h(d))>g(h(e),h(f))?i.important="horizontal":i.important="vertical",b.using.call(this,a,i)}),k.offset(a.extend(A,{using:j}))})},a.ui.position={fit:{left:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollLeft:d.offset.left,f=d.width,h=a.left-b.collisionPosition.marginLeft,i=e-h,j=h+b.collisionWidth-f-e;b.collisionWidth>f?i>0&&j<=0?(c=a.left+i+b.collisionWidth-f-e,a.left+=i-c):a.left=j>0&&i<=0?e:i>j?e+f-b.collisionWidth:e:i>0?a.left+=i:j>0?a.left-=j:a.left=g(a.left-h,a.left)},top:function(a,b){var c,d=b.within,e=d.isWindow?d.scrollTop:d.offset.top,f=b.within.height,h=a.top-b.collisionPosition.marginTop,i=e-h,j=h+b.collisionHeight-f-e;b.collisionHeight>f?i>0&&j<=0?(c=a.top+i+b.collisionHeight-f-e,a.top+=i-c):a.top=j>0&&i<=0?e:i>j?e+f-b.collisionHeight:e:i>0?a.top+=i:j>0?a.top-=j:a.top=g(a.top-h,a.top)}},flip:{left:function(a,b){var c,d,e=b.within,f=e.offset.left+e.scrollLeft,g=e.width,i=e.isWindow?e.scrollLeft:e.offset.left,j=a.left-b.collisionPosition.marginLeft,k=j-i,l=j+b.collisionWidth-g-i,m="left"===b.my[0]?-b.elemWidth:"right"===b.my[0]?b.elemWidth:0,n="left"===b.at[0]?b.targetWidth:"right"===b.at[0]?-b.targetWidth:0,o=-2*b.offset[0];k<0?((c=a.left+m+n+o+b.collisionWidth-g-f)<0||c<h(k))&&(a.left+=m+n+o):l>0&&((d=a.left-b.collisionPosition.marginLeft+m+n+o-i)>0||h(d)<l)&&(a.left+=m+n+o)},top:function(a,b){var c,d,e=b.within,f=e.offset.top+e.scrollTop,g=e.height,i=e.isWindow?e.scrollTop:e.offset.top,j=a.top-b.collisionPosition.marginTop,k=j-i,l=j+b.collisionHeight-g-i,m="top"===b.my[1],n=m?-b.elemHeight:"bottom"===b.my[1]?b.elemHeight:0,o="top"===b.at[1]?b.targetHeight:"bottom"===b.at[1]?-b.targetHeight:0,p=-2*b.offset[1];k<0?(d=a.top+n+o+p+b.collisionHeight-g-f,a.top+n+o+p>k&&(d<0||d<h(k))&&(a.top+=n+o+p)):l>0&&(c=a.top-b.collisionPosition.marginTop+n+o+p-i,a.top+n+o+p>l&&(c>0||h(c)<l)&&(a.top+=n+o+p))}},flipfit:{left:function(){a.ui.position.flip.left.apply(this,arguments),a.ui.position.fit.left.apply(this,arguments)},top:function(){a.ui.position.flip.top.apply(this,arguments),a.ui.position.fit.top.apply(this,arguments)}}},function(){var b,c,d,e,f,g=document.getElementsByTagName("body")[0],h=document.createElement("div");b=document.createElement(g?"div":"body"),d={visibility:"hidden",width:0,height:0,border:0,margin:0,background:"none"},g&&a.extend(d,{position:"absolute",left:"-1000px",top:"-1000px"});for(f in d)b.style[f]=d[f];b.appendChild(h),c=g||document.documentElement,c.insertBefore(b,c.firstChild),h.style.cssText="position: absolute; left: 10.7432222px;",e=a(h).offset().left,a.support.offsetFractions=e>10&&e<11,b.innerHTML="",c.removeChild(b)}()}(jQuery),function(a,b){function c(a,b,c){return a>b&&a<b+c}function d(a){return/left|right/.test(a.css("float"))||/inline|table-cell/.test(a.css("display"))}a.widget("ui.sortable",a.ui.mouse,{version:"1.10.4",widgetEventPrefix:"sort",ready:!1,options:{appendTo:"parent",axis:!1,connectWith:!1,containment:!1,cursor:"auto",cursorAt:!1,dropOnEmpty:!0,forcePlaceholderSize:!1,forceHelperSize:!1,grid:!1,handle:!1,helper:"original",items:"> *",opacity:!1,placeholder:!1,revert:!1,scroll:!0,scrollSensitivity:20,scrollSpeed:20,scope:"default",tolerance:"intersect",zIndex:1e3,activate:null,beforeStop:null,change:null,deactivate:null,out:null,over:null,receive:null,remove:null,sort:null,start:null,stop:null,update:null},_create:function(){var a=this.options;this.containerCache={},this.element.addClass("ui-sortable"),this.refresh(),this.floating=!!this.items.length&&("x"===a.axis||d(this.items[0].item)),this.offset=this.element.offset(),this._mouseInit(),this.ready=!0},_destroy:function(){this.element.removeClass("ui-sortable ui-sortable-disabled"),this._mouseDestroy();for(var a=this.items.length-1;a>=0;a--)this.items[a].item.removeData(this.widgetName+"-item");return this},_setOption:function(b,c){"disabled"===b?(this.options[b]=c,this.widget().toggleClass("ui-sortable-disabled",!!c)):a.Widget.prototype._setOption.apply(this,arguments)},_mouseCapture:function(b,c){var d=null,e=!1,f=this;return!this.reverting&&(!this.options.disabled&&"static"!==this.options.type&&(this._refreshItems(b),a(b.target).parents().each(function(){if(a.data(this,f.widgetName+"-item")===f)return d=a(this),!1}),a.data(b.target,f.widgetName+"-item")===f&&(d=a(b.target)),!!d&&(!(this.options.handle&&!c&&(a(this.options.handle,d).find("*").addBack().each(function(){this===b.target&&(e=!0)}),!e))&&(this.currentItem=d,this._removeCurrentsFromItems(),!0))))},_mouseStart:function(b,c,d){var e,f,g=this.options;if(this.currentContainer=this,this.refreshPositions(),this.helper=this._createHelper(b),this._cacheHelperProportions(),this._cacheMargins(),this.scrollParent=this.helper.scrollParent(),this.offset=this.currentItem.offset(),this.offset={top:this.offset.top-this.margins.top,left:this.offset.left-this.margins.left},a.extend(this.offset,{click:{left:b.pageX-this.offset.left,top:b.pageY-this.offset.top},parent:this._getParentOffset(),relative:this._getRelativeOffset()}),this.helper.css("position","absolute"),this.cssPosition=this.helper.css("position"),this.originalPosition=this._generatePosition(b),this.originalPageX=b.pageX,this.originalPageY=b.pageY,g.cursorAt&&this._adjustOffsetFromHelper(g.cursorAt),this.domPosition={prev:this.currentItem.prev()[0],parent:this.currentItem.parent()[0]},this.helper[0]!==this.currentItem[0]&&this.currentItem.hide(),this._createPlaceholder(),g.containment&&this._setContainment(),g.cursor&&"auto"!==g.cursor&&(f=this.document.find("body"),this.storedCursor=f.css("cursor"),f.css("cursor",g.cursor),this.storedStylesheet=a("<style>*{ cursor: "+g.cursor+" !important; }</style>").appendTo(f)),g.opacity&&(this.helper.css("opacity")&&(this._storedOpacity=this.helper.css("opacity")),this.helper.css("opacity",g.opacity)),g.zIndex&&(this.helper.css("zIndex")&&(this._storedZIndex=this.helper.css("zIndex")),this.helper.css("zIndex",g.zIndex)),this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName&&(this.overflowOffset=this.scrollParent.offset()),this._trigger("start",b,this._uiHash()),this._preserveHelperProportions||this._cacheHelperProportions(),!d)for(e=this.containers.length-1;e>=0;e--)this.containers[e]._trigger("activate",b,this._uiHash(this));return a.ui.ddmanager&&(a.ui.ddmanager.current=this),a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b),this.dragging=!0,this.helper.addClass("ui-sortable-helper"),this._mouseDrag(b),!0},_mouseDrag:function(b){var c,d,e,f,g=this.options,h=!1;for(this.position=this._generatePosition(b),this.positionAbs=this._convertPositionTo("absolute"),this.lastPositionAbs||(this.lastPositionAbs=this.positionAbs),this.options.scroll&&(this.scrollParent[0]!==document&&"HTML"!==this.scrollParent[0].tagName?(this.overflowOffset.top+this.scrollParent[0].offsetHeight-b.pageY<g.scrollSensitivity?this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop+g.scrollSpeed:b.pageY-this.overflowOffset.top<g.scrollSensitivity&&(this.scrollParent[0].scrollTop=h=this.scrollParent[0].scrollTop-g.scrollSpeed),this.overflowOffset.left+this.scrollParent[0].offsetWidth-b.pageX<g.scrollSensitivity?this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft+g.scrollSpeed:b.pageX-this.overflowOffset.left<g.scrollSensitivity&&(this.scrollParent[0].scrollLeft=h=this.scrollParent[0].scrollLeft-g.scrollSpeed)):(b.pageY-a(document).scrollTop()<g.scrollSensitivity?h=a(document).scrollTop(a(document).scrollTop()-g.scrollSpeed):a(window).height()-(b.pageY-a(document).scrollTop())<g.scrollSensitivity&&(h=a(document).scrollTop(a(document).scrollTop()+g.scrollSpeed)),b.pageX-a(document).scrollLeft()<g.scrollSensitivity?h=a(document).scrollLeft(a(document).scrollLeft()-g.scrollSpeed):a(window).width()-(b.pageX-a(document).scrollLeft())<g.scrollSensitivity&&(h=a(document).scrollLeft(a(document).scrollLeft()+g.scrollSpeed))),!1!==h&&a.ui.ddmanager&&!g.dropBehaviour&&a.ui.ddmanager.prepareOffsets(this,b)),this.positionAbs=this._convertPositionTo("absolute"),this.options.axis&&"y"===this.options.axis||(this.helper[0].style.left=this.position.left+"px"),this.options.axis&&"x"===this.options.axis||(this.helper[0].style.top=this.position.top+"px"),c=this.items.length-1;c>=0;c--)if(d=this.items[c],e=d.item[0],(f=this._intersectsWithPointer(d))&&d.instance===this.currentContainer&&!(e===this.currentItem[0]||this.placeholder[1===f?"next":"prev"]()[0]===e||a.contains(this.placeholder[0],e)||"semi-dynamic"===this.options.type&&a.contains(this.element[0],e))){if(this.direction=1===f?"down":"up","pointer"!==this.options.tolerance&&!this._intersectsWithSides(d))break;this._rearrange(b,d),this._trigger("change",b,this._uiHash());break}return this._contactContainers(b),a.ui.ddmanager&&a.ui.ddmanager.drag(this,b),this._trigger("sort",b,this._uiHash()),this.lastPositionAbs=this.positionAbs,!1},_mouseStop:function(b,c){if(b){if(a.ui.ddmanager&&!this.options.dropBehaviour&&a.ui.ddmanager.drop(this,b),this.options.revert){var d=this,e=this.placeholder.offset(),f=this.options.axis,g={};f&&"x"!==f||(g.left=e.left-this.offset.parent.left-this.margins.left+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollLeft)),f&&"y"!==f||(g.top=e.top-this.offset.parent.top-this.margins.top+(this.offsetParent[0]===document.body?0:this.offsetParent[0].scrollTop)),this.reverting=!0,a(this.helper).animate(g,parseInt(this.options.revert,10)||500,function(){d._clear(b)})}else this._clear(b,c);return!1}},cancel:function(){if(this.dragging){this._mouseUp({target:null}),"original"===this.options.helper?this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper"):this.currentItem.show();for(var b=this.containers.length-1;b>=0;b--)this.containers[b]._trigger("deactivate",null,this._uiHash(this)),this.containers[b].containerCache.over&&(this.containers[b]._trigger("out",null,this._uiHash(this)),this.containers[b].containerCache.over=0)}return this.placeholder&&(this.placeholder[0].parentNode&&this.placeholder[0].parentNode.removeChild(this.placeholder[0]),"original"!==this.options.helper&&this.helper&&this.helper[0].parentNode&&this.helper.remove(),a.extend(this,{helper:null,dragging:!1,reverting:!1,_noFinalSort:null}),this.domPosition.prev?a(this.domPosition.prev).after(this.currentItem):a(this.domPosition.parent).prepend(this.currentItem)),this},serialize:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},a(c).each(function(){var c=(a(b.item||this).attr(b.attribute||"id")||"").match(b.expression||/(.+)[\-=_](.+)/);c&&d.push((b.key||c[1]+"[]")+"="+(b.key&&b.expression?c[1]:c[2]))}),!d.length&&b.key&&d.push(b.key+"="),d.join("&")},toArray:function(b){var c=this._getItemsAsjQuery(b&&b.connected),d=[];return b=b||{},c.each(function(){d.push(a(b.item||this).attr(b.attribute||"id")||"")}),d},_intersectsWith:function(a){var b=this.positionAbs.left,c=b+this.helperProportions.width,d=this.positionAbs.top,e=d+this.helperProportions.height,f=a.left,g=f+a.width,h=a.top,i=h+a.height,j=this.offset.click.top,k=this.offset.click.left,l="x"===this.options.axis||d+j>h&&d+j<i,m="y"===this.options.axis||b+k>f&&b+k<g,n=l&&m;return"pointer"===this.options.tolerance||this.options.forcePointerForContainers||"pointer"!==this.options.tolerance&&this.helperProportions[this.floating?"width":"height"]>a[this.floating?"width":"height"]?n:f<b+this.helperProportions.width/2&&c-this.helperProportions.width/2<g&&h<d+this.helperProportions.height/2&&e-this.helperProportions.height/2<i},_intersectsWithPointer:function(a){var b="x"===this.options.axis||c(this.positionAbs.top+this.offset.click.top,a.top,a.height),d="y"===this.options.axis||c(this.positionAbs.left+this.offset.click.left,a.left,a.width),e=b&&d,f=this._getDragVerticalDirection(),g=this._getDragHorizontalDirection();return!!e&&(this.floating?g&&"right"===g||"down"===f?2:1:f&&("down"===f?2:1))},_intersectsWithSides:function(a){var b=c(this.positionAbs.top+this.offset.click.top,a.top+a.height/2,a.height),d=c(this.positionAbs.left+this.offset.click.left,a.left+a.width/2,a.width),e=this._getDragVerticalDirection(),f=this._getDragHorizontalDirection();return this.floating&&f?"right"===f&&d||"left"===f&&!d:e&&("down"===e&&b||"up"===e&&!b)},_getDragVerticalDirection:function(){var a=this.positionAbs.top-this.lastPositionAbs.top;return 0!==a&&(a>0?"down":"up")},_getDragHorizontalDirection:function(){var a=this.positionAbs.left-this.lastPositionAbs.left;return 0!==a&&(a>0?"right":"left")},refresh:function(a){return this._refreshItems(a),this.refreshPositions(),this},_connectWith:function(){var a=this.options;return a.connectWith.constructor===String?[a.connectWith]:a.connectWith},_getItemsAsjQuery:function(b){function c(){h.push(this)}var d,e,f,g,h=[],i=[],j=this._connectWith();if(j&&b)for(d=j.length-1;d>=0;d--)for(f=a(j[d]),e=f.length-1;e>=0;e--)(g=a.data(f[e],this.widgetFullName))&&g!==this&&!g.options.disabled&&i.push([a.isFunction(g.options.items)?g.options.items.call(g.element):a(g.options.items,g.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),g]);for(i.push([a.isFunction(this.options.items)?this.options.items.call(this.element,null,{options:this.options,item:this.currentItem}):a(this.options.items,this.element).not(".ui-sortable-helper").not(".ui-sortable-placeholder"),this]),d=i.length-1;d>=0;d--)i[d][0].each(c);return a(h)},_removeCurrentsFromItems:function(){var b=this.currentItem.find(":data("+this.widgetName+"-item)");this.items=a.grep(this.items,function(a){for(var c=0;c<b.length;c++)if(b[c]===a.item[0])return!1;return!0})},_refreshItems:function(b){this.items=[],this.containers=[this];var c,d,e,f,g,h,i,j,k=this.items,l=[[a.isFunction(this.options.items)?this.options.items.call(this.element[0],b,{item:this.currentItem}):a(this.options.items,this.element),this]],m=this._connectWith();if(m&&this.ready)for(c=m.length-1;c>=0;c--)for(e=a(m[c]),d=e.length-1;d>=0;d--)(f=a.data(e[d],this.widgetFullName))&&f!==this&&!f.options.disabled&&(l.push([a.isFunction(f.options.items)?f.options.items.call(f.element[0],b,{item:this.currentItem}):a(f.options.items,f.element),f]),this.containers.push(f));for(c=l.length-1;c>=0;c--)for(g=l[c][1],h=l[c][0],d=0,j=h.length;d<j;d++)i=a(h[d]),i.data(this.widgetName+"-item",g),k.push({item:i,instance:g,width:0,height:0,left:0,top:0})},refreshPositions:function(b){this.offsetParent&&this.helper&&(this.offset.parent=this._getParentOffset());var c,d,e,f;for(c=this.items.length-1;c>=0;c--)d=this.items[c],d.instance!==this.currentContainer&&this.currentContainer&&d.item[0]!==this.currentItem[0]||(e=this.options.toleranceElement?a(this.options.toleranceElement,d.item):d.item,b||(d.width=e.outerWidth(),d.height=e.outerHeight()),f=e.offset(),d.left=f.left,d.top=f.top);if(this.options.custom&&this.options.custom.refreshContainers)this.options.custom.refreshContainers.call(this);else for(c=this.containers.length-1;c>=0;c--)f=this.containers[c].element.offset(),this.containers[c].containerCache.left=f.left,this.containers[c].containerCache.top=f.top,this.containers[c].containerCache.width=this.containers[c].element.outerWidth(),this.containers[c].containerCache.height=this.containers[c].element.outerHeight();return this},_createPlaceholder:function(b){b=b||this;var c,d=b.options;d.placeholder&&d.placeholder.constructor!==String||(c=d.placeholder,d.placeholder={element:function(){var d=b.currentItem[0].nodeName.toLowerCase(),e=a("<"+d+">",b.document[0]).addClass(c||b.currentItem[0].className+" ui-sortable-placeholder").removeClass("ui-sortable-helper");return"tr"===d?b.currentItem.children().each(function(){a("<td>&#160;</td>",b.document[0]).attr("colspan",a(this).attr("colspan")||1).appendTo(e)}):"img"===d&&e.attr("src",b.currentItem.attr("src")),c||e.css("visibility","hidden"),e},update:function(a,e){c&&!d.forcePlaceholderSize||(e.height()||e.height(b.currentItem.innerHeight()-parseInt(b.currentItem.css("paddingTop")||0,10)-parseInt(b.currentItem.css("paddingBottom")||0,10)),e.width()||e.width(b.currentItem.innerWidth()-parseInt(b.currentItem.css("paddingLeft")||0,10)-parseInt(b.currentItem.css("paddingRight")||0,10)))}}),b.placeholder=a(d.placeholder.element.call(b.element,b.currentItem)),b.currentItem.after(b.placeholder),d.placeholder.update(b,b.placeholder)},_contactContainers:function(b){var e,f,g,h,i,j,k,l,m,n,o=null,p=null;for(e=this.containers.length-1;e>=0;e--)if(!a.contains(this.currentItem[0],this.containers[e].element[0]))if(this._intersectsWith(this.containers[e].containerCache)){if(o&&a.contains(this.containers[e].element[0],o.element[0]))continue;o=this.containers[e],p=e}else this.containers[e].containerCache.over&&(this.containers[e]._trigger("out",b,this._uiHash(this)),this.containers[e].containerCache.over=0);if(o)if(1===this.containers.length)this.containers[p].containerCache.over||(this.containers[p]._trigger("over",b,this._uiHash(this)),this.containers[p].containerCache.over=1);else{for(g=1e4,h=null,n=o.floating||d(this.currentItem),i=n?"left":"top",j=n?"width":"height",k=this.positionAbs[i]+this.offset.click[i],f=this.items.length-1;f>=0;f--)a.contains(this.containers[p].element[0],this.items[f].item[0])&&this.items[f].item[0]!==this.currentItem[0]&&(n&&!c(this.positionAbs.top+this.offset.click.top,this.items[f].top,this.items[f].height)||(l=this.items[f].item.offset()[i],m=!1,Math.abs(l-k)>Math.abs(l+this.items[f][j]-k)&&(m=!0,l+=this.items[f][j]),Math.abs(l-k)<g&&(g=Math.abs(l-k),h=this.items[f],this.direction=m?"up":"down")));if(!h&&!this.options.dropOnEmpty)return;if(this.currentContainer===this.containers[p])return;h?this._rearrange(b,h,null,!0):this._rearrange(b,null,this.containers[p].element,!0),this._trigger("change",b,this._uiHash()),this.containers[p]._trigger("change",b,this._uiHash(this)),this.currentContainer=this.containers[p],this.options.placeholder.update(this.currentContainer,this.placeholder),this.containers[p]._trigger("over",b,this._uiHash(this)),this.containers[p].containerCache.over=1}},_createHelper:function(b){var c=this.options,d=a.isFunction(c.helper)?a(c.helper.apply(this.element[0],[b,this.currentItem])):"clone"===c.helper?this.currentItem.clone():this.currentItem;return d.parents("body").length||a("parent"!==c.appendTo?c.appendTo:this.currentItem[0].parentNode)[0].appendChild(d[0]),d[0]===this.currentItem[0]&&(this._storedCSS={width:this.currentItem[0].style.width,height:this.currentItem[0].style.height,position:this.currentItem.css("position"),top:this.currentItem.css("top"),left:this.currentItem.css("left")}),d[0].style.width&&!c.forceHelperSize||d.width(this.currentItem.width()),d[0].style.height&&!c.forceHelperSize||d.height(this.currentItem.height()),d},_adjustOffsetFromHelper:function(b){"string"==typeof b&&(b=b.split(" ")),a.isArray(b)&&(b={left:+b[0],top:+b[1]||0}),"left"in b&&(this.offset.click.left=b.left+this.margins.left),"right"in b&&(this.offset.click.left=this.helperProportions.width-b.right+this.margins.left),"top"in b&&(this.offset.click.top=b.top+this.margins.top),"bottom"in b&&(this.offset.click.top=this.helperProportions.height-b.bottom+this.margins.top)},_getParentOffset:function(){this.offsetParent=this.helper.offsetParent();var b=this.offsetParent.offset();return"absolute"===this.cssPosition&&this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])&&(b.left+=this.scrollParent.scrollLeft(),b.top+=this.scrollParent.scrollTop()),(this.offsetParent[0]===document.body||this.offsetParent[0].tagName&&"html"===this.offsetParent[0].tagName.toLowerCase()&&a.ui.ie)&&(b={top:0,left:0}),{top:b.top+(parseInt(this.offsetParent.css("borderTopWidth"),10)||0),left:b.left+(parseInt(this.offsetParent.css("borderLeftWidth"),10)||0)}},_getRelativeOffset:function(){if("relative"===this.cssPosition){var a=this.currentItem.position();return{top:a.top-(parseInt(this.helper.css("top"),10)||0)+this.scrollParent.scrollTop(),left:a.left-(parseInt(this.helper.css("left"),10)||0)+this.scrollParent.scrollLeft()}}return{top:0,left:0}},_cacheMargins:function(){this.margins={left:parseInt(this.currentItem.css("marginLeft"),10)||0,top:parseInt(this.currentItem.css("marginTop"),10)||0}},_cacheHelperProportions:function(){this.helperProportions={width:this.helper.outerWidth(),height:this.helper.outerHeight()}},_setContainment:function(){var b,c,d,e=this.options;"parent"===e.containment&&(e.containment=this.helper[0].parentNode),"document"!==e.containment&&"window"!==e.containment||(this.containment=[0-this.offset.relative.left-this.offset.parent.left,0-this.offset.relative.top-this.offset.parent.top,a("document"===e.containment?document:window).width()-this.helperProportions.width-this.margins.left,(a("document"===e.containment?document:window).height()||document.body.parentNode.scrollHeight)-this.helperProportions.height-this.margins.top]),/^(document|window|parent)$/.test(e.containment)||(b=a(e.containment)[0],c=a(e.containment).offset(),d="hidden"!==a(b).css("overflow"),this.containment=[c.left+(parseInt(a(b).css("borderLeftWidth"),10)||0)+(parseInt(a(b).css("paddingLeft"),10)||0)-this.margins.left,c.top+(parseInt(a(b).css("borderTopWidth"),10)||0)+(parseInt(a(b).css("paddingTop"),10)||0)-this.margins.top,c.left+(d?Math.max(b.scrollWidth,b.offsetWidth):b.offsetWidth)-(parseInt(a(b).css("borderLeftWidth"),10)||0)-(parseInt(a(b).css("paddingRight"),10)||0)-this.helperProportions.width-this.margins.left,c.top+(d?Math.max(b.scrollHeight,b.offsetHeight):b.offsetHeight)-(parseInt(a(b).css("borderTopWidth"),10)||0)-(parseInt(a(b).css("paddingBottom"),10)||0)-this.helperProportions.height-this.margins.top])},_convertPositionTo:function(b,c){c||(c=this.position);var d="absolute"===b?1:-1,e="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,f=/(html|body)/i.test(e[0].tagName);return{top:c.top+this.offset.relative.top*d+this.offset.parent.top*d-("fixed"===this.cssPosition?-this.scrollParent.scrollTop():f?0:e.scrollTop())*d,left:c.left+this.offset.relative.left*d+this.offset.parent.left*d-("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():f?0:e.scrollLeft())*d}},_generatePosition:function(b){var c,d,e=this.options,f=b.pageX,g=b.pageY,h="absolute"!==this.cssPosition||this.scrollParent[0]!==document&&a.contains(this.scrollParent[0],this.offsetParent[0])?this.scrollParent:this.offsetParent,i=/(html|body)/i.test(h[0].tagName);return"relative"!==this.cssPosition||this.scrollParent[0]!==document&&this.scrollParent[0]!==this.offsetParent[0]||(this.offset.relative=this._getRelativeOffset()),this.originalPosition&&(this.containment&&(b.pageX-this.offset.click.left<this.containment[0]&&(f=this.containment[0]+this.offset.click.left),b.pageY-this.offset.click.top<this.containment[1]&&(g=this.containment[1]+this.offset.click.top),b.pageX-this.offset.click.left>this.containment[2]&&(f=this.containment[2]+this.offset.click.left),b.pageY-this.offset.click.top>this.containment[3]&&(g=this.containment[3]+this.offset.click.top)),e.grid&&(c=this.originalPageY+Math.round((g-this.originalPageY)/e.grid[1])*e.grid[1],g=this.containment?c-this.offset.click.top>=this.containment[1]&&c-this.offset.click.top<=this.containment[3]?c:c-this.offset.click.top>=this.containment[1]?c-e.grid[1]:c+e.grid[1]:c,d=this.originalPageX+Math.round((f-this.originalPageX)/e.grid[0])*e.grid[0],f=this.containment?d-this.offset.click.left>=this.containment[0]&&d-this.offset.click.left<=this.containment[2]?d:d-this.offset.click.left>=this.containment[0]?d-e.grid[0]:d+e.grid[0]:d)),{top:g-this.offset.click.top-this.offset.relative.top-this.offset.parent.top+("fixed"===this.cssPosition?-this.scrollParent.scrollTop():i?0:h.scrollTop()),left:f-this.offset.click.left-this.offset.relative.left-this.offset.parent.left+("fixed"===this.cssPosition?-this.scrollParent.scrollLeft():i?0:h.scrollLeft())}},_rearrange:function(a,b,c,d){c?c[0].appendChild(this.placeholder[0]):b.item[0].parentNode.insertBefore(this.placeholder[0],"down"===this.direction?b.item[0]:b.item[0].nextSibling),this.counter=this.counter?++this.counter:1;var e=this.counter;this._delay(function(){e===this.counter&&this.refreshPositions(!d)})},_clear:function(a,b){function c(a,b,c){return function(d){c._trigger(a,d,b._uiHash(b))}}this.reverting=!1;var d,e=[];if(!this._noFinalSort&&this.currentItem.parent().length&&this.placeholder.before(this.currentItem),this._noFinalSort=null,this.helper[0]===this.currentItem[0]){for(d in this._storedCSS)"auto"!==this._storedCSS[d]&&"static"!==this._storedCSS[d]||(this._storedCSS[d]="");this.currentItem.css(this._storedCSS).removeClass("ui-sortable-helper")}else this.currentItem.show();for(this.fromOutside&&!b&&e.push(function(a){this._trigger("receive",a,this._uiHash(this.fromOutside))}),!this.fromOutside&&this.domPosition.prev===this.currentItem.prev().not(".ui-sortable-helper")[0]&&this.domPosition.parent===this.currentItem.parent()[0]||b||e.push(function(a){this._trigger("update",a,this._uiHash())}),this!==this.currentContainer&&(b||(e.push(function(a){this._trigger("remove",a,this._uiHash())}),e.push(function(a){return function(b){a._trigger("receive",b,this._uiHash(this))}}.call(this,this.currentContainer)),e.push(function(a){return function(b){a._trigger("update",b,this._uiHash(this))}}.call(this,this.currentContainer)))),d=this.containers.length-1;d>=0;d--)b||e.push(c("deactivate",this,this.containers[d])),this.containers[d].containerCache.over&&(e.push(c("out",this,this.containers[d])),this.containers[d].containerCache.over=0);if(this.storedCursor&&(this.document.find("body").css("cursor",this.storedCursor),this.storedStylesheet.remove()),this._storedOpacity&&this.helper.css("opacity",this._storedOpacity),this._storedZIndex&&this.helper.css("zIndex","auto"===this._storedZIndex?"":this._storedZIndex),this.dragging=!1,this.cancelHelperRemoval){if(!b){for(this._trigger("beforeStop",a,this._uiHash()),d=0;d<e.length;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!1}if(b||this._trigger("beforeStop",a,this._uiHash()),this.placeholder[0].parentNode.removeChild(this.placeholder[0]),this.helper[0]!==this.currentItem[0]&&this.helper.remove(),this.helper=null,!b){for(d=0;d<e.length;d++)e[d].call(this,a);this._trigger("stop",a,this._uiHash())}return this.fromOutside=!1,!0},_trigger:function(){!1===a.Widget.prototype._trigger.apply(this,arguments)&&this.cancel()},_uiHash:function(b){var c=b||this;return{helper:c.helper,placeholder:c.placeholder||a([]),position:c.position,originalPosition:c.originalPosition,offset:c.positionAbs,item:c.currentItem,sender:b?b.element:null}}})}(jQuery),define("jquery.ui",["$"],function(){}),define("views/common/controls/CommonDropDownListCtl",["talent","templates/common"],function(a,b){return window.dropdownListCache=[],a.ItemView.extend({template:b["common/controls/CommonDropDownListCtl"],ui:{body:"div.list_sel_wrap",title:"a.tit_sel",value:"input[type=hidden]"},initialize:function(b){var c=this;c.model=new a.Model({name:"",id:"",showLabel:!0,value:"1",desc:"",tips:"",required:!1}),c.model.set(b),this.showList=!1,$(document).on("click",function(a){0==$(a.target).parents(".cnt_form").length&&(this.showList=!1,$(".list_sel_wrap").hide())})},events:{"click a.tit_sel":"showOptions","click li":"selectOption"},onShow:function(){},showOptions:function(a){var b=this.$el.find(".list_sel_wrap");this.showList?b.hide():b.show()},selectOption:function(a){var b=$(a.currentTarget);this.$el.find(".tit_sel").html(b.attr("t")),this.$el.find(".list_sel_wrap li").removeClass("cur"),b.addClass("cur"),this.$el.find("input[type=hidden]").val(b.attr("v")),this.$el.find(".list_sel_wrap").hide(),this.trigger("optionChange",{formName:this.model.get("formName"),value:b.attr("v")})},getData:function(){return this.$el.find(this.ui.value).val()}})}),define("views/common/helpers/validator",["talent"],function(a){function b(b,c){var d=Number(b);return!(d<0||d>100||!a.Validator.isTwoDecimal(b,{strict:!1}))}function c(b,c){var d=Number(c.max),e=Number(c.min),f=Number(b);return!(!a.Validator.isTwoDecimal(b,{scrict:!1})||f<e||f>d)}function d(a,b){var c=Number(a);return!(b.max&&c>b.max)&&!(b.min&&c<b.min)}return{isCorrectWeight:b,isCorrectScore:c,isBetweenLimits:d}}),function(a){"function"==typeof define&&define.amd?define("$.autoresize",["jquery"],a):a(window.jQuery||window.$)}(function(a){var b,c={className:"autosizejs",append:"",callback:!1,resizeDelay:10},d='<textarea tabindex="-1" style="position:absolute; top:-999px; left:0; right:auto; bottom:auto; border:0; -moz-box-sizing:content-box; -webkit-box-sizing:content-box; box-sizing:content-box; word-wrap:break-word; height:0 !important; min-height:0 !important; overflow:hidden; transition:none; -webkit-transition:none; -moz-transition:none;"/>',e=["fontFamily","fontSize","fontWeight","fontStyle","letterSpacing","textTransform","wordSpacing","textIndent"],f=a(d).data("autosize",!0)[0];f.style.lineHeight="99px","99px"===a(f).css("lineHeight")&&e.push("lineHeight"),f.style.lineHeight="",a.fn.autosize=function(d){return d=a.extend({},c,d||{}),f.parentNode!==document.body&&a(document.body).append(f),this.each(function(){function c(){var c={};if(b=l,f.className=d.className,i=parseInt(m.css("maxHeight"),10),a.each(e,function(a,b){c[b]=m.css(b)}),a(f).css(c),"oninput"in l){var g=l.style.width;l.style.width="0px",l.offsetWidth,l.style.width=g}}function g(){var e,g,h,k;b!==l&&c(),f.value=l.value+d.append,f.style.overflowY=l.style.overflowY,g=parseInt(l.style.height,10),"getComputedStyle"in window?(k=window.getComputedStyle(l),h=l.getBoundingClientRect().width,a.each(["paddingLeft","paddingRight","borderLeftWidth","borderRightWidth"],function(a,b){h-=parseInt(k[b],10)}),f.style.width=h+"px"):f.style.width=Math.max(m.width(),0)+"px",f.scrollTop=0,f.scrollTop=9e4,e=f.scrollTop,i&&e>i?(l.style.overflowY="scroll",e=i):(l.style.overflowY="hidden",e<j&&(e=j)),e+=n,g!==e&&(l.style.height=e+"px",o&&d.callback.call(l,l))}function h(){clearTimeout(k),k=setTimeout(function(){m.width()!==q&&g()},parseInt(d.resizeDelay,10))}var i,j,k,l=this,m=a(l),n=0,o=a.isFunction(d.callback),p={height:l.style.height,overflow:l.style.overflow,overflowY:l.style.overflowY,wordWrap:l.style.wordWrap,resize:l.style.resize},q=m.width();m.data("autosize")||(m.data("autosize",!0),"border-box"!==m.css("box-sizing")&&"border-box"!==m.css("-moz-box-sizing")&&"border-box"!==m.css("-webkit-box-sizing")||(n=m.outerHeight()-m.height()),j=Math.max(parseInt(m.css("minHeight"),10)-n||0,m.height()),m.css({overflow:"hidden",overflowY:"hidden",wordWrap:"break-word",resize:"none"===m.css("resize")||"vertical"===m.css("resize")?"none":"horizontal"}),"onpropertychange"in l?"oninput"in l?m.on("input.autosize keyup.autosize",g):m.on("propertychange.autosize",function(){"value"===event.propertyName&&g()}):m.on("input.autosize",g),!1!==d.resizeDelay&&a(window).on("resize.autosize",h),m.on("autosize.resize",g),m.on("autosize.resizeIncludeStyle",function(){b=null,g()}),m.on("autosize.destroy",function(){b=null,clearTimeout(k),a(window).off("resize",h),m.off("autosize").off(".autosize").css(p).removeData("autosize")}),g())})}}),define("views/common/mixins/ratescore-item-mixins",["talent","views/common/controls/CommonDropDownListCtl","views/common/helpers/validator","$.autoresize"],function(a,b,c){return{initialize:function(b){var c=this.model.toJSON(),d=this;c.modelClass="left";var e=c.Score,f=c.Comment,g=c.FieldRight.RateScore,h=c.FieldRight.RateStatement,i=c.FieldRight.IsCommentRequired;c.ownerId!=c.UserId&&(this.$el.removeClass("content-left").addClass("content-right"),c.modelClass="right"),c.UserId!=a.Context.getUserInfo().UserId||c.WorkflowStepId!=c.currentStepId||1!=c.FieldRight.RateScore&&1!=c.FieldRight.RateStatement||!c.HasTask?c.CanOperate=!1:c.CanOperate=!0,c.WorkflowStepId!=c.currentStepId||null!=c.Id&&"00000000-0000-0000-0000-000000000000"!=c.Id&&(1!=g||null!=e&&""!=e)&&(1!=i||null!=f&&""!=f)?c.mode="view":(c.mode="add",(e||f||""==f)&&(c.mode="edit"),c.CanOperate=0!=g||0!=h),this.speechFrameSetting={},this.listSetting={},this.dropdownSetting={};var j=c.ScoreLevelSettings;_.each(j,function(a){switch(a.DisplayType){case 1:d.dropdownSetting=a;break;case 2:d.speechFrameSetting=a;break;case 0:d.listSetting=a}}),c.showDescription=!0,c.showName=!1,c.showValue=!0,0==c.scoreType&&(1!=c.TypeId||1==c.TypeId&&1==c.ScoringMethod)&&(_.indexOf(d.listSetting.DisplayFields,"Value")>-1?c.showValue=!0:c.showValue=!1,_.indexOf(d.listSetting.DisplayFields,"Description")>-1?c.showDescription=!0:c.showDescription=!1,_.indexOf(d.listSetting.DisplayFields,"Name")>-1?c.showName=!0:c.showName=!1,_.each(c.ScoreLevelOptions_new&&c.ScoreLevelOptions_new.ScoreLevelOptions,function(a,b){a.Value==c.Score&&(c.ScoreName=a.Name,c.ScoreDescription=a.Description)})),this.model.set(c)},className:"content-left clearfix",ui:{},events:{"click .add-signModule":"saveScore","click .cancel-signModule":"cancelScore","click .edit-signModule":"editScore","keyup  input.form-num":"scoreKeyup","keyup  textarea":"textKeyup","focus  input.form-num":"scoreFocus","blur  input.form-num":"scoreBlur"},textKeyup:function(a){var b=$(a.currentTarget),c=this.model.toJSON(),d=($.trim(b.val())||"").length;if(b.next(".str-len").text(d+"/4000"),1==c.FieldRight.IsCommentRequired&&!d)return b.addClass("error"),!1;d>4e3?b.addClass("error"):b.removeClass("error")},scoreKeyup:function(a){var b=$(a.currentTarget);this._checkScore(b.val())?b.removeClass("error"):b.addClass("error")},_checkScore:function(a){var b=$.trim(a),d=this.model.get("WeightScoreLevel"),e=this.model.get("TargetScoreLevels"),f=this.model.get("ScoreMethod");return 1==f?c.isCorrectScore(b,{min:e.MinValue,max:e.MaxValue}):2==f?c.isCorrectScore(b,{min:d.MinValue,max:d.MaxValue}):void 0},scoreFocus:function(a){var b=$(a.currentTarget);this._checkScore(b.val())||""==b.val()?b.removeClass("error"):b.addClass("error"),b.next(".form-desc").show()},scoreBlur:function(a){var b=$(a.currentTarget);this._checkScore(b.val())&&b.next(".form-desc").hide()},cancelScore:function(){this.model.set("mode","view"),this.render()},editScore:function(){this.model.set("mode","edit"),this.render(),this.$el.find("textarea").autosize()},selectChange:function(b){var c=this.model.toJSON();if(!c.ScoreLevelOptions_new)return!1;var d=_.findWhere(c.ScoreLevelOptions_new.ScoreLevelOptions,{Value:b.value});this.ChangeModel=d?new a.Model({Score:d.Value,ScoreDescription:d.Description,ScoreName:d.Name}):new a.Model({Score:"",ScoreDescription:"",ScoreName:""}),""!=b.value?this.$el.find("a.tit_sel").removeClass("error"):this.$el.find("a.tit_sel").addClass("error")},onRender:function(){var c=this.model.toJSON(),d=this;if(localStorage.setItem(c.GoalId+"view",c.mode),$(".btnWeightChange").removeClass("warn_class"),this.trigger("operateScore",c),""==c.Score&&(c.Score=null),"view"!=c.mode&&0==c.scoreType&&(1!=c.TypeId||1==c.TypeId&&1==c.ScoringMethod)){var e=[{value:null,text:_.langs("common","selectDefault")}];_.each(c.ScoreLevelOptions_new&&c.ScoreLevelOptions_new.ScoreLevelOptions,function(a,b){var c=_.formatScoreByConfig(a,d.dropdownSetting),f=_.formatScoreByConfig(a,d.speechFrameSetting),g={value:a.Value,activeText:f,text:c};e.push(g)});var f={Description:"",Name:"",value:""};c.ScoreLevelOptions_new&&c.ScoreLevelOptions_new.ScoreLevelOptions&&c.ScoreLevelOptions_new.ScoreLevelOptions.length>0&&(f=c.ScoreLevelOptions_new.ScoreLevelOptions[0]),this.ChangeModel=new a.Model({Score:c.Score||e[0].value,ScoreDescription:c.ScoreDescription||f.Description,ScoreName:c.ScoreName||f.Name});var g=c.Score||e[0].value;g=null==g?g:_.toFixed(g,2),this.model.set("Score",g);var h=void 0==c.Score||null==c.Score?e[0].value:c.Score;if("1"==c.TypeId&&"0"==c.ScoringMethod)return;_.find(e,function(a){return a.value==c.Score})||(h=null),e=_.sortScoreLevel(e),this.scoreSelector=new b({formName:"Score",showLabel:!1,value:h,required:!1,state:"create",dataSource:e}),this.listenTo(this.scoreSelector,"optionChange",this.selectChange),this.$(".form-num").html(this.scoreSelector.render().el);var i=this.$el.find("textarea");setTimeout(function(){i.autosize()},0)}var i=this.$el.find("textarea");setTimeout(function(){i.autosize()},0)}}}),define("views/assessment/ratescore-item-view",["talent","templates/assessment","views/common/mixins/ratescore-item-mixins","views/common/dialog/dialog-index-view"],function(a,b,c,d){var e=a.ItemView.extend({template:b["assessment/ratescore-item"],showInfoDialog:function(a){var b={contentStr:a,icon:"info",showClose:!0,height:"58",width:278,inHeight:"auto",timeColse:3e3,showFoot:!1};this.infoDialog=new d(b),this.infoDialog.render()},saveScore:function(){var b=this,c=!0,d=this.model.toJSON(),e=d.FieldRight.RateScore,f=d.FieldRight.RateStatement,g=d.FieldRight.IsCommentRequired,h="";if(this.saving)return!1;if(d.Comment=1==f?this.$el.find("textarea").val():"",1==e)if(0!=d.scoreType)d.Score=this.$el.find("input").val(),""!=d.Score&&this._checkScore(d.Score)&&!this.$el.find("input").hasClass("error")||(this.$el.find("input").addClass("error"),c=!1);else{var i=this.ChangeModel.toJSON();""!=i.Score&&void 0!=i.Score&&null!=i.Score||(this.$el.find("a.tit_sel").addClass("error"),c=!1),d.Score=i.Score,d.ScoreDescription=i.ScoreDescription,d.ScoreName=i.ScoreName}else d.Score=null,h="-2147483648.00";if(1==g&&(""==$.trim(d.Comment)||this.$("textarea").hasClass("error"))&&(this.$("textarea").addClass("error"),c=!1),!c)return!1;b.saving=!0,a.app.request("Target:saveRate",{UserId:d.ownerId,uid:d.ownerId,goalId:d.goalId,moduleId:d.ModuleId,assessmentId:d.assessmentId,rateScore:d.Score||h,rateStatement:encodeURIComponent(d.Comment),moduleType:d.moduleType}).done(function(a){b.saving=!1,a.Result&&(d.mode="view",d.Comment=d.Comment,d.TotalScore=a.TotalScore,d.GoalScore=a.ItemScores[0].Score||"10000.00",d.ModuleRates=a.ModuleRates,d.WorkflowStepScoreList=a.WorkflowStepScoreList||[],b.model.set(d),b.render())}).fail(function(a){b.saving=!1})}});return _.extend(e.prototype,c),e}),define("views/assessment/ratescore-composite-view",["talent","templates/home","views/assessment/ratescore-item-view"],function(a,b,c){return a.CompositeView.extend({template:_.template(""),itemView:c,initialize:function(){var b=this.options;$(b.RateScoreList).each(function(a,c){(b.Assessment.HasTask||null!=c.WorkflowStepId)&&(c.ScoreLevelSettings=b.ScoreLevelSettings,c.ScoreLevelOptions_new=b.ScoreLevelOptions_new,c.FieldRight=b.FieldRight,c.assessmentId=b.assessmentId,c.ModuleId=b.ModuleId,c.goalId=b.Id,c.Id=b.Id,c.moduleType=b.ModuleType,c.CurrentStepUserId=b.CurrentStepUserId,c.HasTask=b.Assessment.HasTask,c.currentStepId=b.currentStepId,c.TargetScoreLevels=b.TargetScoreLevels,c.scoreLevelOption=b.ScoreLevelOptions,c.scoreType=b.ScoreType,c.ownerId=b.ownerId,c.fields=b.fields,c.TypeId=b.TypeId,c.ScoreMethod=b.ScoreMethod,c.ScoringMethod=b.ScoringMethod,c.WeightScoreLevel=b.WeightScoreLevel,c.ModuleScoreType=b.ModuleScoreType,c.ScoreDescription=c.ScoreDescription||"")}),this.collection=new a.Collection(b.RateScoreList),this.model=new a.Model(this.options)},onAfterItemAdded:function(a){var b=this.model.toJSON(),c=this;this.listenTo(a,"operateScore",function(a){var d=c.collection.toJSON();$(d).each(function(b,c){c.WorkflowStepId==a.WorkflowStepId&&(d[b]=a)}),b.RateScoreList=d,b.RateScore=a.GoalScore,b.ModuleRates=a.ModuleRates,b.TotalScore=a.TotalScore,b.WorkflowStepScoreList=a.WorkflowStepScoreList,c.trigger("ScoreChange",b)})}})}),define("templates/natureDialog",[],function(){return this.JST=this.JST||{},this.JST["natureDialog/addSubItem/index-page"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="module-dialog" style="width:'+__e(width)+"px;min-height:"+__e(height)+'px;">\n\t<a class="dialog-btn dialog-close "></a>\n\t<div class="dialog_header">\n\t\t'+(null==(__t=title)?"":__t)+'\n\t</div>\n\t<div class="dialog_body" style="height:'+__e(inHeight)+'px;overflow-y:auto;margin-top:0px;">\n\t\t<div class="form_items">\n\t\t\t\n\t\t\t\t<ul class="addsub-dialog">\n\t\t\t\t<li>\n\t\t\t\t\t<span class="form_label" style="text-align:right"><span style="color:red;padding: 0 6px;">*</span>'+__e(i18n.name)+'：</span>\n\t\t\t\t\t<span class="form_name_content input-text" style="left:0">\n\t\t\t\t\t   ',"edit"!=mode?__p+='\n\t\t\t\t\t\t  <div contenteditable="true" name="name" class="input_objective_name" maxlength="50" value="'+(null==(__t=i18n.addSubTip)?"":__t)+'" ></div><span class="warning-tip" >'+__e(_.langs("common","required"))+"</span>\n\t\t\t\t\t\t":__p+='\n\t\t\t\t\t\t   <div contenteditable="'+__e("0"==FieldRight.Property?"false":"true")+'" name="name" class="input_objective_name hasval" maxlength="50" value="'+__e(name)+'" ></div><span class="warning-tip" style="display:none;">'+(null==(__t=_.langs("common","required"))?"":__t)+"</span>\n\t\t\t\t\t\t",__p+='\n\t\t\t\t\t</span>\n\n\t\t\t\t</li>\n\t\t\t\t<li class="clearfix">\n\t\t\t\t\t<span class="form_label" style="text-align:right;position:relative;top:-34px;" >'+__e(i18n.detailDesc)+'：</span>\n\t\t\t\t\t\n\t\t\t\t\t<span class="form_item w400 display-inbl form_cc">\n\t\t\t\t\t\t',"edit"!=mode?__p+='\n\t\t\t\t\t\t  \t<textarea class="inner"  ></textarea>\n\t\t\t\t\t\t\t<span class="str-len " style="bottom:initial;right:initial;margin-top:100px">0/4000</span>\n\t\t\t\t\t\t':__p+='\n\t\t\t\t\t\t   \t<textarea  class="hasval inner "  '+__e("0"==FieldRight.Property?"disabled":"")+">"+__e(description)+'</textarea>\n\t\t\t\t\t\t\t<span class="str-len " style="bottom:initial;right:initial;margin-top:100px">'+__e(description.length)+"/4000</span>\n\t\t\t\t\t\t",__p+='\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t<li class="clearfix">\n\t\t\t\t\t\n\t\t\t\t',isScoreLevel?(__p+="\n\t\t\t\t\t<input style='display:none' id='addSubScore'>\n\t\t\t\t\t<span class=\"form_label fleft form_label_module\" \n\t\t\t\t\tstyle=\"margin: 0 6px 0 0;text-align:right\" >"+__e(i18n.score)+"：</span>\n\t\t\t\t\t","0"==FieldRight.RateScore?__p+="\n\n\t\t\t\t\t<input type='text' value=\""+__e("10000.00"==score?_.langs("common","invaluably"):score)+'" disabled style="width: 361px;"/>\n\n\n\t\t\t\t\t':__p+='\n\n\t\t\t\t\t\n\t\t\t\t\t<span class="form_item form_item_module select-container-create '+(null==(__t=name.length>0?"edit":"create")?"":__t)+' disinblock fuzhidao">\n\t\t\t\t\t</span>\n\n\t\t\t\t\t',__p+="\n\n\t\t\t\t"):__p+='\n\t\n\t\t\t\t\t<span class="form_label" style="text-align:right" >'+__e(i18n.score)+'：</span>\n\t\t\t\t\t<span class="form_item display-inbl">\n\t\t\t\t\t\t<input type="text" class="lianghvinput  hasval" id="addSubScore" '+__e("0"==FieldRight.RateScore?"disabled":"")+' value="'+__e(score)+'" tip-info="'+__e(_.langs("common","scoreRange"))+":"+__e(scoreLevel.MinValue)+"&nbsp;～&nbsp;"+__e(scoreLevel.MaxValue)+'" >\n\t\t\t\t\t\t\n\t\t\t\t\t</span>\n\n\t\t\t\t\n\t\t\t\t',__p+='\n\t\t\t\t</li>\n\t\t\t</ul>\n\t\t\n\t\t</div>\n\t\t<div class="form_items last_item">\n\t\t\t\n\t\t</div>\n\t</div>\n\t<div class="dialog_operation">\n\t\n\t\t<span class="btn btn-small  btn-blue btn-sure">\n\t\t\t'+__e(_.langs("common","submit"))+'\n\t\t</span>\n\t\n\t\t<span class="btn btn-small btn-white btn-cancel simplemodal-close">\n\t\t\t'+__e(_.langs("common","cancel"))+"\n\t\t</span>\n\t</div>\n</div>";return __p},this.JST["natureDialog/confirm/index-page"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="module-dialog" style="width:'+__e(width)+"px;height:"+__e(height)+'px;">\n    ',showClose&&(__p+='\n\t<a class="dialog-btn dialog-close simplemodal-close"></a>\n\t'),__p+="\n\t",showHeader&&(__p+='\n\t<div class="dialog_header">\n\t\t'+__e(title)+"\n\t</div>\n\t"),__p+='\n\t\x3c!-- \n\tedited by fuyue\n\t<div class="dialog_body" style="height:'+__e(inHeight)+'px;">\n\t\t<span class="ico ico_'+__e(icon)+'">'+__e(contentStr)+'</span>\n\t</div> --\x3e\n\t<div class="dialog_body" style="height:'+__e(inHeight)+'px;padding:0 10px;line-height:15px;">\n\t\t<span class="ico ico_'+__e(icon)+'" style="margin-top:22px">'+(null==(__t=contentStr)?"":__t)+'</span>\n\t\t<span class="ico ico_'+__e(icon)+'" style="margin-top:15px;background:none;color:#C5BEBE;">'+(null==(__t=contentTip)?"":__t)+"</span>\n\t\t\n\t</div>\n\t",showFoot&&(__p+='\n\t<div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-'+__e(yesColor)+' btn-sure">'+__e(yesText)+'</span>\n\t\t<span class="btn btn-small btn-'+__e(noColor)+' btn-cancel">'+__e(noText)+"</span>\n\t</div>\n\t"),__p+="\n</div>";return __p},this.JST["natureDialog/copyGoal/index-page"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="module-dialog" style="width:'+__e(width)+"px;height:"+__e(height)+'px;">\n\t<a class="dialog-btn dialog-close "></a>\n\t<div class="dialog_body" style="height:'+__e(inHeight)+'px;">\n\t\t<div class="module-header">\n\t\t\t<span class="title current" data-type="0">'+__e(i18n.copyFromZhibiao)+'</span>\n\t\t\t<span class="title" data-type="1">'+__e(i18n.copyFromAssessment)+'</span>\n\t\t</div>\n\t\t<div class="activity-select" style="display:none;">\n\t\t\t<span class="select-container fleft fuzhidao">\n\t\t\t</span>\n\t\t\t<span class="fleft m10" style="margin-top:10px;margin-left:50px;">\n\t\t\t\t<span class="checkbox checkbox_uncheck copyTask" style="vertical-align:middle;">\n\t\t\t\t</span>\n\t\t\t\t'+__e(i18n.copyTask)+'\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="list-body">\n\t\t\t',0==respData.length&&(__p+='\n\t\t\t\t<div class="empty-data">\n\t\t\t\t\t'+__e(i18n.noTarget)+"\n\t\t\t\t</div>\n\t\t\t"),__p+='\n\t\t</div>\n\t\t<div class="select-module">\n\t\t\t<span class="disinblock fleft">'+__e(i18n.copyTo)+'：</span>\n\t\t\t<span class="select-container fuzhidao fleft">\n\t\t\t</span>\n\t\t</div>\n\t</div><div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-blue btn-sure">'+__e(_.langs("common","submit"))+'</span>\n\t\t<span class="btn btn-small btn-white btn-cancel ">'+__e(_.langs("common","cancel"))+"</span>\n\t</div>\n</div>";return __p},this.JST["natureDialog/copyGoalFromObject/index-page"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="module-dialog" style="width:'+__e(width)+"px;height:"+__e(height)+'px;overflow:hidden">\n    <a class="dialog-btn dialog-close"></a>\n\t<div class="dialog_header">\n\t\t'+__e(title)+'\n\t</div>\n\t<div class="dialog_body" style="height:'+__e(inHeight)+'px;">\n\t\t<div class="select-module copyFromObject">\n\t\t\t<span class="disinblock fleft">'+__e(i18n.copyTo)+'：</span>\n\t\t\t<span class="select-container fleft fuzhidao">\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="select-header copyObjectMangment">\n\t\t\t<span class="date-period yearList"></span>\n\t\t\t<span class="date-period periodList"></span>\n\t\t\t<span class="date-period statusList"></span>\n\t\t\t\n\t\t</div>\n\t\t<div class="list-body">\n\t\t\n\t\t</div>\n\t\t\t',1==IsSetLeadInMBOCondition&&(__p+='\n\t\t\t\t<div class="mes-tip">\n\t\t\t\t\t<span>'+(null==(__t=Message)?"":__t)+"</span>\n\t\t\t\t</div>\n\t\t\t"),__p+='\n\t</div>\n\t<div class="dialog_operation clearfix">\n\t\t<span class="btn btn-small btn-blue btn-sure">'+__e(_.langs("common","submit"))+'</span>\n\t\t<span class="btn btn-small btn-white btn-cancel ">'+__e(_.langs("common","cancel"))+"</span>\n\t</div>\n</div>";return __p},this.JST["natureDialog/copytask/index-page"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="module-dialog" style="width:'+__e(width)+"px;height:"+__e(height)+'px;">\n\t<a class="dialog-btn dialog-close simplemodal-close"></a>\n\t<div class="dialog_header">\n\t\t'+__e(title)+'\n\t</div>\n\t<div class="dialog_body copy-task-container" style="height:'+__e(inHeight)+'px;">\n\t\t<div class="activity-select" style="margin-left: 50px;">\n\t\t\t<span class="select-container fleft fuzhidao" >\n\t\t\t\t\n\t\t\t</span>\n\t\t</div>\n\t\t<div class="list-body">\n\t\t\t\n\t\t</div>\n\t</div><div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-blue btn-sure">\n\t\t\t'+(null==(__t=_.langs("common","submit"))?"":__t)+'\n\t\t</span>\n\t\t<span class="btn btn-small btn-white btn-cancel simplemodal-close">\n\t\t\t'+(null==(__t=_.langs("common","cancel"))?"":__t)+"\n\t\t</span>\n\t</div>\n</div>";return __p},this.JST["natureDialog/goalOperation/index-page"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="module-dialog " style="width:'+__e(width)+"px;min-height:"+__e(height)+'px;position:absolute">\n\t<a class="dialog-btn dialog-close "></a>\n\t<div class="dialog_header">\n\t\t'+__e(title)+'\n\t</div>\n\t<div class="dialog_body" style="height:'+__e(inHeight)+'px;overflow-y:auto;margin-top:0px;">\n\t\t<div class="form_items">\n\t\t\t\n\t\t\t\t<ul class="form_item_list">\n\t\t\t\t<li>\n\t\t\t\t\t<span class="form_item_name"></span>\n\t\t\t\t\t<span class="form_name_content input-text">\n\t\t\t\t\t   ',name==i18n.targetNameTip||""==name?__p+='\n\t\t\t\t\t\t  <div name="name" contenteditable="true" class="input_objective_name" maxlength="500" value="'+__e(_.langs("assessment","dialog","targetNameTip"))+'"></div>\n\t\t\t\t\t\t   <span class="warning-tip" >'+__e(_.langs("common","required"))+"</span>\n\t\t\t\t\t\t":__p+='\n\t\t\t\t\t\t   <div contenteditable="'+__e("1"!=typeId&&"0"!=currentModule.FieldRight.Property&&"7"!=currentModule.ModuleType)+'" name="name" class="input_objective_name hasval" maxlength="500"  textContext="'+(null==(__t=name)?"":__t)+'"></div>\n\t\t\t\t\t\t   <span class="warning-tip" style="display:none;">'+__e(_.langs("common","required"))+"</span>\n\t\t\t\t\t\t",__p+=' \n\t\t\t\t\t\t<span class="period-tooltip"\n\t\t\t\t\t\t\t'+__e("7"==currentModule.ModuleType?"style= visibility:hidden":"")+'\n\t\t\t\t\t\t title="'+__e(_.langs("assessment","dialog","dateline"))+":"+__e(startDate.replace(/-/g,"/"))+"--"+__e(endDate.replace(/-/g,"/"))+'"></span>\n\t\t\t\t\t</span>\n\n\t\t\t\t</li>\n\n\t\t\t\t<li class="dropDownList clearfix">\n\t\t\t\t\t<span class="form_label fleft form_label_module" \n\t\t\t\t\tstyle="margin: 0 6px 0 0;text-align:right" >'+__e(i18n.module)+'：</span>\n\t\t\t\t\t<span class="form_item form_item_module select-container-create '+(null==(__t=name.length>0?"edit":"create")?"":__t)+' disinblock fuzhidao">\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\n\t\t\t\t<li class="clearfix weightInp" '+__e(hideWeight?"style= display:none":"")+'>\n\t\t\t\t\t<span class="form_label" style="text-align:right">'+__e(i18n.weight)+'：</span>\n\t\t\t\t\t<span class="form_item  display-inbl">\n\t\t\t\t\t\t<input '+__e("0"==currentModule.FieldRight.Weight?"disabled":"")+'  type="text"  class="input-weight hasval" value="'+__e(_.toFixed(weight))+'">   %\n\t\t\t\t\t</span>\n\t\t\t\t\t',"106561"==BSGlobal.tenantInfo.Id&&(__p+='\n\t\t\t\t\t\t<p style="margin-left: 125px;color: #ccc;">单个KR的权重不高于15%,不低于5%，建议按照5%、10%、15%的方式设定</p>\n\t\t\t\t\t'),__p+="\n\t\t\t\t</li>\n\n\t\t\t\t",7!=currentModule.ModuleType&&(__p+='\n\t\t\t\t<li style="display:none">\n\t\t\t\t\t<span class="form_label">'+__e(i18n.dateline)+'：</span>\n\t\t\t\t\t<span class="form_item form_item_time">\n\t\t\t\t\t\t<input type="text" class="datetime startDate hasval" value="'+__e(startDate.replace(/\./g,"-"))+'">\n\t\t\t\t\t\t<span class="dot">......</span>\n\t\t\t\t\t\t<input type="text" class="datetime endDate hasval" value="'+__e(endDate.replace(/\./g,"-"))+'">\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t',"1"==typeId?__p+='\n\t\t\t\t\t<li class="clearfix" '+__e("1"==MinimumValue.IsAdopt?"":"style= display:none")+'>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span class="form_label" style="text-align:right">'+__e(i18n.minimumValue)+'：</span>\n\t\t\t\t\t\t\t<span class="form_item display-inbl">\n\t\t\t\t\t\t\t\t<input type="text" class="lianghvinput  hasval" value="'+__e(MinimumValue.Value)+'" '+__e("0"==currentModule.FieldRight.ObjectiveType?"disabled":"")+' id="bdz">\n\t\t\t\t\t\t\t\t\t'+__e(Unit)+'\n\t\t\t\t\t\t\t</span>    \n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class="clearfix" '+__e("1"==ItemValue.IsAdopt?"":"style= display:none")+'>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span class="form_label" style="text-align:right" >'+__e(i18n.itemValue)+'：</span>\n\t\t\t\t\t\t\t<span class="form_item display-inbl">\n\t\t\t\t\t\t\t\t<input type="text" class="lianghvinput  hasval" id="mbz" '+__e("0"==currentModule.FieldRight.ObjectiveType?"disabled":"")+' value="'+__e(ItemValue.Value)+'">\n\t\t\t\t\t\t\t\t'+__e(Unit)+'\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class="clearfix" '+__e("1"==ChallengeValue.IsAdopt?"":"style= display:none")+'>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span class="form_label" style="text-align:right" >'+__e(i18n.challengeValue)+'：</span>\n\t\t\t\t\t\t\t\t<span class="form_item display-inbl">\n\t\t\t\t\t\t\t\t\t<input type="text" class="lianghvinput  hasval" id="tzz" '+__e("0"==currentModule.FieldRight.ObjectiveType?"disabled":"")+' value="'+__e(ChallengeValue.Value)+'">\n\t\t\t\t\t\t\t\t\t'+__e(Unit)+'\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t\t<li class="clearfix" '+__e(1!=currentStepTypeId&&6!=currentStepTypeId?"":"style=display:none")+'>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\t<span class="form_label" style="text-align:right" >'+__e(i18n.completeValue)+'：</span>\n\t\t\t\t\t\t\t\t<span class="form_item display-inbl">\n\t\t\t\t\t\t\t\t<input type="text" class="lianghvinput  hasval" id="wcz" '+__e(1==currentModule.FieldRight.CompleteValue&&1==CompleteValueSource?"":"disabled")+' value="'+__e(CompleteValue)+'">\n\t\t\t\t\t\t\t\t\t\t'+__e(Unit)+"\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t\t</li>\n\t\t\t\t\t\n\t\t\t\t\t\t\n\t\t\t\t":__p+="\n\t\t\t\t\t\n\t\t\t\t\t\n\n\t\t\t\t",__p+='\n\t\t\t\t<li class="clearfix">\n\t\t\t\t\t',102712==BSGlobal.tenantInfo.Id?__p+='\n\t\t\t\t\t\t<span class="form_label" style="text-align:right;position:relative;top:-34px;" >拟输出结果：</span>\n\t\t\t\t\t':__p+='\n\t\t\t\t\t\t<span class="form_label" style="text-align:right;position:relative;top:-34px;" >'+__e(i18n.description)+"：</span>\n\t\t\t\t\t",__p+='\n\t\t\t\t\t\n\t\t\t\t\t<span class="form_item display-inbl form_cc form_stander">\n\t\t\t\t\t\t',description==i18n.descriptionTip||""==description?__p+='\n\t\t\t\t\t\t  \t<textarea class="inner stanDesc" '+__e("1"==typeId||"0"==currentModule.FieldRight.Property?"disabled ":"")+"  >"+__e(102712==BSGlobal.tenantInfo.Id?"仅制定KPI指标或结果性目标承诺时填写":i18n.descriptionTip)+'</textarea>\n\t\t\t\t\t\t\t<span class="str-len">0/4000</span>\n\t\t\t\t\t\t':__p+='\n\t\t\t\t\t\t   \t<textarea  class="hasval inner stanDesc"  '+__e("1"==typeId||"0"==currentModule.FieldRight.Property?"disabled ":"")+"  >"+(null==(__t=description)?"":__t)+'</textarea>\n\t\t\t\t\t\t\t<span class="str-len">'+__e(description.length)+"/4000</span>\n\t\t\t\t\t\t",__p+="\n\t\t\t\t\t</span>\n\t\t\t\t</li>\n\t\t\t\t",CustomFields&&(__p+="\n\t\t\t\t\t",_.each(CustomFields,function(a,b){__p+='\n\t\t\t\t\t\t<li class="clearfix customFildes"\n\t\t\t\t\t\t style='+__e(1==showCustomFields?"display:none":"display:block")+" >\n\t\t\t\t\t\t\t",1==a.Type?(__p+='\n\t\t\t\t\t\t\t\t<span class="form_label" style="text-align:right" >\n\t\t\t\t\t\t\t\t',"true"==String(a.IsRequire)&&(__p+='\n\t\t\t\t\t\t\t\t\t<span class="redstar">*</span>\n\t\t\t\t\t\t\t\t'),__p+="\n\t\t\t\t\t\t\t\t"+__e(a.Name)+'：</span>\n\t\t\t\t\t\t\t\t<span class="form_item display-inbl">\n\t\t\t\t\t\t\t\t\t<input type="text" class="lianghvinput hasval" id="'+__e(a.Id)+'"  name="'+__e(a.Name)+'"\n\t\t\t\t\t\t\t\t\tvalue="'+__e(a.Description)+'" isRequire="'+__e(a.IsRequire)+'" code="'+__e(a.Code)+'" types="'+__e(a.Type)+'" len="'+__e(a.MaxLength)+'"/>\n\t\t\t\t\t\t\t\t\t<span class="str-len">'+__e(a.Description?a.Description.length:"0")+"/"+__e(a.MaxLength)+"</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t","难度系数"==a.Name&&"106561"==BSGlobal.tenantInfo.Id&&(__p+='\n\t\t\t\t\t\t\t\t\t<p style="margin-left: 125px;color:#ccc;">一般工作为1，挑战工作为1.05.</br>\n\t\t\t\t\t\t\t\t\t一个季度不超过2个难度系数1.05的任务</p>\n\t\t\t\t\t\t\t\t'),__p+="\n\t\t\t\t\t\t\t"):(__p+='\n\t\t\t\t\t\t\t\t<span class="form_label" style="text-align:right;position:relative;top:-34px;" >\n\t\t\t\t\t\t\t\t\t',"true"==String(a.IsRequire)&&(__p+='\n\t\t\t\t\t\t\t\t\t\t<span class="redstar">*</span>\n\t\t\t\t\t\t\t\t\t'),__p+="\n\t\t\t\t\t\t\t\t"+__e(a.Name)+'：</span>\n\t\t\t\t\t\t\t\t<span class="form_item display-inbl form_cc form_custom">\n\t\t\t\t\t\t\t\t\t<textarea  class="hasval inner" isRequire="'+__e(a.IsRequire)+'" code="'+__e(a.Code)+'" name="'+__e(a.Name)+'" id="'+__e(a.Id)+'" types="'+__e(a.Type)+'" len="'+__e(a.MaxLength)+'">'+__e(a.Description)+'</textarea>\n\t\t\t\t\t\t\t\t\t<span class="str-len">'+__e(a.Description?a.Description.length:"0")+"/"+__e(a.MaxLength)+"</span>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t"),__p+="\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+="\n\t\t\t\t\t"),__p+="\n\t\t\t\t"),__p+='\n\t\t\t</ul>\n\t\t\n\t\t</div>\n\t\t<div class="form_items last_item">\n\t\t\t\n\t\t</div>\n\t</div><div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-blue btn-sure js-btn-sure">\n\t\t\t'+__e(_.langs("common","submit"))+'\n\t\t</span>\n\t\t<span class="btn btn-small btn-white btn-cancel simplemodal-close js-btn-cancel">\n\t\t\t'+__e(_.langs("common","cancel"))+"\n\t\t</span>\n\t</div>\n</div>";return __p},this.JST["natureDialog/index-page"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+="";return __p},this.JST["natureDialog/organizationTree/index-page"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="module-dialog " style="width:'+__e(width)+"px;min-height:"+__e(height)+'px;position:absolute">\n\t<a class="dialog-btn dialog-close "></a>\n\t<div class="dialog_header">\n\t\t'+__e(title)+'\n\t</div>\n\t<div class="dialog_body" style="height:'+__e(minHeight)+'px;overflow-y:auto;margin-top:0px;">\n\t\t<ul class="ztree" id="treeDemo">\n\n\t\t</ul>\n\t</div>\n\t\t\n\t<div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-blue btn-sure js-btn-sure">\n\t\t\t'+__e(_.langs("common","submit"))+'\n\t\t</span>\n\t\t<span class="btn btn-small btn-white btn-cancel simplemodal-close js-btn-cancel">\n\t\t\t'+__e(_.langs("common","cancel"))+"\n\t\t</span>\n\t</div>\n</div>";return __p},this.JST["natureDialog/reject/index-page"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="module-dialog" style="width:300px;height:176px;">\n\t<div class="dialog_body reback-dialog" style="height:100px;padding:15px;text-align:left">\n\t\t<span class="ico ico_asking" style="margin-top:0">'+__e(_.langs("assessment","sureReject"))+'</span>\n\t\t<textarea class="dialog-text" style="width: 250px;height: 50px;margin-top: 8px;padding: 10px;" data-placeholder="'+__e(_.langs("assessment","writeReason"))+'"></textarea>\n\t</div>\n\t<div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-blue btn-sure">'+__e(_.langs("common","submit"))+'</span>\n\t\t<span class="btn btn-small btn-white btn-cancel">'+__e(_.langs("common","cancel"))+"</spam>\n\t</div>\n</div>";return __p},this.JST["natureDialog/thirdRate/index-page"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="module-dialog" style="width:'+__e(width)+"px;height:"+__e(height)+'px;overflow:hidden">\n\t<a class="dialog-btn dialog-close "></a>\n\t<div class="dialog_header">\n\t\t'+__e(title)+'\n\t</div>\n\t<div class="dialog_body" style="height:'+__e(inHeight)+'px;">\n\t\t<ul class="feedperson-form">\n\t\t\t<li class="form-item">\n\t\t\t\t<span class="item_label fleft">'+__e(i18n.appriUser)+'</span>\n\t\t\t\t<span class="item_content input-appraiser input-text new-input-appraiser">\n\t\t\t\t\t<span class="add-person"><span></span></span>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="form-item">\n\t\t\t<span class="item_label fleft">'+__e(i18n.appriContent)+'</span>\n\t\t\t<span class="item_content">\n\t\t\t\t<div class="list-body app-content">\n\t\t\t\t\t<ul class="list_data">\n\t\t\t\t\t',_.each(moduleList,function(a,b){__p+='\n\t\t\t\t\t\t<li>\n\t\t\t\t\t\t  <div class="title">\n\t\t\t\t\t\t  \t \n\t\t\t\t\t\t\t\t<span class="checkbox checkbox_uncheck" data-id=\''+__e(a.Id)+"' data-parent='true'>\n\t\t\t\t\t\t\t\t</span>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t  \t "+__e(a.Name)+'\n\t\t\t\t\t\t  </div>\n\t\t\t\t\t\t  <ul data-id="'+__e(a.Id)+'" class="list_item_back">\n\t\t\t\t\t\t\t',_.each(a.GoalList,function(a,b){__p+='\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t<li>\n\t\t\t\t\t\t\t\t\t<span class="checkbox checkbox_uncheck" data-id=\''+__e(a.Id)+"' data-type='0' data-parent='false'></span>\n\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t\t"+__e(a.Name)+"\n\t\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t\t\n\t\t\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t\t  </ul>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+='\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="form-item">\n\t\t\t\t<span class="item_label fleft">'+__e(i18n.emailContext)+'</span>\n\t\t\t\t<span class="form-content item_content disinblock">\n\t\t\t\t\t<textarea>'+__e(i18n.formateEmailContent(userName))+'</textarea>\n\t\t\t\t\t<span class="str-len">0/200</span>\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="form-item">\n\t\t\t\t<span class="item_label fleft">'+__e(i18n.isRate)+'</span>\n\t\t\t\t<span class="item_content off6-0">\n\t\t\t\t\t<span class="checkbox '+__e(1===fieldValue.IsScore?"checkbox_checked":"checkbox_uncheck")+' isScore" data-value="1"></span>\n\t\t\t\t\t'+__e(i18n.isRateTip)+'\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t\t<li class="form-item clearfix">\n\t\t\t\t<span class="item_label fleft">'+__e(i18n.isShowType)+'</span>\n\t\t\t\t<span class="item_content off6-0">\n\t\t\t\t<span class="radio '+__e(1==fieldValue.IsShow?"radio_checked":"radio_uncheck")+' isShow" data-value="1"></span>\n\t\t\t\t\t'+__e(i18n.anonymousApprise)+'\n\t\t\t\t<span class="radio '+__e(0==fieldValue.IsShow?"radio_checked":"radio_uncheck")+' isShow" data-value="0"></span>\n\t\t\t\t\t'+__e(i18n.realApprise)+'\n\t\t\t\t<span class="radio '+__e(2==fieldValue.IsShow?"radio_checked":"radio_uncheck")+' isShow" data-value="2"></span>\n\t\t\t\t\t'+__e(i18n.evaluatedPersonAnonymousApprise)+'\n\t\t\t\t</span>\n\t\t\t</li>\n\t\t</ul>\n\t</div><div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-blue btn-sure">'+__e(yesText)+'</span>\n\t\t<span class="btn btn-small btn-white btn-cancel ">'+__e(noText)+"</span>\n\t</div>\n</div>";return __p},this.JST["natureDialog/transmit/index-page"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="module-dialog" style="width:300px;height:176px;">\n\t<div class="dialog_body transmit-dialog" style="height:130px;">\n\t\t<span class="ico ico_asking">'+__e(_.langs("assessment","askingtransmitother"))+'</span>\n\t\t<input type="text" class="other-user"/>\n\t</div>\n\t<div class="dialog_operation">\n\t\t<span class="btn btn-small  btn-blue btn-sure">'+__e(_.langs("common","submit"))+'</span>\n\t\t<span class="btn btn-small btn-white btn-cancel">'+__e(_.langs("common","cancel"))+"</span>\n\t</div>\n</div>";return __p},this.JST}),define("titaDatePicker",["talent","$.tipsy","moment"],function(talent,Ttipsy,moment){function TipDialogView(a,b,c){var c=c||{},d=Talent._.extend({},c,{autoHide:!0,className:c.className||"warn"});d.skin&&"skin2"==d.skin&&(d.showClosed=!0,d.minWidth="400",d.maxWidth="400");var e=c.container||Talent.$("body");if(window.tipView&&window.tipView.close(),window.tipView=new TDialogView({type:"tipsy",skin:d.skin||"",showClosed:d.showClosed,maxWidth:d.maxWidth||"",minWidth:d.minWidth||50,zindex:d.zindex||1001}),d.skin&&"skin2"==d.skin){var f=/[^\x00-\xff]/g;b.replace(f,"**").length<47&&d.skin&&"skin2"==d.skin&&window.tipView.$el.css("text-align","center")}return e.append(window.tipView.render().el),tipView.show(a,b,d),tipView}function ConfirmDialogView(a,b,c){var c=c||{},d=c.container||Talent.$("body"),e=(TDialogView.instanceConfirm,Talent._.extend({},{autoHide:!1,cancel:!0,sure:!0,quirkTheme:!1,className:"ask",type:"tipsy",sureText:"确定",cancelText:"取消"},c));if(e.skin&&"skin2"==e.skin&&(e.minWidth="400",e.maxWidth="400"),window.dialogView&&window.dialogView.close(),window.dialogView=new TDialogView({type:e.type,skin:e.skin||"",cancel:e.cancel,sure:e.sure,sureText:e.sureText,cancelText:e.cancelText,maxWidth:e.maxWidth||"",minWidth:e.minWidth||50,zindex:e.zindex||1001}),e.skin&&"skin2"==e.skin){var f=/[^\x00-\xff]/g;b.replace(f,"**").length<47&&e.skin&&"skin2"==e.skin&&window.dialogView.$el.css("text-align","center")}return d.append(window.dialogView.render().el),Talent.$(document).off("mouseup.TT-Dialog-View-Confirm"),Talent.$(document).on("mouseup.TT-Dialog-View-Confirm",function(){Talent.$(document).off("mouseup.TT-Dialog-View-Confirm"),window.dialogView.close()}),window.dialogView.show(a,b,e),window.dialogView}var jst=function(){return this.JST=this.JST||{},this.JST["date-time-picker/date-time-cycle"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<h2>设置循环时间</h2>\n<div class="cycle_task_container">\n\t<div class="cycle_type_list" data-name="date-time-picker-tab">\n\t\t<ul>\n\t\t\t<li cyctype="2">\n\t\t\t\t<a href="javascript:void(0)" class="radio ',2==cycType&&(__p+="radio-checked"),__p+='"></a>\n\t\t\t\t<span>每个工作日</span>\n\t\t\t</li>\n\t\t\t<li cyctype="1">\n\t\t\t\t<a href="javascript:void(0)" class="radio ',1==cycType&&(__p+="radio-checked"),__p+='"></a>\n\t\t\t\t<span>每天</span>\n\t\t\t</li>\n\t\t\t<li cyctype="3">\n\t\t\t\t<a href="javascript:void(0)" class="radio ',3==cycType&&(__p+="radio-checked"),__p+='"></a>\n\t\t\t\t<span>每周</span>\n\t\t\t</li>\n\t\t\t<li cyctype="4">\n\t\t\t\t<a href="javascript:void(0)" class="radio ',4==cycType&&(__p+="radio-checked"),__p+='"></a>\n\t\t\t\t<span>每月</span>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n\t<div class="cycle_type_date">\n\t\t<div class="cycle_time clearfix">\n\t\t\t<span>开始时间</span>\n\t\t\t',3!=cycType&&4!=cycType||(__p+='\n\t\t\t\t<div class="day_time_nst first-col">\n\t\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycStartDayTxt)?"":__t)+'</label>\n\t\t\t\t\t<ul class="dayvalues_nst" data-name="date-time-dropdown">\n\t\t\t\t\t\t',_.each(dateData,function(a,b){__p+="\n\t\t\t\t\t\t\t<li ",cycStartDayTxt==a&&(__p+='class="cur_nst"'),__p+='>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" index="'+(null==(__t=b)?"":__t)+'" data-type="1">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t"),__p+='\n\t\t\t<div class="day_time_nst">\n\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycStartHour)?"":__t)+'</label>\n\t\t\t\t<ul class="dayvalues_nst"  data-name="date-time-dropdown">\n\t\t\t\t\t',_.each(hours,function(a){__p+="\n\t\t\t\t\t\t<li ",cycStartHour==a&&(__p+='class="cur_nst"'),__p+='>\n\t\t\t\t\t\t\t<a href="javascript:void(0)" hour="'+(null==(__t=a)?"":__t)+'" data-type="3">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+='\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<div class="date-time-colon">:</div>\n\t\t\t<div class="day_time_nst">\n\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycStartMinute)?"":__t)+'</label>\n\t\t\t\t<ul class="dayvalues_nst" data-name="date-time-dropdown">\n\t\t\t\t\t',_.each(minites,function(a){__p+="\n\t\t\t\t\t\t<li ",cycStartMinute==a&&(__p+='class="cur_nst"'),__p+='>\n\t\t\t\t\t\t\t<a href="javascript:void(0)" minite="'+(null==(__t=a)?"":__t)+'" data-type="5">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+='\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="cycle_time clearfix">\n\t\t\t<span>结束时间</span>\n\t\t\t',3!=cycType&&4!=cycType||(__p+='\n\t\t\t\t<div class="day_time_nst first-col">\n\t\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycEndDayTxt)?"":__t)+'</label>\n\t\t\t\t\t<ul class="dayvalues_nst" data-name="date-time-dropdown">\n\t\t\t\t\t\t',_.each(dateData,function(a,b){__p+="\n\t\t\t\t\t\t\t<li ",cycEndDayTxt==a&&(__p+='class="cur_nst"'),__p+='>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" index="'+(null==(__t=b)?"":__t)+'" data-type="2">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t"),__p+='\n\t\t\t<div class="day_time_nst">\n\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycEndHour)?"":__t)+'</label>\n\t\t\t\t<ul class="dayvalues_nst" data-name="date-time-dropdown">\n\t\t\t\t\t',_.each(hours,function(a){__p+="\n\t\t\t\t\t\t<li ",cycEndHour==a&&(__p+='class="cur_nst"'),__p+=' >\n\t\t\t\t\t\t\t<a href="javascript:void(0)" hour="'+(null==(__t=a)?"":__t)+'" data-type="4">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+='\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<div class="date-time-colon">:</div>\n\t\t\t<div class="day_time_nst">\n\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycEndMinute)?"":__t)+'</label>\n\t\t\t\t<ul class="dayvalues_nst" data-name="date-time-dropdown">\n\t\t\t\t\t',_.each(minites,function(a){__p+="\n\t\t\t\t\t\t<li ",cycEndMinute==a&&(__p+='class="cur_nst"'),__p+='>\n\t\t\t\t\t\t\t<a href="javascript:void(0)" minite="'+(null==(__t=a)?"":__t)+'" data-type="6">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+='\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n<div class="buttons clearfix">\n\t<a href="javascript:void(0)" class="btn btn-cancel reset-cycle" data-name="data-time-picker-reset-cycle">取消循环</a>\n\t<div class="right-part">\n\t\t<a href="javascript:void(0)" class="btn btn-sure" data-name="data-time-picker-sure-cycle">确定</a>\n\t\t<a href="javascript:void(0)" class="btn btn-cancel" data-name="data-time-picker-close-cycle">取消</a>\n\t</div>\n</div>';return __p},this.JST["date-time-picker/date-time-long"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="clearfix">\n\t<div class="date-long-left" data-name="date-time-long-date">\n\t</div>\n\t<div class="date-long-right">\n\t\t<div class="date-check" data-name="date-time-long-check">\n\t\t\t<span class="checkbox checkbox-checked" data-name="date-time-long-input"></span><span>长期</span>\n\t\t</div>\n\t</div>\n</div>\n<div class="buttons clearfix">\n\t<span class="btn btn-cancel cancel-long" data-name="date-time-long-candellong">取消长期</span>\n\t<span class="btn btn-cancel" data-name="date-time-long-candel">取消</span>\n\t<span class="btn btn-success" data-name="date-time-long-sure">确定</span>\n</div>';return __p},this.JST["date-time-picker/date-time-picker-tab"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n\t",isShowDateView&&(__p+='\n\t<li class="item-tab ',"date"==viewType&&(__p+="active"),__p+='" data-type="date">起止时间</li>\n\t'),__p+="\n\t",isShowCycleView&&(__p+='\n\t<li class="item-tab ',"cycle"==viewType&&(__p+="active"),__p+='" data-type="cycle" >循环时间</li>\n\t'),__p+="\n\t",isShowLongView&&(__p+='\n\t<li class="item-tab ',"long"==viewType&&(__p+="active"),__p+='" data-type="long" >长期</li>\n\t');return __p},this.JST["date-time-picker/date-time-picker"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="cont-box" data-name="date-time-picker-content"></div>';return __p},this.JST["tdialog/dialog"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="arrow"></div>\n',settings.showClosed&&(__p+='\n\t<span class="icon-dialog-closed closed_dialog"></span>\n'),__p+='\n<div class="content_dialog"></div>\n\n',0==settings.sure&&0==settings.cancel||(__p+='\n<div class="uibutton">\n\t',settings.sure&&(__p+='\n\t\t<a data-bypass href="'+(null==(__t=settings.sureLink?settings.sureLink:"javascript:void(0);")?"":__t)+'"   class="btn btn-sure sure_dialog">'+(null==(__t=settings.sureText)?"":__t)+"</a>\n\t\t"),__p+="\n\t",settings.cancel&&(__p+='\n\t<a href="javascript:void(0);" title="" class="btn btn-cancel cancel_dialog">'+(null==(__t=settings.cancelText)?"":__t)+"</a>\n\t"),__p+="\n</div>\n");return __p},this.JST}(),apiServer=BSGlobal.apiPath,Context={getGlobal:function(a){return BSGlobal[a]},changeHash:function(a,b,c){var d=decodeURIComponent(location.hash),e=d.split("?"),f=Context.parseUrl(d),g=[];if(url=null,c=1==c,"deleted"==b)for(var h=0,i=a.length;h<i;h++)delete f[a[h]];"add"==b&&(f=Talent._.extend({},f,a)),"eidt"==b&&(f=Talent._.extend({},f,a));for(var j in f)g.push(j+"="+f[j]);g.length?url=e[0]+"?"+g.join("&"):url=e[0],Talent.app.execute("history:navigate",url,c)},getLocalStorage:function(){if("object"==typeof localStorage)return localStorage;if("object"==typeof globalStorage)return globalStorage[location.host];throw new Error("local storage not available")},deleteGlobalProp:function(a){delete BSGlobal[a]},setGlobal:function(a,b){BSGlobal[a]=b},getTenantInfo:function(){return BSGlobal.tenantInfo},getUserInfo:function(){return BSGlobal.loginUserInfo},getStaticUrl:function(a){return"../../images/components/tita-widget/"+a},getApiUrl:function(a){var b=this.getUserInfo().Id,c=this.getTenantInfo().Id;return apiServer+"/api/v1/"+c+"/"+b+"/"+a},getApiUrlV2:function(a){var b=this.getUserInfo().Id,c=this.getTenantInfo().Id;return apiServer+"/api/v2/"+c+"/"+b+"/"+a},parseUrl:function(a){var b={};if(!a)return b;var c=a.indexOf("?");if(c>-1)for(var d=a.slice(c+1),e=d.split("&"),f=0;f<e.length;f++){var g=e[f].split("=");b[g[0]]=decodeURIComponent(g[1])}return b},getI18n:function(){var a={home_1:"动态",plan_1:"计划",work_1:"项目",document_1:"文件",workmate_1:"同事",app_1:"应用",task_1:"任务",task_2:"循环任务",schedule_1:"日程",share_1:"分享",sharing_1:"分享",follow_1:"立即关注",following_1:"正在关注",cancelfollow_1:"取消关注",myfollowmate_1:"我关注的",myfans_1:"我的粉丝",publishshare_1:"发分享",publishtask_1:"派任务",myfollowfeed_1:"与我相关",mypublishfeed_1:"我发表的",myleavefeed_1:"@我的",myreplayfeed_1:"回复我的",mycollectfeed_1:"我收藏的",myallfeed_1:"所有动态",message_1:"消息",remind_1:"提醒",myschedule_1:"我的日程",href_1:"常用链接",invitemate_1:"邀请同事",helpcenter_1:"帮助中心",onlineuser_1:"在线同事"},b={guide_1:"打开导览"};return BSGlobal&&BSGlobal.BSi18n?Talent._.extend({},BSGlobal.BSi18n,b):Talent._.extend({},a,b)},getAttachmentType:function(a){return{image:["jpg","png","gif","jpeg","JPG","PNG","GIF","JPEG"],file:["rar","zip","exe","pdf","txt","doc","docx","ppt","pptx","XLS","XLSX","RAR","ZIP","EXE","PDF","TXT","DOC","DOCX","PPT","PPTX","XLS","XLSX"],music:["mp3","wma","wav","flac","ape","ogg","aac","m4a","MP3","WMA","WAV","FLAC","APE","OGG","AAC","M4A"],video:["mp4","mkv","rm","rmvb","avi","3gp","flv","wmv","asf","mpeg","mpg","mov","ts","m4v"]}},getUploadOptions:function(a){var b=this.getGlobal("evn"),c=b&&"develop"==b?"tita-inc.com":"tita.com",d={validate:{format:[],onceLimt:20,allLimt:-1,nameLimt:-1},callbackName:"jsCallback",url:this.getApiUrl("Upload/PostFiles"),ajaxUrl:this.getApiUrl("Upload/PostFiles?format=json"),fileInputName:"file_upload",extendData:{domain:"document.domain="+c},error:{error_allLimt:"文件超出最大限度",error_format:"文件格式不合法",error_nameLimt:"名字长度不合格"},isPaste:!0,isDrag:!0,callbackValue:"parent._callback_"};return a&&(d=Talent._.extend({},d,a)),d},isAbsolutePath:function(){var a=this.getGlobal("titaHost")||"",b="http://"+location.host,c="";return c=a==b?"":a+"/u/"+this.getUserInfo().Id+"/Home",{host:a,webHost:c}},encodeScript:function(a){return 0==a.length?"":(s=a.replace(/</g,"&lt;"),s=s.replace(/>/g,"&gt;"),s)},dencodeScript:function(a){return 0==a.length?"":(s=a.replace(/&lt;/g,"<"),s=s.replace(/&gt;/g,">"),s)},formatDate:function(a){if(!a)return a;var b=moment().year(),c=a.split(" ");return moment(new Date(a)).year()==b&&(a=c[1]?moment(new Date(a)).format("M/D HH:mm"):moment(new Date(a)).format("M/D")),a},setPosition:function(a,b,c){var d={container:Talent.$("body"),pos:"bottom",leftBias:0,topBias:0,autoFrames:"body"},c=Talent._.extend({},d,c),e=c.container||Talent.$("body"),f=e.offset(),g=a.offset(),h=a.outerHeight(),i=a.outerWidth(),j=b.outerWidth(),k=b.outerHeight(),l={},m=g.top,n=g.left,o=m-f.top,p=n-f.left;switch(c.pos){case"top":l={top:o-k,left:p},"bottom";break;case"topCenter":l={top:o-k,left:p+i/2-j/2},"bottom";break;case"topRight":l={top:o-k,left:p+i-j},l.left<0&&(l.left=0),"bottom";break;case"bottom":l={top:o+h,left:p},"top";break;case"bottomCenter":l={top:o+h,left:p+i/2-j/2},"top";break;case"bottomRight":l={top:o+h,left:p+i-j},l.left<0&&(l.left=0),"top";break;case"left":l={top:o,left:p-j},"right";break;case"leftCenter":l={top:o+h/2-k/2,left:p-j},"right";break;case"leftBottom":l={top:o+h-k,left:p-j},"right";break;case"right":l={top:o,left:p+i},"left";break;case"rightCenter":l={top:o+h/2-k/2,left:p+i},"left";break;case"rightBottom":l={top:o+h-k,left:p+i},"left"}c.leftBias&&(l.left=l.left+c.leftBias),c.topBias&&(l.top=l.top+c.topBias);var q=Talent.$(window).height(),r=Talent.$(window).width(),s=Talent.$(document).scrollTop(),t=Talent.$(document).scrollLeft();if(f.top+l.top+k>q+s){var u=q+s-(f.top+l.top+k);l.top=l.top+u}if(f.top+l.top<s){var u=s-(f.top+l.top);l.top=l.top+u}if(f.left+l.left+j>r+t){var v=r+t-(f.left+l.left+j);l.left=l.left+v}if(f.left+l.left<t){var v=t-(f.left+l.left);l.left=l.left+v}b.css(l)},IsOpenYifangyun:function(){var a=Talent.Context.getGlobal("WebHead")||{},b=a.AppHead||[];return!!b.length&&!!_.findWhere(b,{AppId:"801"})},getUploadTipText:function(){return'<div style="text-align:left"><b style="display:block;font-size:14px;">支持拖拽上传<br>最多一次能上传20个</b>大小不超过20M</div>'},getAppHead:function(a){var b=this.getGlobal("WebHead");if(b){var c=b.AppHead||[],d=Talent._.findWhere(c,a);return d||null}}};_.TitaWidget_substring=function(a,b,c){if(!a)return"";for(var d=0,e="",f=/[^\x00-\xff]/g,g="",h=a.replace(f,"**").length,i=0;i<h&&(g=a.charAt(i).toString(),null!=g.match(f)?d+=2:d+=1,!(c&&h>b&&d+2>b))&&!(d>b);i++)e+=g;return c&&h>b&&(e+="…"),e},_.substring=function(a,b,c){if(!a)return"";for(var d=0,e="",f=/[^\x00-\xff]/g,g="",h=a.replace(f,"**").length,i=0;i<h&&(g=a.charAt(i).toString(),null!=g.match(f)?d+=2:d+=1,!(c&&h>b&&d+2>b))&&!(d>b);i++)e+=g;return c&&h>b&&(e+="…"),e},_.substringWithM=function(a,b,c){for(var d=0,e="",f=/[^\x00-\xff]/g,g="",h=a.replace(f,"**").length,i=0;i<h&&(g=a.charAt(i).toString(),null!=g.match(f)?d+=2:"m"==g||"w"==g?d+=2:d++,!(d>b));i++)e+=g;return c&&h>b&&(e+="…"),e},_.isStringBeyondLength=function(a,b){var c=/[^\x00-\xff]/g;return a.replace(c,"**").length>b},_.convertImage=function(a){var b="",a=a||{},c={className:"",size:30,shape:"radius",name:"",src:""};return a=_.extend({},c,a),a.bgColor?(50==a.size?a.subName=_.substring(a.name,6,!1):30==a.size?a.subName=_.substring(a.name,3,!1):64==a.size?a.subName=_.substring(a.name,6,!1):80==a.size&&(a.subName=_.substring(a.name,6,!1)),b=['<span class="',a.shape,"_img",a.size," ",a.className,'" style="background-color:',a.bgColor,';"  original-title="',a.name,'">',a.subName,"</span>"].join("")):b=['<img class="',a.shape,"_img",a.size," ",a.className,'" width="',a.size,'" height="',a.size,'" src="',a.src,'" original-title="',a.name,'" />'].join(""),b},_.TitaWidget_evaluation=function(a,b){var c={1:"tw-medal-grade-one-light",2:"tw-medal-grade-two-light",3:"tw-medal-grade-three-light"},d={1:"太棒了！",2:"干的不错！",3:"再接再厉！"},a=a||{},e={type:1,value:"",lvl:5,goal:2};a=_.extend({},e,a),a.value=parseInt(a.value),a.type=parseInt(a.type);var f=a.type;a.lvl||(a.lvl=5),a.goal||(a.goal=2);var g=["","",""];if(1==f){var h=Math.floor(a.value/a.goal);g=['<span class="evaluation-star-list">',"","</span>"];var i=0,j=Math.ceil(a.value/a.goal);h!=j&&(i=j);for(var k=1;k<=a.lvl;k++)g[1]+=k<=h?'<span class="icon-star-m-active"></span>':i==k?'<span class="icon-star-m-half-active"></span>':'<span class="icon-star-m-disabled"></span>';g[1]+='<div class="last-score"><span class="score-value">'+a.value+'</span><span class="value-unit">分</span></div>'}return 2==f&&(a.name&&"null"!=a.name||(a.name=d[a.value]),g[1]='<span class="result-'+[a.value]+'"><span class="'+c[a.value]+'"></span>'+a.name+"</span>"),'<span class="tt_evaluation">'+g.join("")+"</span>"};var supportT=function(){var a=document.body||document.documentElement,b=a.style;return void 0!==b.WebkitAnimation||void 0!==b.webkitAnimation||void 0!==b.MozAnimation||void 0!==b.OAnimation||void 0!==b.msAnimation||void 0!==b.animation}();_.animate=function(a,b,c,d,e){var b=b||"shake",c=c||"noraml",e=e||function(){};if(!supportT)return void e();"number"==typeof c?c*=100:c=""==c?300:{fast:200,normal:500,slow:1e3}[c]||500;var f=["UI_animated","UI_speed_"+c,"UI_ani_"+b];a.addClass(f.join(" "));setTimeout(function(){a.removeClass(f.join(" ")),e()},c)},_.privateTipText=function(a,b,c,d){var e=Context.getI18n(),f=b,g="仅相关人可见";if(f){if(d)switch(d){case 400:case 500:g="仅你和你上级可见";break;case 600:g="仅"+e.task_1+"成员可见"}else if(c)switch(c){case 3:g="仅团队成员可见";break;case 4:g="仅相关成员可见";break;case 8:4==a&&(g="仅共享者可见"),5==a&&(g="仅共享者可见");break;case 15:g="仅发起者的部门可见"}else{if(!a)return"仅自己可见";switch(a){case 1:g="仅@的人可见";break;case 20:g="仅"+e.task_1+"成员可见"}}return g}return"所有人可见"};var TDialogView=Talent.CompositeView.extend({template:jst["tdialog/dialog"],defaults:{id:"tdialog",type:"tipsy",arrowPos:"top",sure:!1,sureText:"确定",sureLink:"",cancel:!1,cancelText:"取消",arrow:1,minHeight:"37",minWidth:"50",maxWidth:"",fixed:!1,zindex:1001,quirkTheme:!1,showClosed:!1,skin:""},tagName:"div",className:"_tt_dialog",ui:{sure:".sure_dialog",sureText:".sure_dialog>span",cancel:".cancel_dialog",closed:".closed_dialog",dd:".ask_dialog"},events:function(){var a={};return a["click "+this.ui.sure]="onSureEvent",a["click "+this.ui.cancel]="onCancel",a["click "+this.ui.closed]="onCancel",a},initialize:function(){this.settings=Talent._.extend({},this.defaults,this.options),this.$el.attr("id",this.options.id),this.model.set({settings:this.settings}),this._init(),this.$el.on("mouseup",function(a){a.stopPropagation()}),"skin2"==this.settings.skin&&this.$el.addClass("tt-dialog-skin2")},_init:function(){var a={minWidth:this.settings.minWidth+"px",minHeight:this.settings.minHeight+"px","z-index":this.settings.zindex,position:this.settings.fixed?"fixed":"absolute"};this.settings.maxWidth&&""!=this.settings.maxWidth&&(a.maxWidth=this.settings.maxWidth+"px"),this.$el.css(a)},onSureEvent:function(a){var b=$(a.currentTarget);if($("#tdialog_mask").remove(),"function"==typeof this.settings.sure){if(void 0!=this.activeNode&&null!=this.activeNode){if(0==this.settings.sure(b))return}else this.settings.sure();this.close()}},onCancel:function(a){var b=$(a.currentTarget);this.trigger("hide",b),$("#tdialog_mask").remove(),"function"==typeof this.settings.cancel&&this.settings.cancel(b),this.close()},show:function(a,b,c){var d={className:"none",autoHide:!1,pos:"bottom",x:0,y:0,topBias:0,leftBias:0,arrowBias:0,zindex:999,autoFrames:"window",container:"",arrow:!1},e=Talent._.extend({},d,c);if("tipsy"==this.settings.type){var f=Talent.$('<div class="tipsy_dialog '+e.className+'_dialog"><b class="ico"></b><span class="content"></span></div>');f.append(b),this.$el.find(".content_dialog").empty().append(f)}else this.$el.find(".content_dialog").empty().append(b);if(this.settings.skin&&"skin2"==this.settings.skin){var g=/[^\x00-\xff]/g;b.replace(g,"**").length<47&&this.settings.skin&&"skin2"==this.settings.skin&&this.$el.css("text-align","center")}this.settings.quirkTheme&&(this.$el.find(".sure_dialog").removeClass("btn-sure").addClass("btn-cancel"),this.$el.find(".cancel_dialog").removeClass("btn-cancel").addClass("btn-sure")),a?this._showHere(a,e):($("body").append('<div class="mask" id="tdialog_mask"></div'),this.$el.css({top:"300px",left:"50%","margin-left":"-"+this.$el.width()/2})),this._autoHide(e),this.$el.show(),Talent._.animate(this.$el,"fadeInDown",3),this.$el.find(".content_dialog").off("click")},hide:function(){this.close()},setOptions:function(a){this.settings=Talent._.extend({},this.settings,a),this.model.set({settings:this.settings}),this.render()},onRender:function(){var a=this;this.$el.on("click",function(b){a.trigger("click"),b.stopPropagation()})},_stopMouseUpHandler:function(a){a.stopPropagation()},_autoHide:function(a){var b=this;1==a.autoHide&&setTimeout(function(){$("#tdialog_mask").remove(),b.trigger("hide"),b.close()},1500),"number"==typeof a.autoHide&&setTimeout(function(){b.trigger("hide"),b.close()},a.autoHide)},_showHere:function(a,b){this.activeNode=a||null;var c=b.container||Talent.$("body"),d=c.offset(),e=Talent.$("body").scrollTop(),f=Talent.$("body").scrollLeft(),g=a.offset(),h=a.outerHeight(),i=a.outerWidth(),j=b.width?b.width:this.$el.outerWidth(),k=b.height?b.height:this.$el.outerHeight(),l={},m={},n="",o=b.domOffTop?b.domOffTop:g.top,p=g.left,q=o-d.top,r=p-d.left;switch(b.pos){case"top":l={top:q-k-8,left:r},m={left:0},n="bottom";break;case"topCenter":l={top:q-k-8,left:r+i/2-j/2},m={left:j/2-8},n="bottom";break;case"topRight":l={top:q-k-8,left:r+i-j},l.left<0&&(l.left=0),m={left:j-16},n="bottom";break;case"bottom":l={top:q+h+8,left:r},m={left:0},n="top";break;case"bottomCenter":l={top:q+h+8,left:r+i/2-j/2},m={left:j/2-8},n="top";break;case"bottomRight":l={top:q+h+8,left:r+i-j},l.left<0&&(l.left=0),m={left:j-16},n="top";break;case"left":l={top:q,left:r-j},m={top:0},n="right";break;case"leftCenter":l={top:q+h/2-k/2,left:r-j},m={top:k/2-8},n="right";break;case"leftBottom":l={top:q+h-k,left:r-j},m={top:k-16},n="right";break;case"right":l={top:q,left:r+i},m={top:0},n="left";break;case"rightCenter":l={top:q+h/2-k/2,left:r+i},m={top:k/2-8},n="left";break;case"rightBottom":l={top:q+h-k,left:r+i},m={top:k-16},n="left"}b.leftBias&&(l.left=l.left+b.leftBias),b.topBias&&(l.top=l.top+b.topBias);var s=Talent.$(window).height(),t=Talent.$(window).width(),e=Talent.$(document).scrollTop(),f=Talent.$(document).scrollLeft();if(d.top+l.top+k>s+e){var u=s+e-(d.top+l.top+k);l.top=l.top+u}if(d.top+l.top<e){var u=e-(d.top+l.top);l.top=l.top+u}if(d.left+l.left+j>t+f){var v=t+f-(d.left+l.left+j);l.left=l.left+v}if(d.left+l.left<f){var v=f-(d.left+l.left);l.left=l.left+v}this.$el.css(l);var w=this.$el.find(".arrow");!1===b.arrow&&w.hide(),w.addClass(n),2===b.arrow&&("top"===n||"bottom"===n?w.addClass("arrow2"):w.addClass("horizontal_arrow2")),w.css(m)},onClose:function(){this.$el.find(".content_dialog").off("click")},changeSubmitBtn:function(a){1==a?(this.ui.sureText.text("确定"),this.ui.sure.removeClass("success_submint").removeClass("loading_submint")):2==a?(this.ui.sureText.text(""),this.ui.sure.removeClass("success_submint"),this.ui.sure.addClass("loading_submint")):(this.ui.sureText.text(""),this.ui.sure.removeClass("loading_submint"),this.ui.sure.addClass("success_submint"))}}),zh_cn=moment.defineLocale("zh-cn",{months:"一月_二月_三月_四月_五月_六月_七月_八月_九月_十月_十一月_十二月".split("_"),monthsShort:"1月_2月_3月_4月_5月_6月_7月_8月_9月_10月_11月_12月".split("_"),weekdays:"星期日_星期一_星期二_星期三_星期四_星期五_星期六".split("_"),weekdaysShort:"周日_周一_周二_周三_周四_周五_周六".split("_"),weekdaysMin:"日_一_二_三_四_五_六".split("_"),longDateFormat:{LT:"Ah点mm分",LTS:"Ah点m分s秒",L:"YYYY-MM-DD",LL:"YYYY年MMMD日",LLL:"YYYY年MMMD日LT",LLLL:"YYYY年MMMD日ddddLT",l:"YYYY-MM-DD",ll:"YYYY年MMMD日",lll:"YYYY年MMMD日LT",llll:"YYYY年MMMD日ddddLT"},meridiemParse:/凌晨|早上|上午|中午|下午|晚上/,meridiemHour:function(a,b){return 12===a&&(a=0),"凌晨"===b||"早上"===b||"上午"===b?a:"下午"===b||"晚上"===b?a+12:a>=11?a:a+12},meridiem:function(a,b,c){var d=100*a+b;return d<600?"凌晨":d<900?"早上":d<1130?"上午":d<1230?"中午":d<1800?"下午":"晚上"},calendar:{sameDay:function(){return 0===this.minutes()?"[今天]Ah[点整]":"[今天]LT"},nextDay:function(){return 0===this.minutes()?"[明天]Ah[点整]":"[明天]LT"},lastDay:function(){return 0===this.minutes()?"[昨天]Ah[点整]":"[昨天]LT"},nextWeek:function(){var a,b;return a=moment().startOf("week"),b=this.unix()-a.unix()>=604800?"[下]":"[本]",0===this.minutes()?b+"dddAh点整":b+"dddAh点mm"},lastWeek:function(){var a,b;return a=moment().startOf("week"),b=this.unix()<a.unix()?"[上]":"[本]",0===this.minutes()?b+"dddAh点整":b+"dddAh点mm"},sameElse:"LL"},ordinalParse:/\d{1,2}(日|月|周)/,ordinal:function(a,b){switch(b){case"d":case"D":case"DDD":return a+"日";case"M":return a+"月";case"w":case"W":return a+"周";default:return a}},relativeTime:{future:"%s内",past:"%s前",s:"几秒",m:"1 分钟",mm:"%d 分钟",h:"1 小时",hh:"%d 小时",d:"1 天",dd:"%d 天",M:"1 个月",MM:"%d 个月",y:"1 年",yy:"%d 年"},week:{dow:1,doy:4}}),DateRangePicker=function(a,b,c){this.parentEl="body",this.element=$(a),this.isShowing=!1,"object"==typeof b&&null!==b||(b={}),this.parentEl="object"==typeof b&&b.parentEl&&$(b.parentEl).length?$(b.parentEl):$(this.parentEl),this.container=$('<div class="daterangepicker dropdown-menu"><div class="calendar first left"></div><div class="calendar second right"></div><div class="ranges"><div class="range_inputs"><div class="daterangepicker_start_input"><label for="daterangepicker_start"></label><input class="input-mini" type="text" name="daterangepicker_start" value=""  disabled="disabled" /></div><div class="daterangepicker_end_input"><label for="daterangepicker_end"></label><input class="input-mini" type="text" name="daterangepicker_end" value=""  disabled="disabled" /></div><button class="applyBtn" disabled="disabled" type="button"></button>&nbsp;<button class="cancelBtn" type="button"></button></div></div></div>').appendTo(this.parentEl),b=$.extend(this.element.data(),b),this.setOptions(b,c),this.container.find(".calendar").on("click.daterangepicker",".prev",$.proxy(this.clickPrev,this)).on("click.daterangepicker",".next",$.proxy(this.clickNext,this)).on("click.daterangepicker","td.available",$.proxy(this.clickDate,this)).on("mouseenter.daterangepicker","td.available",$.proxy(this.hoverDate,this)).on("mouseleave.daterangepicker","td.available",$.proxy(this.updateFormInputs,this)).on("change.daterangepicker","select.yearselect",$.proxy(this.updateMonthYear,this)).on("change.daterangepicker","select.monthselect",$.proxy(this.updateMonthYear,this)).on("change.daterangepicker","select.hourselect,select.minuteselect,select.secondselect,select.ampmselect",$.proxy(this.updateTime,this)),this.container.find(".ranges").on("click.daterangepicker","button.applyBtn",$.proxy(this.clickApply,this)).on("click.daterangepicker","button.cancelBtn",$.proxy(this.clickCancel,this)).on("click.daterangepicker",".daterangepicker_start_input,.daterangepicker_end_input",$.proxy(this.showCalendars,this)).on("change.daterangepicker",".daterangepicker_start_input,.daterangepicker_end_input",$.proxy(this.inputsChanged,this)).on("keydown.daterangepicker",".daterangepicker_start_input,.daterangepicker_end_input",$.proxy(this.inputsKeydown,this)).on("click.daterangepicker","li",$.proxy(this.clickRange,this)).on("mouseenter.daterangepicker","li",$.proxy(this.enterRange,this)).on("mouseleave.daterangepicker","li",$.proxy(this.updateFormInputs,this)),this.element.is("input")?this.element.on({"click.daterangepicker":$.proxy(this.show,this),"focus.daterangepicker":$.proxy(this.show,this),"keyup.daterangepicker":$.proxy(this.updateFromControl,this),"keydown.daterangepicker":$.proxy(this.keydown,this)}):this.element.on("click.daterangepicker",$.proxy(this.toggle,this))};DateRangePicker.prototype={constructor:DateRangePicker,setOptions:function(a,b){if(this.startDate=moment().startOf("day"),this.endDate=moment().endOf("day"),this.timeZone=moment().utcOffset(),this.minDate=!1,this.maxDate=!1,this.dateLimit=!1,this.showDropdowns=!1,this.showWeekNumbers=!1,this.timePicker=!1,this.timePickerSeconds=!1,this.timePickerIncrement=30,this.timePicker12Hour=!0,this.autoApply=!1,this.singleDatePicker=!1,this.ranges={},this.autoHide=!0,this.opens="right",this.element.hasClass("pull-right")&&(this.opens="left"),this.drops="down",this.element.hasClass("dropup")&&(this.drops="up"),this.buttonClasses=["btn","btn-small btn-sm"],this.applyClass="btn-success",this.cancelClass="btn-default",this.format="MM/DD/YYYY",this.separator=" - ",this.locale={applyLabel:"Apply",cancelLabel:"Cancel",fromLabel:"From",toLabel:"To",weekLabel:"W",customRangeLabel:"Custom Range",daysOfWeek:moment.weekdaysMin(),monthNames:moment.monthsShort(),firstDay:moment.localeData()._week.dow},this.cb=function(){},"string"==typeof a.format&&(this.format=a.format),"string"==typeof a.separator&&(this.separator=a.separator),"string"==typeof a.startDate&&(this.startDate=moment(a.startDate,this.format)),"string"==typeof a.endDate&&(this.endDate=moment(a.endDate,this.format)),"string"==typeof a.minDate&&(this.minDate=moment(a.minDate,this.format)),"string"==typeof a.maxDate&&(this.maxDate=moment(a.maxDate,this.format)),"object"==typeof a.startDate&&(this.startDate=moment(a.startDate)),"object"==typeof a.endDate&&(this.endDate=moment(a.endDate)),"object"==typeof a.minDate&&(this.minDate=moment(a.minDate)),"object"==typeof a.maxDate&&(this.maxDate=moment(a.maxDate)),"string"==typeof a.applyClass&&(this.applyClass=a.applyClass),"string"==typeof a.cancelClass&&(this.cancelClass=a.cancelClass),"object"==typeof a.dateLimit&&(this.dateLimit=a.dateLimit),"object"==typeof a.locale&&("object"==typeof a.locale.daysOfWeek&&(this.locale.daysOfWeek=a.locale.daysOfWeek.slice()),"object"==typeof a.locale.monthNames&&(this.locale.monthNames=a.locale.monthNames.slice()),"number"==typeof a.locale.firstDay&&(this.locale.firstDay=a.locale.firstDay),"string"==typeof a.locale.applyLabel&&(this.locale.applyLabel=a.locale.applyLabel),"string"==typeof a.locale.cancelLabel&&(this.locale.cancelLabel=a.locale.cancelLabel),"string"==typeof a.locale.fromLabel&&(this.locale.fromLabel=a.locale.fromLabel),"string"==typeof a.locale.toLabel&&(this.locale.toLabel=a.locale.toLabel),"string"==typeof a.locale.weekLabel&&(this.locale.weekLabel=a.locale.weekLabel),"string"==typeof a.locale.customRangeLabel&&(this.locale.customRangeLabel=a.locale.customRangeLabel)),"string"==typeof a.opens&&(this.opens=a.opens),"string"==typeof a.drops&&(this.drops=a.drops),"boolean"==typeof a.showWeekNumbers&&(this.showWeekNumbers=a.showWeekNumbers),"string"==typeof a.buttonClasses&&(this.buttonClasses=[a.buttonClasses]),"object"==typeof a.buttonClasses&&(this.buttonClasses=a.buttonClasses),"boolean"==typeof a.showDropdowns&&(this.showDropdowns=a.showDropdowns),"boolean"==typeof a.singleDatePicker&&(this.singleDatePicker=a.singleDatePicker,this.singleDatePicker&&(this.endDate=this.startDate.clone())),"boolean"==typeof a.timePicker&&(this.timePicker=a.timePicker),"boolean"==typeof a.timePickerSeconds&&(this.timePickerSeconds=a.timePickerSeconds),"number"==typeof a.timePickerIncrement&&(this.timePickerIncrement=a.timePickerIncrement),"boolean"==typeof a.timePicker12Hour&&(this.timePicker12Hour=a.timePicker12Hour),"boolean"==typeof a.autoApply&&(this.autoApply=a.autoApply,this.autoApply&&this.container.find(".applyBtn, .cancelBtn").addClass("hide")),"boolean"==typeof a.autoHide&&(this.autoHide=a.autoHide),0!=this.locale.firstDay)for(var c=this.locale.firstDay;c>0;)this.locale.daysOfWeek.push(this.locale.daysOfWeek.shift()),c--;var d,e,f;if(void 0===a.startDate&&void 0===a.endDate&&$(this.element).is("input[type=text]")){var g=$(this.element).val(),h=g.split(this.separator);d=e=null,2==h.length?(d=moment(h[0],this.format),e=moment(h[1],this.format)):this.singleDatePicker&&""!==g&&(d=moment(g,this.format),e=moment(g,this.format)),null!==d&&null!==e&&(this.startDate=d,this.endDate=e)}if("string"==typeof a.timeZone||"number"==typeof a.timeZone?("string"==typeof a.timeZone&&void 0!==moment.tz?this.timeZone=-1*moment.tz.zone(a.timeZone).parse(new Date):this.timeZone=a.timeZone,this.startDate.utcOffset(this.timeZone),this.endDate.utcOffset(this.timeZone)):this.timeZone=moment(this.startDate).utcOffset(),"object"==typeof a.ranges){for(f in a.ranges)d="string"==typeof a.ranges[f][0]?moment(a.ranges[f][0],this.format):moment(a.ranges[f][0]),e="string"==typeof a.ranges[f][1]?moment(a.ranges[f][1],this.format):moment(a.ranges[f][1]),this.minDate&&d.isBefore(this.minDate)&&(d=moment(this.minDate)),this.maxDate&&e.isAfter(this.maxDate)&&(e=moment(this.maxDate)),this.minDate&&e.isBefore(this.minDate)||this.maxDate&&d.isAfter(this.maxDate)||(this.ranges[f]=[d,e]);var i="<ul>";for(f in this.ranges)i+="<li>"+f+"</li>";i+="<li>"+this.locale.customRangeLabel+"</li>",i+="</ul>",this.container.find(".ranges ul").remove(),this.container.find(".ranges").prepend(i)}if("function"==typeof b&&(this.cb=b),this.timePicker||(this.startDate=this.startDate.startOf("day"),this.endDate=this.endDate.endOf("day")),this.singleDatePicker?(this.opens=this.opens||"right",this.container.addClass("single"),this.container.find(".calendar.right").show(),this.container.find(".calendar.left").hide(),this.timePicker?this.container.find(".ranges .daterangepicker_start_input, .ranges .daterangepicker_end_input").hide():this.container.find(".ranges").hide(),this.container.find(".calendar.right").hasClass("single")||this.container.find(".calendar.right").addClass("single")):(this.container.removeClass("single"),this.container.find(".calendar.right").removeClass("single"),this.container.find(".calendar.left").show(),this.container.find(".ranges").show()),this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.oldChosenLabel=this.chosenLabel,this.leftCalendar={month:moment([this.startDate.year(),this.startDate.month(),1,this.startDate.hour(),this.startDate.minute(),this.startDate.second()]),calendar:[]},this.rightCalendar={month:moment([this.endDate.year(),this.endDate.month(),1,this.endDate.hour(),this.endDate.minute(),this.endDate.second()]),calendar:[]},"right"==this.opens||"center"==this.opens){var j=this.container.find(".calendar.first"),k=this.container.find(".calendar.second");k.hasClass("single")&&(k.removeClass("single"),j.addClass("single")),j.removeClass("left").addClass("right"),k.removeClass("right").addClass("left"),this.singleDatePicker&&(j.show(),k.hide())}void 0!==a.ranges||this.singleDatePicker||this.container.addClass("show-calendar"),this.autoHide?this.container.removeClass("opensleft opensright").addClass("opens"+this.opens):this.container.removeClass("opensleft opensright openscenter").addClass("open"),this.updateView(),this.updateCalendars();var l=this.container;$.each(this.buttonClasses,function(a,b){l.find("button").addClass(b)}),this.container.find(".daterangepicker_start_input label").html(this.locale.fromLabel),this.container.find(".daterangepicker_end_input label").html(this.locale.toLabel),this.applyClass.length&&this.container.find(".applyBtn").addClass(this.applyClass),this.cancelClass.length&&this.container.find(".cancelBtn").addClass(this.cancelClass),this.container.find(".applyBtn").html(this.locale.applyLabel),this.container.find(".cancelBtn").html(this.locale.cancelLabel)},setStartDate:function(a){"string"==typeof a&&(this.startDate=moment(a,this.format).utcOffset(this.timeZone)),"object"==typeof a&&(this.startDate=moment(a)),this.timePicker||(this.startDate=this.startDate.startOf("day")),this.oldStartDate=this.startDate.clone(),this.updateView(),this.updateCalendars(),this.updateInputText()},setEndDate:function(a){"string"==typeof a&&(this.endDate=moment(a,this.format).utcOffset(this.timeZone)),"object"==typeof a&&(this.endDate=moment(a)),this.timePicker||(this.endDate=this.endDate.endOf("day")),this.oldEndDate=this.endDate.clone(),this.updateView(),this.updateCalendars(),this.updateInputText()},updateView:function(){this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year()).hour(this.startDate.hour()).minute(this.startDate.minute()),this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year()).hour(this.endDate.hour()).minute(this.endDate.minute()),this.updateFormInputs()},updateFormInputs:function(){this.container.find("input[name=daterangepicker_start]").val(this.startDate.format(this.format)),this.container.find("input[name=daterangepicker_end]").val(this.endDate.format(this.format)),this.startDate.isSame(this.endDate)||this.startDate.isBefore(this.endDate)?this.container.find("button.applyBtn").removeAttr("disabled"):this.container.find("button.applyBtn").attr("disabled","disabled")},updateFromControl:function(){if(this.element.is("input")&&this.element.val().length){var a=this.element.val().split(this.separator),b=null,c=null;2===a.length&&(b=moment(a[0],this.format).utcOffset(this.timeZone),c=moment(a[1],this.format).utcOffset(this.timeZone)),(this.singleDatePicker||null===b||null===c)&&(b=moment(this.element.val(),this.format).utcOffset(this.timeZone),c=b),c.isBefore(b)||(this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.startDate=b,this.endDate=c,this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.notify(),this.updateCalendars())}},keydown:function(a){9!==a.keyCode&&13!==a.keyCode||this.hide()},notify:function(){this.updateView(),this.updateInputText(),this.cb(this.startDate,this.endDate,this.chosenLabel)},move:function(){var a,b={top:0,left:0},c=$(window).width();this.parentEl.is("body")||(b={top:this.parentEl.offset().top-this.parentEl.scrollTop(),left:this.parentEl.offset().left-this.parentEl.scrollLeft()},c=this.parentEl[0].clientWidth+this.parentEl.offset().left),a="up"==this.drops?this.element.offset().top-this.container.outerHeight()-b.top:this.element.offset().top+this.element.outerHeight()-b.top,this.container["up"==this.drops?"addClass":"removeClass"]("dropup"),"left"==this.opens?(this.container.css({top:a,right:c-this.element.offset().left-this.element.outerWidth(),left:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):"center"==this.opens?(this.container.css({top:a,left:this.element.offset().left-b.left+this.element.outerWidth()/2-this.container.outerWidth()/2,right:"auto"}),this.container.offset().left<0&&this.container.css({right:"auto",left:9})):(this.container.css({top:a,left:this.element.offset().left-b.left,right:"auto"}),this.container.offset().left+this.container.outerWidth()>$(window).width()&&this.container.css({left:"auto",right:0}))},toggle:function(a){this.autoHide&&(this.element.hasClass("active")?this.hide():this.show())},show:function(a){this.isShowing||(this.element.addClass("active"),this.container.show(),this.move(),this._outsideClickProxy=$.proxy(function(a){this.outsideClick(a)},this),$(document).on("mousedown.daterangepicker",this._outsideClickProxy).on("touchend.daterangepicker",this._outsideClickProxy).on("click.daterangepicker","[data-toggle=dropdown]",this._outsideClickProxy).on("focusin.daterangepicker",this._outsideClickProxy),this.isShowing=!0,this.element.trigger("show.daterangepicker",this))},outsideClick:function(a){var b=$(a.target);this.autoHide||"focusin"==a.type||b.closest(this.element).length||b.closest(this.container).length||b.closest(".calendar-date").length||this.hide()},hide:function(a){this.isShowing&&($(document).off(".daterangepicker"),this.element.removeClass("active"),this.container.hide(),this.startDate.isSame(this.oldStartDate)&&this.endDate.isSame(this.oldEndDate)||this.notify(),this.oldStartDate=this.startDate.clone(),this.oldEndDate=this.endDate.clone(),this.isShowing=!1,this.element.trigger("hide.daterangepicker",this))},enterRange:function(a){var b=a.target.innerHTML;if(b==this.locale.customRangeLabel)this.updateView();else{var c=this.ranges[b];this.container.find("input[name=daterangepicker_start]").val(c[0].format(this.format)),this.container.find("input[name=daterangepicker_end]").val(c[1].format(this.format))}},showCalendars:function(){this.container.addClass("show-calendar"),this.move(),this.element.trigger("showCalendar.daterangepicker",this)},hideCalendars:function(){this.container.removeClass("show-calendar"),this.element.trigger("hideCalendar.daterangepicker",this)},inputsChanged:function(a){var b=$(a.target),c=moment(b.val(),this.format);if(c.isValid()){var d,e;if("daterangepicker_start"===b.attr("name")){if(d=!1!==this.minDate&&c.isBefore(this.minDate)?this.minDate:c,e=this.endDate,"object"==typeof this.dateLimit){var f=moment(d).add(this.dateLimit).endOf("day");e.isAfter(f)&&(e=f)}}else if(d=this.startDate,e=!1!==this.maxDate&&c.isAfter(this.maxDate)?this.maxDate:c.endOf("day"),"object"==typeof this.dateLimit){var g=moment(e).subtract(this.dateLimit).startOf("day");d.isBefore(g)&&(d=g)}this.setCustomDates(d,e)}},inputsKeydown:function(a){13===a.keyCode&&(this.inputsChanged(a),this.notify())},updateInputText:function(){this.element.is("input")&&!this.singleDatePicker?(this.element.val(this.startDate.format(this.format)+this.separator+this.endDate.format(this.format)),this.element.trigger("change")):this.element.is("input")&&(this.element.val(this.endDate.format(this.format)),this.element.trigger("change"))},clickRange:function(a){var b=a.target.innerHTML;if(this.chosenLabel=b,b==this.locale.customRangeLabel)this.showCalendars();else{var c=this.ranges[b];this.startDate=c[0],this.endDate=c[1],this.timePicker||(this.startDate.startOf("day"),this.endDate.endOf("day")),this.leftCalendar.month.month(this.startDate.month()).year(this.startDate.year()).hour(this.startDate.hour()).minute(this.startDate.minute()),this.rightCalendar.month.month(this.endDate.month()).year(this.endDate.year()).hour(this.endDate.hour()).minute(this.endDate.minute()),this.updateCalendars(),this.updateInputText(),this.hideCalendars(),this.hide(),this.element.trigger("apply.daterangepicker",this),this.autoApply&&this.notify()}},clickPrev:function(a){$(a.target).parents(".calendar").hasClass("left")?this.leftCalendar.month.subtract(1,"month"):this.rightCalendar.month.subtract(1,"month"),this.updateCalendars()},clickNext:function(a){$(a.target).parents(".calendar").hasClass("left")?this.leftCalendar.month.add(1,"month"):this.rightCalendar.month.add(1,"month"),this.updateCalendars()},hoverDate:function(a){var b=$(a.target).attr("data-title"),c=b.substr(1,1),d=b.substr(3,1);$(a.target).parents(".calendar").hasClass("left")?this.container.find("input[name=daterangepicker_start]").val(this.leftCalendar.calendar[c][d].format(this.format)):this.container.find("input[name=daterangepicker_end]").val(this.rightCalendar.calendar[c][d].format(this.format))},setCustomDates:function(a,b){if(this.chosenLabel=this.locale.customRangeLabel,a.isAfter(b)){var c=this.endDate.diff(this.startDate);b=moment(a).add(c,"ms"),this.maxDate&&b.isAfter(this.maxDate)&&(b=this.maxDate.clone())}this.startDate=a,this.endDate=b,this.updateView(),this.updateCalendars(),this.autoApply&&(this.notify(),this.element.trigger("apply.daterangepicker",this))},clickDate:function(a){var b,c,d=$(a.target).attr("data-title"),e=d.substr(1,1),f=d.substr(3,1),g=$(a.target).parents(".calendar");if(g.hasClass("left")){if(b=this.leftCalendar.calendar[e][f],c=this.endDate,"object"==typeof this.dateLimit){var h=moment(b).add(this.dateLimit).endOf("day");c.isAfter(h)&&(c=h)}}else if(b=this.startDate,c=this.rightCalendar.calendar[e][f],"object"==typeof this.dateLimit){var i=moment(c).subtract(this.dateLimit).startOf("day");b.isBefore(i)&&(b=i)}this.singleDatePicker&&g.hasClass("left")?c=b.clone():this.singleDatePicker&&g.hasClass("right")&&(b=c.clone()),g.find("td").removeClass("active"),$(a.target).addClass("active"),this.setCustomDates(b,c),this.timePicker||c.endOf("day"),this.singleDatePicker&&!this.timePicker&&this.clickApply()},clickApply:function(a){this.updateInputText(),this.hide(),this.element.trigger("apply.daterangepicker",this)},clickCancel:function(a){this.startDate=this.oldStartDate,this.endDate=this.oldEndDate,this.chosenLabel=this.oldChosenLabel,this.updateView(),this.updateCalendars(),this.hide(),this.element.trigger("cancel.daterangepicker",this)},updateMonthYear:function(a){var b=$(a.target).closest(".calendar").hasClass("left"),c=b?"left":"right",d=this.container.find(".calendar."+c),e=parseInt(d.find(".monthselect").val(),10),f=d.find(".yearselect").val();b||this.singleDatePicker||(f<this.startDate.year()||f==this.startDate.year()&&e<this.startDate.month())&&(e=this.startDate.month(),f=this.startDate.year()),this.minDate&&(f<this.minDate.year()||f==this.minDate.year()&&e<this.minDate.month())&&(e=this.minDate.month(),f=this.minDate.year()),this.maxDate&&(f>this.maxDate.year()||f==this.maxDate.year()&&e>this.maxDate.month())&&(e=this.maxDate.month(),f=this.maxDate.year()),this[c+"Calendar"].month.month(e).year(f),this.updateCalendars()},updateTime:function(a){var b=$(a.target).closest(".calendar"),c=b.hasClass("left"),d=parseInt(b.find(".hourselect").val(),10),e=parseInt(b.find(".minuteselect").val(),10),f=0;if(this.timePickerSeconds&&(f=parseInt(b.find(".secondselect").val(),10)),this.timePicker12Hour){var g=b.find(".ampmselect").val();"PM"===g&&d<12&&(d+=12),"AM"===g&&12===d&&(d=0)}if(c){var h=this.startDate.clone();h.hour(d),h.minute(e),h.second(f),this.startDate=h,this.leftCalendar.month.hour(d).minute(e).second(f),this.singleDatePicker&&(this.endDate=h.clone())}else{var i=this.endDate.clone();i.hour(d),i.minute(e),i.second(f),this.endDate=i,this.singleDatePicker&&(this.startDate=i.clone()),this.rightCalendar.month.hour(d).minute(e).second(f)}this.updateView(),this.updateCalendars(),this.autoApply&&(this.notify(),this.element.trigger("apply.daterangepicker",this))},updateCalendars:function(){this.leftCalendar.calendar=this.buildCalendar(this.leftCalendar.month.month(),this.leftCalendar.month.year(),this.leftCalendar.month.hour(),this.leftCalendar.month.minute(),this.leftCalendar.month.second(),"left"),this.rightCalendar.calendar=this.buildCalendar(this.rightCalendar.month.month(),this.rightCalendar.month.year(),this.rightCalendar.month.hour(),this.rightCalendar.month.minute(),this.rightCalendar.month.second(),"right"),this.container.find(".calendar.left").empty().html(this.renderCalendar(this.leftCalendar.calendar,this.startDate,this.minDate,this.maxDate,"left")),this.container.find(".calendar.right").empty().html(this.renderCalendar(this.rightCalendar.calendar,this.endDate,this.singleDatePicker?this.minDate:this.startDate,this.maxDate,"right")),this.container.find(".ranges li").removeClass("active");var a=!0,b=0;for(var c in this.ranges)this.timePicker?this.startDate.isSame(this.ranges[c][0])&&this.endDate.isSame(this.ranges[c][1])&&(a=!1,this.chosenLabel=this.container.find(".ranges li:eq("+b+")").addClass("active").html()):this.startDate.format("YYYY-MM-DD")==this.ranges[c][0].format("YYYY-MM-DD")&&this.endDate.format("YYYY-MM-DD")==this.ranges[c][1].format("YYYY-MM-DD")&&(a=!1,this.chosenLabel=this.container.find(".ranges li:eq("+b+")").addClass("active").html()),b++;a&&(this.chosenLabel=this.container.find(".ranges li:last").addClass("active").html(),this.showCalendars())},buildCalendar:function(a,b,c,d,e,f){var g,h=moment([b,a]).daysInMonth(),i=moment([b,a,1]),j=moment([b,a,h]),k=moment(i).subtract(1,"month").month(),l=moment(i).subtract(1,"month").year(),m=moment([l,k]).daysInMonth(),n=i.day(),o=[];for(o.firstDay=i,o.lastDay=j,g=0;g<6;g++)o[g]=[];var p=m-n+this.locale.firstDay+1;p>m&&(p-=7),n==this.locale.firstDay&&(p=m-6);var q,r,s=moment([l,k,p,12,d,e]);for(g=0,q=0,r=0;g<42;g++,q++,s=moment(s).add(24,"hour"))g>0&&q%7==0&&(q=0,r++),o[r][q]=s.clone().hour(c),s.hour(12),this.minDate&&o[r][q].format("YYYY-MM-DD")==this.minDate.format("YYYY-MM-DD")&&o[r][q].isBefore(this.minDate)&&"left"==f&&(o[r][q]=this.minDate.clone()),this.maxDate&&o[r][q].format("YYYY-MM-DD")==this.maxDate.format("YYYY-MM-DD")&&o[r][q].isAfter(this.maxDate)&&"right"==f&&(o[r][q]=this.maxDate.clone());return o},renderDropdowns:function(a,b,c){for(var d=a.month(),e=a.year(),f=c&&c.year()||e+5,g=b&&b.year()||e-50,h='<select class="monthselect">',i=e==g,j=e==f,k=0;k<12;k++)(!i||k>=b.month())&&(!j||k<=c.month())&&(h+="<option value='"+k+"'"+(k===d?" selected='selected'":"")+">"+this.locale.monthNames[k]+"</option>");h+="</select>";for(var l='<select class="yearselect">',m=g;m<=f;m++)l+='<option value="'+m+'"'+(m===e?' selected="selected"':"")+">"+m+"</option>";return l+="</select>",h+l},renderCalendar:function(a,b,c,d,e){var f='<div class="calendar-date">';f+='<table class="table-condensed">',f+="<thead>",f+="<tr>",this.showWeekNumbers&&(f+="<th></th>"),!c||c.isBefore(a.firstDay)?f+='<th class="prev available"><i class="fa fa-arrow-left icon icon-arrow-left glyphicon glyphicon-arrow-left"></i></th>':f+="<th></th>";var g=this.locale.monthNames[a[1][1].month()]+a[1][1].format(" YYYY");this.showDropdowns&&(g=this.renderDropdowns(a[1][1],c,d)),f+='<th colspan="5" class="month">'+g+"</th>",!d||d.isAfter(a.lastDay)?f+='<th class="next available"><i class="fa fa-arrow-right icon icon-arrow-right glyphicon glyphicon-arrow-right"></i></th>':f+="<th></th>",f+="</tr>",f+="<tr>",this.showWeekNumbers&&(f+='<th class="week">'+this.locale.weekLabel+"</th>"),$.each(this.locale.daysOfWeek,function(a,b){f+="<th>"+b+"</th>"}),f+="</tr>",f+="</thead>",f+="<tbody>";for(var h=0;h<6;h++){f+="<tr>",this.showWeekNumbers&&(f+='<td class="week">'+a[h][0].week()+"</td>");for(var i=0;i<7;i++){var j="available ";j+=a[h][i].month()==a[1][1].month()?"":"off",a[h][i].isSame(new Date,"day")&&(j+=" today "),c&&a[h][i].isBefore(c,"day")||d&&a[h][i].isAfter(d,"day")?j=" off disabled ":a[h][i].format("YYYY-MM-DD")==b.format("YYYY-MM-DD")?(j+=" active ",a[h][i].format("YYYY-MM-DD")==this.startDate.format("YYYY-MM-DD")&&(j+=" start-date "),a[h][i].format("YYYY-MM-DD")==this.endDate.format("YYYY-MM-DD")&&(j+=" end-date ")):a[h][i]>=this.startDate&&a[h][i]<=this.endDate&&(j+=" in-range ",a[h][i].isSame(this.startDate)&&(j+=" start-date "),a[h][i].isSame(this.endDate)&&(j+=" end-date "));var k="r"+h+"c"+i;f+='<td class="'+j.replace(/\s+/g," ").replace(/^\s?(.*?)\s?$/,"$1")+'" data-title="'+k+'">'+a[h][i].date()+"</td>"}f+="</tr>"}f+="</tbody>",f+="</table>",f+="</div>";var l;if(this.timePicker){f+='<div class="calendar-time">',f+='<select class="hourselect">';var m=0,n=23;c&&("left"==e||this.singleDatePicker)&&b.format("YYYY-MM-DD")==c.format("YYYY-MM-DD")&&(m=c.hour(),b.hour()<m&&b.hour(m),this.timePicker12Hour&&m>=12&&b.hour()>=12&&(m-=12),this.timePicker12Hour&&12==m&&(m=1)),d&&("right"==e||this.singleDatePicker)&&b.format("YYYY-MM-DD")==d.format("YYYY-MM-DD")&&(n=d.hour(),b.hour()>n&&b.hour(n),this.timePicker12Hour&&n>=12&&b.hour()>=12&&(n-=12));var o=0,p=23,q=b.hour();for(this.timePicker12Hour&&(o=1,p=12,q>=12&&(q-=12),0===q&&(q=12)),l=o;l<=p;l++)f+=l==q?'<option value="'+l+'" selected="selected">'+l+"</option>":l<m||l>n?'<option value="'+l+'" disabled="disabled" class="disabled">'+l+"</option>":'<option value="'+l+'">'+l+"</option>";f+="</select> : ",f+='<select class="minuteselect">';var r=0,s=59;for(c&&("left"==e||this.singleDatePicker)&&b.format("YYYY-MM-DD h A")==c.format("YYYY-MM-DD h A")&&(r=c.minute(),b.minute()<r&&b.minute(r)),d&&("right"==e||this.singleDatePicker)&&b.format("YYYY-MM-DD h A")==d.format("YYYY-MM-DD h A")&&(s=d.minute(),b.minute()>s&&b.minute(s)),l=0;l<60;l+=this.timePickerIncrement){var t=l;t<10&&(t="0"+t),l==b.minute()?f+='<option value="'+l+'" selected="selected">'+t+"</option>":f+=l<r||l>s?'<option value="'+l+'" disabled="disabled" class="disabled">'+t+"</option>":'<option value="'+l+'">'+t+"</option>"}if(f+="</select> ",this.timePickerSeconds){for(f+=': <select class="secondselect">',l=0;l<60;l+=this.timePickerIncrement){var t=l;t<10&&(t="0"+t),l==b.second()?f+='<option value="'+l+'" selected="selected">'+t+"</option>":f+='<option value="'+l+'">'+t+"</option>"}f+="</select>"}if(this.timePicker12Hour){f+='<select class="ampmselect">';var u="",v="";c&&("left"==e||this.singleDatePicker)&&b.format("YYYY-MM-DD")==c.format("YYYY-MM-DD")&&c.hour()>=12&&(u=' disabled="disabled" class="disabled"'),d&&("right"==e||this.singleDatePicker)&&b.format("YYYY-MM-DD")==d.format("YYYY-MM-DD")&&d.hour()<12&&(v=' disabled="disabled" class="disabled"'),b.hour()>=12?f+='<option value="AM"'+u+'>AM</option><option value="PM" selected="selected"'+v+">PM</option>":f+='<option value="AM" selected="selected"'+u+'>AM</option><option value="PM"'+v+">PM</option>",f+="</select>"}f+="</div>"}return f},remove:function(){this.container.remove(),this.element.off(".daterangepicker"),this.element.removeData("daterangepicker")}},$.fn.daterangepicker=function(a,b){return this.each(function(){var c=$(this);c.data("daterangepicker")&&c.data("daterangepicker").remove(),c.data("daterangepicker",new DateRangePicker(c,a,b))}),this};var DateTimeCycleView=Talent.ItemView.extend({template:jst["date-time-picker/date-time-cycle"],className:"_cycle_tt_dialog",defaults:{isShowTip:!0},ui:{dateTimeSetBtn:'[data-name="date-time-set-btn"]',dateTimeDropDown:'[data-name="date-time-dropdown"]',dateTimeDropDownItem:'[data-name="date-time-dropdown"] a',cycleType:"div[data-name=date-time-picker-tab] li",sureBtn:'a[data-name="data-time-picker-sure-cycle"]',closeBtn:'a[data-name="data-time-picker-close-cycle"]',resetBtn:'a[data-name="data-time-picker-reset-cycle"]'},events:function(){var a={};return a["click "+this.ui.dateTimeSetBtn]="_showDataList",a["click "+this.ui.dateTimeDropDownItem]="_selectData",a["click "+this.ui.cycleType]="_changeCycleType",a["click "+this.ui.sureBtn]="_sureCycle",a["click "+this.ui.closeBtn]="_closeCycle",a["click "+this.ui.resetBtn]="_resetCycle",a},modelEvents:{change:"render"},templateHelpers:function(){var a=this._get24HourList(),b=this._getMiniteList(),c=this.model.get("cycType"),d=[];curEndDate="";return d=3==c?this.weekList:this.monthList,{hours:a,minites:b,dateData:d}},initialize:function(a){var b=this;this.settings=Talent._.extend({},this.defaults,a),this._initData(),this.$el.on("click",function(a){a.stopPropagation(),void 0===Talent.$(a.target).attr("data-name")&&b.ui.dateTimeDropDown.hide()})},onRender:function(){},_initData:function(){var a={cycType:2,cycStartDay:"",cycEndDay:"",cycStartHour:"08",cycStartMinute:"00",cycEndHour:"18",cycEndMinute:"00",cycStartDayTxt:"",cycEndDayTxt:""},b=this.model.toJSON();this.initData=Talent._.extend({},a,this.model.toJSON()),this.weekList=["周一","周二","周三","周四","周五","周六","周日"],this.monthList=this._getDateList();var c=b.cycType;3==c&&this.model.set({cycStartDayTxt:this.weekList[b.cycStartDay-1],cycEndDayTxt:this.weekList[b.cycEndDay-1]}),4==c&&(this.model.set({cycStartDayTxt:this.monthList[b.cycStartDay-1],cycEndDayTxt:this.monthList[b.cycEndDay-1]}),this.model.get("cycStartDay")||this.model.set("cycStartDay",moment().date()),this.model.get("cycEndDay")||this.model.set("cycEndDay",moment().date()))},_changeCycleType:function(a){var b=Talent.$(a.currentTarget),c=b.attr("cyctype"),d="",e="",f=this.initData,g=Talent._.indexOf;3==c?(e=this.weekList[moment().format("d")-1],d=g(this.weekList,e)+1):4==c&&(e=moment().format("DD"),d=_.indexOf(this.monthList,e)+1),c!=this.model.get("cycType")&&(this.model.set({cycType:c,cycStartHour:f.cycStartHour,cycStartMinute:f.cycStartMinute,cycEndHour:f.cycEndHour,cycEndMinute:f.cycEndMinute,cycStartDay:d,cycEndDay:d,cycStartDayTxt:e,cycEndDayTxt:e},{silent:!0}),this.render())},_resetCycle:function(a){var b=Talent.$(a.currentTarget);0==this.settings.isShowTip?(this.trigger("resetCycle",b),this.close()):this._showTip(b)},_showTip:function(a){var b=this;ConfirmDialogView(this.ui.resetBtn,"您确定取消此循环吗？此操作将不可恢复",{pos:"top",container:this.$el,sure:function(){b.model.set("isCycle",!1),b.trigger("resetCycle",a),b.close()},cancel:function(){b.trigger("cancel",a),b.close()}})},_sureCycle:function(a){var b=Talent.$(a.currentTarget);this._checkCycleDate()?(this.trigger("sureCycleDate",b),this.close()):this.model.set({cycStartDay:this.initData.cycStartDay,cycEndDay:this.initData.cycEndDay,cycStartHour:this.initData.cycStartHour,cycEndHour:this.initData.cycEndHour,cycStartMinute:this.initData.cycStartMinute,cycEndMinute:this.initData.cycEndMinute},{silent:!0})},_checkCycleDate:function(){var a=this.model.get("cycType"),b=this.model.get("cycStartDay"),c=this.model.get("cycEndDay"),d=this.model.get("cycStartHour"),e=this.model.get("cycEndHour"),f=this.model.get("cycStartMinute"),g=this.model.get("cycEndMinute"),h=d+":"+f,i=e+":"+g;return 1==a||2==a?!(i<h||i==h)||(TipDialogView(this.ui.sureBtn,"结束时间不能小于开始时间",{container:this.$el,pos:"topCenter"}),!1):3==a||4==a?b==c&&(i<h||i==h)?(TipDialogView(this.ui.sureBtn,"结束时间不能小于开始时间",{container:this.$el,pos:"topCenter"}),!1):!(b>c)||(TipDialogView(this.ui.sureBtn,"结束时间不能小于开始时间",{container:this.$el,pos:"topCenter"}),!1):void 0},_closeCycle:function(a){var b=Talent.$(a.currentTarget);this.trigger("cancel",b),this.close()},_selectData:function(a){this[["_changeStartDate","_changeEndDate","_changeStartHour","_changeEndHour","_changeStartMinute","_changeEndMinute"][this.$(a.currentTarget).attr("data-type")-1]](a)},_changeStartDate:function(a){var b=Talent.$(a.currentTarget),c=Number(b.attr("index")),d=this.model.get("cycType");if(3==d)var e=this.weekList;else if(4==d)var e=this.monthList;this.model.set({cycStartDay:Number(c)+1,cycStartDayTxt:e[c]})},_changeEndDate:function(a){var b=Talent.$(a.currentTarget),c=Number(b.attr("index")),d=this.model.get("cycType");if(3==d)var e=this.weekList;else if(4==d)var e=this.monthList;this.model.set({cycEndDay:Number(c)+1,cycEndDayTxt:e[c]})},_changeStartHour:function(a){var b=Talent.$(a.currentTarget),c=b.attr("hour");c!=this.model.get("cycStartHour")&&this.model.set("cycStartHour",c)},_changeEndHour:function(a){var b=Talent.$(a.currentTarget),c=b.attr("hour");c!=this.model.get("cycEndHour")&&this.model.set("cycEndHour",c)},_changeStartMinute:function(a){var b=Talent.$(a.currentTarget),c=b.attr("minite");c!=this.model.get("cycStartMinute")&&this.model.set("cycStartMinute",c)},_changeEndMinute:function(a){var b=Talent.$(a.currentTarget),c=b.attr("minite");c!=this.model.get("cycEndMinute")&&this.model.set("cycEndMinute",c)},_showDataList:function(a){var b=Talent.$(a.currentTarget);this.ui.dateTimeDropDown.hide(),b.parent().find(".dayvalues_nst").show()},_getDateList:function(){for(var a=[],b=1;b<=31;b++)b<10&&(b="0"+b),a.push(b.toString());return a},_get24HourList:function(){for(var a=[],b=0;b<=23;b++)b<10&&(b="0"+b),a.push(b);return a},_getMiniteList:function(){return miniteList=["00","05","10","15","20","25","30","35","40","45","50","55"]},onClose:function(){}}),DateTimePickerTabView=Talent.ItemView.extend({defaults:{isShowDateView:!0,isShowCycleView:!0,isShowLongView:!0},tagName:"ul",className:"tab-bar",template:jst["date-time-picker/date-time-picker-tab"],ui:{tabItem:"li"},templateHelpers:function(){return this.settings},modelEvents:{"change:viewType":"_changeTypeEvent"},events:function(){var a={};return a["click "+this.ui.tabItem]="_itemClickHandler",a},initialize:function(a){this.settings=Talent._.extend({},this.defaults,this.options)},_changeTypeEvent:function(){var a=this.model.get("viewType");this.ui.tabItem.removeClass("active"),this.$el.find("li[data-type="+a+"]").addClass("active")},_itemClickHandler:function(a){var b=Talent.$(a.currentTarget),c=b.attr("data-type");this.model.set({viewType:c}),this.model.set({isLongTerm:!1,isCycle:!1},{silent:!0}),"cycle"==c&&this.model.set({cycType:2})}}),DateView=Talent.Layout.extend({defaults:{rangepickerOptions:{timePicker:!0,format:"YYYY/MM/DD HH:mm",timePicker12Hour:!1,timePickerIncrement:5,startDate:moment().format("YYYY/MM/DD HH:mm")+"08:00",endDate:moment().format("YYYY/MM/DD HH:mm")+"18:00",minDate:"2013/01/01",showDropdowns:!0,autoHide:!1,opens:"left",locale:{applyLabel:"确定",cancelLabel:"取消",fromLabel:"开始时间",toLabel:"结束时间"}}},className:"date-container",template:Talent._.template('<div data-name="date-time-picker-date"/>'),ui:{content:"div[data-name=date-time-picker-content]"},regions:{content:"div[data-name=date-time-picker-content]"},modelEvents:{"change:startDate":"_changeStartDateHander","change:endDate":"_changeEndDateHander"},templateHelpers:function(){return{}},events:function(){var a={};return a["click "+this.ui.tabDate]="showDatePicker",a["click "+this.ui.tabCycle]="showCyclePicker",a},initialize:function(a){this.settings=Talent._.extend({},this.defaults,this.options),"object"==typeof this.options.rangepickerOptions&&(this.settings.rangepickerOptions=Talent._.extend({},this.defaults.rangepickerOptions,this.options.rangepickerOptions))},onRender:function(){},onShow:function(){this._renderDateView()},_renderDateView:function(){var a=this.ui.content,b=this,c=this.settings.rangepickerOptions;c.timePicker?(moment(new Date(this.model.get("startDate"))).hour()?c.startDate=this.model.get("startDate"):c.startDate=this.model.get("startDate")+"08:00",moment(new Date(this.model.get("endDate"))).hour()?c.endDate=this.model.get("endDate"):c.endDate=this.model.get("endDate")+"18:00"):(c.startDate=this.model.get("startDate"),c.endDate=this.model.get("endDate")),DateRangePicker.prototype.updateFormInputs=function(){var a=this.startDate.format(this.format),b=this.endDate.format(this.format);this.container.find("input[name=daterangepicker_start]").val(a),this.container.find("input[name=daterangepicker_end]").val(b);var c=this.container.find("button.applyBtn");(this.singleDatePicker&&this.startDate.isSame(this.endDate)||this.startDate.isBefore(this.endDate))&&c.removeAttr("disabled")},DateRangePicker.prototype.clickApply=function(){this.startDate.format(this.format),this.endDate.format(this.format);if(this.singleDatePicker&&this.startDate.isSame(this.endDate)||this.startDate.isBefore(this.endDate))this.updateInputText(),this.hide(),this.element.trigger("apply.daterangepicker",this);else{TipDialogView(this.container.find("button.applyBtn"),"结束时间不能早于或等于开始时间",{pos:"topCenter"})}},c.parentEl=this.$el.find("div[data-name=date-time-picker-date]"),this.$el.daterangepicker(c);this.$el.data("daterangepicker");this.$el.on("apply.daterangepicker",function(c,d){var e=b.settings.rangepickerOptions.format,f=moment(d.startDate).format(e),g=moment(d.endDate).format(e);b.model.set({startDate:f,endDate:g,isLongTerm:!1,cycType:0,isCycle:!1}),b.trigger("sure",a)}),this.$el.on("cancel.daterangepicker",function(){b.trigger("cancel",a)})},_changeStartDateHander:function(){this.$el.data("daterangepicker").setStartDate(this.model.get("startDate"))},_changeEndDateHander:function(){this.$el.data("daterangepicker").setEndDate(this.model.get("endDate"))},onClose:function(){}}),DateTimeLongView=Talent.Layout.extend({defaults:{rangepickerOptions:{parentEl:"div[data-name=date-time-long-date]",timePicker:!1,format:"YYYY/MM/DD",showDropdowns:!0,autoHide:!1,opens:"left",singleDatePicker:!0,locale:{applyLabel:"确定",cancelLabel:"取消",fromLabel:"开始时间",toLabel:"结束时间"}}},className:"date-long",template:jst["date-time-picker/date-time-long"],ui:{dateContent:"div[data-name=date-time-long-date]",checkout:"div[data-name=date-time-long-check]",buttonCandel:"[data-name=date-time-long-candel]",buttonSure:"[data-name=date-time-long-sure]",buttonCandelLong:"[data-name=date-time-long-candellong]",inputCheck:"[data-name=date-time-long-input]"},regions:{content:"div[data-name=date-time-picker-content]"},templateHelpers:function(){return{}},events:function(){var a={};return a["click "+this.ui.checkout]="_openLongHandler",a["click "+this.ui.buttonCandelLong]="_cancelLongHandler",a["click "+this.ui.buttonCandel]="_cancelHandler",a["click "+this.ui.buttonSure]="_sureHandler",a},initialize:function(a){this.settings=Talent._.extend({},this.defaults,this.options),"object"==typeof this.options.rangepickerOptions&&(this.settings.rangepickerOptions=Talent._.extend({},this.defaults.rangepickerOptions,this.options.rangepickerOptions)),this.settings.rangepickerOptions.timePicker=!1,this.startDate=this.model.get("startDate"),this.endDate=this.model.get("endDate")},onRender:function(){},onShow:function(){this._renderDateView()},_cancelHandler:function(a){var b=Talent.$(a.currentTarget);this.trigger("cancel",b)},_sureHandler:function(a){var b=Talent.$(a.currentTarget);this.model.set({startDate:this.startDate,endDate:this.endDate,isLongTerm:!0,cycType:0}),this.trigger("sure",b)},_cancelLongHandler:function(a){Talent.$(a.currentTarget);this.model.set("isLongTerm",!1),this.trigger("cancelLong")},_openLongHandler:function(a){var b=(Talent.$(a.currentTarget),this.ui.inputCheck);b.hasClass("checkbox-checked")?(b.removeClass("checkbox-checked"),this.model.set("isLongTerm",!1),this.trigger("cancelLong")):(b.addClass("checkbox-checked"),this.model.set("isLongTerm",!0))},_renderDateView:function(){var a=this,b=Talent._.extend(this.settings.rangepickerOptions,{startDate:this.model.get("startDate"),endDate:this.model.get("endDate")});this.ui.dateContent.daterangepicker(b),this.ui.dateContent.on("apply.daterangepicker",function(b,c){var d=moment(c.startDate).format("YYYY/MM/DD"),e=moment(c.endDate).format("YYYY/MM/DD");a.startDate=d,a.endDate=e})},onClose:function(){}}),DateTimePickerView=Talent.Layout.extend({defaults:{id:"date-time-picker",count:2,viewType:"date",isShowDateView:!0,isShowCycleView:!0,isShowLongView:!0,rangepickerOptions:{timePickerOpens:"left",showLong:!0,format:"YYYY/MM/DD HH:mm",timePicker:!0},isShowTab:!0},contentViewMap:{date:"_renderDateView",long:"_renderLongView",cycle:"_renderCycleView"},className:"tt-time-date-picker",template:jst["date-time-picker/date-time-picker"],ui:{content:"div[data-name=date-time-picker-content]"},regions:{content:"div[data-name=date-time-picker-content]"},templateHelpers:function(){return{}},events:function(){return{}},modelEvents:{"change:viewType":"_changeTypeEvent"},initialize:function(a){var b=this;if(this.settings=Talent._.extend({},this.defaults,this.options),this.settings.rangepickerOptions&&(this.settings.rangepickerOptions=Talent._.extend({},this.settings.rangepickerOptions,a.rangepickerOptions)),1==this.settings.count&&(this.settings.isShowTab=!1,this.isShowDateView=!1,this.isShowLongView=!1,this.isShowCycleView=!1,this.settings.rangepickerOptions.singleDatePicker=!0,1==this.settings.rangepickerOptions.timePicker?(this.settings.rangepickerOptions.timePicker,this.settings.rangepickerOptions.autoHide=!1):(this.settings.rangepickerOptions.autoHide=!1,this.settings.rangepickerOptions.timePicker=!1),this.$el.addClass("tt-time-date-picker-on")),this.model.set({viewType:this.settings.viewType}),0==this.isShowDateView&&0==this.isShowCycleView&&0==this.isShowLongView&&(this.settings.isShowTab=!1),this.$el.attr("id",this.settings.id),this.$el.on("mouseup",function(a){a.stopPropagation()}),Talent.$(document).on("mouseup.tt-DateTimePickerView",function(){b.close()}),!this.settings.model){var c=this.settings.rangepickerOptions.startDate||moment().format("YYYY/MM/DD"),d=this.settings.rangepickerOptions.endDate||moment().add(1,"day").format("YYYY/MM/DD");this.model.set({startDate:c,endDate:d,isLongTerm:!0,isCycle:"cycle"==this.settings.viewType,cycType:0,cycStartDay:"",cycEndDay:"",cycStartHour:"08",cycStartMinute:"00",cycEndHour:"18",cycEndMinute:"00"},{silent:!0})}},onRender:function(){},onShow:function(){this._renderTabView(),this._changeTypeEvent()},show:function(a,b){this.$el.show(),Context.setPosition(a,this.$el,b)},hide:function(){this.$el.hide()},_changeTypeEvent:function(){var a=this.contentViewMap[this.model.get("viewType")],b=this[a]();this.content.show(b)},_renderTabView:function(){this.settings.isShowTab&&(this.tabView=new DateTimePickerTabView({model:this.model,isShowDateView:this.settings.isShowDateView,isShowCycleView:this.settings.isShowCycleView,isShowLongView:this.settings.isShowLongView}),this.$el.prepend(this.tabView.render().$el))},_renderDateView:function(){return this.dateView?this.dateView:(this.dateView=new DateView({model:this.model,rangepickerOptions:this.settings.rangepickerOptions}),this.listenTo(this.dateView,"sure",function(a,b){this.trigger("sure",a,this.model.toJSON()),this.hide()}),this.listenTo(this.dateView,"cancel",function(a,b){this.trigger("cancel",a,this.model.toJSON()),this.hide()}),this.dateView)},_renderLongView:function(){return this.dateTimeLongView?this.dateTimeLongView:(this.dateTimeLongView=new DateTimeLongView({model:this.model,rangepickerOptions:this.settings.rangepickerOptions}),this.listenTo(this.dateTimeLongView,"cancel",function(a){this.trigger("cancel",a,this.model.toJSON()),this.hide()}),this.listenTo(this.dateTimeLongView,"sure",function(a){this.trigger("sure",a,this.model.toJSON()),this.hide()}),this.listenTo(this.dateTimeLongView,"cancelLong",function(){this.model.set("viewType","date"),this.trigger("cancelLong")}),this.dateTimeLongView)},_renderCycleView:function(){if(this.cycleTaskView)return this.cycleTaskView;return this.cycleTaskView=new DateTimeCycleView({model:this.model}),this.listenTo(this.cycleTaskView,"cancel",function(a){this.close(),this.trigger("cancel",a,this.model.toJSON())}),this.listenTo(this.cycleTaskView,"resetCycle",function(a){this.model.set({isCycle:!1}),this.trigger("resetCycle",a,this.model.toJSON()),this.close()}),this.listenTo(this.cycleTaskView,"sureCycleDate",function(a){this.model.set({isCycle:!0}),this.close(),this.trigger("sure",a,this.model.toJSON())}),this.cycleTaskView},onClose:function(){this.dateView&&this.dateView.close(),Talent.$(document).off("mouseup.tt-dateTimePicker")}}),titaWidget={DateTimePickerView:DateTimePickerView};return titaWidget}),define("views/natureDialog/goalOperation/index-page-view",["talent","templates/natureDialog","views/common/event-name","simplemodal","views/common/autocomplete/autocomplete-item-view","titaDatePicker","$.tipsy"],function(a,b,c,d,e,f){var g=a.Layout.extend({template:b["natureDialog/goalOperation/index-page"],ui:{saveBtn:".js-btn-sure",cancelBtn:".js-btn-cancel,.dialog-close",objName:".input_objective_name",periodui:".period-tooltip",moduleItem:".form_item_module",objdesc:".form_cc textarea.stanDesc",customValid:".customFildes .hasval",objTime:".datetime",titadatainput:".input-mini",ttTime:".tt-time-date-picker",inputBdz:"#bdz,#mbz,#tzz,#wcz"},events:function(){var a={};return a["click "+this.ui.saveBtn]="saveBtnFn",a["dblclick "+this.ui.saveBtn]="dbClikfun",a["click "+this.ui.cancelBtn]="closeBtnFn",a["focus .startDate,.endDate"]="dateFocus",a["focus "+this.ui.objName]="nameFocus",a["blur "+this.ui.objName]="nameBlur",a["keyup "+this.ui.objName]="nameKeyup",a["focus "+this.ui.objdesc]="focusDesc",a["blur "+this.ui.objdesc]="blurDesc",a["keyup "+this.ui.objdesc]="keyupDesc",a["keyup "+this.ui.customValid]="keyupCustom",a["click "+this.ui.objTime]="clickobjTime",a["click "+this.ui.periodui]="showDateChange",a["mouseup "+this.ui.periodui]="stopMouseHandler",a["click "+this.ui.titadatainput]="stopMouseHandler",a["click "+this.ui.ttTime]="stopMouseHandler",a["keyup "+this.ui.inputBdz]="targetValueKeyup",a},stopMouseHandler:function(a){a.stopPropagation()},showDateChange:function(b){b.stopPropagation();var c=this,d=this.model.toJSON();if(d.currentModule&&"0"==d.currentModule.FieldRight.Property)return!1;var e=a.$(b.currentTarget);this.titaDatePicker&&this.titaDatePicker.close();e.parents(".simplemodal-data");this.titaDatePicker=new f.DateTimePickerView({id:"date-time-picker",count:2,viewType:"date",isShowDateView:!0,isShowCycleView:!1,isShowLongView:!1,rangepickerOptions:{showLong:!1,startDate:d.startDate,endDate:d.endDate,format:"YYYY-MM-DD",timePicker:!1},isShowTab:!0}),this.listenTo(this.titaDatePicker,"sure",function(a){var b=c.titaDatePicker.model.toJSON();return $(".period-tooltip").attr("original-title","起止日期:"+b.startDate+"--"+b.endDate),c.submitModel.set("startDate",b.startDate),c.submitModel.set("endDate",b.endDate),c.model.set("startDate",b.startDate),c.model.set("endDate",b.endDate),!1}),c.$el.append(this.titaDatePicker.render().el),c.titaDatePicker.onShow(),c.titaDatePicker.show(this.$el),c.titaDatePicker.$el.hide();var g,h,i;a.inItalent?(g=e.position(),h=parseInt(g.left,10)-340,i=parseInt(g.top,10)+120):(g=$(".simplemodal-container").position(),h=parseInt(g.left,10)+21,i=parseInt(g.top,10)+130),setTimeout(function(){c.titaDatePicker.$el.css({position:"fixed",left:h,top:i}),c.titaDatePicker.$el.show()},0)},clickobjTime:function(a){a.stopPropagation()},dbClikfun:function(){return!1},initialize:function(b){a.inItalent?b=_.getPopData():(this.DialogView=new d({zIndex:1100}),this.$el=this.DialogView.$el),this.options=b,this.i18n=_.langs("assessment","dialog"),this.defaultSetting={i18n:this.i18n,height:"100",width:"600",inHeight:"154",showHeader:!1,title:"",showFoot:!0,showCustomFields:b.ModuleList[0]?b.ModuleList[0].ModuleType:1,yesColor:"blue",noColor:"white",timeColse:null,showClose:!0},_.extend(this.defaultSetting,b),this.defaultSetting.currentModule=_.findWhere(b.ModuleList,{Id:b.moduleId}),this.defaultSetting.hideWeight=2===this.defaultSetting.currentModule.WeightType;var c=[];_.each(b.ModuleList,function(a,d){(7!=a.ModuleType&&1!=a.RelType&&0!=a.FieldRight.Property||a.Id==b.moduleId)&&c.push({text:_.unescape(a.Name),id:a.Id,moduleType:a.ModuleType,weightType:a.WeightType})}),b.mode?this.submitModel=new a.Model({startDate:b.startDate,endDate:b.endDate,moduleId:b.moduleId,name:b.name,description:b.description}):this.submitModel=new a.Model({startDate:b.startDate,endDate:b.endDate,weight:0,moduleId:b.moduleId,name:this.i18n.targetNameTip,description:this.i18n.descriptionTip}),this.ModuleSelector=new e({formName:"moduleId",style:{width:"360px"},value:b.moduleId,data:c}),this.listenTo(this.ModuleSelector,"optionChange",this.selectChange),this.model.set(this.defaultSetting)},render:function(){var b=this,c=this.model.toJSON(),d=this.submitModel.toJSON(),e=_.extend(c,d);a.inItalent?b.$el.html(b.template(e)):b.DialogView.render(b.template(e)).appendTo($("body")),b.bindUIElements&&b.bindUIElements(),b.$(".period-tooltip").tipsy({gravity:"se"}),this.ui.objName.html(c.name),this.ui.moduleItem.html(this.ModuleSelector.render().el);var f=this.$("textarea.stanDesc"),g=f.val()||"",h=g.length;g==this.i18n.descriptionTip&&(h=0),f.next(".str-len").text(h+"/4000"),g.length>4e3?f.addClass("error"):f.removeClass("error");var i=c.CustomFields;return _.each(i,function(a,b){var c=a.MaxLength;(a.Description?a.Description:0).length>c?f.addClass("error"):f.removeClass("error")}),b},selectChange:function(a){this.submitModel.set(a.formName,a.value);var b=this.model.toJSON(),c=_.findWhere(b.ModuleList,{Id:a.value});this.model.set({currentModule:c,showCustomFields:a.moduleType,hideWeight:2==a.weightType}),0==a.moduleType?this.$("li.customFildes").css("display","block"):this.$("li.customFildes").css("display","none"),b.currentModule&&1!=b.currentModule.FieldRight.Weight?this.$el.find(".input-weight").attr("disabled",!0).val(_.toFixed(b.weight,2)||0):this.$el.find(".input-weight").removeAttr("disabled"),2==a.weightType?this.$("li.weightInp").css("display","none"):this.$("li.weightInp").css("display","block")},saveBtnFn:function(){var b,d,e,f,g=this,h=this.$el,i=_.escape(h.find(".input_objective_name").text()),j=Number(h.find(".input-weight").val()-0+"").toString(),k=h.find(".form_stander textarea").val()||"",l=!0,m=!0,n=/^-?\d{0,16}(\.\d{1,8})?$/,o=j.match(n),p=[];if(h.find(".lianghvinput").hasClass("input-error")&&(m=!1),0==this.model.get("showCustomFields")){var q=h.find(".customFildes .hasval");_.each(q,function(a,b){var c=$(a),d=c.attr("isRequire"),e=c.attr("len"),f=c.val();p.push({Description:f,Name:c.attr("name"),Id:c.attr("id"),Code:c.attr("code"),MaxLength:e,Type:c.attr("types"),IsRequire:d});var g=$.trim(f).length;(g>e||"true"==d&&0==g)&&(m=!1,$(a).addClass("error"))})}if(k.length>4e3&&(m=!1),"1"==this.model.get("typeId")){var r=this.$("#bdz:visible"),s=this.$("#mbz:visible"),t=this.$("#tzz:visible"),u=this.$("#wcz:visible");b=0!=r.length?r.val():"",d=0!=s.length?s.val():"",e=0!=t.length?t.val():"",f=0!=u.length?u.val():"";var v=BSGlobal.EpmData.IsTargetValueRequired,w=BSGlobal.EpmData.IsCompleteValueRequired,x=this.options.CompleteValueSource,y=this.options.FieldRight.ObjectiveType,z=this.options.FieldRight.CompleteValue;v&&1==y&&(r.length&&!b&&(r.addClass("input-error"),m=!1),s.length&&!d&&(s.addClass("input-error"),m=!1),t.length&&!e&&(t.addClass("input-error"),m=!1)),w&&1==x&&1==z&&u.length&&!f&&(u.addClass("input-error"),m=!1),m||(l=!1)}if(!l)return!1;if(""==$.trim(i)||$.trim(i)==g.i18n.targetNameTip?(h.find(".input-text").addClass("input-error"),m=!1):h.find(".input-text").removeClass("input-error"),100==j||""!=j&&/^\d{0,2}(\.\d{1,2})?$/.test(Number(j))&&o?h.find(".input-weight").removeClass("input-error"):(h.find(".input-weight").addClass("input-error"),m=!1),!m)return!1;(""==k||k==g.i18n.descriptionTip||102712==BSGlobal.tenantInfo.Id&&"仅制定KPI指标或结果性目标承诺时填写"==k)&&(k=""),j&&(j=_.toFixed(j,2)),this.model.get("hideWeight")&&(j=_.toFixed(0,2));var A=this.options,B=this.model.get("currentModule").ModuleType;if("1"==this.model.get("typeId")?(7==B&&(b=A.MinimumValue.Value,d=A.ItemValue.Value,e=A.ChallengeValue.Value,f=A.CompleteValue,k=A.description),this.submitModel.set({name:i,description:k,weight:j,goalCustomDatas:p,MinimumValue:{Value:_.formatNumber2(b),IsAdopt:A.MinimumValue.IsAdopt},ItemValue:{Value:_.formatNumber2(d),IsAdopt:A.ItemValue.IsAdopt},ChallengeValue:{Value:_.formatNumber2(e),IsAdopt:A.ChallengeValue.IsAdopt},CompleteValue:"undefined"==_.formatNumber2(f)?this.model.get("CompleteValue"):_.formatNumber2(f)})):this.submitModel.set({goalCustomDatas:p,name:i,description:k,weight:j}),a.inItalent){var C="edit"==A.mode?"ASSESSMENT_EDITGOAL_OK":"ASSESSMENT_ANDGOAL_OK";window.iTalentSDK.sendMessage({publishEvent:c(C,A.Id),data:this.submitModel.toJSON()}),this.closeBtnFn()}else this.trigger("dialogSave",this.submitModel.toJSON()),this.trigger("smalledialogClose"),this.closeBtnFn()},targetValueKeyup:function(a){var b=$(a.currentTarget),c=b.val(),d=/^-?\d{0,16}(\.\d{1,8})?$/,e=d.test(c);isNaN(c)||!e?b.addClass("input-error"):b.removeClass("input-error")},dblSureFn:function(){return!1},closeBtnFn:function(){a.inItalent?window.iTalentSDK.hidePopup():(this.$el.remove(),this.close())},nameFocus:function(a){var b=$(a.currentTarget);b.addClass("hasval"),b.parent(".form_name_content").removeClass("input-error"),b.text()==this.i18n.targetNameTip&&(b.text(""),b.width("98.5%").next(".warning-tip").css("display","none")),b.parent(".input-text").addClass("input-focus")},nameBlur:function(a){var b=$(a.currentTarget);""==b.text()&&(b.removeClass("hasval"),b.text(this.i18n.targetNameTip),b.next(".warning-tip").css("display","inline-block")),b.parent(".input-text").removeClass("input-focus")},nameKeyup:function(a){var b=$(a.currentTarget);b.val();b.addClass("hasval")},keyupDesc:function(a){var b=$(a.currentTarget),c=b.val();b.next(".str-len").text(c.length+"/4000"),c.length>4e3?b.addClass("error"):b.removeClass("error")},keyupCustom:function(a){var b=$(a.currentTarget),c=b.val(),d=b.attr("len"),e=b.attr("isRequire");b.next(".str-len").text(c.length+"/"+d),c.length>d||"true"==e&&0==c.length?b.addClass("error"):b.removeClass("error")},focusDesc:function(a){var b=$(a.currentTarget);b.addClass("hasval"),102712==BSGlobal.tenantInfo.Id?"仅制定KPI指标或结果性目标承诺时填写"==b.val()&&b.val(""):b.val()==this.i18n.descriptionTip&&b.val("")},blurDesc:function(a){var b=$(a.currentTarget);""==b.val()&&(b.removeClass("hasval"),102712==BSGlobal.tenantInfo.Id?b.val("仅制定KPI指标或结果性目标承诺时填写"):b.val(this.i18n.descriptionTip))}});return a.inItalent?a.BasePageView.extend({mainViewClass:g,hideSidebar:!1,layout:"empty-layout"}):g}),define("views/natureDialog/addSubItem/index-page-view",["talent","templates/natureDialog","views/common/event-name","simplemodal","views/common/autocomplete/autocomplete-item-view","views/common/helpers/validator","$.tipsy"],function(a,b,c,d,e,f,g){var h=a.Layout.extend({template:b["natureDialog/addSubItem/index-page"],ui:{saveBtn:".btn-sure",cancelBtn:".btn-cancel,.btn-close,.dialog-close ",objName:".input_objective_name",DropDownList:".form_item_module",objdesc:".form_cc textarea",scoreIpt:"#addSubScore"},events:function(){var a={};return a["click "+this.ui.saveBtn]="saveBtnFn",a["dblclick "+this.ui.saveBtn]="dbClikfun",a["click "+this.ui.cancelBtn]="closeBtnFn",a["focus "+this.ui.objName]="nameFocus",a["blur "+this.ui.objName]="nameBlur",a["keyup "+this.ui.objName]="nameKeyup",a["focus "+this.ui.objdesc]="focusDesc",a["blur "+this.ui.objdesc]="blurDesc",a["keyup "+this.ui.objdesc]="keyupDesc",a["keyup "+this.ui.scoreIpt]="scoreInputCheck",a},stopMouseHandler:function(a){a.stopPropagation()},clickobjTime:function(a){a.stopPropagation()},dbClikfun:function(){return!1},scoreInputCheck:function(a){var b=this.model.toJSON(),c=$(a.currentTarget),d=Number($.trim(c.val())),e=f.isCorrectScore(d,{max:b.scoreLevel.MaxValue,min:b.scoreLevel.MinValue});if(!e&&""!=d)return c.addClass("input-error"),e;c.removeClass("input-error")},initialize:function(b){a.inItalent?b=_.getPopData():(this.DialogView=new d({zIndex:1100}),this.$el=this.DialogView.$el),this.options=b,this.i18n=_.langs("assessment","dialog"),this.defaultSetting={i18n:this.i18n,height:"100",width:"600",inHeight:"154",showHeader:!1,title:"",showFoot:!0,yesColor:"blue",noColor:"white",timeColse:null,showClose:!0},_.extend(this.defaultSetting,b),this.defaultSetting.currentModule=_.findWhere(b.scoreLevel,{Value:b.score}),this.defaultSetting.currentModule||(this.defaultSetting.currentModule=_.findWhere(b.scoreLevel,{Id:b.scoreLevelId}));var c=[];_.each(b.scoreLevel,function(a,b){var d={text:"10000.00"==a.Value?"无法评价":a.Value,id:a.Id,value:a.Value};_.extend(d,a),c.push(d)}),"add"==b.mode?this.submitModel=new a.Model({moduleId:b.moduleId,name:this.i18n.addSubTip,description:""}):this.submitModel=new a.Model({moduleId:b.moduleId,name:b.name,score:b.score,description:b.description,Id:b.singeItemId}),b.isScoreLevel&&(c.unshift({id:"000-000",text:_.langs("common","selectDefault"),value:void 0,Name:_.langs("common","selectDefault")}),c=_.sortScoreLevel(c),this.scoreLevelSelector=new e({formName:"scoreLevelId",style:{width:"380px"},dataSetting:b.ScoreLevelSettings,value:this.defaultSetting.currentModule&&this.defaultSetting.currentModule.Id,data:c}),this.listenTo(this.scoreLevelSelector,"optionChange",this.selectChange)),this.model.set(this.defaultSetting)},render:function(){var b=this,c=this.model.toJSON(),d=this.submitModel.toJSON(),e=_.extend(c,d);a.inItalent?b.$el.html(b.template(e)):b.DialogView.render(b.template(e)).appendTo($("body")),b.bindUIElements&&b.bindUIElements(),c.isScoreLevel&&this.ui.DropDownList.html(this.scoreLevelSelector.render().el),this.ui.objName.html(_.escape(c.name));var f=this.$("textarea"),g=f.val();return f.next(".str-len").text(g.length+"/4000"),this.$("#addSubScore").tipsy({gravity:"s",title:"tip-info"}),g.length>4e3?f.addClass("error"):f.removeClass("error"),b},selectChange:function(a){var b=this,c=_.findWhere(b.options.scoreLevel,{Id:a.value});c?(this.submitModel.set("score",c.Value),this.submitModel.set("scoreLevelId",c.Id),this.$(".select2-selection").removeClass("input-error")):(this.submitModel.set("score",""),this.submitModel.set("scoreLevelId",""))},saveBtnFn:function(){var b=this,d=this.model.toJSON(),e=this.$(".input_objective_name").text(),f=this.$(".form_cc textarea").val(),g=!0;if(f.length>4e3&&(g=!1),""==$.trim(e)||$.trim(e)==b.i18n.addSubTip?(this.$(".input-text").addClass("input-error"),g=!1):this.$(".input-text").removeClass("input-error"),!d.isScoreLevel){var h=parseFloat(this.$("#addSubScore").val()),i=d.scoreLevel;(h<i.MinValue||h>i.MaxValue)&&(this.$("#addSubScore").addClass("input-error"),g=!1),this.submitModel.set("score",h)}if(this.$("#addSubScore").hasClass("input-error")&&(g=!1),!g)return!1;if(this.submitModel.set("goalName",e),this.submitModel.set("description",f),a.inItalent){var j="add"==d.mode?"ASSESSMENT_ADDSUBGOAL_OK":"ASSESSMENT_EDITSUBGOAL_OK";window.iTalentSDK.sendMessage({publishEvent:c(j,d.Id),data:this.submitModel.toJSON()}),this.closeBtnFn()}else a.app.trigger("addSubSave",this.submitModel.toJSON()),this.trigger("addSubSave",this.submitModel.toJSON()),this.trigger("smalledialogClose"),this.closeBtnFn()},dblSureFn:function(){return!1},closeBtnFn:function(){a.inItalent?window.iTalentSDK.hidePopup():this.DialogView.$el.remove()},nameFocus:function(a){var b=$(a.currentTarget);b.addClass("hasval"),b.text()==this.i18n.addSubTip&&(b.text(""),b.width("98.5%").next(".warning-tip").css("display","none")),b.parent(".input-text").addClass("input-focus")},nameBlur:function(a){var b=$(a.currentTarget);""==b.text()&&(b.removeClass("hasval"),b.text(this.i18n.addSubTip),b.width("324px").next(".warning-tip").css("display","inline-block")),b.parent(".input-text").removeClass("input-focus")},nameKeyup:function(a){var b=$(a.currentTarget),c=b.text();b.addClass("hasval"),c.length>50&&b.val(c.substring(0,50)),c&&this.$(".input-text").removeClass("input-error")},keyupDesc:function(a){var b=$(a.currentTarget),c=b.text();b.next(".str-len").text(c.length+"/4000"),c.length>4e3?b.addClass("error"):b.removeClass("error")},focusDesc:function(a){var b=$(a.currentTarget);b.addClass("hasval"),b.val()==this.i18n.descriptionTip&&b.val("")},blurDesc:function(a){var b=$(a.currentTarget);""==b.val()&&b.removeClass("hasval")}});return a.inItalent?a.BasePageView.extend({mainViewClass:h,hideSidebar:!1,layout:"empty-layout"}):h}),define("views/assessment/copytask-item-view",["talent","templates/assessment","simplemodal","views/common/autocomplete/autocomplete-item-view"],function(a,b,c,d){return a.ItemView.extend({template:b["assessment/copytask-item"],ui:{saveBtn:".btn-sure",cancelBtn:".btn-cancel,.btn-close",checkbox1:".checkbox",activity_select:".activity-select .select-container"},events:function(){var a={};return a["click "+this.ui.saveBtn]="saveBtnFn",a["dblclick "+this.ui.saveBtn]="dbClikfun",a["click "+this.ui.cancelBtn]="closeBtnFn",a["click "+this.ui.checkbox1]="checkSelect",a},initialize:function(){var a=this.options;this.DialogView=new c({zIndex:1100}),this.defaultSetting={height:"100",width:"600",inHeight:"154",showHeader:!1,title:"",showFoot:!0,yesText:"确定",noText:"取消",yesColor:"blue",noColor:"white",timeColse:null,showClose:!0},this.defaultSetting=_.extend(this.defaultSetting,this.options);var b=[];_.each(this.options.ModuleList,function(a,c){var d={};d.text=a.Name,d.id=a.Id,b.push(d)}),this.submitParam={assessmentId:a.AssessmentId,moduleId:b[0].id},this.model.set(this.defaultSetting),this.$el=this.DialogView.$el},checkSelect:function(a){var b=$(a.currentTarget),c=this.$el.find(".list_data");if(b.hasClass("checkbox_uncheck"))if(b.addClass("checkbox_checked").removeClass("checkbox_uncheck"),1==b.data("parent"))c.find("ul[data-id="+b.data("id")+"]").find(".checkbox_uncheck").addClass("checkbox_checked").removeClass("checkbox_uncheck");else{var d=b.parents(".list_item");d.find(".checkbox_checked").length==d.find(".checkbox").length&&$(".checkbox_uncheck[data-id="+d.data("id")+"]").addClass("checkbox_checked").removeClass("checkbox_uncheck")}else if(b.addClass("checkbox_uncheck").removeClass("checkbox_checked"),1==b.data("parent"))c.find("ul[data-id="+b.data("id")+"]").find(".checkbox_checked").addClass("checkbox_uncheck").removeClass("checkbox_checked");else{var d=b.parents(".list_item");d.find(".checkbox_checked").length==d.find(".checkbox").length-1&&$(".checkbox_checked[data-id="+d.data("id")+"]").addClass("checkbox_uncheck").removeClass("checkbox_checked")}},render:function(){var b=this,c=this.model.toJSON();a.app.request("Target:getCopyAssessmentItem",{UserId:c.UserId,assessmentId:c.AssessmentId}).done(function(a){b.DialogView.render(b.template(c)).appendTo($("body")),b.bindUIElements&&b.bindUIElements(),b.showListData(a.Modules);var e=[];return $(a.Assessments).each(function(a,b){var c={};c.text=b.Text,c.id=b.Id,e.push(c)}),b.submitParam.assessmentId=e[0].id,b.assessmentSelector=new d({formName:"assessmentId",style:{width:"200px"},value:e[0]&&e[0].id,data:e}),b.bindUIElements&&b.bindUIElements(),b.listenTo(b.assessmentSelector,"optionChange",b.selectChange),b.ui.activity_select.html(b.assessmentSelector.render().el),b})},showListData:function(a){var b=this;0==a.length?this.$el.find(".list-body").html("<div class='empty-data'>该考核表下暂无目标</div>"):(this.$el.find(".list-body").html("<ul class='list_data'></ul>"),$(a).each(function(a,c){var d="<li><div class='title'>";0==c.ItemInfos.length?(d+="<span class='tree tree_empty'></span>",d+="<span class='checkbox checkbox_uncheck' data-id='"+c.ModuleId+"' data-parent='true'></span>",d=d+"<span class='item-name'><strong>"+_.escape(c.ModuleName)+"</strong></span></div></li>"):(d+="<span class='tree tree_unfold'></span>",d+="<span class='checkbox checkbox_uncheck' data-id='"+c.ModuleId+"'  data-parent='true'></span>",d=d+"<span class='item-name'><strong>"+_.escape(c.ModuleName)+"</strong></span></div>",d=d+"<ul class='list_item' data-id='"+c.ModuleId+"'>",$(c.ItemInfos).each(function(a,b){d+="<li><div class='title'>",d+="<span class='tree tree_empty'></span>",d+="<span class='checkbox checkbox_uncheck' data-id='"+b.Id+"' data-type='0'  data-parent='false'></span>",d=d+"<span class='item-name'>"+_.escape(b.Text)+"</span></div></li>"}),d+="</li></ul>"),b.$el.find(".list_data").append(d)}))},onShow:function(){},selectChange:function(b){var c=this,d=c.model.toJSON();this.submitParam[b.formName]=b.value,a.app.request("Target:getHistoryItem",{UserId:this.model.get("UserId"),assessmentId:b.value,currentassessmentId:d.AssessmentId}).done(function(a){c.showListData(a)})},saveBtnFn:function(){var a=this.DialogView.$el,b=a.find(".checkbox_checked[data-type='0']");if(0==b.length)return!1;var c=this;b.each(function(a,b){c.submitParam["idList["+a+"].Id"]=$(b).data("id")}),this.trigger("dialogSave",this.submitParam),this.DialogView.$el.remove(),this.trigger("smalledialogClose")},closeBtnFn:function(){this.DialogView.$el.remove(),this.trigger("smalledialogClose")},onRender:function(){}})}),define("views/assessment/third-feed-item-view",["talent","templates/assessment"],function(a,b){return a.ItemView.extend({template:b["assessment/third-feed-item"],initialize:function(){var b=this.options;b.i18n=_.langs("assessment"),this.model=new a.Model(b)},className:"content-right clearfix",ui:{},events:{},onRender:function(){},onShow:function(){},onClose:function(){}})}),define("views/assessment/key-result-item-view",["talent","templates/assessment"],function(a,b){return a.ItemView.extend({template:b["assessment/key-result-item"],className:"kr-container"})}),define("views/assessment/key-result-composite-view",["talent","templates/assessment","views/assessment/key-result-item-view"],function(a,b,c){return a.CompositeView.extend({template:_.template('<ul class="goal-container"></ul>'),itemView:c,itemViewContainer:"ul.goal-container"})}),define("Uploader",["talent"],function(talent){var jst=function(){return this.JST=this.JST||{},this.JST["uploader/rencent-upload-composite"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div style="position:relative;">\n\t<span>最近上传的文件</span><a class="btn_close_file">X</a>\n</div>\n<ul class="uploader_exist_file_list"></ul>\n<div>\n\t<button class="btn_save_file">提交</button>\n\t<button class="btn_canc_file">取消</button>\n</div>';return __p},this.JST["uploader/rencent-upload-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<input type="checkbox" class="checkbox" title="'+(null==(__t=Name)?"":__t)+'"  value="'+(null==(__t=Id)?"":__t)+'"  id="'+(null==(__t=Id)?"":__t)+'" >'+(null==(__t=Name)?"":__t)+"</input>";return __p},this.JST["uploader/uploader-component"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="upload_node">文件/图片</div>\n<ul class = "upload_type_show upload_dropdown" style="display:none">\n\t<li class="upload_new_file">\t\t\t\t\n\t\t<div class="dp_upload_text">本地上传</div>\n\t</li>\n\t',isShowExistFile||(__p+='\n\t<li class="dp_upload_exist_text">从我的文件上传</li>\t\n\t'),__p+='\n</ul>\n<div class="error_container"></div>\n<div class="preview_container"></div>\n<div class="loading_view"></div>';return __p},this.JST["uploader/uploader-form"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<form class="upload_form" style="width: 100%;" action="'+(null==(__t=url)?"":__t)+'" method="post" enctype="multipart/form-data" target="upload_target_iframe">\n\t<input type="hidden" class="callback" name="'+(null==(__t=callbackName)?"":__t)+'" value="'+(null==(__t=callbackValue)?"":__t)+'">\n\t',validate.onceLimt>1?__p+='\n\t<input type="file" style="opacity:0;filter:alpha(opacity=0);" multiple="true" name="'+(null==(__t=fileInputName)?"":__t)+'[]" class="upload_file_input">\n\t':__p+='\n\t<input type="file" style="opacity:0;filter:alpha(opacity=0);" name="'+(null==(__t=fileInputName)?"":__t)+'" class="upload_file_input">\n\t',__p+="\n\t",_.each(extendData,function(a,b){__p+='\n\t<input type="hidden" name="'+(null==(__t=b)?"":__t)+'" class="upload_file_input" value="'+(null==(__t=a)?"":__t)+'">\n\t'}),__p+="\n</form>";return __p},this.JST}(),UploaderView=talent.ItemView.extend({template:jst["uploader/uploader-form"],className:"upload_form_container",defaults:{url:"upload",fileInputName:"files",callbackName:"_callback_",callbackValue:"parent._callback_",container:"",extendData:{},ajaxUrl:"",validate:{},isPaste:!0,isDrag:!0,pasteNode:null},modelEvents:{"change:timestamp":"render"},ui:{form:".upload_form",file:'input[type="file"]'},initialize:function(a){var a=a||{};this.options=talent._.extend({},this.defaults,a);var b="_"+parseInt(1e3*Math.random());if(this.options.callbackValue&&-1!=this.options.callbackValue.indexOf(".")){var c=this.options.callbackValue.split(".");"parent"==c[0]&&(c=talent._.rest(c)),this.options.windowCallbackValue=c.join(".")+b}else this.options.windowCallbackValue=this.options.callbackValue+b;this.options.callbackValue=this.options.callbackValue+b,this.model=new talent.Model(talent._.extend({},this.options)),this.changeTimestamp(),this.hasEnter=!1},onRender:function(){0==talent.$("#upload_target_iframe").length&&$("body").append('<iframe style="display:none;" id="upload_target_iframe" name="upload_target_iframe"></iframe>'),this.$el.css({position:"absolute",top:"0px"});var a=this.options.container;talent.$(a).find(".upload_new_file").find(".upload_form_container").remove(),talent.$(a).find(".upload_new_file").append(this.$el),this.addEventListener(),this.trigger("formViewRender",this)},changeTimestamp:function(){var a=(new Date).getTime(),b=this.model.get("url").replace(/&?timestamp=.*/g,""),c=this.model.get("ajaxUrl").replace(/&?timestamp=.*/g,"");c=-1==c.indexOf("?")?c+"?timestamp="+a:c+"&timestamp="+a,b=-1==b.indexOf("?")?b+"?timestamp="+a:b+"&timestamp="+a,this.model.set("url",b),this.model.set("ajaxUrl",c),this.model.set("timestamp",a)},addEventListener:function(){var a=this;window[this.options.windowCallbackValue]=function(b){a.onAfterUpload(b)},this.options.isPaste&&this.bindPasteEvents(),this.options.isDrag&&this.bindDropDragEvents(),this.bindFileInputEvents()},bindFileInputEvents:function(){var a=this,b=this.options.container;talent.$(b).off("change.uploader"),talent.$(b).on("change.uploader",'input[type="file"]',function(b){a.onBeforeInputUpload(b)})},bindDropDragEvents:function(){var a=this,b=this.options.container;talent.$(b).off("dragenter.uploader").off("dragleave.uploader").off("dragover.uploader").off("drop.uploader"),talent.$(b).on("dragenter.uploader",function(b){b.preventDefault(),a.hasEnter||(a.hasEnter=!0)}).on("dragleave.uploader",function(b){b.preventDefault(),a.hasEnter=!1}).on("dragover.uploader",function(a){a.preventDefault()}).on("drop.uploader",function(b){b.preventDefault(),a.options.onDrop&&a.options.onDrop(b),a.onBeforeDragUpload(b.originalEvent),a.hasEnter=!1})},bindPasteEvents:function(){var a=this,b=this.options.container,c=this.options.pasteNode;c?(talent.$(c).off("paste.uploader"),talent.$(c).on("paste.uploader",function(b){a.onBeforePasteUpload(b.originalEvent)})):(talent.$(b).off("paste.uploader"),talent.$(b).on("paste.uploader","textarea",function(b){a.onBeforePasteUpload(b.originalEvent)}))},onBeforeInputUpload:function(a){var b=[];talent.$.each(this.$el.find('[type="file"]'),function(a,c){var d=talent.$(c).val()||"";talent.$.trim(d)&&b.push({name:d})});var c=this;this.validateFile(b).done(function(a){a&&c.formSubmit()})},onBeforeDragUpload:function(a){var b=this,c=a.dataTransfer.files;if(0!=c.length){for(var d=new FormData,e=0,f=c.length;e<f;e++)d.append(this.options.fileInputName+"[]",c[e]);var g=this.options.extendData;talent._.each(g,function(a,b){d.append(b,a)});this.validateFile(c).done(function(a){a&&b.ajaxSubmit(d)})}},onBeforePasteUpload:function(a){var b=this,c=a.clipboardData&&a.clipboardData.items,d=[];if(!c)return!1;if(talent.$.each(c,function(a,b){var c=b.getAsFile&&b.getAsFile();c&&(c.name=(new Date).getTime()+parseInt(100*Math.random())+".png",d.push(c))}),0==d.length)return!1;var e=new FormData;talent.$.each(d,function(a,c){e.append(b.options.fileInputName+"[]",c,c.name)});var f=this.options.extendData;talent._.each(f,function(a,b){e.append(b,a)}),this.validateFile(d).done(function(a){a&&b.ajaxSubmit(e)})},onAfterUpload:function(a){this.trigger("uploadEnd",a)},formSubmit:function(){this.trigger("uploadStart",{timestamp:this.model.get("timestamp")}),this.ui.form.submit(),this.changeTimestamp()},ajaxSubmit:function(a){var b=this;this.trigger("uploadStart",{timestamp:this.model.get("timestamp")}),$.ajax({url:this.model.get("ajaxUrl"),type:"post",processData:!1,contentType:!1,data:a,dataType:"json",success:function(a){b.onAfterUpload(a)}}),this.changeTimestamp()},validateFile:function(a){var b=new talent.$.Deferred,c=this.options.validate,d=this,e=!0,a=a||this.ui.file[0].files;for(var f in c)if(0==(e=d[f+"Validate"]?e&&d[f+"Validate"](a):e&&!0))break;return e||(d.trigger("error",{type:f}),this.changeTimestamp()),b.resolve(e),b.promise()},formatValidate:function(a){var b=!0,c=this;return talent._.each(a,function(a){var d=a.name||"";b=b&&c.formatValidateByItem(d)}),b},formatValidateByItem:function(a){var b=a.substring(a.lastIndexOf(".")+1),c=this.options.validate.format,d=0;if(!c||c&&0==c.length)return!0;for(;d<c.length;d++)if(b==c[d])return!0;return d!=c.length&&void 0},allLimtValidate:function(a,b){var c=this.options.validate.allLimt;if(c<0)return!0;var d=this.options.fileCollection.length,b=a&&a.length||b,e=!0;return c>0&&d+b>c&&(e=!1),e},onceLimtValidate:function(a){this.options.validate.onceLimt;return!0},nameLimtValidate:function(a){if(this.options.validate.nameLimt<0)return!0;var b=!0,c=this;return talent._.each(a,function(a){var d=a.name||"";b=b&&c.nameLimtValidateByItem(d)}),b},nameLimtValidateByItem:function(a){var b=this.options.validate.nameLimt;return this._isStringBeyondLength(a,b)},_isStringBeyondLength:function(a,b){var c=/[^\x00-\xff]/g;return a.replace(c,"**").length>b}}),PreviewView=talent.CollectionView.extend({itemView:talent.ItemView.extend({template:talent._.template('<%= Name %><a class="del_item" href="javascript:void(0)">删除</a>'),tagName:"li",events:{"click .del_item":"delItem"},delItem:function(){this.trigger("delete")}}),tagName:"ul",initialize:function(){var a=this;this.templateHelpers=this.model.get("text"),this.on("itemview:delete",function(b){a.delItem(b)})},delItem:function(a){this.collection.remove(a.model),this.trigger("deleteItem")},onAfterItemAdded:function(a){a.$el.attr("cid",a.model.cid)}}),RecentUploadView=talent.CompositeView.extend({template:jst["uploader/rencent-upload-composite"],itemView:talent.ItemView.extend({tagName:"li",template:jst["uploader/rencent-upload-item"]}),itemViewContainer:".uploader_exist_file_list",events:{"click .btn_save_file":"onAfterSubmit","click .btn_close_file":"onAfterClose","click .btn_canc_file":"onAfterCancel"},initialize:function(a){var a=a||{};this.templateHelpers=this.model.get("text"),this.getListData(),this.checkedFileCollection=a.checkedFileCollection},getListData:function(){var a=this;talent.$.ajax({url:this.model.get("getRecentFileUrl")}).done(function(b){var b=b||{};b.data&&a.collection.add(b.data)})},onRender:function(){this.$el.appendTo("body"),this.$el.css({position:"absolute",top:"50%",left:"50%"})},showDialog:function(){var a=this;talent._.each(this.checkedFileCollection,function(b){var c=b.get("Id");a.$el.find('input[value="'+c+'"]').attr("checked",!0)}),this.$el.show()},hideDialog:function(){this.$el.find("input:checked").attr("checked",!1),this.$el.hide()},onAfterSubmit:function(){this.getSelected(),this.trigger("submit",this.checkedFileCollection),this.hideDialog()},onAfterClose:function(){this.getSelected(),this.trigger("close",this.checkedFileCollection),this.hideDialog()},onAfterCancel:function(){this.getSelected(),this.trigger("cancel",this.checkedFileCollection),this.hideDialog()},getSelected:function(){var a=this;this.checkedFileCollection.reset([]),talent.$.each(this.$el.find("input:checked"),function(){var b=talent.$(this).val(),c=a.collection.where({Id:parseInt(b)})[0];c&&a.checkedFileCollection.add(c)})},onClose:function(){this.$el.remove()}}),UploaderComponentView=talent.ItemView.extend({template:jst["uploader/uploader-component"],className:"upload_component",PreviewView:PreviewView,RecentUploadView:RecentUploadView,FileCollection:talent.Collection,CheckedFileCollection:talent.Collection,RecentFileCollection:talent.Collection,loadingTemplate:talent._.template("<div>loading</div>"),errorTemplate:talent._.template("<div><%= msg %></div>"),defaults:{text:{},container:"",callbackName:"callback",url:"upload",fileInputName:"files",extendData:{},ajaxUrl:"",validate:{format:["jpeg","JPEG","pdf","PDF","docx","DOCX","xlsx","XLSX","ppt","PPT","rar","RAR","txt","TXT","xls","XLS","doc","zip","ZIP","jpg","JPG","gif","GIF","png","PNG","pptx","PPTX","mmap","MMAP"],onceLimt:2,allLimt:2,nameLimt:-1},error:{error_allLimt:"超出最大限度",error_format:"格式不合法",error_nameLimt:"名字长度不合格"},isDrag:!1,isPaste:!1,isShowExistFile:!1,errorTime:500,data:[],getRecentFileUrl:""},ui:{dropDown:".upload_dropdown"},events:{"click .upload_node":"showUploadDropdown","click .upload_old_file":"showRecentUploadView"},initialize:function(a){var b=this;this.dealOptions(a),this.model=new talent.Model(this.options);var c=this.options.data||[];this.fileCollection=new this.FileCollection(c),this.checkedFileCollection=new this.CheckedFileCollection,this.recentFileCollection=new this.RecentFileCollection,this.templateHelpers=this.model.get("text"),talent.$("body").off("click.upload"),talent.$("body").on("click.upload",function(){b.hideUploadDropdown()}),this.options.PreviewView&&(this.PreviewView=this.options.PreviewView),this.options.RecentUploadView&&(this.RecentUploadView=this.options.RecentUploadView),this.options.loadingTemplate&&(this.loadingTemplate=this.options.loadingTemplate),this.options.errorTemplate&&(this.errorTemplate=this.options.errorTemplate),this.options.template&&(this.template=this.options.template)},dealOptions:function(a){this.options=talent._.extend({},this.defaults,a)},onRender:function(){var a=this.options.container;""==a&&(this.options.container=this.$el),0==talent.$(a).find(".upload_new_file").length&&this.$el.appendTo(talent.$(a).find(".uploader_container")),this.renderUploaderFormView(),this.renderPreviewListView(),this.options.isShowExistFile&&this.renderRecentUploadView()},renderUploaderFormView:function(){var a=this;this.options.fileCollection=this.fileCollection,this.uploaderView=new UploaderView(this.options),this.uploaderView.on("formViewRender",function(b){a.onAfterFormViewRender(b)}),this.uploaderView.render(),this.uploaderView.on("uploadStart",function(b){a.showLoadingView(b),a.trigger("uploadStart",b)}),this.uploaderView.on("uploadEnd",function(b){var c=a.onAfterUpload&&a.onAfterUpload(b);a.fileCollection.add(c),a.hideLoadingView(b),a.trigger("uploadEnd",a.fileCollection.toJSON(),b)}),this.uploaderView.on("error",function(b){a.hideLoadingView(b),a.showErrorView(b),a.trigger("error",b)})},onAfterFormViewRender:function(a){},onAfterUpload:function(a){return a.data},renderPreviewListView:function(){var a=this,b=this.options.container;this.previewCompositeView=new this.PreviewView({collection:this.fileCollection,model:this.model}),this.previewCompositeView.on("deleteItem",function(b){a.trigger("deleteItem",a.fileCollection.toJSON())}),talent.$(b).find(".preview_container").append(this.previewCompositeView.render().$el)},renderRecentUploadView:function(){var a=this;this.rencentCompositeView=new this.RecentUploadView({collection:this.recentFileCollection,model:this.model,checkedFileCollection:this.checkedFileCollection}),this.rencentCompositeView.on("submit",function(){a.fileCollection.length+a.checkedFileCollection.models.length>a.options.validate.allLimt?a.showErrorView({type:"allLimt"}):a.fileCollection.add(a.checkedFileCollection.toJSON())}),this.rencentCompositeView.render()},showRecentUploadView:function(){this.rencentCompositeView.showDialog()},showErrorView:function(a){var b=this.options.container,c=this,a=a||{},d=a.type;a=this.options.error["error_"+d]||a,d&&(a=a.replace(/\{\{[\s\S]+\}\}/,this.options.validate[d])),talent.$(b).find(".error_container").empty().append(this.errorTemplate({msg:a})).show(),setTimeout(function(){c.hideErrorView()},this.options.errorTime)},hideErrorView:function(a){var b=this.options.container;talent.$(b).find(".error_container").hide()},showLoadingView:function(){var a=this.options.container;talent.$(a).find(".loading_container").empty().append(this.loadingTemplate()).show()},hideLoadingView:function(a){var b=this.options.container;talent.$(b).find(".loading_container").hide()},showUploadDropdown:function(a){a.stopPropagation(),this.ui.dropDown.show()},hideUploadDropdown:function(){this.ui&&this.ui.dropDown&&talent.$(this.ui.dropDown).hide()},getFileList:function(){return this.fileCollection.toJSON()}}),Uploader={};return Uploader.UploaderView=UploaderView,Uploader.UploaderComponentView=UploaderComponentView,Uploader.PreviewView=PreviewView,Uploader.RecentUploadView=RecentUploadView,Uploader}),define("richeditor",["talent","Uploader"],function(a,b){var c,d;if(void 0===e)var e={};var f={formatting:"标题",html:"HTML代码",video:"视频",image:"图片",table:"表格",link:"链接",link_insert:"插入链接",unlink:"取消链接",styles:"样式",paragraph:"段落",quote:"引用",code:"代码",header1:"一级标题",header2:"二级标题",header3:"三级标题",header4:"四级标题",format:"格式",bold:"粗体",italic:"斜体",superscript:"上标",strikethrough:"删除线",fontcolor:"字体颜色",backcolor:"背景颜色",removeformat:"取消格式",cleanstyles:"清除样式",lists:"目录",unorderedlist:"项目编号",orderedlist:"数字编号",outdent:"减少缩进",indent:"增加缩进",redo:"重做",undo:"撤销",cut:"剪切",cancel:"取消",insert:"插入",save:"保存",_delete:"删除",insert_table:"插入表格",insert_row_above:"在上方插入",insert_row_below:"在下方插入",insert_column_left:"在左侧插入",insert_column_right:"在右侧插入",delete_column:"删除整列",delete_row:"删除整行",delete_table:"删除表格",rows:"行",columns:"列",add_head:"添加标题",delete_head:"删除标题",title:"标题",image_view:"查看图片",image_position:"位置",none:"无",left:"左",right:"右",image_web_link:"图片网页链接",text:"文本",mailto:"邮箱",web:"网址",video_html_code:"视频嵌入代码",file:"文件",upload:"上传",download:"下载",choose:"选择",or_choose:"或选择",drop_file_here:"将文件拖拽至此区域",align_left:"左对齐",align_center:"居中",align_right:"右对齐",align_justify:"两端对齐",horizontalrule:"水平线",fullscreen:"全屏",deleted:"删除",none:"无",anchor:"锚点",alignment:"对齐方式",link_new_tab:"在新页面打开",subscript:"下标",fontfamily:"字体",fontsize:"字号",fontname1:"Arial",fontname2:"宋体",fontname3:"simsun",fontname4:"微软雅黑",fontsize1:"1",fontsize2:"2",fontsize3:"3",fontsize4:"4",fontsize5:"5",fontsize6:"6",fontsize7:"7",underline:"下划线"};return function(a){jQuery.fn.redactor=function(c){return this.each(function(){var d=a(this),e=d.data("redactor");e||d.data("redactor",e=new b(this,c))})};var b=function(b,c){this.$el=a(b),void 0!==c&&void 0!==c.lang&&"en"!==c.lang&&void 0!==e[c.lang]&&(f=e[c.lang]),this.opts=a.extend({iframe:!1,css:!1,lang:"en",direction:"ltr",callback:!1,keyupCallback:!1,keydownCallback:!1,execCommandCallback:!1,plugins:!1,cleanup:!0,forbidden:!1,focus:!1,tabindex:!1,autoresize:!0,minHeight:!1,fixed:!1,fixedTop:0,fixedBox:!1,source:!0,shortcuts:!0,mobile:!0,air:!1,wym:!1,convertLinks:!0,convertDivs:!0,protocol:"http://",autosave:!1,autosaveCallback:!1,interval:60,imageGetJson:!1,imageUpload:!1,imageUploadCallback:!1,imageUploadErrorCallback:!1,fileUpload:!1,fileUploadCallback:!1,fileUploadErrorCallback:!1,uploadCrossDomain:!1,uploadFields:!1,observeImages:!0,overlay:!0,allowedTags:["form","input","button","select","option","datalist","output","textarea","fieldset","legend","section","header","hgroup","aside","footer","article","details","nav","progress","time","canvas","code","span","div","label","a","br","p","b","i","del","strike","u","img","video","source","track","audio","iframe","object","embed","param","blockquote","mark","cite","small","ul","ol","li","hr","dl","dt","dd","sup","sub","big","pre","code","figure","figcaption","strong","em","table","tr","td","th","tbody","thead","tfoot","h1","h2","h3","h4","h5","h6"],toolbarExternal:!1,buttonsCustom:{},buttonsAdd:[],buttons:["html","formatting","fontfamily","fontsize","bold","italic","underline","deleted","unorderedlist","orderedlist","outdent","indent","image","video","file","table","link","fontcolor","backcolor","alignment","horizontalrule","superscript","subscript"],airButtons:["formatting","|","bold","italic","deleted","|","unorderedlist","orderedlist","outdent","indent","|","fontcolor","backcolor"],formattingTags:["p","blockquote","pre","h1","h2","h3","h4"],activeButtons:["html","formatting","italic","deleted","bold","unorderedlist","underline","orderedlist","outdent","indent","image","alignment","horizontalrule","superscript","subscript","fontfamily","fontsize"],activeButtonsStates:{b:"bold",strong:"bold",i:"italic",em:"italic",del:"deleted",strike:"deleted",ul:"unorderedlist",ol:"orderedlist",u:"underline"},colors:["#ffffff","#000000","#eeece1","#1f497d","#4f81bd","#c0504d","#9bbb59","#8064a2","#4bacc6","#f79646","#ffff00","#f2f2f2","#7f7f7f","#ddd9c3","#c6d9f0","#dbe5f1","#f2dcdb","#ebf1dd","#e5e0ec","#dbeef3","#fdeada","#fff2ca","#d8d8d8","#595959","#c4bd97","#8db3e2","#b8cce4","#e5b9b7","#d7e3bc","#ccc1d9","#b7dde8","#fbd5b5","#ffe694","#bfbfbf","#3f3f3f","#938953","#548dd4","#95b3d7","#d99694","#c3d69b","#b2a2c7","#b7dde8","#fac08f","#f2c314","#a5a5a5","#262626","#494429","#17365d","#366092","#953734","#76923c","#5f497a","#92cddc","#e36c09","#c09100","#7f7f7f","#0c0c0c","#1d1b10","#0f243e","#244061","#632423","#4f6128","#3f3151","#31859b","#974806","#7f6000"],emptyHtml:"<p><br /></p>",buffer:!1,visual:!0,modal_file:String()+'<div class="redactor_modal_content"><form id="redactorUploadFileForm" method="post" action="" enctype="multipart/form-data"><label>Name (optional)</label><input type="text" id="redactor_filename" class="redactor_input" /><div style="margin-top: 7px;"><input type="file" id="redactor_file" name="file" /></div></form><br></div>',modal_image_edit:String()+'<div class="redactor_modal_content"><label>'+f.title+'</label><input id="redactor_file_alt" class="redactor_input" /><label>'+f.link+'</label><input id="redactor_file_link" class="redactor_input" /><label>'+f.image_position+'</label><select id="redactor_form_image_align"><option value="none">'+f.none+'</option><option value="left">'+f.left+'</option><option value="right">'+f.right+'</option></select></div><div class="redactor_modal_footer"><a href="javascript:void(null);" id="redactor_image_delete_btn" class="redactor_modal_btn">'+f._delete+'</a>&nbsp;&nbsp;&nbsp;<a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+f.cancel+'</a><input type="button" name="save" class="redactor_modal_btn" id="redactorSaveBtn" value="'+f.save+'" /></div>',modal_image:String()+'<div class="redactor_modal_content"><div class="redactor_tabs"><a href="javascript:void(null);" class="redactor_tabs_act">'+f.upload+'</a><a href="javascript:void(null);">'+f.choose+'</a><a href="javascript:void(null);">'+f.link+'</a></div><form id="redactorInsertImageForm" method="post" action="" enctype="multipart/form-data"><div id="redactor_tab1" class="redactor_tab"><input type="file" id="redactor_file" name="file" /></div><div id="redactor_tab2" class="redactor_tab" style="display: none;"><div class="redactor_image_box"></div></div></form><div id="redactor_tab3" class="redactor_tab" style="display: none;"><label>'+f.image_web_link+'</label><input type="text" name="redactor_file_link" id="redactor_file_link" class="redactor_input"  /></div></div><div class="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+f.cancel+'</a><input type="button" name="upload" class="redactor_modal_btn" id="redactor_upload_btn" value="'+f.insert+'" /></div>',modal_link:String()+'<div class="redactor_modal_content"><form id="redactorInsertLinkForm" method="post" action=""><div class="redactor_tabs"><a href="javascript:void(null);" class="redactor_tabs_act">URL</a><a href="javascript:void(null);">Email</a><a href="javascript:void(null);">'+f.anchor+'</a></div><input type="hidden" id="redactor_tab_selected" value="1" /><div class="redactor_tab" id="redactor_tab1"><label>URL</label><input type="text" id="redactor_link_url" class="redactor_input"  /><label>'+f.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_url_text" /><label><input type="checkbox" id="redactor_link_blank"> '+f.link_new_tab+'</label></div><div class="redactor_tab" id="redactor_tab2" style="display: none;"><label>Email</label><input type="text" id="redactor_link_mailto" class="redactor_input" /><label>'+f.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_mailto_text" /></div><div class="redactor_tab" id="redactor_tab3" style="display: none;"><label>'+f.anchor+'</label><input type="text" class="redactor_input" id="redactor_link_anchor"  /><label>'+f.text+'</label><input type="text" class="redactor_input redactor_link_text" id="redactor_link_anchor_text" /></div></form></div><div class="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+f.cancel+'</a><input type="button" class="redactor_modal_btn" id="redactor_insert_link_btn" value="'+f.insert+'" /></div>',modal_table:String()+'<div class="redactor_modal_content"><label>'+f.rows+'</label><input type="text" size="5" value="2" id="redactor_table_rows" /><label>'+f.columns+'</label><input type="text" size="5" value="3" id="redactor_table_columns" /></div><div class="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+f.cancel+'</a><input type="button" name="upload" class="redactor_modal_btn" id="redactor_insert_table_btn" value="'+f.insert+'" /></div>',modal_video:String()+'<div class="redactor_modal_content"><form id="redactorInsertVideoForm"><label>'+f.video_html_code+'</label><textarea id="redactor_insert_video_area" style="width: 99%; height: 160px;"></textarea></form></div><div class="redactor_modal_footer"><a href="javascript:void(null);" class="redactor_modal_btn redactor_btn_modal_close">'+f.cancel+'</a><input type="button" class="redactor_modal_btn" id="redactor_insert_video_btn" value="'+f.insert+'" /></div>',toolbar:{html:{title:f.html,func:"toggle"},formatting:{title:f.formatting,func:"show",dropdown:{p:{title:f.paragraph,exec:"formatblock"},blockquote:{title:f.quote,exec:"formatblock",className:"redactor_format_blockquote"},pre:{title:f.code,exec:"formatblock",className:"redactor_format_pre"},h1:{title:f.header1,exec:"formatblock",className:"redactor_format_h1"},h2:{title:f.header2,exec:"formatblock",className:"redactor_format_h2"},h3:{title:f.header3,exec:"formatblock",className:"redactor_format_h3"},h4:{title:f.header4,exec:"formatblock",className:"redactor_format_h4"}}},bold:{title:f.bold,exec:"bold"},italic:{title:f.italic,exec:"italic"},deleted:{title:f.deleted,exec:"strikethrough"},underline:{title:f.underline,exec:"underline"},unorderedlist:{title:"&bull; "+f.unorderedlist,exec:"insertunorderedlist"},orderedlist:{title:"1. "+f.orderedlist,exec:"insertorderedlist"},outdent:{title:"< "+f.outdent,exec:"outdent"},indent:{title:"> "+f.indent,exec:"indent"},image:{title:f.image,func:"showImage"},video:{title:f.video,func:"showVideo"},file:{title:f.file,func:"showFile"},table:{title:f.table,func:"show",dropdown:{insert_table:{title:f.insert_table,func:"showTable"},separator_drop1:{name:"separator"},insert_row_above:{title:f.insert_row_above,func:"insertRowAbove"},insert_row_below:{title:f.insert_row_below,func:"insertRowBelow"},insert_column_left:{title:f.insert_column_left,func:"insertColumnLeft"},insert_column_right:{title:f.insert_column_right,func:"insertColumnRight"},separator_drop2:{name:"separator"},add_head:{title:f.add_head,func:"addHead"},delete_head:{title:f.delete_head,func:"deleteHead"},separator_drop3:{name:"separator"},delete_column:{title:f.delete_column,func:"deleteColumn"},delete_row:{title:f.delete_row,func:"deleteRow"},delete_table:{title:f.delete_table,func:"deleteTable"}}},link:{title:f.link,func:"show",dropdown:{link:{title:f.link_insert,func:"showLink"},unlink:{title:f.unlink,exec:"unlink"}}},fontcolor:{title:f.fontcolor,func:"show"},backcolor:{title:f.backcolor,func:"show"},alignment:{title:f.alignment,func:"show",dropdown:{alignleft:{title:f.align_left,exec:"JustifyLeft"},aligncenter:{title:f.align_center,exec:"JustifyCenter"},alignright:{title:f.align_right,exec:"JustifyRight"},justify:{title:f.align_justify,exec:"JustifyFull"}}},alignleft:{exec:"JustifyLeft",title:f.align_left},aligncenter:{exec:"JustifyCenter",title:f.align_center},alignright:{exec:"JustifyRight",title:f.align_right},justify:{exec:"JustifyFull",title:f.align_justify},horizontalrule:{exec:"inserthorizontalrule",title:f.horizontalrule},superscript:{exec:"superscript",title:f.superscript},subscript:{exec:"subscript",title:f.subscript},fontfamily:{title:f.fontfamily,func:"show",dropdown:{fontname1:{title:f.fontname1,exec:"FontName",className:"fontArial"},fontname2:{title:f.fontname2,exec:"FontName",className:"fontSong"},fontname3:{title:f.fontname3,exec:"FontName",className:"fontSim"},fontname4:{title:f.fontname4,exec:"FontName",className:"fontWei"}}},fontsize:{title:f.fontsize,func:"show",dropdown:{fontsize1:{title:f.fontsize1,exec:"FontSize",className:"fontsize1"},fontsize2:{title:f.fontsize2,exec:"FontSize",className:"fontsize2"},fontsize3:{title:f.fontsize3,exec:"FontSize",className:"fontsize3"},fontsize4:{title:f.fontsize4,exec:"FontSize",className:"fontsize4"},fontsize5:{title:f.fontsize5,exec:"FontSize",className:"fontsize5"},fontsize6:{title:f.fontsize6,exec:"FontSize",className:"fontsize6"},fontsize7:{title:f.fontsize7,exec:"FontSize",className:"fontsize7"}}}}},c,this.$el.data()),this.dropdowns=[],this.init()};b.prototype={init:function(){function b(){if(this.enableAir(),this.buildToolbar(),"object"==typeof this.opts.plugins&&a.each(this.opts.plugins,a.proxy(function(b,c){void 0!==RedactorPlugins[c]&&(a.extend(this,RedactorPlugins[c]),void 0!==RedactorPlugins[c].init&&this.init())},this)),!1!==this.opts.activeButtons&&!1!==this.opts.toolbar){var b=a.proxy(function(){this.observeFormatting()},this);this.$editor.click(b).keyup(b)}var c=!1;if(this.browser("webkit")&&-1===navigator.userAgent.indexOf("Chrome")){this.browser("version").split(".")[0]<536&&(c=!0)}if(!1===this.isMobile(!0)&&!1===c&&this.$editor.bind("paste",a.proxy(function(b){if(!1===this.opts.cleanup)return!0;this.pasteRunning=!0,this.setBuffer(),!0===this.opts.autoresize?this.saveScroll=this.document.body.scrollTop:this.saveScroll=this.$editor.scrollTop();var c=this.extractContent();setTimeout(a.proxy(function(){var a=this.extractContent();this.$editor.append(c),this.restoreSelection();var b=this.getFragmentHtml(a);this.pasteCleanUp(b),this.pasteRunning=!1},this),1)},this)),this.keyup(),this.keydown(),!1!==this.opts.autosave&&this.autoSave(),setTimeout(a.proxy(function(){this.observeImages(),this.observeTables()},this),1),this.browser("mozilla")){this.$editor.click(a.proxy(function(){this.saveSelection()},this));try{this.document.execCommand("enableObjectResizing",!1,!1),this.document.execCommand("enableInlineTableEditing",!1,!1)}catch(a){}}this.opts.focus&&setTimeout(a.proxy(function(){this.$editor.focus()},this),1),this.opts.fixed&&(this.observeScroll(),a(document).scroll(a.proxy(this.observeScroll,this))),"function"==typeof this.opts.callback&&this.opts.callback(this),!1!==this.opts.toolbar&&this.$toolbar.find("a").attr("tabindex","-1")}if(this.height=this.$el.css("height"),this.width=this.$el.css("width"),d=this.document=document,c=this.window=window,!1===this.opts.mobile&&this.isMobile())return this.build(!0),!1;if(this.opts.iframe&&(this.opts.autoresize=!1),this.opts.air)this.opts.buttons=this.opts.airButtons;else if(!1!==this.opts.toolbar){if(!1===this.opts.source){var e=this.opts.buttons.indexOf("html"),f=this.opts.buttons[e+1];this.opts.buttons.splice(e,1),void 0!==f&&"|"===f&&this.opts.buttons.splice(e,1)}a.extend(this.opts.toolbar,this.opts.buttonsCustom),a.each(this.opts.buttonsAdd,a.proxy(function(a,b){this.opts.buttons.push(b)},this))}!1!==this.opts.toolbar&&a.each(this.opts.toolbar.formatting.dropdown,a.proxy(function(b,c){"-1"==a.inArray(b,this.opts.formattingTags)&&delete this.opts.toolbar.formatting.dropdown[b]},this)),this.build(!1,b)},shortcuts:function(a,b){a.preventDefault(),this.execCommand(b,!1)},keyup:function(){this.$editor.keyup(a.proxy(function(a){var b=a.keyCode||a.which;if(this.browser("mozilla")&&!this.pasteRunning&&this.saveSelection(),this.browser("msie")&&this.saveSelection(),"function"==typeof this.opts.keyupCallback&&this.opts.keyupCallback(this,a),8===b||46===b)return this.observeImages(),this.formatEmpty(a);13!==b||a.shiftKey||a.ctrlKey||a.metaKey||(this.browser("webkit")&&this.formatNewLine(a),this.opts.convertLinks&&this.$editor.linkify()),this.syncCode()},this))},keydown:function(){this.$editor.keydown(a.proxy(function(b){var c=b.keyCode||b.which,d=this.getParentNode(),e=this.getCurrentNode(),f=!1,g=b.ctrlKey||b.metaKey;if(!d&&!e||"PRE"!==a(d).get(0).tagName&&"PRE"!==a(e).get(0).tagName||(f=!0),"function"==typeof this.opts.keydownCallback&&this.opts.keydownCallback(this,b),g&&this.opts.shortcuts&&(90===c?!1!==this.opts.buffer?(b.preventDefault(),this.getBuffer()):b.shiftKey?this.shortcuts(b,"redo"):this.shortcuts(b,"undo"):77===c?this.shortcuts(b,"removeFormat"):66===c?this.shortcuts(b,"bold"):73===c?this.shortcuts(b,"italic"):74===c?this.shortcuts(b,"insertunorderedlist"):75===c?this.shortcuts(b,"insertorderedlist"):76===c?this.shortcuts(b,"superscript"):72===c&&this.shortcuts(b,"subscript")),g||90===c||(this.opts.buffer=!1),!0===f&&13===c){b.preventDefault();var h=a(e).parent().text();return this.insertNodeAtCaret(this.document.createTextNode("\r\n")),-1==h.search(/\s$/)&&this.insertNodeAtCaret(this.document.createTextNode("\r\n")),this.syncCode(),!1}if(this.opts.shortcuts&&!b.shiftKey&&9===c){if(!1!==f)return b.preventDefault(),this.insertNodeAtCaret(this.document.createTextNode("\t")),this.syncCode(),!1;this.shortcuts(b,"indent")}else this.opts.shortcuts&&b.shiftKey&&9===c&&this.shortcuts(b,"outdent");if(this.browser("webkit")&&-1===navigator.userAgent.indexOf("Chrome"))return this.safariShiftKeyEnter(b,c)},this))},build:function(b,e){function f(){this.$editor=this.$content.contents().find("body").attr("contenteditable",!0).attr("dir",this.opts.direction),d=this.document=this.$editor[0].ownerDocument,c=this.window=this.document.defaultView||window,!1!==this.opts.css&&this.$content.contents().find("head").append('<link rel="stylesheet" href="'+this.opts.css+'" />'),this.$editor.html(i),e&&(e.call(this),e=null)}if(!0!==b){if(this.$box=a('<div class="redactor_box"></div>'),this.opts.air&&(this.air=a('<div class="redactor_air" style="display: none;"></div>')),this.$content=null,this.textareamode=!0,"TEXTAREA"===this.$el.get(0).tagName){if(this.opts.iframe){var g=this;this.$content=a('<iframe style="width: 100%;" frameborder="0"></iframe>').load(function(){f.call(g)})}else this.$content=this.$editor=a("<div></div>");var h=this.$el.get(0).className.split(/\s+/);a.each(h,a.proxy(function(a,b){this.$content.addClass("redactor_"+b)},this))}else this.textareamode=!1,this.$content=this.$editor=this.$el,this.$el=a('<textarea name="'+this.$editor.attr("id")+'"></textarea>').css("height",this.height);this.$editor&&this.$editor.addClass("redactor_editor").attr("contenteditable",!0).attr("dir",this.opts.direction),!1!==this.opts.tabindex&&this.$content.attr("tabindex",this.opts.tabindex),!1!==this.opts.minHeight&&this.$content.css("min-height",this.opts.minHeight+"px"),!0===this.opts.wym&&this.$content.addClass("redactor_editor_wym"),!1===this.opts.autoresize&&this.$content.css("height",this.height),this.$el.hide();var i="";this.textareamode?(i=this.$el.val(),i=this.savePreCode(i),this.$box.insertAfter(this.$el).append(this.$content).append(this.$el)):(i=this.$editor.html(),i=this.savePreCode(i),this.$box.insertAfter(this.$content).append(this.$el).append(this.$editor)),i=this.paragraphy(i),this.$editor&&this.$editor.html(i),!1===this.textareamode&&this.syncCode()}else if("TEXTAREA"!==this.$el.get(0).tagName){var i=this.$el.val(),j=a('<textarea name="'+this.$editor.attr("id")+'"></textarea>').css("height",this.height).val(i);this.$el.hide(),this.$el.after(j)}e&&this.$editor&&e.call(this)},enableAir:function(){if(!1===this.opts.air)return!1;this.air.hide(),this.$editor.bind("textselect",a.proxy(function(a){this.showAir(a)},this)),this.$editor.bind("textunselect",a.proxy(function(){this.air.hide()},this))},showAir:function(b){a(".redactor_air").hide();var c=this.air.innerWidth(),d=b.clientX;a(this.document).width()<d+c&&(d-=c);var e=b.clientY+a(document).scrollTop()+14;!0===this.opts.iframe&&(e+=this.$box.position().top,d+=this.$box.position().left),this.air.css({left:d+"px",top:e+"px"}).show()},syncCode:function(){this.$el.val(this.$editor.html())},setCode:function(a){a=this.stripTags(a),this.$editor.html(a).focus(),this.syncCode()},getCode:function(){var a="";return a=this.opts.visual?this.$editor.html():this.$el.val(),this.stripTags(a)},insertHtml:function(a){this.$editor.focus(),this.pasteHtmlAtCaret(a),this.observeImages(),this.syncCode()},pasteHtmlAtCaret:function(a){var b,c;if(this.document.getSelection){if(b=this.window.getSelection(),b.getRangeAt&&b.rangeCount){c=b.getRangeAt(0),c.deleteContents();var d=this.document.createElement("div");d.innerHTML=a;for(var e,f,g=this.document.createDocumentFragment();e=d.firstChild;)f=g.appendChild(e);c.insertNode(g),f&&(c=c.cloneRange(),c.setStartAfter(f),c.collapse(!0),b.removeAllRanges(),b.addRange(c))}}else this.document.selection&&"Control"!=this.document.selection.type&&this.document.selection.createRange().pasteHTML(a)},destroy:function(){var b=this.getCode();this.textareamode?(this.$box.after(this.$el),this.$box.remove(),this.$el.height(this.height).val(b).show()):(this.$box.after(this.$editor),this.$box.remove(),this.$editor.removeClass("redactor_editor").removeClass("redactor_editor_wym").attr("contenteditable",!1).html(b).show()),this.opts.toolbarExternal&&a(this.opts.toolbarExternal).empty(),a(".redactor_air").remove();for(var c=0;c<this.dropdowns.length;c++)this.dropdowns[c].remove(),delete this.dropdowns[c];!1!==this.opts.autosave&&clearInterval(this.autosaveInterval)},observeFormatting:function(){var b=this.getCurrentNode();this.inactiveAllButtons(),a.each(this.opts.activeButtonsStates,a.proxy(function(c,d){0!=a(b).closest(c,this.$editor.get()[0]).length&&this.setBtnActive(d)},this));var c=a(b).closest(["p","div","h1","h2","h3","h4","h5","h6","blockquote","td"]);if(void 0!==c[0]&&void 0!==c[0].elem&&0!=a(c[0].elem).size()){switch(a(c[0].elem).css("text-align")){case"right":this.setBtnActive("alignright");break;case"center":this.setBtnActive("aligncenter");break;case"justify":this.setBtnActive("justify");break;default:this.setBtnActive("alignleft")}}},observeImages:function(){if(!1===this.opts.observeImages)return!1;this.$editor.find("img").each(a.proxy(function(b,c){this.browser("msie")&&a(c).attr("unselectable","on"),this.resizeImage(c)},this))},observeTables:function(){this.$editor.find("table").click(a.proxy(this.tableObserver,this))},observeScroll:function(){var b=a(this.document).scrollTop(),c=this.$box.offset().top,d=0;if(b>c){var e="100%";this.opts.fixedBox&&(d=this.$box.offset().left,e=this.$box.innerWidth()),this.fixed=!0,this.$toolbar.css({position:"fixed",width:e,zIndex:1005,top:this.opts.fixedTop+"px",left:d})}else this.fixed=!1,this.$toolbar.css({position:"relative",width:"auto",zIndex:1,top:0,left:d})},setBuffer:function(){this.saveSelection(),this.opts.buffer=this.$editor.html()},getBuffer:function(){if(!1===this.opts.buffer)return!1;this.$editor.html(this.opts.buffer),this.browser("msie")||this.restoreSelection(),this.opts.buffer=!1},execCommand:function(b,c){if(0==this.opts.visual)return this.$el.focus(),!1;try{var d;if("inserthtml"===b)this.browser("msie")?(this.$editor.focus(),this.document.selection.createRange().pasteHTML(c)):this.pasteHtmlAtCaret(c),this.observeImages();else if("unlink"===b)d=this.getParentNode(),"A"===a(d).get(0).tagName?a(d).replaceWith(a(d).text()):this.execRun(b,c);else if("JustifyLeft"===b||"JustifyCenter"===b||"JustifyRight"===b||"JustifyFull"===b){d=this.getCurrentNode();var e=a(d).get(0).tagName;if(!1===this.opts.iframe&&0==a(d).parents(".redactor_editor").size())return!1;var f=["P","DIV","H1","H2","H3","H4","H5","H6","BLOCKQUOTE","TD"];if(-1!=a.inArray(e,f)){var g=!1;"JustifyCenter"===b?g="center":"JustifyRight"===b?g="right":"JustifyFull"===b&&(g="justify"),!1===g?a(d).css("text-align",""):a(d).css("text-align",g)}else this.execRun(b,c)}else if("formatblock"===b&&"blockquote"===c)if(d=this.getCurrentNode(),"BLOCKQUOTE"===a(d).get(0).tagName)if(this.browser("msie")){var h=a("<p>"+a(d).html()+"</p>");a(d).replaceWith(h)}else this.execRun(b,"p");else if("P"===a(d).get(0).tagName){var i=a(d).parent();if("BLOCKQUOTE"===a(i).get(0).tagName){var h=a("<p>"+a(d).html()+"</p>");a(i).replaceWith(h),this.setSelection(h[0],0,h[0],0)}else if(this.browser("msie")){var h=a("<blockquote>"+a(d).html()+"</blockquote>");a(d).replaceWith(h)}else this.execRun(b,c)}else this.execRun(b,c);else if("formatblock"!==b||"pre"!==c&&"p"!==c)if("superscript"==b){var d=this.getCurrentNode();if("SUP"===a(d).get(0).tagName){var h=a(d).html();a(d).replaceWith(h)}else this.execRun(b,c)}else if("subscript"==b){var d=this.getCurrentNode();if("SUB"===a(d).get(0).tagName){var h=a(d).html();a(d).replaceWith(h)}else this.execRun(b,c)}else if("FontName"==b){var j={fontname1:"Arial",fontname2:"宋体",fontname3:"simsun",fontname4:"微软雅黑"};this.execRun(b,j[c])}else if("FontSize"==b){var k={fontsize1:"1",fontsize2:"2",fontsize3:"3",fontsize4:"4",fontsize5:"5",fontsize6:"6",fontsize7:"7"};this.execRun(b,k[c])}else"inserthorizontalrule"===b&&this.browser("msie")&&this.$editor.focus(),"formatblock"===b&&this.browser("mozilla")&&this.$editor.focus(),this.execRun(b,c);else d=this.getParentNode(),"PRE"===a(d).get(0).tagName?a(d).replaceWith("<p>"+this.encodeEntities(a(d).text())+"</p>"):this.execRun(b,c);"inserthorizontalrule"===b&&this.$editor.find("hr").removeAttr("id"),this.syncCode(),this.oldIE()&&this.$editor.focus(),"function"==typeof this.opts.execCommandCallback&&this.opts.execCommandCallback(this,b),this.opts.air&&this.air.hide()}catch(a){}},execRun:function(a,b){"formatblock"===a&&this.browser("msie")&&(b="<"+b+">"),this.document.execCommand(a,!1,b)},formatNewLine:function(b){var c=this.getParentNode();if("DIV"===c.nodeName&&"redactor_editor"===c.className){var d=a(this.getCurrentNode());if("DIV"===d.get(0).tagName&&(""===d.html()||"<br>"===d.html())){var e=a("<p>").append(d.clone().get(0).childNodes);d.replaceWith(e),e.html("<br />"),this.setSelection(e[0],0,e[0],0)}}},safariShiftKeyEnter:function(b,c){return!b.shiftKey||13!==c||(b.preventDefault(),this.insertNodeAtCaret(a("<span><br /></span>").get(0)),this.syncCode(),!1)},formatEmpty:function(b){var c=a.trim(this.$editor.html());this.browser("mozilla")&&(c=c.replace(/<br>/i,""));var d=c.replace(/<(?!img[\s\S]*)[\s\S]*?>/gm,"");if(""===c||""===d){b.preventDefault();var e=a(this.opts.emptyHtml).get(0);return this.$editor.html(e),this.setSelection(e,0,e,0),this.syncCode(),!1}this.syncCode()},paragraphy:function(b){if(""===(b=a.trim(b))||"<p></p>"===b)return this.opts.emptyHtml;this.opts.convertDivs&&(b=b.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2</p>"));var c=function(a,b,c){return a.replace(new RegExp(b,"g"),c)},d=function(a,d){return c(b,a,d)},e="(table|thead|tfoot|caption|colgroup|tbody|tr|td|th|div|dl|dd|dt|ul|ol|li|pre|select|form|blockquote|address|math|style|script|object|input|param|p|h[1-6])";return b+="\n",d("<br />\\s*<br />","\n\n"),d("(<"+e+"[^>]*>)","\n$1"),d("(</"+e+">)","$1\n\n"),d("\r\n|\r","\n"),d("\n\n+","\n\n"),d("\n?((.|\n)+?)$","<p>$1</p>\n"),d("<p>\\s*?</p>",""),d("<p>(<div[^>]*>\\s*)","$1<p>"),d("<p>([^<]+)\\s*?(</(div|address|form)[^>]*>)","<p>$1</p>$2"),d("<p>\\s*(</?"+e+"[^>]*>)\\s*</p>","$1"),d("<p>(<li.+?)</p>","$1"),d("<p>\\s*(</?"+e+"[^>]*>)","$1"),d("(</?"+e+"[^>]*>)\\s*</p>","$1"),d("(</?"+e+"[^>]*>)\\s*<br />","$1"),d("<br />(\\s*</?(p|li|div|dl|dd|dt|th|pre|td|ul|ol)[^>]*>)","$1"),-1!=b.indexOf("<pre")&&d("(<pre(.|\n)*?>)((.|\n)*?)</pre>",function(a,b,d,e){return c(b,"\\\\(['\"\\\\])","$1")+c(c(c(e,"<p>","\n"),"</p>|<br />",""),"\\\\(['\"\\\\])","$1")+"</pre>"}),d("\n</p>$","</p>")},stripTags:function(b){var c=this.opts.allowedTags,d=/<\/?([a-z][a-z0-9]*)\b[^>]*>/gi;return b.replace(d,function(b,d){return a.inArray(d.toLowerCase(),c)>"-1"?b:""})},savePreCode:function(b){var c=b.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);return null!==c&&a.each(c,a.proxy(function(a,c){var d=c.match(/<pre(.*?)>([\w\W]*?)<\/pre>/i);d[2]=this.encodeEntities(d[2]),b=b.replace(c,"<pre"+d[1]+">"+d[2]+"</pre>")},this)),b},encodeEntities:function(a){return a=String(a).replace(/&amp;/g,"&").replace(/&lt;/g,"<").replace(/&gt;/g,">").replace(/&quot;/g,'"'),String(a).replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},cleanupPre:function(a){a=a.replace(/<br>/gi,"\n"),a=a.replace(/<\/p>/gi,"\n"),a=a.replace(/<\/div>/gi,"\n");var b=this.document.createElement("div");return b.innerHTML=a,b.textContent||b.innerText},pasteCleanUp:function(b){var c=this.getParentNode();if("PRE"===a(c).get(0).tagName)return b=this.cleanupPre(b),this.pasteCleanUpInsert(b),!0;b=b.replace(/<!--[\s\S]*?-->|<\?(?:php)?[\s\S]*?\?>/gi,""),b=b.replace(/(&nbsp;){2,}/gi,"&nbsp;"),b=b.replace(/<b\sid="internal-source-marker(.*?)">([\w\W]*?)<\/b>/gi,"$2"),b=this.stripTags(b),b=b.replace(/<td><\/td>/gi,"[td]"),b=b.replace(/<td>&nbsp;<\/td>/gi,"[td]"),b=b.replace(/<td><br><\/td>/gi,"[td]"),b=b.replace(/<a(.*?)href="(.*?)"(.*?)>([\w\W]*?)<\/a>/gi,'[a href="$2"]$4[/a]'),b=b.replace(/<iframe(.*?)>([\w\W]*?)<\/iframe>/gi,"[iframe$1]$2[/iframe]"),b=b.replace(/<video(.*?)>([\w\W]*?)<\/video>/gi,"[video$1]$2[/video]"),b=b.replace(/<audio(.*?)>([\w\W]*?)<\/audio>/gi,"[audio$1]$2[/audio]"),b=b.replace(/<embed(.*?)>([\w\W]*?)<\/embed>/gi,"[embed$1]$2[/embed]"),b=b.replace(/<object(.*?)>([\w\W]*?)<\/object>/gi,"[object$1]$2[/object]"),b=b.replace(/<param(.*?)>/gi,"[param$1]"),b=b.replace(/<img(.*?)style="(.*?)"(.*?)>/gi,"[img$1$3]"),b=b.replace(/<(\w+)([\w\W]*?)>/gi,"<$1>"),b=b.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,""),b=b.replace(/<[^\/>][^>]*>(\s*|\t*|\n*|&nbsp;|<br>)<\/[^>]+>/gi,""),b=b.replace(/\[td\]/gi,"<td>&nbsp;</td>"),b=b.replace(/\[a href="(.*?)"\]([\w\W]*?)\[\/a\]/gi,'<a href="$1">$2</a>'),b=b.replace(/\[iframe(.*?)\]([\w\W]*?)\[\/iframe\]/gi,"<iframe$1>$2</iframe>"),b=b.replace(/\[video(.*?)\]([\w\W]*?)\[\/video\]/gi,"<video$1>$2</video>"),b=b.replace(/\[audio(.*?)\]([\w\W]*?)\[\/audio\]/gi,"<audio$1>$2</audio>"),b=b.replace(/\[embed(.*?)\]([\w\W]*?)\[\/embed\]/gi,"<embed$1>$2</embed>"),b=b.replace(/\[object(.*?)\]([\w\W]*?)\[\/object\]/gi,"<object$1>$2</object>"),b=b.replace(/\[param(.*?)\]/gi,"<param$1>"),b=b.replace(/\[img(.*?)\]/gi,"<img$1>"),this.opts.convertDivs&&(b=b.replace(/<div(.*?)>([\w\W]*?)<\/div>/gi,"<p>$2</p>")),b=b.replace(/<span>([\w\W]*?)<\/span>/gi,"$1"),b=b.replace(/\n{3,}/gi,"\n"),b=b.replace(/<p><p>/gi,"<p>"),b=b.replace(/<\/p><\/p>/gi,"</p>"),this.browser("mozilla")&&(b=b.replace(/<br>$/gi,"")),this.pasteCleanUpInsert(b)},pasteCleanUpInsert:function(b){this.execCommand("inserthtml",b),!0===this.opts.autoresize?a(this.document.body).scrollTop(this.saveScroll):this.$editor.scrollTop(this.saveScroll)},formattingRemove:function(b){var c=[],d=b.match(/<pre(.*?)>([\w\W]*?)<\/pre>/gi);return null!==d&&a.each(d,function(a,d){b=b.replace(d,"prebuffer_"+a),c.push(d)}),b=b.replace(/\s{2,}/g," "),b=b.replace(/\n/g," "),b=b.replace(/[\t]*/g,""),b=b.replace(/\n\s*\n/g,"\n"),b=b.replace(/^[\s\n]*/g,""),b=b.replace(/[\s\n]*$/g,""),b=b.replace(/>\s+</g,"><"),c&&(a.each(c,function(a,c){b=b.replace("prebuffer_"+a,c)}),c=[]),b},formattingIndenting:function(a){return a=a.replace(/<li/g,"\t<li"),a=a.replace(/<tr/g,"\t<tr"),a=a.replace(/<td/g,"\t\t<td"),a=a.replace(/<\/tr>/g,"\t</tr>")},formattingEmptyTags:function(a){for(var b=["<pre></pre>","<blockquote>\\s*</blockquote>","<em>\\s*</em>","<ul></ul>","<ol></ol>","<li></li>","<table></table>","<tr></tr>","<span>\\s*<span>","<span>&nbsp;<span>","<b>\\s*</b>","<b>&nbsp;</b>","<p>\\s*</p>","<p>&nbsp;</p>","<p>\\s*<br>\\s*</p>","<div>\\s*</div>","<div>\\s*<br>\\s*</div>"],c=0;c<b.length;++c){var d=b[c];a=a.replace(new RegExp(d,"gi"),"")}return a},formattingAddBefore:function(a){for(var b="\r\n",c=["<p","<form","</ul>","</ol>","<fieldset","<legend","<object","<embed","<select","<option","<input","<textarea","<pre","<blockquote","<ul","<ol","<li","<dl","<dt","<dd","<table","<thead","<tbody","<caption","</caption>","<th","<tr","<td","<figure"],d=0;d<c.length;++d){var e=c[d];a=a.replace(new RegExp(e,"gi"),b+e)}return a},formattingAddAfter:function(a){for(var b="\r\n",c=["</p>","</div>","</h1>","</h2>","</h3>","</h4>","</h5>","</h6>","<br>","<br />","</dl>","</dt>","</dd>","</form>","</blockquote>","</pre>","</legend>","</fieldset>","</object>","</embed>","</textarea>","</select>","</option>","</table>","</thead>","</tbody>","</tr>","</td>","</th>","</figure>"],d=0;d<c.length;++d){var e=c[d];a=a.replace(new RegExp(e,"gi"),e+b)}return a},formatting:function(a){return a=this.formattingRemove(a),a=this.formattingEmptyTags(a),a=this.formattingAddBefore(a),a=this.formattingAddAfter(a),a=this.formattingIndenting(a)},toggle:function(){var a;if(this.opts.visual){var b=this.$editor.innerHeight();this.$editor.hide(),this.$content.hide(),a=this.$editor.html(),this.$el.height(b).val(a).show().focus(),this.setBtnActive("html"),this.opts.visual=!1}else{this.$el.hide();var a=this.$el.val();this.$editor.html(a).show(),this.$content.show(),""===this.$editor.html()&&this.setCode(this.opts.emptyHtml),this.$editor.focus(),this.setBtnInactive("html"),this.opts.visual=!0,this.observeImages(),this.observeTables()}},autoSave:function(){this.autosaveInterval=setInterval(a.proxy(function(){a.ajax({url:this.opts.autosave,type:"post",data:this.$el.attr("name")+"="+escape(encodeURIComponent(this.getCode())),success:a.proxy(function(a){"function"==typeof this.opts.autosaveCallback&&this.opts.autosaveCallback(a,this)},this)})},this),1e3*this.opts.interval)},buildToolbar:function(){if(!1===this.opts.toolbar)return!1;if(this.$toolbar=a("<ul>").addClass("redactor_toolbar"),this.opts.air?(a(this.air).append(this.$toolbar),a("body").append(this.air)):!1===this.opts.toolbarExternal?this.$box.prepend(this.$toolbar):a(this.opts.toolbarExternal).html(this.$toolbar),this.opts.forbidden)var b=this,c=a.map(this.opts.buttons,function(c){if(a.inArray(c,b.opts.forbidden)<0)return c});else var c=this.opts.buttons;a.each(c,a.proxy(function(b,c){if("|"!==c&&void 0!==this.opts.toolbar[c]){var d=this.opts.toolbar[c];if(!1===this.opts.fileUpload&&"file"===c)return!0;this.$toolbar.append(a("<li>").append(this.buildButton(c,d)))}},this))},buildButton:function(b,c){var d=a('<a href="javascript:void(null);" title="'+c.title+'" class="redactor_btn_'+b+'"></a>');if(void 0===c.func?d.click(a.proxy(function(){-1!=a.inArray(b,this.opts.activeButtons)&&(this.inactiveAllButtons(),this.setBtnActive(b)),this.browser("mozilla")&&this.$editor.focus(),this.execCommand(c.exec,b)},this)):"show"!==c.func&&d.click(a.proxy(function(a){this[c.func](a)},this)),void 0!==c.callback&&!1!==c.callback&&d.click(a.proxy(function(a){c.callback(this,a,b)},this)),"backcolor"===b||"fontcolor"===b||void 0!==c.dropdown){var e=a('<div class="redactor_dropdown" style="display: none;">');e="backcolor"===b||"fontcolor"===b?this.buildColorPicker(e,b):this.buildDropdown(e,c.dropdown),this.dropdowns.push(e.appendTo(this.$box)),this.hdlShowDropDown=a.proxy(function(a){this.showDropDown(a,e,b)},this),d.click(this.hdlShowDropDown)}return d},buildDropdown:function(b,c){return a.each(c,a.proxy(function(c,d){void 0===d.className&&(d.className="");var e;void 0!==d.name&&"separator"===d.name?e=a('<a class="redactor_separator_drop">'):(e=a('<a href="javascript:void(null);" class="'+d.className+'">'+d.title+"</a>"),"function"==typeof d.callback?a(e).click(a.proxy(function(a){d.callback(this,a,c)},this)):void 0===d.func?a(e).click(a.proxy(function(){this.execCommand(d.exec,c)},this)):a(e).click(a.proxy(function(a){this[d.func](a)},this))),a(b).append(e)},this)),b},buildColorPicker:function(b,c){var d;d="backcolor"===c?this.browser("msie")?"BackColor":"hilitecolor":"forecolor",a(b).width(210);for(var e=this.opts.colors.length,g=0;g<e;++g){var h=this.opts.colors[g],i=a('<a rel="'+h+'" href="javascript:void(null);" class="redactor_color_link"></a>').css({backgroundColor:h});a(b).append(i);var j=this;a(i).click(function(){j.execCommand(d,a(this).attr("rel")),"forecolor"===d&&j.$editor.find("font").replaceWith(function(){return a('<span style="color: '+a(this).attr("color")+';">'+a(this).html()+"</span>")}),j.browser("msie")&&"BackColor"===d&&j.$editor.find("font").replaceWith(function(){return a('<span style="'+a(this).attr("style")+'">'+a(this).html()+"</span>")})})}var k=a('<a href="javascript:void(null);" class="redactor_color_none"></a>').html(f.none);return"backcolor"===c?k.click(a.proxy(this.setBackgroundNone,this)):k.click(a.proxy(this.setColorNone,this)),a(b).append(k),b},setBackgroundNone:function(){a(this.getParentNode()).css("background-color","transparent"),this.syncCode()},setColorNone:function(){a(this.getParentNode()).attr("color","").css("color",""),this.syncCode()},showDropDown:function(b,c,d){if(this.getBtn(d).hasClass("dropact"))this.hideAllDropDown();else{this.hideAllDropDown(),this.setBtnActive(d),this.getBtn(d).addClass("dropact");var e=this.getBtn(d).offset().left-this.$box.offset().left;if(this.opts.air){var f=this.air.offset().top-this.$box.offset().top;a(c).appendTo(this.$box),a(c).css({position:"absolute",left:e+"px",top:f+30+"px"}).show()}else if(this.opts.fixed&&this.fixed)a(c).appendTo(this.$box),a(c).css({position:"fixed",left:e+"px",top:"30px"}).show();else{var g=this.$toolbar.offset().top+30-this.$box.offset().top;a(c).appendTo(this.$box),a(c).css({position:"absolute",left:e+"px",top:g+"px"}).show()}}var h=a.proxy(function(a){this.hideDropDown(a,c,d)},this);c.one("click",h),a(document).one("click",h),this.$editor.one("click",h),this.$content.one("click",h),b.stopPropagation()},hideAllDropDown:function(){this.$toolbar.find("a.dropact").removeClass("redactor_act").removeClass("dropact"),a(".redactor_dropdown").hide()},hideDropDown:function(b,c,d){a(b.target).hasClass("dropact")||(a(c).removeClass("dropact"),this.showedDropDown=!1,this.hideAllDropDown())},getBtn:function(b){return!1!==this.opts.toolbar&&a(this.$toolbar.find("a.redactor_btn_"+b))},setBtnActive:function(a){var b=this.returnClassName(this.getBtn(a));this.getBtn(a).addClass(b+"_act")},returnClassName:function(b){for(var c=a.map(this.opts.activeButtons,function(a){return"redactor_btn_"+a}),d=0;d<c.length;d++)if(b.hasClass(c[d]))return c[d];return!1},setBtnInactive:function(a){var b=this.returnClassName(this.getBtn(a));this.getBtn(a).removeClass(b+"_act")},inactiveAllButtons:function(){a.each(this.opts.activeButtons,a.proxy(function(a,b){this.setBtnInactive(b)},this))},changeBtnIcon:function(a,b){var c=this.returnClassName(this.getBtn(a));this.getBtn(a).addClass("redactor_btn_"+c)},removeBtnIcon:function(a,b){var c=this.returnClassName(this.getBtn(a));this.getBtn(a).removeClass("redactor_btn_"+c)},addBtnSeparator:function(){},addBtnSeparatorAfter:function(a){this.getBtn(a)},addBtnSeparatorBefore:function(a){this.getBtn(a)},removeBtnSeparatorAfter:function(a){this.getBtn(a).parent().next().remove()},removeBtnSeparatorBefore:function(a){this.getBtn(a).parent().prev().remove()},setBtnRight:function(a){if(!1===this.opts.toolbar)return!1;this.getBtn(a).parent().addClass("redactor_btn_right")},setBtnLeft:function(a){if(!1===this.opts.toolbar)return!1;this.getBtn(a).parent().removeClass("redactor_btn_right")},addBtn:function(b,c,d,e){if(!1===this.opts.toolbar)return!1;var f=this.buildButton(b,{title:c,callback:d,dropdown:e});this.$toolbar.append(a("<li>").append(f))},addBtnFirst:function(b,c,d,e){if(!1===this.opts.toolbar)return!1;var f=this.buildButton(b,{title:c,callback:d,dropdown:e});this.$toolbar.prepend(a("<li>").append(f))},addBtnAfter:function(b,c,d,e,f){if(!1===this.opts.toolbar)return!1;var g=this.buildButton(c,{title:d,callback:e,dropdown:f});this.getBtn(b).parent().after(a("<li>").append(g))},addBtnBefore:function(b,c,d,e,f){if(!1===this.opts.toolbar)return!1;var g=this.buildButton(c,{title:d,callback:e,dropdown:f});this.getBtn(b).parent().before(a("<li>").append(g))},removeBtn:function(a,b){var c=this.getBtn(a);!0===b&&c.parent().next().remove(),c.parent().removeClass("redactor_btn_right"),c.remove()},getFragmentHtml:function(a){var b=a.cloneNode(!0),c=this.document.createElement("div");return c.appendChild(b),c.innerHTML},extractContent:function(){for(var a,b=this.$editor.get(0),c=this.document.createDocumentFragment();a=b.firstChild;)c.appendChild(a);return c},saveSelection:function(){this.$editor.focus(),this.savedSel=this.getOrigin(),this.savedSelObj=this.getFocus()},restoreSelection:function(){void 0!==this.savedSel&&null!==this.savedSel&&null!==this.savedSelObj&&"BODY"!==this.savedSel[0].tagName?!1===this.opts.iframe&&0==a(this.savedSel[0]).closest(".redactor_editor").size()?this.$editor.focus():(this.browser("opera")&&this.$editor.focus(),this.setSelection(this.savedSel[0],this.savedSel[1],this.savedSelObj[0],this.savedSelObj[1]),this.browser("mozilla")&&this.$editor.focus()):this.$editor.focus()},getSelection:function(){var a=this.document;return this.oldIE()?a.selection.createRange():this.window.getSelection?this.window.getSelection():a.getSelection?a.getSelection():a.selection.createRange()},hasSelection:function(){if(this.oldIE()){var a,b=this.$editor.get(0);return!!this.$editor.is(":visible")&&(b.focus(),!!b.document&&((a=b.document.selection.createRange())&&a.parentElement().document===b.document))}var c;return(c=this.getSelection())&&null!=c.focusNode&&null!=c.anchorNode},getOrigin:function(){if(this.oldIE()){var a,b=this.$editor.get(0);return this.$editor.is(":visible")&&b.focus(),this.hasSelection()?(a=b.document.selection.createRange(),this._getBoundary(b.document,a,!0)):null}var c;return(c=this.getSelection())&&null!=c.anchorNode?[c.anchorNode,c.anchorOffset]:null},getFocus:function(){if(this.oldIE()){var a,b=this.$editor.get(0);return this.$editor.is(":visible")&&b.focus(),this.hasSelection()?(a=b.document.selection.createRange(),this._getBoundary(b.document,a,!1)):null}var c;return(c=this.getSelection())&&null!=c.focusNode?[c.focusNode,c.focusOffset]:null},setSelection:function(a,b,c,d){if(null==c&&(c=a),null==d&&(d=b),this.oldIE()){var e=this.$editor.get(0),f=e.document.body.createTextRange();return this._moveBoundary(e.document,f,!1,c,d),this._moveBoundary(e.document,f,!0,a,b),f.select()}var g=this.getSelection();if(g)if(g.collapse&&g.extend)g.collapse(a,b),g.extend(c,d);else{r=this.document.createRange(),r.setStart(a,b),r.setEnd(c,d);try{g.removeAllRanges()}catch(a){}g.addRange(r)}},getCurrentNode:function(){return void 0!==this.window.getSelection?this.getSelectedNode().parentNode:void 0!==this.document.selection?this.getSelection().parentElement():void 0},getParentNode:function(){return a(this.getCurrentNode()).parent()[0]},getSelectedNode:function(){if(this.oldIE())return this.getSelection().parentElement();if(void 0!==this.window.getSelection){return this.window.getSelection().rangeCount>0&&this.getSelection().getRangeAt(0).commonAncestorContainer}return void 0!==this.document.selection?this.getSelection():void 0},_getBoundary:function(a,b,c){var d,e,f,g,h;for(e=a.createElement("a"),d=b.duplicate(),d.collapse(c),h=d.parentElement();;)if(h.insertBefore(e,e.previousSibling),d.moveToElementText(e),!(d.compareEndPoints(c?"StartToStart":"StartToEnd",b)>0&&null!=e.previousSibling))break;return-1===d.compareEndPoints(c?"StartToStart":"StartToEnd",b)&&e.nextSibling?(d.setEndPoint(c?"EndToStart":"EndToEnd",b),f=e.nextSibling,g=d.text.length):(f=e.parentNode,g=this._getChildIndex(e)),e.parentNode.removeChild(e),[f,g]},_moveBoundary:function(a,b,c,d,e){var f,g,h,i,j;return j=0,f=this._isText(d)?d:d.childNodes[e],g=this._isText(d)?d.parentNode:d,this._isText(d)&&(j=e),i=a.createElement("a"),g.insertBefore(i,f||null),h=a.body.createTextRange(),h.moveToElementText(i),i.parentNode.removeChild(i),b.setEndPoint(c?"StartToStart":"EndToEnd",h),b[c?"moveStart":"moveEnd"]("character",j)},_isText:function(a){return null!=a&&3==a.nodeType},_getChildIndex:function(a){for(var b=0;a=a.previousSibling;)b++;return b},insertNodeAfterCaret:function(a){this.saveSelection(),this.insertNodeAtCaret(a),this.restoreSelection()},insertNodeAtCaret:function(a){if(this.window.getSelection){var b=this.getSelection();if(b.rangeCount){var c=b.getRangeAt(0);c.collapse(!1),c.insertNode(a),c=c.cloneRange(),c.selectNodeContents(a),c.collapse(!1),b.removeAllRanges(),b.addRange(c)}}else if(this.document.selection){var d=1===a.nodeType?a.outerHTML:a.data,e="marker_"+(""+Math.random()).slice(2);d+='<span id="'+e+'"></span>';var f=this.getSelection();f.collapse(!1),f.pasteHTML(d);var g=this.document.getElementById(e);f.moveToElementText(g),f.select(),g.parentNode.removeChild(g)}},getSelectedHtml:function(){var a="";if(this.window.getSelection){var b=this.window.getSelection();if(b.rangeCount){for(var c=this.document.createElement("div"),d=0,e=b.rangeCount;d<e;++d)c.appendChild(b.getRangeAt(d).cloneContents());a=c.innerHTML}}else this.document.selection&&"Text"===this.document.selection.type&&(a=this.document.selection.createRange().htmlText);return a},resizeImage:function(b){var c,d,e=!1,f=!1,g=a(b).width()/a(b).height();a(b).off("hover mousedown mouseup click mousemove"),a(b).hover(function(){a(b).css("cursor","nw-resize")},function(){a(b).css("cursor",""),e=!1}),a(b).mousedown(function(h){h.preventDefault(),g=a(b).width()/a(b).height(),e=!0,f=!0,c=Math.round(h.pageX-a(b).eq(0).offset().left),d=Math.round(h.pageY-a(b).eq(0).offset().top)}),a(b).mouseup(a.proxy(function(c){e=!1,a(b).css("cursor",""),this.syncCode()},this)),a(b).click(a.proxy(function(a){f&&this.imageEdit(a)},this)),a(b).mousemove(function(h){if(e){f=!1;var i=(Math.round(h.pageX-a(this).eq(0).offset().left),Math.round(h.pageY-a(this).eq(0).offset().top)-d),j=a(b).height(),k=parseInt(j,10)+i,l=k*g;l>10&&a(b).width(l),k>10&&a(b).height(k),c=Math.round(h.pageX-a(this).eq(0).offset().left),d=Math.round(h.pageY-a(this).eq(0).offset().top)}})},showTable:function(){this.saveSelection(),this.modalInit(f.table,this.opts.modal_table,300,a.proxy(function(){a("#redactor_insert_table_btn").click(a.proxy(this.insertTable,this)),setTimeout(function(){a("#redactor_table_rows").focus()},200)},this))},insertTable:function(){for(var b=a("#redactor_table_rows").val(),c=a("#redactor_table_columns").val(),d=a("<div></div>"),e=Math.floor(99999*Math.random()),f=a('<table id="table'+e+'"><tbody></tbody></table>'),g=0;g<b;g++){for(var h=a("<tr></tr>"),i=0;i<c;i++){var j=a("<td><br></td>");a(h).append(j)}a(f).append(h)}a(d).append(f);var k=a(d).html()+"<p></p>";this.restoreSelection(),this.execCommand("inserthtml",k),this.modalClose(),this.observeTables()},tableObserver:function(b){this.$table=a(b.target).closest("table"),this.$table_tr=this.$table.find("tr"),this.$table_td=this.$table.find("td"),this.$tbody=a(b.target).closest("tbody"),this.$thead=a(this.$table).find("thead"),this.$current_td=a(b.target),this.$current_tr=a(b.target).closest("tr")},deleteTable:function(){a(this.$table).remove(),this.$table=!1,this.syncCode()},deleteRow:function(){a(this.$current_tr).remove(),this.syncCode()},deleteColumn:function(){var b=a(this.$current_td).get(0).cellIndex;a(this.$table).find("tr").each(function(){a(this).find("td").eq(b).remove()}),this.syncCode()},addHead:function(){if(0!==a(this.$table).find("thead").size())this.deleteHead();else{var b=a(this.$table).find("tr").first().clone();b.find("td").html("&nbsp;"),this.$thead=a("<thead></thead>"),this.$thead.append(b),a(this.$table).prepend(this.$thead),this.syncCode()}},deleteHead:function(){a(this.$thead).remove(),this.$thead=!1,this.syncCode()},insertRowAbove:function(){this.insertRow("before")},insertRowBelow:function(){this.insertRow("after")},insertColumnLeft:function(){this.insertColumn("before")},insertColumnRight:function(){this.insertColumn("after")},insertRow:function(b){var c=a(this.$current_tr).clone();c.find("td").html("&nbsp;"),"after"===b?a(this.$current_tr).after(c):a(this.$current_tr).before(c),this.syncCode()},insertColumn:function(b){var c=0;if(this.$current_tr){this.$current_tr.find("td")&&(this.$current_tr.find("td").each(a.proxy(function(b,d){a(d)[0]===this.$current_td[0]&&(c=b)},this)),this.$table_tr.each(function(d,e){var f=a(e).find("td").eq(c),g=f.clone();g.html("&nbsp;"),"after"===b?a(f).after(g):a(f).before(g)}),this.syncCode())}},showVideo:function(){this.saveSelection(),this.modalInit(f.video,this.opts.modal_video,600,a.proxy(function(){a("#redactor_insert_video_btn").click(a.proxy(this.insertVideo,this)),setTimeout(function(){a("#redactor_insert_video_area").focus()},200)},this))},insertVideo:function(){var b=a("#redactor_insert_video_area").val();b=this.stripTags(b),this.restoreSelection(),this.execCommand("inserthtml",b),this.modalClose()},imageEdit:function(b){var c=a(b.target),d=c.parent(),e=a.proxy(function(){a("#redactor_file_alt").val(c.attr("alt")),a("#redactor_image_edit_src").attr("href",c.attr("src")),a("#redactor_form_image_align").val(c.css("float")),"A"===a(d).get(0).tagName&&a("#redactor_file_link").val(a(d).attr("href")),a("#redactor_image_delete_btn").click(a.proxy(function(){this.imageDelete(c)},this)),a("#redactorSaveBtn").click(a.proxy(function(){this.imageSave(c)},this))},this);this.modalInit(f.image,this.opts.modal_image_edit,380,e)},imageDelete:function(b){a(b).remove(),this.modalClose(),this.syncCode()},imageSave:function(b){var c=a(b).parent();a(b).attr("alt",a("#redactor_file_alt").val());var d=a("#redactor_form_image_align").val();"left"===d?a(b).css({float:"left",margin:"0 10px 10px 0"}):"right"===d?a(b).css({float:"right",margin:"0 0 10px 10px"}):a(b).css({float:"none",margin:"0"});var e=a.trim(a("#redactor_file_link").val());""!==e?"A"!==a(c).get(0).tagName?a(b).replaceWith('<a href="'+e+'">'+this.outerHTML(b)+"</a>"):a(c).attr("href",e):"A"===a(c).get(0).tagName&&a(c).replaceWith(this.outerHTML(b)),this.modalClose(),this.observeImages(),this.syncCode()},showImage:function(){return},imageSetThumb:function(b){this._imageSet('<img src="'+a(b.target).attr("rel")+'" alt="'+a(b.target).attr("title")+'" />',!0)},imageUploadCallbackLink:function(){if(""!==a("#redactor_file_link").val()){var b='<img src="'+a("#redactor_file_link").val()+'" />';this._imageSet(b,!0)}else this.modalClose()},imageUploadCallback:function(a){this._imageSet(a)},_imageSet:function(a,b){if(this.restoreSelection(),!1!==a){var c="";c=!0!==b?'<p><img src="'+a.filelink+'" /></p>':a,this.execCommand("inserthtml",c),!0!==b&&"function"==typeof this.opts.imageUploadCallback&&this.opts.imageUploadCallback(this,a)}this.modalClose(),this.observeImages()},showLink:function(){this.saveSelection();var b=a.proxy(function(){this.insert_link_node=!1;var b=this.getSelection(),c="",d="",e="";if(this.browser("msie")){var f=this.getParentNode();"A"===f.nodeName?(this.insert_link_node=a(f),d=this.insert_link_node.text(),c=this.insert_link_node.attr("href"),e=this.insert_link_node.attr("target")):d=this.oldIE()?b.text:b.toString()}else b&&b.anchorNode&&"A"===b.anchorNode.parentNode.tagName?(c=b.anchorNode.parentNode.href,d=b.anchorNode.parentNode.text,e=b.anchorNode.parentNode.target,""===b.toString()&&(this.insert_link_node=b.anchorNode.parentNode)):d=b.toString();a(".redactor_link_text").val(d);var g=self.location.href.replace(/\/$/i,""),h=c.replace(g,"");0===c.search("mailto:")?(this.setModalTab(2),a("#redactor_tab_selected").val(2),a("#redactor_link_mailto").val(c.replace("mailto:",""))):0===h.search(/^#/gi)?(this.setModalTab(3),a("#redactor_tab_selected").val(3),a("#redactor_link_anchor").val(h.replace(/^#/gi,""))):a("#redactor_link_url").val(h),"_blank"===e&&a("#redactor_link_blank").attr("checked",!0),a("#redactor_insert_link_btn").click(a.proxy(this.insertLink,this)),setTimeout(function(){a("#redactor_link_url").focus()},200)},this);this.modalInit(f.link,this.opts.modal_link,460,b)},insertLink:function(){var b=a("#redactor_tab_selected").val(),c="",d="",e="";if("1"===b){c=a("#redactor_link_url").val(),d=a("#redactor_link_url_text").val(),a("#redactor_link_blank").attr("checked")&&(e=' target="_blank"');var f="/(w+:{0,1}w*@)?(S+)(:[0-9]+)?(/|/([w#!:.?+=&%@!-/]))?/",g=new RegExp("^(http|ftp|https)://"+f,"i"),h=new RegExp("^"+f,"i");-1==c.search(g)&&0==c.search(h)&&!1!==this.opts.protocol&&(c=this.opts.protocol+c)}else"2"===b?(c="mailto:"+a("#redactor_link_mailto").val(),d=a("#redactor_link_mailto_text").val()):"3"===b&&(c="#"+a("#redactor_link_anchor").val(),d=a("#redactor_link_anchor_text").val());this._insertLink('<a href="'+c+'"'+e+">"+d+"</a>",a.trim(d),c,e)},_insertLink:function(b,c,d,e){this.$editor.focus(),this.restoreSelection(),""!==c&&(this.insert_link_node?(a(this.insert_link_node).text(c),a(this.insert_link_node).attr("href",d),""!==e?a(this.insert_link_node).attr("target",e):a(this.insert_link_node).removeAttr("target"),this.syncCode()):this.execCommand("inserthtml",b)),this.modalClose()},showFile:function(){this.saveSelection();var b=a.proxy(function(){var b=this.getSelection(),c="";c=this.oldIE()?b.text:b.toString(),a("#redactor_filename").val(c),!1===this.opts.uploadCrossDomain&&!1===this.isMobile()&&a("#redactor_file").dragupload({url:this.opts.fileUpload,uploadFields:this.opts.uploadFields,success:a.proxy(this.fileUploadCallback,this),error:a.proxy(this.opts.fileUploadErrorCallback,this)}),this.uploadInit("redactor_file",{auto:!0,url:this.opts.fileUpload,success:a.proxy(this.fileUploadCallback,this),error:a.proxy(this.opts.fileUploadErrorCallback,this)})},this);this.modalInit(f.file,this.opts.modal_file,500,b)},fileUploadCallback:function(b){if(this.restoreSelection(),!1!==b){var c=a("#redactor_filename").val();""===c&&(c=b.filename);var d='<a href="'+b.filelink+'">'+c+"</a>";this.browser("webkit")&&this.window.chrome&&(d+="&nbsp;"),this.execCommand("inserthtml",d),"function"==typeof this.opts.fileUploadCallback&&this.opts.fileUploadCallback(this,b)}this.modalClose()},modalInit:function(b,c,d,e){if(0===a(".redactor_modal_overlay").size()&&(this.overlay=a('<div class="redactor_modal_overlay" style="display: none;"></div>'),a("body").prepend(this.overlay)),this.opts.overlay&&(a(".redactor_modal_overlay").show(),a(".redactor_modal_overlay").click(a.proxy(this.modalClose,this))),0===a(".redactor_modal").size()&&(this.modal=a('<div class="redactor_modal" style="display: none;"><div class="redactor_modal_close">&times;</div><div class="redactor_modal_header"></div><div id="redactor_modal_inner"></div></div>'),a("body").append(this.modal)),a(".redactor_modal_close").click(a.proxy(this.modalClose,this)),this.hdlModalClose=a.proxy(function(a){if(27===a.keyCode)return this.modalClose(),!1},this),a(document).keyup(this.hdlModalClose),this.$editor.keyup(this.hdlModalClose),0==c.indexOf("#")?a("#redactor_modal_inner").empty().append(a(c).html()):a("#redactor_modal_inner").empty().append(c),a(".redactor_modal_header").html(b),void 0!==a.fn.draggable&&(a(".redactor_modal").draggable({handle:".redactor_modal_header"}),a(".redactor_modal_header").css("cursor","move")),0!==a(".redactor_tabs").size()){var f=this;a(".redactor_tabs a").each(function(b,c){b++,a(c).click(function(){if(a(".redactor_tabs a").removeClass("redactor_tabs_act"),a(this).addClass("redactor_tabs_act"),a(".redactor_tab").hide(),a("#redactor_tab"+b).show(),a("#redactor_tab_selected").val(b),!1===f.isMobile()){var c=a(".redactor_modal").outerHeight();a(".redactor_modal").css("margin-top","-"+(c+10)/2+"px")}})})}a(".redactor_modal .redactor_btn_modal_close").click(a.proxy(this.modalClose,this)),!1===this.isMobile()?(a(".redactor_modal").css({position:"fixed",top:"-2000px",left:"50%",width:d+"px",marginLeft:"-"+(d+60)/2+"px"}).show(),this.modalSaveBodyOveflow=a(document.body).css("overflow"),a(document.body).css("overflow","hidden")):a(".redactor_modal").css({position:"fixed",width:"100%",height:"100%",top:"0",left:"0",margin:"0",minHeight:"300px"}).show(),"function"==typeof e&&e(),!1===this.isMobile()&&setTimeout(function(){var b=a(".redactor_modal").outerHeight();a(".redactor_modal").css({top:"50%",height:"auto",minHeight:"auto",marginTop:"-"+(b+10)/2+"px"})},20)},modalClose:function(){return a(".redactor_modal_close").unbind("click",this.modalClose),a(".redactor_modal").fadeOut("fast",a.proxy(function(){a("#redactor_modal_inner").html(""),this.opts.overlay&&(a(".redactor_modal_overlay").hide(),a(".redactor_modal_overlay").unbind("click",this.modalClose)),a(document).unbind("keyup",this.hdlModalClose),this.$editor.unbind("keyup",this.hdlModalClose)},this)),!1===this.isMobile()&&a(document.body).css("overflow",this.modalSaveBodyOveflow?this.modalSaveBodyOveflow:"visible"),!1},setModalTab:function(b){a(".redactor_tab").hide();var c=a(".redactor_tabs a");c.removeClass("redactor_tabs_act"),c.eq(b-1).addClass("redactor_tabs_act"),a("#redactor_tab"+b).show()},uploadInit:function(b,c){this.uploadOptions={url:!1,success:!1,error:!1,start:!1,trigger:!1,auto:!1,input:!1},a.extend(this.uploadOptions,c),0!==a("#"+b).size()&&"INPUT"===a("#"+b).get(0).tagName?(this.uploadOptions.input=a("#"+b),this.element=a(a("#"+b).get(0).form)):this.element=a("#"+b),this.element_action=this.element.attr("action"),this.uploadOptions.auto?a(this.uploadOptions.input).change(a.proxy(function(){this.element.submit(function(a){return!1}),this.uploadSubmit()},this)):this.uploadOptions.trigger&&a("#"+this.uploadOptions.trigger).click(a.proxy(this.uploadSubmit,this))},uploadSubmit:function(){this.uploadForm(this.element,this.uploadFrame())},uploadFrame:function(){this.id="f"+Math.floor(99999*Math.random());var b=this.document.createElement("div"),c='<iframe style="display:none" id="'+this.id+'" name="'+this.id+'"></iframe>';return b.innerHTML=c,a(b).appendTo("body"),this.uploadOptions.start&&this.uploadOptions.start(),a("#"+this.id).load(a.proxy(this.uploadLoaded,this)),this.id},uploadForm:function(b,c){if(this.uploadOptions.input){var d="redactorUploadForm"+this.id,e="redactorUploadFile"+this.id;this.form=a('<form  action="'+this.uploadOptions.url+'" method="POST" target="'+c+'" name="'+d+'" id="'+d+'" enctype="multipart/form-data"></form>'),!1!==this.opts.uploadFields&&"object"==typeof this.opts.uploadFields&&a.each(this.opts.uploadFields,a.proxy(function(b,c){0===c.toString().indexOf("#")&&(c=a(c).val());var d=a("<input/>",{type:"hidden",name:b,value:c});a(this.form).append(d)},this));var f=this.uploadOptions.input,g=a(f).clone();a(f).attr("id",e),a(f).before(g),a(f).appendTo(this.form),a(this.form).css("position","absolute"),a(this.form).css("top","-2000px"),a(this.form).css("left","-2000px"),a(this.form).appendTo("body"),this.form.submit()}else b.attr("target",c),b.attr("method","POST"),b.attr("enctype","multipart/form-data"),b.attr("action",this.uploadOptions.url),this.element.submit()},uploadLoaded:function(){var b,c=a("#"+this.id)[0];if(b=c.contentDocument?c.contentDocument:c.contentWindow?c.contentWindow.document:window.frames[this.id].document,this.uploadOptions.success)if(void 0!==b){var d=b.body.innerHTML,e=d.match(/\{(.|\n)*\}/)[0],f=a.parseJSON(e);void 0===f.error?this.uploadOptions.success(f):(this.uploadOptions.error(this,f),this.modalClose())}else alert("Upload failed!"),this.modalClose();this.element.attr("action",this.element_action),this.element.attr("target","")},browser:function(a){var b=navigator.userAgent.toLowerCase(),c=/(chrome)[ \/]([\w.]+)/.exec(b)||/(webkit)[ \/]([\w.]+)/.exec(b)||/(opera)(?:.*version|)[ \/]([\w.]+)/.exec(b)||/(msie) ([\w.]+)/.exec(b)||b.indexOf("compatible")<0&&/(mozilla)(?:.*? rv:([\w.]+)|)/.exec(b)||[];return"version"==a?c[2]:"webkit"==a?"chrome"==c[1]||"webkit"==c[1]:c[1]==a},oldIE:function(){return!!(this.browser("msie")&&parseInt(this.browser("version"),10)<9)},outerHTML:function(b){return a("<p>").append(a(b).eq(0).clone()).html()},normalize:function(a){return parseInt(a.replace("px",""),10)},isMobile:function(a){return!(!0!==a||!/(iPhone|iPod|iPad|BlackBerry|Android)/.test(navigator.userAgent))||!!/(iPhone|iPod|BlackBerry|Android)/.test(navigator.userAgent)},selectText:function(){}},a.fn.getObject=function(){return this.data("redactor")},a.fn.selectText=function(){var a=document,b=this[0];if(a.body.createTextRange){var c=document.body.createTextRange();c.moveToElementText(b),c.select()}else if(window.getSelection){var d=window.getSelection(),c=document.createRange();c.selectNodeContents(b),d.removeAllRanges(),d.addRange(c)}},a.fn.getEditor=function(){return this.data("redactor").$editor},a.fn.getCode=function(){return a.trim(this.data("redactor").getCode())},a.fn.getText=function(){return this.data("redactor").$editor.text()},a.fn.getSelected=function(){return this.data("redactor").getSelectedHtml()},a.fn.setCode=function(a){this.data("redactor").setCode(a)},a.fn.insertHtml=function(a){this.data("redactor").insertHtml(a)},a.fn.destroyEditor=function(){this.each(function(){void 0!==a(this).data("redactor")&&(a(this).data("redactor").destroy(),a(this).removeData("redactor"))})},a.fn.setFocus=function(){this.data("redactor").$editor.focus()},a.fn.execCommand=function(a,b){this.data("redactor").execCommand(a,b)},a.fn.saveSelection=function(a,b){this.data("redactor").saveSelection()},a.fn.restoreSelection=function(a,b){this.data("redactor").restoreSelection()}}(jQuery),function(a){"use strict";function b(b,c){this.opts=a.extend({url:!1,success:!1,error:!1,preview:!1,uploadFields:!1,text:f.drop_file_here,atext:f.or_choose},c),this.$el=a(b)}a.fn.dragupload=function(a){return this.each(function(){new b(this,a).init()})},b.prototype={init:function(){if(-1===navigator.userAgent.search("MSIE")){this.droparea=a('<div class="redactor_droparea"></div>'),this.dropareabox=a('<div class="redactor_dropareabox">'+this.opts.text+"</div>"),this.dropalternative=a('<div class="redactor_dropalternative">'+this.opts.atext+"</div>"),this.droparea.append(this.dropareabox),this.$el.before(this.droparea),this.$el.before(this.dropalternative),this.dropareabox.bind("dragover",a.proxy(function(){return this.ondrag()},this)),this.dropareabox.bind("dragleave",a.proxy(function(){return this.ondragleave()},this));var b=a.proxy(function(a){var b=parseInt(a.loaded/a.total*100,10);this.dropareabox.text("Loading "+b+"%")},this),c=jQuery.ajaxSettings.xhr();c.upload&&c.upload.addEventListener("progress",b,!1);var d=function(){return c};this.dropareabox.get(0).ondrop=a.proxy(function(b){b.preventDefault(),this.dropareabox.removeClass("hover").addClass("drop");var c=b.dataTransfer.files[0],e=new FormData;!1!==this.opts.uploadFields&&"object"==typeof this.opts.uploadFields&&a.each(this.opts.uploadFields,a.proxy(function(b,c){0===c.toString().indexOf("#")&&(c=a(c).val()),e.append(b,c)},this)),e.append("file",c),a.ajax({url:this.opts.url,dataType:"html",data:e,xhr:d,cache:!1,contentType:!1,processData:!1,type:"POST",success:a.proxy(function(b){var c=a.parseJSON(b);void 0===c.error?this.opts.success(c):(this.opts.error(this,c),this.opts.success(!1))},this)})},this)}},ondrag:function(){return this.dropareabox.addClass("hover"),!1},ondragleave:function(){return this.dropareabox.removeClass("hover"),!1}}}(jQuery),function(a){"use strict";var b="http://",c=/(^|&lt;|\s)(www\..+?\..+?)(\s|&gt;|$)/g,d=/(^|&lt;|\s)(((https?|ftp):\/\/|mailto:).+?)(\s|&gt;|$)/g,e=function(){for(var f=this.childNodes,g=f.length;g--;){var h=f[g];if(3===h.nodeType){var i=h.nodeValue;i&&(i.match(c)||i.match(d))&&(i=i.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(c,'$1<a href="'+b+'$2">$2</a>$3').replace(d,'$1<a href="$2">$2</a>$5'),a(h).after(i).remove())}else 1!==h.nodeType||/^(a|button|textarea)$/i.test(h.tagName)||e.call(h)}};a.fn.linkify=function(){this.each(e)}}(jQuery),a.ItemView.extend({template:_.template('<textarea class="redactor_content" name="content"></textarea>'),ui:{redactor:".redactor_content",redactorBox:".redactor_box",redactorEditor:".redactor_editor"},initialize:function(a){this.options=a,this.model.set("code",""),this.options.forbiddenBtn||(this.options.forbiddenBtn=["backcolor","video","fontcolor","fontsize","link","html"])},events:function(){var a={};return a["focus "+this.ui.redactorEditor]="focusEditor",a["blur "+this.ui.redactorEditor]="unfocusEditor",a["click "+this.ui.redactorEditor]="saveSelection",a["paste "+this.ui.redactorEditor]="saveSelection",a},onShow:function(){var a=this,c=this.ui.redactor.redactor({keyupCallback:function(){""==c.getCode()||"<p><br></p>"==c.getCode()?a.trigger("emptyCode"):a.model.set("code",c.getCode())},execCommandCallback:function(){a.model.set("code",c.getCode())},forbidden:a.options.forbiddenBtn});this.$el.find(".redactor_editor").css({"min-height":"120px"}),this.$el.find(".redactor_toolbar").find(".redactor_btn_image").addClass("upload_new_file");var d=new b.UploaderView({container:this.$el.find(".redactor_box"),validate:{format:["jpeg","JPEG","jpg","JPG","gif","GIF","png","PNG"],onceLimt:5,allLimt:-1,nameLimt:-1},callbackName:this.options.uploadOptions.callbackName,callbackValue:this.options.uploadOptions.callbackValue,url:this.options.uploadOptions.uploadUrl,ajaxUrl:this.options.uploadOptions.ajaxUrl,fileInputName:this.options.uploadOptions.fileInputName,extendData:this.options.uploadOptions.extendData,pasteNode:this.$el.find(".redactor_editor"),isPaste:!0,isDrag:!0});d.render(),d.on("uploadEnd",function(b){var c=a.options.uploadOptions.onAfterUpload(b);a.insertRedactor(c)}),d.on("error",function(a){console.log(a)}),this.$el.on("click",function(a){a.stopPropagation()})},getRedactorApi:function(a,arguments){this.ui.redactor[a](arguments)},focusEditor:function(){this.trigger("focusEditor")},unfocusEditor:function(){this.trigger("unfocusEditor")},getCode:function(){return this.ui.redactor.getCode()},setCode:function(a){this.ui.redactor.setCode(a)},insertRedactor:function(a){var b=(this.getCode(),'<img src="'+a+'">');this.getRedactorApi("restoreSelection"),this.getRedactorApi("insertHtml",b),this.model.set("code",this.getCode())},saveSelection:function(){this.getRedactorApi("saveSelection")}})}),define("taskWidget",["talent","UserSelector","$.tipsy","moment","Uploader","richeditor"],function(Talent,UserSelector,Ttipsy,moment,Uploader,Richeditor){function TipDialogView(a,b,c){var c=c||{},d=Talent._.extend({},c,{autoHide:!0,className:c.className||"warn"});d.skin&&"skin2"==d.skin&&(d.showClosed=!0,d.minWidth="400",d.maxWidth="400");var e=c.container||Talent.$("body");if(window.tipView&&window.tipView.close(),window.tipView=new TDialogView({type:"tipsy",skin:d.skin||"",showClosed:d.showClosed,maxWidth:d.maxWidth||"",minWidth:d.minWidth||50,zindex:d.zindex||1001}),d.skin&&"skin2"==d.skin){var f=/[^\x00-\xff]/g;b.replace(f,"**").length<47&&d.skin&&"skin2"==d.skin&&window.tipView.$el.css("text-align","center")}return e.append(window.tipView.render().el),tipView.show(a,b,d),tipView}function ConfirmDialogView(a,b,c){var c=c||{},d=c.container||Talent.$("body"),e=(TDialogView.instanceConfirm,Talent._.extend({},{autoHide:!1,cancel:!0,sure:!0,quirkTheme:!1,className:"ask",type:"tipsy",sureText:"确定",cancelText:"取消"},c));if(e.skin&&"skin2"==e.skin&&(e.minWidth="400",e.maxWidth="400"),window.dialogView&&window.dialogView.close(),window.dialogView=new TDialogView({type:e.type,skin:e.skin||"",cancel:e.cancel,sure:e.sure,sureText:e.sureText,cancelText:e.cancelText,maxWidth:e.maxWidth||"",minWidth:e.minWidth||50,zindex:e.zindex||1001}),e.skin&&"skin2"==e.skin){var f=/[^\x00-\xff]/g;b.replace(f,"**").length<47&&e.skin&&"skin2"==e.skin&&window.dialogView.$el.css("text-align","center")}return d.append(window.dialogView.render().el),Talent.$(document).off("mouseup.TT-Dialog-View-Confirm"),Talent.$(document).on("mouseup.TT-Dialog-View-Confirm",function(){Talent.$(document).off("mouseup.TT-Dialog-View-Confirm"),window.dialogView.close()}),window.dialogView.show(a,b,e),window.dialogView}var jst=function(){return this.JST=this.JST||{},this.JST["task-list/plan-item-status"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<ul>\n\t<li status="2"><a href="javascript:void(0);" title="">\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-2"></span>已完成\n\t</a></li>\n\t<li status="1"><a href="javascript:void(0);" title="" >\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-1"></span>进行中</a></li>\n\t<li status="4"><a href="javascript:void(0);" title="" >\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-4"></span>已取消\n\t</a></li>\n\t<li status="3"><a href="javascript:void(0);" title="" >\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-3"></span>已延迟\n\t</a></li>\n\t<li status="6"><a href="javascript:void(0);" title="" >\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-6"></span>暂停中\n\t</a></li>\n\t<li status="0"><a href="javascript:void(0);" title="" >\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-0"></span>未开始\n\t</a></li>\n</ul>\n\n\n\n\n\n';return __p},this.JST["task-list/task-list-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)isChildTask&&(__p+='\n\t<span class="border-left"></span>\n\t<span class="icon-task-left-border"></span>\n'),__p+='\n\n<div class="plan_list_li '+(null==(__t=isChildTask?"p1":isShowKclass?"p3":"p2")?"":__t)+'">\n\t<div class="right_ttpl">\n\t',2==status&&evaluateModel?__p+="\n\t\t"+(null==(__t=_.TitaWidget_evaluation(evaluateModel))?"":__t)+"\n\t":(__p+="\n\t\t",cycleId>0?__p+='\n\t\t\t<span class="icon-task-cycle" data-name="task-cycle" data-id="'+(null==(__t=taskId)?"":__t)+'" data-cys="'+(null==(__t=cycleId)?"":__t)+'"></span>\n\t\t':__p+='\n\t\t\t<span class="cycle-placeholder"></span>\n\t\t',__p+="\n\t\t",isLongTerm?__p+='\n\t\t\t<span class="date">长期</span>\n\t\t':(__p+="\n\t\t\t",isDeadLine?__p+='\n\t\t\t\t<span class="date expire">'+(null==(__t=deadLine)?"":__t)+"</span>\n\t\t\t":2==status?__p+='\n\t\t\t\t<span class="date">'+(null==(__t=deadLine)?"":__t)+"</span>\n\t\t\t":__p+='\n\t\t\t\t<span class="date '+(null==(__t=1==fromNow?"warn":"")?"":__t)+'">'+(null==(__t=fromNow>0&&fromNow<4?"剩余"+fromNow+"天":deadLine)?"":__t)+"</span>\n\t\t\t",__p+="\n\t\t"),__p+='\t\n\t\t<span class="principle">'+(null==(__t=_.TitaWidget_substring(principalUser.name,6,!0,2))?"":__t)+"</span>\n\t\t",isShowSetRemind&&(__p+="\n\t\t\t",0==cycleId?__p+='\n\t\t\t\t<span data-name="notice_plan" original-title="'+(null==(__t=isRemind?"已设提醒":"设置提醒")?"":__t)+'" data=\'{"objid":"'+(null==(__t=taskId)?"":__t)+'","objType":"'+(null==(__t=objType)?"":__t)+'"}\' class="notice-wraper sup-notice icon-clock'+(null==(__t=isRemind?"-active":"")?"":__t)+'"></span>\n\t\t\t':__p+='\n\t\t\t\t<span class="sup-notice-placeholder"></span>\n\t\t\t',__p+="\n\n\t\t"),__p+="\n\t\t",isShowStar&&(__p+="\n\t\t\t",isMark?__p+='\n\t\t\t\t<span class="sup-set-mark icon-star-active" original-title="取消星标" data-id="'+(null==(__t=taskId)?"":__t)+'" data-name="set-mark"></span>\n\t\t\t':__p+='\n\t\t\t\t<span class="sup-set-mark icon-star" original-title="标为星标" data-id="'+(null==(__t=taskId)?"":__t)+'" data-name="set-mark"></span>\n\t\t\t',__p+="\n\t\t"),__p+="\n\t\t",isShowDelete&&(__p+="\n\t\t\t",deleteable?__p+='\n\t\t\t\t<span class="sup-delete"  data-name="plan-delete" data-id="'+(null==(__t=taskId)?"":__t)+'">删除</span>\n\t\t\t':__p+='\t\n\t\t\t\t<span class="sup-delete-placeholder"></span>\n\t\t\t',__p+="\n\t\t"),__p+="\n\t"),__p+='\n\t</div>\n\n\t<div class="left_left">\n\t\t',(hasSubTask||"undefined"!=typeof tasks&&tasks.length)&&(__p+="\n\t\t\t","undefined"!=typeof tasks&&tasks.length?__p+='\n\t\t\t\t<span data-id="'+(null==(__t=taskId)?"":__t)+'" data-name="packup" class="packup '+(null==(__t=currentDeploy?"icon-minus":"icon-plus")?"":__t)+'"></span>\n\t\t\t':__p+='\n\t\t\t\t<span data-id="'+(null==(__t=taskId)?"":__t)+'" data-name="packup" class="packup icon-plus"></span>\n\t\t\t',__p+="\n\t\t"),__p+="\n\t\t",isApply?__p+='\n\t\t\t<span class="status_ttpl_wraper" style="height:1px;"></span>\n\t\t\t<span class="icon-apply apply_status"></span>\n\t\t':__p+='\n\t\t\t<span class="status_ttpl_wraper">\t\n\t\t\t\t<a href="javascript:void(0);" class="status_ttpl icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+"-"+(null==(__t=status)?"":__t)+(null==(__t=editStatusable?"":"-disable")?"":__t)+" "+(null==(__t=editStatusable?"":"status_disabled")?"":__t)+'" original-title="'+(null==(__t=StatusTip)?"":__t)+'" data-id="'+(null==(__t=taskId)?"":__t)+'"><span class="ico"></span></a>\n\t\t\t\t\n\t\t\t</span>\n\t\t',__p+="\n\t\t",isShowKclass&&(__p+="\n\t\t\t",editLableable?__p+='\n\t\t\t\t<div class="klass_box_ttpl pointer" data-id="'+(null==(__t=taskId)?"":__t)+'" data-name="update-klass" data-lab="'+(null==(__t=labelId)?"":__t)+'" data-type="'+(null==(__t=labelType)?"":__t)+'">\n\t\t\t':__p+='\n\t\t\t\t<div class="klass_box_ttpl">\n\t\t\t',__p+='\n\t\t\t\t\t<div class="kclass" data-name="kclass-area"></div>\n\t\t\t\t',labelName&&"未分类"!=labelName?(__p+="\n\t\t\t\t\t",4==labelType?(__p+="\n\t\t\t\t\t\t",402==appId||203==appId||902==appId?__p+='\n\t\t\t\t\t\t<span class="icon-app-xxs-'+(null==(__t=appId)?"":__t)+'"></span>\n\t\t\t\t\t\t':__p+='\n\t\t\t\t\t\t<span class="icon-work-small"></span>\n\t\t\t\t\t\t',__p+='\n\t\t\t\t\t\t<span class="klass_ttpl">'+(null==(__t=_.substringWithM(labelName,8,!1))?"":__t)+"</span>  \n\t\t\t\t\t"):__p+='\n\t\t\t\t\t\t<span class="klass_ttpl">'+(null==(__t=_.substringWithM(labelName,10,!1))?"":__t)+"</span>  \n\t\t\t\t\t",__p+="\n\t\t\t\t"):__p+='\n\t\t\t\t\t<span class="klass_ttpl none_klass_ttpl">未分类</span>  \n\t\t\t\t',__p+="\n\t\t\t\t</div>\n\t\t\t"),__p+='\n\t\t\t\n\t\t\t\n\t\t\t\n\t\t\t\n\t</div>\n\t<div class="left_ttpl '+(null==(__t=isChildTask?"p1":isShowKclass?"p3":"p2")?"":__t)+'">\n\t\t\n\t\t',2==status||4==status||6==status?(__p+="\n\t\t\t",isPush?__p+='\n\t\t\t\t<span  id="'+(null==(__t=taskId)?"":__t)+'" data-name="taskName" class="'+(null==(__t=isChildTask?"child":"")?"":__t)+' task-name disable">'+(null==(__t=taskName)?"":__t)+"</span>\n\t\t\t":__p+='\n\t\t\t\t<a id="'+(null==(__t=taskId)?"":__t)+'" href="'+(null==(__t=taskUrl)?"":__t)+'" target="_blank" class="'+(null==(__t=isChildTask?"child":"")?"":__t)+' task-name disable">'+(null==(__t=taskName)?"":__t)+"</a>\n\t\t\t",__p+="\n\t\t\t\n\t\t"):(__p+="\n\t\t\t",isPush?__p+='\n\t\t\t\t<span id="'+(null==(__t=taskId)?"":__t)+'" data-name="taskName" class="'+(null==(__t=isChildTask?"child":"")?"":__t)+" task-name "+(null==(__t=isDeadLine?"warn":"")?"":__t)+'">'+(null==(__t=taskName)?"":__t)+"</span>\n\t\t\t":__p+='\n\t\t\t\t<a id="'+(null==(__t=taskId)?"":__t)+'" href="'+(null==(__t=taskUrl)?"":__t)+'" class="'+(null==(__t=isChildTask?"child":"")?"":__t)+" task-name "+(null==(__t=isDeadLine?"warn":"")?"":__t)+'" target="_blank">'+(null==(__t=taskName)?"":__t)+"</a>\n\t\t\t",__p+="\n\t\t"),__p+='\n\t\t<div class="all-icons">\n\t\t\t',203!=appId&&902!=appId||(__p+='\n\t\t\t\t<span class="ico-position ico-position-'+(null==(__t=taskType)?"":__t)+'">\n\t\t\t\t\t'+(null==(__t={6:"面",7:"offer",8:"职",16:"筛",20:"审",21:"申"}[taskType])?"":__t)+"\n\t\t\t\t</span>\n\t\t\t"),__p+="\n\t\t\t",isShowOwnerTag&&(__p+="\n\t\t\t\t",1==userRelation?__p+='\n\t\t\t\t\t<span class="mine task-tag">'+(null==(__t=quirkOwnerTag?"ta":"我")?"":__t)+"派发的</span>\n\t\t\t\t":2==userRelation?__p+='\n\t\t\t\t\t<span class="task-tag">上级安排</span>\n\t\t\t\t':3==userRelation?__p+='\n\t\t\t\t\t<span class="join task-tag">'+(null==(__t=quirkOwnerTag?"ta":"我")?"":__t)+"参与的</span>\n\t\t\t\t":__p+='\n\t\t\t\t\t\x3c!-- <span class="task-tag-placeholder"></span> --\x3e\n\t\t\t\t',__p+="\n\t\t\t"),__p+="\n\t\t\t",isShowPercent&&counter.taskTotal&&(__p+='\n\t\t\t<span class="percent task-tag" original-title="下一级任务（完成数/总数）">\n\t\t\t\t<span class="icon-task"></span>\n\t\t\t\t'+(null==(__t=counter.finishTaskTotal)?"":__t)+"/"+(null==(__t=counter.taskTotal)?"":__t)+"\n\t\t\t</span>\n\t\t\t"),__p+="\n\n\t\t\t",counter.workTimeTotal&&(__p+='\n\t\t\t\t<span class="work_hour">'+(null==(__t=counter.workTimeTotal)?"":__t)+"h</span>\n\t\t\t"),__p+="\n\t\t\t",detail_checked||(__p+="\n\t\t\t\t",counter.taskTotal>0&&isShowTaskTotal&&(__p+='\n\t\t\t\t\t<span class="icon-plan-task icon" original-title="有任务"></span>\n\t\t\t\t\t<span class="num">'+(null==(__t=counter.taskTotal)?"":__t)+"</span>\n\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.commentTotal>0&&isShowCommentTotal&&(__p+='\n\t\t\t\t\t<span class="icon-plan-talk icon" original-title="有沟通"></span>\n\t\t\t\t\t<span class="num">'+(null==(__t=counter.commentTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.experienceTotal>0&&isShowExperienceTotal&&(__p+='\n\t\t\t\t\t<span class="icon-plan-summarize icon" original-title="有心得"></span>\n\t\t\t\t\t<span class="num">'+(null==(__t=counter.experienceTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.businessTripTotal>0&&isShowBusinessTripTotal&&(__p+='\n\t\t\t\t\t<span class="icon-plan-trip icon" original-title="有出差"></span>\n\t\t\t\t\t<span class="num">'+(null==(__t=counter.businessTripTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.meetTotal>0&&isShowMeetingTotal&&(__p+='\n\t\t\t\t\t<span class="icon-plan-meeting icon" original-title="有会议"></span>\n\t\t\t\t\t<span class="num">'+(null==(__t=counter.meetTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t\n\t\t\t\t\n\t\t\t"),__p+="\n\t\t</div>\n\t\t\n\t</div>\t\n</div>\n",detail_checked&&(__p+='\n<div class="plan_list_total  ',(hasSubTask||"undefined"!=typeof tasks&&tasks.length)&&currentDeploy&&(__p+="border-over"),__p+=" "+(null==(__t=isChildTask?"p1":isShowKclass?"p3":"p2")?"":__t)+'">\n\t<div class="plan_total_left">\n\t\t<span>'+(null==(__t=i18n.task_1)?"":__t)+"&nbsp;"+(null==(__t=counter.taskTotal)?"":__t)+"</span>\n\t\t",isShowCommentTotal&&(__p+="\n\t\t\t<span>沟通&nbsp;"+(null==(__t=counter.commentTotal)?"":__t)+"</span>\n\t\t"),__p+="\n\t\t",isShowExperienceTotal&&(__p+="\n\t\t<span>心得&nbsp;"+(null==(__t=counter.experienceTotal)?"":__t)+"</span>\n\t\t"),__p+="\n\t\t",isShowBusinessTripTotal&&(__p+="\n\t\t\t<span>出差&nbsp;"+(null==(__t=counter.businessTripTotal)?"":__t)+"</span>\n\t\t"),__p+="\n\t\t",isShowMeetingTotal&&(__p+="\n\t\t\t<span>会议&nbsp;"+(null==(__t=counter.meetTotal)?"":__t)+"</span>\n\t\t"),__p+='\n\t\t\n\t\t\n\t</div>\n\t<div class="plan_total_right">\n\t\t<span class="start-date">创建于'+(null==(__t=createDate)?"":__t)+"</span>\n\t\t",0==cycleId&&(__p+="\n\t\t\t",isRemind?(__p+='\n\t\t\t\t<span data-name="notice_plan"  class="notice-wraper" original-title="已设提醒" data=\'{"objid":"'+(null==(__t=taskId)?"":__t)+'","objType":"'+(null==(__t=objType)?"":__t)+'"}\'>\n\t\t\t\t\t<span class="notice icon-clock-active"></span>\n\t\t\t\t\t<span class="txt">',time&&(__p+="于"+(null==(__t=time)?"":__t)+" "),__p+="提醒我</span>\n\t\t\t\t</span>\n\t\t\t"):__p+='\n\t\t\t\t<span data-name="notice_plan" class="notice-wraper" original-title="设置提醒" data=\'{"objid":"'+(null==(__t=taskId)?"":__t)+'","objType":"'+(null==(__t=objType)?"":__t)+'"}\'>\n\t\t\t\t\t<span class="notice icon-clock"></span>\n\t\t\t\t\t<span class="txt">提醒我</span>\n\t\t\t\t</span>\n\t\t\t\t\n\t\t\t',__p+="\n\t\t"),__p+="\n\t\t",deleteable?__p+='\n\t\t\t<span class="delete icon-delete" original-title="删除" data-name="plan-delete" data-id="'+(null==(__t=taskId)?"":__t)+'"></span>\n\t\t':__p+='\t\n\t\t\t<span class="sub-delete-placeholder"></span>\n\t\t',__p+="\n\t\t\n\t</div>\n</div>\n"),__p+='\n<div class="child-list-wraper '+(null==(__t=isChildTask?"p3":isShowKclass?"p1":"p2")?"":__t)+'">\n\t\n\t<ul class="child-list '+(null==(__t=currentDeploy?"":"hide")?"":__t)+'  "></ul>\n</div>';return __p},this.JST["task-list/task-list"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<ul class="list-container">\n\n</ul>\n<div class="showmore" data-name="showmore">\n\t<a href="javascript:void(0);"  class="text_fsm">\n\t\t<span>查看更多</span>\n\t</a>\n</div>';return __p},this.JST["tdialog/dialog"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="arrow"></div>\n',settings.showClosed&&(__p+='\n\t<span class="icon-dialog-closed closed_dialog"></span>\n'),__p+='\n<div class="content_dialog"></div>\n\n',0==settings.sure&&0==settings.cancel||(__p+='\n<div class="uibutton">\n\t',settings.sure&&(__p+='\n\t\t<a data-bypass href="'+(null==(__t=settings.sureLink?settings.sureLink:"javascript:void(0);")?"":__t)+'"   class="btn btn-sure sure_dialog">'+(null==(__t=settings.sureText)?"":__t)+"</a>\n\t\t"),__p+="\n\t",settings.cancel&&(__p+='\n\t<a href="javascript:void(0);" title="" class="btn btn-cancel cancel_dialog">'+(null==(__t=settings.cancelText)?"":__t)+"</a>\n\t"),__p+="\n</div>\n");return __p},this.JST["set-notice/set-notice"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n\t<div class="outer_nst">\n\t\t<div class="content_nst">\n\t\t\t<div class="wrap_time_nst clearfix">\n\t\t\t\t<span class="timelabel_nst mylock">提醒时间</span>\n\t\t\t\t<div class="day_time_nst" data-name="day-input">\n\t\t\t\t\t<a class="triday_nst " href="javascript:void(0)"></a>\n\t\t\t\t\t<label cyctype="0" uservalue="'+(null==(__t=today)?"":__t)+'" data-name="day-input-value">'+(null==(__t=today)?"":__t)+'</label>\n\t\t\t\t\t<div class="day_timewrap_nst" data-name="day-dropdown">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<ul class="dayvalues_nst">\n\t\t\t\t\t\t\t'+(null==(__t=day7)?"":__t)+'\n\t\t\t\t\t\t\t<li label="其它日期" uservalue="0" class="other_nst" data-name="day-other">\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)">其它日期</a>\n\t\t\t\t\t\t\t\t<div class="day-timepicker" data-name="day-dropdown-datepicker"></div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li class="everyday_nst" label="每天" uservalue="1" data-name="day-every-day"><a href="javascript:void(0);">每天</a></li>\n\t\t\t\t\t\t\t<li class="everyworkday_nst" label="每个工作日" uservalue="2" data-name="day-every-weekday"><a href="javascript:void(0);">每个工作日</a></li>\n\t\t\t\t\t\t\t<li label="每周" uservalue="3" class="weektime_nst" data-name="day-every-week">\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)">每周</a>\n\t\t\t\t\t\t\t\t<dl class="weektimevalue_nst" data-name="day-dropdown-week">\n\t\t\t\t\t\t\t\t\t<dd uservalue="2" label="每周一"><a href="javascript:void(0)">周一</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="3" label="每周二"><a href="javascript:void(0)">周二</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="4" label="每周三"><a href="javascript:void(0)">周三</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="5" label="每周四"><a href="javascript:void(0)">周四</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="6" label="每周五"><a href="javascript:void(0)">周五</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="7" label="每周六"><a href="javascript:void(0)">周六</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="1" label="每周日"><a href="javascript:void(0)">周日</a></dd>\n\t\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li label="每月" uservalue="11" class="monthtime_nst" data-name="day-every-month">\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" >每月</a>\n\t\t\t\t\t\t\t\t<dl class="monthtimevalue_nst" data-name="day-dropdown-month">\n\t\t\t\t\t\t\t\t\t'+(null==(__t=month31)?"":__t)+'\n\t\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="his_time_nst" data-name="hour-wrap">\t\t\n\t\t\t\t\t<a class="tritime_nst " href="javascript:void(0)"></a>\t\t\t\n\t\t\t\t\t<label class="timecur_nst" uservalue="'+(null==(__t=nowHour)?"":__t)+'" label="'+(null==(__t=nowHour)?"":__t)+'" data-name="hour-input-value">'+(null==(__t=nowHourLabel)?"":__t)+'</label>\n\t\t\t\t\t<ul class="timevalues_nst" data-name="hour-dropdown">\n\t\t\t\t\t\t'+(null==(__t=hour24)?"":__t)+'\n\t\t\t\t\t</ul>\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div class="minite_time_nst"  data-name="minite-wrap">\n\t\t\t\t\t<a class="triminite_nst " href="javascript:void(0)"></a>\n\t\t\t\t\t<label class="minitecur_nst" uservalue = "00" label="00" data-name="minite-input-value">00</label>\n\t\t\t\t\t<ul class="minitevalues_nst" data-name="minute-dropdown">\n\t\t\t\t\t\t'+(null==(__t=minite12)?"":__t)+'\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div data-name="person-list"></div>\n\t\t\t<div class="desc_nst" data-name="remind-desc-wrap">\n\t\t\t\t<textarea class="default_nst" defaultValue="提醒内容" data-name="remind-desc-input">提醒内容</textarea>\n\t\t\t</div>\n\n\t\t\t<div class="tip_nst" data-name="error-tip"></div>\n\t\t\t<div class="btn_nst">\n\t\t\t\t<a class="btn btn-candel" href="javascript:void(0)" data-name="remind-button-cancel-remind">取消提醒</a>\n\t\t\t\t<a class="btn btn-sure" href="javascript:void(0)"  data-name="remind-button-sure">确定</a>\n\t\t\t\t<a class="btn btn-candel" href="javascript:void(0)" data-name="remind-button-cancel">取消</a>\n\t\t\t</div>\n\t\t</div>\n\t</div>';return __p},this.JST["add-user/add-user-composite"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="title-pl">'+(null==(__t=title)?"":__t)+'</div>\n<div class="list-pl">\n<em class="ux_add_btn"></em>\n<ul></ul>\n</div>';return __p},this.JST["add-user/add-user-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)"undefined"!=typeof type&&"department"==type?__p+='\n<a href="javascript:void(0)" title="删除:'+(null==(__t=name)?"":__t)+'" id="'+(null==(__t=id)?"":__t)+'" class="square">'+(null==(__t=_.TitaWidget_substring(name,2,!1))?"":__t)+"</a>\n":__p+='\n<a href="javascript:void(0)" title="删除:'+(null==(__t=Name)?"":__t)+'" id="'+(null==(__t=Id)?"":__t)+'" class="ux_user_area">'+(null==(__t=_.convertImage({src:UserAvatar.Small,size:30,name:Name,bgColor:UserAvatar.Color}))?"":__t)+"</a>\n";return __p},this.JST["class/checked-class-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="checked_name">'+(null==(__t=name)?"":__t)+'</div>\n<a href="javascript:void(0)" data-handler="Delete" class="smember_btn_reduce">\n\t<span></span>\n</a>';return __p},this.JST["class/class-component"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="top_cd">\n\t',isMulti&&(__p+='\n\t<div class="top_title">选择分类</div>\n\t'),__p+='\n\t<ul class="tab_cd" data-name="klass-tab">\n\t\t',isShowClass&&(__p+='\n\t\t<li data-type="17">选择分类</li>\n\t\t'),__p+="\n\t\t",isShowWork&&(__p+='\n\t\t\t<li data-type="4">选择'+(null==(__t=i18n.work_1)?"":__t)+"</li>\n\t\t"),__p+="\n\t\t",isShowTarget&&(__p+='\n\t\t\t<li data-type="402">选择目标</li>\n\t\t'),__p+='\n\t</ul>\n\t<span class="icon-dialog-closed closed_cd" data-name="klass-close"></span>\n</div>\n<div class="box_cd" >\n\t<div data-name="klass-content" class="plan-klass-content"></div>\n</div>';return __p},this.JST["class/class-new"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<form data-name="file-move-new-form">\n\t',"rename"!=type&&(__p+='\n\t<div class="title_tv">\n\t'),__p+='\n\t\t<div class="new_tv">\n\t\t\t<div class="input-default input_ntv" data-name="file-move-new-input-warp">\n\t\t\t\t<input type="text" value="'+(null==(__t=name)?"":__t)+'">\n\t\t\t</div>\n\t\t\t<span class="btn_ntv icon-radius-success-over" data-name="file-move-new-submit"></span>\n\t\t\t<span class="btn_ntv icon-radius-error-over" data-name="file-move-new-cancel"></span>\n\t\t</div>\n\t',"rename"!=type&&(__p+="\n\t</div>\n\t"),__p+="\n</form>";return __p},this.JST["class/class-rename"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<form data-name="rename-form">\n\t<div class="input-default input_ridl" data-name="rename-inputwrap">\n\t\t<input type="text" value="'+(null==(__t=name)?"":__t)+'">\n\t</div>\n\t<a class="btn btn-sure" data-name="rename-sure">确定</a>\n\t<a class="btn btn-cancel" data-name="rename-cancel">取消</a>\n</form>\n';return __p},this.JST["class/class-search"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="class_search_form_container">\n\t<div class="class_search_header_input">\n\t\t<label class="class_search_condition_label" data-name="smember-condition">搜索分类</label>\n\t\t<input  autocomplete="off" id="lableName" class="class_search_condition_input smemberInput " type="text"  name="content"></input>\n\t\t<span class="icon-search"></span>\n\t</div>\n\t<div class="lable-list" id="lable-list" data-name="lable-list">\n\t\t<ul class="lable-ul" data-name="lable-ul" id="lable-ul"></ul>\n\t</div>\n</div>';return __p},this.JST["class/class-tree-component"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="class_data_pop_header">\n\t'+(null==(__t=title)?"":__t)+'\n\t<a href="javascript:void(0)" class="icon-dialog-closed" data-handler="Close"></a>\n</div>\n<div class="class_data_pop_content">\n\t<div class="class_data_search_content_left">\n\t\t<div class="tab">\n\t\t\t<span class="class active" data-name="all">所有分类</span>\n\t\t\t',1==pluginType&&(__p+='<span class="project" data-name="project">所有项目</span>'),__p+='\n\t\t</div>\n\t\t<div class="class_data_type_list"></div>\n\t</div>\n\t<div class="class_data_search_content_center">\n\t\t<span class="smember_search_arrow_icon search_arrow_icon"></span>\n\t</div>\n\t<div class="class_data_search_content_right">\n\t\t<span>已选类别</span>\n\t\t<div class="class_data_checked_type_list"></div>\n\t</div>\n</div>\n<div class="smember_footer">\n\t<a href="javascript:void(0)" class="btn btn-cancel" data-handler="clean">清除全部</a>\n\t<a href="javascript:void(0)" class="btn cancel_rd" data-handler="Cancel">取消</a>\n\t<a href="javascript:void(0)" class="btn btn-sure sure_rd" data-handler="Submit">确定</a>\n</div>   ';return __p},this.JST["class/class-tree-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="title_tv" data-name="title">\n\n\t',0==isEnd&&(__p+='\n\t<span class="icon_tv" data-name="toggle"></span>\n\t'),__p+="\n\t","undefined"!=typeof IsTenant&&IsTenant?(__p+='\n\t\t<span class="icon-enterprise_icon" data-name="enterprise"></span>\n\t\t<div class="text_tv_parent">\n\t\t\t<div class="text_tv text_width" data-name="title-name">'+(null==(__t=name)?"":__t)+"</div>\n\t\t\t",IsAllowSetPersonalLable||(__p+='\n\t\t\t\t<span class="m-lock icon-lock" data-name="lock-permission"></span>\n\t\t\t'),__p+="\n\t\t</div>\n\t"):"undefined"==typeof IsTenant||IsTenant?__p+='\n\t\t<div class="text_tv" data-name="title-name">'+(null==(__t=name)?"":__t)+"</div>\n\t":__p+='\n\t\t<span class="icon-personal_img" data-name="person"></span>\n\t\t<div class="text_tv_parent">\n\t\t\t<div class="text_tv personal" data-name="title-name">'+(null==(__t=name)?"":__t)+"</div>\n\t\t</div>\n\t",__p+="\n\t",0!=id&&isEdit&&(__p+="\n\t\t","undefined"==typeof IsTenant||IsTenant||(__p+='\n\t\t\t<div class="action_ttv" data-name="klass-item-action">\n\t\t\t\t<a href="javascript:void(0);" data-name="edit" id="'+(null==(__t=id)?"":__t)+'">编辑</a>\n\t\t\t\t<a href="javascript:void(0);" data-name="deleted" data-end="'+(null==(__t=isEnd)?"":__t)+'" id="'+(null==(__t=id)?"":__t)+'">删除</a>\n\t\t\t</div> \n\t\t'),__p+="  \n\t"),__p+="\n</div>\n<ul></ul>";return __p},this.JST["class/class"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="title_rd" data-name="title">\n    <h2>我的分类</h2>\n    <span class="icon-dialog-closed closed_rd" data-name="klass-move-close"></span>\n</div>\n<div class="cont_rd">\n    <div class="tt_tree_view">\n        <div data-name="class-project-tab"></div>\n        <div data-name="search-class"></div>\n        <div data-name="tree" class="moveTreeList">\n            <div class="_tt_loading_m">努力加载中…</div>\n        </div>\n        <div data-name="empty"></div>\n    </div>\n    <div class="class_data_search_content_center">\n        <span class="smember_search_arrow_icon search_arrow_icon"></span>\n    </div>\n    <div class="class_data_search_content_right">\n        <span>已选类别</span>\n        <div class="class_data_checked_type_list" data-name=\'class-data-checked\'></div>\n    </div>\n</div>\n<div class="bottom_rd" data-name="klass-action">\n    <button class="btn btn-cancel reset_rd" data-name="klass-move-reset">清空选项</button>\n    <button class="btn btn-cancel new_rd" data-name="klass-move-new-folder">添加分类</button>\n    <button class="btn btn-cancel cancel_rd" data-name="klass-move-cancel">取消</button>\n    <button class="btn btn-sure sure_rd" data-name="klass-move-submit">确定</button>\n</div>\n';return __p},this.JST["class/work-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<span class="icon-work-small"></span><span>'+(null==(__t=WorkName)?"":__t)+"</span>";return __p},this.JST["class/work-list"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="title_kw" data-name="work-title">\n\t<span class="icon-minus-square" data-name="toggle"></span><span>'+(null==(__t=title)?"":__t)+'</span>\n</div>\n<ul data-name="work-list"></ul>';return __p},this.JST["class/work"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="title_rd" data-name="work-move-title">\n\t<h2>'+(null==(__t=i18n.work_1)?"":__t)+'分类</h2>\n\t<span class="icon-dialog-closed closed_rd" data-name="work-move-close"></span>\n</div>\n<div class="cont_rd">\n\t<div class="tt_tree_view">\n\t\t<div data-name="work-box">\n\t\t\t<div class="_tt_loading_m">努力加载中…</div>\n\t\t</div>\n\t\t<div data-name="work-box-join"></div>\n\t\t<div data-name="empty"></div>\n\t</div>\n\t<div class="class_data_search_content_center">\n\t\t<span class="smember_search_arrow_icon search_arrow_icon"></span>\n\t</div>\n\t<div class="class_data_search_content_right">\n\t\t<span>已选类别</span>\n\t\t<div class="class_data_checked_type_list" data-name=\'class-data-checked\'></div>\n\t</div>\n</div>\n<div class="bottom_rd" data-name="work-action">\n\t<button class="btn btn-cancel reset_rd" data-name="work-move-reset">清空选项</button>\n\t<button class="btn btn-cancel new_rd" data-name="work-move-new-folder">新建项目</button>\n\t<button class="btn btn-cancel cancel_rd" data-name="work-move-cancel">取消</button>\n\t<button class="btn btn-sure sure_rd" data-name="work-move-submit">确定</button>\n\t\n</div>';return __p},this.JST["empty-view/empty"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="content_emptyinit">\n\t<div class="className">'+(null==(__t=emptyContext)?"":__t)+"</div>\n</div>";return __p},this.JST["experience/experience"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="head-ev">填写心得</div>\n<div data-name="experience-contant"></div>';return __p},this.JST["task-create/task-create-add-user-composite"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<em class="ux_add_btn" data-name="add-user-btn"></em>\n<ul></ul>';return __p},this.JST["task-create/task-create-add-user-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)departmentTag?__p+='\n\t<a href="javascript:void(0)" title="删除:'+(null==(__t=Name)?"":__t)+'" id="'+(null==(__t=id)?"":__t)+'" class="ux_user_area department">'+(null==(__t=imgTemplate)?"":__t)+"</a>\n":__p+='\n\t<a href="javascript:void(0)" title="删除:'+(null==(__t=Name)?"":__t)+'" id="'+(null==(__t=Id)?"":__t)+'" class="ux_user_area">'+(null==(__t=imgTemplate)?"":__t)+"</a>\n";return __p},this.JST["task-create/task-create-apply-user"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<span class="task-create-tools-item task-create-applyuser-wraper" title="审批人">\n\t<a class="task-create-tools-link task-create-applyuser-icon '+(null==(__t=applyUser?"task-create-applyuser-icon-active":"")?"":__t)+'" href="javascript:void(0)" data-name="task-create-applyuser">审批人：\n\t\t',applyUser&&applyUser.Name?__p+="\n\t\t\t"+(null==(__t=_.substring(applyUser.Name,6,!0))?"":__t)+" \n\t\t":__p+="\n\t\t\t无\n\t\t",__p+="\n\t</a>\n\t",applyUser&&applyUser.Name&&(__p+='\n\t\t<span data-name="task-create-delete-applyuserr"  data-id="'+(null==(__t=applyUser.Id)?"":__t)+'" class="task-create-delete-applyuser-wraper"><span  class="icon-task-close"  data-name="task-create-delete-applyuser" ></span></span>\n\t'),__p+="\n</span>\n";return __p},this.JST["task-create/task-create-bottom"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="task-create-bottom-wraper clearfix">\n\t',isShowFileUpload&&(__p+='\n\t<div class="uploader_container" style="position: relative;"><a title="" href="javascript:void(0);" data-name="file" ></a></div>\n\t'),__p+='\n\t<div class="ux_publish">\n\t\t<span data-name="publish-wraper" class="publish-wraper '+(null==(__t=packUp&&isShowPackUpBtn?"packup":"")?"":__t)+'">\n\t\t\t',isShowMessage&&(__p+='\n\t\t\t\t<div class="msg">\n\t\t\t\t\t<a href="javascript:void(0);" class="check checkbox'+(null==(__t=sendUserStatus?"-checked":"")?"":__t)+'" data-name="data-message">\n\t\t\t\t\t\t<span class="ico"></span>\n\t\t\t\t\t</a>\n\t\t\t\t\t<span class="txt" original-title="'+(null==(__t=sendUserStatus?"取消短信通知负责人":"短信通知负责人")?"":__t)+'">短信通知</span>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t'),__p+="\n\t\t\t",isShowPrivateBtn&&(__p+='\n\t\t\t<div class="set-private-area" data-name="task-create-private">\n\t\t\t\t',"public"!==privateText.type&&(__p+='<i class="icon-lock" data-name="lock" style=""></i>'),__p+=(null==(__t=privateText.name)?"":__t)+'\n\t\t\t\t<i class="caret" data-name="range-caret"></i>\n\t\t\t</div>\n\t\t\t'),__p+="\n\t\t</span>\n\t\t\n\t\t",isShowPackUpBtn&&(__p+='\n\t\t<span class="toggle" data-name="toggle">\n\t\t\t<span class="l">'+(null==(__t=packUp?"更多信息":"收起")?"":__t)+'</span>\n\t\t\t<span class="r icon-arrow-'+(null==(__t=packUp?"down":"up")?"":__t)+'-double"></span>\n\t\t</span>\n\t\t'),__p+='\n\n\t\t<a class="btn btn-sure btn-disabled" href="javascript:void(0);" title="'+(null==(__t=pubBtnText)?"":__t)+'" data-name="set-pub-btn">'+(null==(__t=pubBtnText)?"":__t)+'</a>\n\t</div>\n</div>\n<div class="error_container"></div>\n<div class="preview_container"></div>\n<div class="loading_container"></div> ';return __p},this.JST["task-create/task-create-class"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n\t",showBorderLeft&&(__p+='\n\t\t<span class="border"></span>\n\t'),__p+='\n\t<div class="task-create-class-innder '+(null==(__t=disable?"disable":"")?"":__t)+'" data-name="task-create-class" >\n\t\t<span data-name="task-create-class-name" class="task-create-class-name">\n\t\t\t',labelId&&labelName?__p+="\n\t\t\t\t"+(null==(__t=_.substringWithM(labelName,6,!0))?"":__t)+"\n\t\t\t":__p+="\n\t\t\t\t分类/项目\n\t\t\t",__p+="\n\t\t</span>\n\t\t",4!=labelType&&(__p+='\n\t\t\t<span class="icon-arrow-down"></span>\n\t\t'),__p+="\n\t</div>\n\n\n\n";return __p},this.JST["task-create/task-create-customize-date-richeditor"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="task-create-laytout-input layout-border" data-name="task-create-add-input">\n\t<div class="task-create-add-task-container" data-name="task-create-add-task-container">\n\t\t<div class="task-create-date-container" data-name="task-create-date"></div>\n\t</div>\n\t\n</div>\n<div class="task-create-richeditor layout-border" data-name="task-create-richeditor"></div>\n<div class="task-create-bottom" data-name="task-create-bottom"></div>\n\n';return __p},this.JST["task-create/task-create-customize-work-hour"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="task-create-laytout-input layout-border" data-name="task-create-add-input">\n\t<div class="task-create-add-task-container" data-name="task-create-add-task-container">\n\t\t<div class="task-create-name-container" data-name="task-create-name"></div>\n\t\t<div class="task-create-right-part">\n\t\t\t<div class="task-create-date-container" data-name="task-create-date"></div>\n\t\t\t<div class="task-create-tools-item-wraper" data-name="task-create-hour-date"></div>\n\t\t</div>\n\t</div>\n\t\n</div>\n<div class="task-create-richeditor layout-border" data-name="task-create-richeditor"></div>\n<div class="task-create-bottom" data-name="task-create-bottom"></div>\n\n';return __p},this.JST["task-create/task-create-date"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+="\n",isCycle?__p+='\n\t<div class="task-create-date-inner" data-name="task-create-date-box" original-title="'+(null==(__t=cycleTip)?"":__t)+'">\n\t\t<span class="ico icon-action-cycle-active" data-name="task-create-date-ico"></span>\n\t</div>\n':__p+='\n\t<div class="task-create-date-inner" data-name="task-create-date-box" original-title="'+(null==(__t=dateTip)?"":__t)+'">\n\t\t\t<span class="ico icon-task-during" data-name="task-create-date-ico"></span>\n\t</div>\n';return __p},this.JST["task-create/task-create-external-person"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<span class="task-create-tools-item" data-name="task-create-extend-person" title="外部联系人">\n\t<a href="javascript:void(0)" class="task-create-tools-link task-create-add-icon ',extendUser&&(__p+="task-create-add-icon-active"),__p+='">外部联系人</a>\n</span>\n';return __p},this.JST["task-create/task-create-name"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+="\n\n",iconShow&&(__p+='\n\t<span class="ico-name '+(null==(__t=iconClassName)?"":__t)+'"></span>\n'),__p+='\n<input class="'+(null==(__t=iconShow?"has-icon":"")?"":__t)+'" data-name="task-create-name" type="text" placeholder="'+(null==(__t=defaultText)?"":__t)+'" value="'+(null==(__t=taskTitle)?"":__t)+'" />\n\n<div data-name="task-create-name-dropdown"></div>\n';return __p},this.JST["task-create/task-create-participator"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<span data-name="task-create-participator" class="task-create-tools-item task-create-participator" title="'+(null==(__t=participatorsCount?participatorsCount+"人":"添加参与者")?"":__t)+'">\n\t<a href="javascript:void(0)" class="task-create-tools-link task-create-add-icon '+(null==(__t=participatorsCount?"task-create-add-icon-active":"")?"":__t)+'" >\n\t\t'+(null==(__t=participatorsCount?"参与者："+participatorsCount+"人":"参与者")?"":__t)+"\n\t</a>\n</span>\n";return __p},this.JST["task-create/task-create-principle"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<div class="task-create-principle">\n\t<span class="task-create-principle-inner" data-name="task-create-principle-inner">\n\t\t<span class="icon-task-creater"></span>\n\t\t<label class="task-create-principle-label" data-name=\'task-create-principle-label\' >'+(null==(__t=_.substring(principalUser.Name,6,!0))?"":__t)+"负责</label>\n\t</span>\n</div>\n";return __p},this.JST["task-create/task-create-replace"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<div class="task-create-tools-item task-create-replace '+(null==(__t=isCanReplace?"":"disable")?"":__t)+'" original-title="'+(null==(__t=isCanReplace?"点击可切换任务发起人":"不可以代自己发起任务")?"":__t)+'">\n\t\t\t\t\n\t<span class="task-create-replace-check-wraper" data-name="task-create-replace-check-wraper">\n\t\t',isCanReplace?(__p+="\n\t\t\t",replaceRadioChecked?__p+='\n\t\t\t\t<span class="task-create-replace-check checkbox checkbox-checked" data-name="task-create-replace-check"></span>\n\t\t\t':__p+='\n\t\t\t\t<span class="task-create-replace-check checkbox" data-name="task-create-replace-check"></span>\n\t\t\t',__p+="\n\t\t"):__p+='\n\t\t\t<span class="task-create-replace-check checkbox-default-disable %>"></span>\n\t\t',__p+='\n\t</span>\n\t<span class="task-create-replace-label" data-name="task-create-replace-label">代ta发起</span>\n\t<span class="task-create-help">\n\t\t<a href="http://service.tita.com/pages/viewpage.action?pageId=590556" target="_blank" class="icon-help"></a>\n\t</span>\n</div>\n\n';return __p},this.JST["task-create/task-create-workhour"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<span class="task-create-tools-item task-create-workhour"  data-name="task-create-workhour"\n\ttitle="'+(null==(__t=hourDate||minuteDate?"修改工时":"设置工时")?"":__t)+'">\n\t<a class="task-create-tools-link task-create-add-icon '+(null==(__t=workHour?"task-create-add-icon-active":"")?"":__t)+'">\n\t\t'+(null==(__t=workHour?workHour+" 小时":"工时")?"":__t)+"\n\t</a>\n</span>\n";return __p},this.JST["task-create/task-create"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="task-create-laytout-input layout-border" data-name="task-create-add-input">\n\t<div class="task-create-add-task-container" data-name="task-create-add-task-container">\n\t\t<div class="task-create-class" data-name="task-create-class"></div>\n\t\t<div class="task-create-name-container" data-name="task-create-name"></div>\n\t\t<div class="task-create-right-part">\n\t\t\t<div class="task-create-principle-area" data-name="task-create-principle-area"></div>\n\t\t\t<div class="task-create-date-container" data-name="task-create-date"></div>\n\t\t</div>\n\t</div>\n\t\n</div>\n<div class="task-create-layout-tools clearfix layout-border" data-name="task-create-tools">\n\t\t<div class="task-create-tools-item-wraper" data-name="task-create-hour-date"></div>\n\t\t<div class="task-create-tools-item-wraper" data-name="task-create-participator"></div>\n\t\t<div class="task-create-tools-item-wraper" data-name="task-create-apply-user"></div>\n\t\t<div class="task-create-tools-item-wraper" data-name="task-create-external-person"></div>\n\t\t<div class="task-create-tools-item-wraper" data-name="task-create-replace"></div>\n\n</div>\n<div class="task-create-layout-extend layout-border" data-name="task-create-layout-extend">\n\t<div class="task-create-layout-member-list " data-name="task-create-member-list"></div>\n\t<div class="task-create-layout-extend-user " data-name="task-create-extend"></div>\n</div>\n\n<div class="task-create-richeditor layout-border" data-name="task-create-richeditor"></div>\n<div class="task-create-bottom" data-name="task-create-bottom"></div>\n\n';return __p},this.JST=this.JST||{},this.JST["empty-view/empty"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="content_emptyinit">\n\t<div class="className">'+(null==(__t=emptyContext)?"":__t)+"</div>\n</div>";return __p},this.JST}(),BaseCollection={request:function(a){function b(a){var b=a.Code;if(1==b){var e=a.Data;a.ExtendedData&&(e=Talent._.extend({},a.Data,a.ExtendedData)),d.resolve(e)}else 401==b&&c(),d.reject(a.Message)}function c(){throw location.href=Context.getLoginUrl(),new Error("401")}var d=new Talent.$.Deferred;return a=Talent._.extend({},a),a.url=a.url||this.url,a.url=Context.getApiUrl(a.url),a.mockData?b(a.mockData):Talent.$.ajax(a).done(b),d.promise()},requestV2:function(a){function b(a){var b=a.Code;if(1==b){var d=a.Data;a.ExtendedData&&(d=Talent._.extend({},a.Data,a.ExtendedData)),c.resolve(d)}else c.reject(a.Message)}var c=new Talent.$.Deferred;return a=Talent._.extend({},a),a.url=a.url||this.url,a.url=Context.getApiUrlV2(a.url),a.mockData?b(a.mockData):Talent.$.ajax(a).done(b),c.promise()},batch:function(options){function action(resp){for(x in resp)resp[x].Data=eval("("+resp[x].Data+")");deferred.resolve(resp)}var deferred=new Talent.$.Deferred,urls=[];options=Talent._.extend({},options),options.url=options.url||this.url;for(var i=0;i<options.url.length;i++)urls.push(Context.getApiUrl(options.url[i]));return options.mockData?action(options.mockData):Talent.$.ajax({url:Context.getApiUrl("batch"),type:"POST",headers:{"x-bs-batch":1},data:"['"+urls.join("','")+"']",contentType:"application/json; charset=UTF-8"}).done(action),deferred.promise()},batchV2:function(options){function action(resp){for(x in resp)resp[x].Data=eval("("+resp[x].Data+")");deferred.resolve(resp)}var deferred=new Talent.$.Deferred,urls=[];options=Talent._.extend({},options),options.url=options.url||this.url;for(var i=0;i<options.url.length;i++)urls.push(Context.getApiUrlV2(options.url[i]));return options.mockData?action(options.mockData):Talent.$.ajax({url:Context.getApiUrl("batch"),type:"POST",headers:{"x-bs-batch":1},data:"['"+urls.join("','")+"']",contentType:"application/json; charset=UTF-8"}).done(action),deferred.promise()}},PlanCollection={postUpdateLable:function(a){var b=new Talent.$.Deferred,c={planItem_id:"",lable_id:"",lable_type:""},a=Talent._.extend({},c,a);return BaseCollection.request({url:"PlanV2/UpdateLable",type:"Post",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b},postPlanSetMark:function(a){var b=new Talent.$.Deferred,c={type:"",plan_id:""},a=Talent._.extend({},c,a);return BaseCollection.request({url:"PlanV2/Mark",type:"POST",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b},PutUpdateStatus:function(a){var b=new Talent.$.Deferred,c={plan_item_id:"",Status:""},a=Talent._.extend({},c,a),d="?plan_item_id="+a.plan_item_id+"&Status="+a.Status;return BaseCollection.request({url:"PlanV2/UpdateStatus"+d,type:"PUT",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b},deleteData:function(a){var b=new Talent.$.Deferred,c={plan_item_id:""},a=Talent._.extend({},c,a),d="?plan_item_id="+a.plan_item_id;return BaseCollection.request({url:"PlanV2/Remove"+d,type:"DELETE",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b},getDataList:function(a){var b=new Talent.$.Deferred,c={to_user_id:"",plan_table_id:"",plan_table_type:"",feed_id:"",task_id:""},a=Talent._.extend({},c,a),d="?to_user_id="+a.to_user_id+"&plan_table_id="+a.plan_table_id+"&plan_table_type="+a.plan_table_type+"&feed_id="+a.feed_id+"&task_id="+a.task_id;return BaseCollection.request({url:"PlanV2/PersionlPlanItemList"+d,type:"Get"}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b},getPlanData:function(){},getPlan:function(a){var b=new Talent.$.Deferred,c=JSON.stringify(PlanDataJson),d=JSON.parse(c),e={group_id:"",date:""},a=Talent._.extend({},e,a),f={Data:d},f=this._findData(f,a);return b.resolve(f.Data),b.promise()},_findData:function(a,b){var c=a.Data.taglist,d=b.date.split("/");if(0!=b.group_id&&moment().year()!=d[0]){var e=Talent._.findWhere(c,{GroupId:b.group_id}),f=e,g=f.PlanTableListModels[0],h=g.PlanTableModels[0];return f.Active=!0,g.Active=!0,h.Active=!0,a}if("00"==d[1]){var e=Talent._.findWhere(c,{GroupName:d[0]}),f=e,g=f.PlanTableListModels[0],h=g.PlanTableModels[0];return f.Active=!0,g.Active=!0,h.Active=!0,a}if("00"==d[2]){var e=Talent._.findWhere(c,{GroupName:d[0]}),i=Number(d[1])+1,f=e,g=Talent._.findWhere(e.PlanTableListModels,{TagId:i}),h=g.PlanTableModels[0];return f.Active=!0,g.Active=!0,h.Active=!0,a}for(var j=0;j<c.length;j++)for(var e=c[j],k=e.PlanTableListModels,l=0;l<k.length;l++)for(var m=k[l],n=m.PlanTableModels,o=m.TagId,p=0;p<n.length;p++){var q=n[p],r=this._formatDate(q.StartDate),s=this._formatDate(q.EndDate);if(r<=b.date&&s>=b.date&&o>1&&o<14&&0!=p)if(e.GroupId==b.group_id||0==b.group_id)q.Active=!0,q.IsCurrentDate=!0,m.Active=!0,e.Active=!0;else{var e=talent._.findWhere(c,{GroupId:b.group_id}),f=e,g=f.PlanTableListModels[0],h=g.PlanTableModels[0];f.Active=!0,g.Active=!0,h.Active=!0}r>b.date&&(q.IsCurrentDate=!1)}return a},_formatDate:function(a){var a=a.replace("年","/");return a=a.replace("月","/"),a=a.replace("日",""),moment(a).format("YYYY/MM/DD")}},TaskCollection={addTask:function(a){var b={TaskName:"",PrincipalUser:"",StartDate:"",EndDate:"",Importance:"",Visibility:"",Description:"",FileUrls:"",RemindTime:"",RemindType:"",hourDate:"",minuteDate:"",singleDate:"",extend_user:"",CycType:"",CycStartDate:"",CycStartTime:"",CycEndDate:"",CycEndTime:"",ApplyUserId:"",IsLongTerm:"",parentTaskId:"",LabId:"",LabType:"",PlanTableId:"",planTableType:"",TaskSource:"",AddPlan:"",objType:""},a=Talent._.extend({},b,a),c=new Talent.$.Deferred;return BaseCollection.request({url:"task/Add",type:"post",data:a}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},updateLable:function(a){var b={task_id:"",lab_id:"",lab_type:""},a=Talent._.extend({},b,a),c="?task_id="+a.task_id+"&lab_id="+a.lab_id+"&lab_type="+a.lab_type,d=new Talent.$.Deferred;return BaseCollection.request({url:"task/UpdateLable"+c,type:"Post"}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},UpdateCycleTask:function(a){var b={cycle_id:"",CycType:"",CycStartDate:"",CycStartTime:"",CycEndDate:"",CycEndTime:""},a=Talent._.extend({},b,a),c="?cycle_id="+a.cycle_id,d=new Talent.$.Deferred;return BaseCollection.request({url:"task/UpdateCycleTask"+c,type:"Post",data:a}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},updateTaskDate:function(a){var b={task_id:"",Deadline:"",StartDate:""},a=Talent._.extend({},b,a),c="?task_id="+a.task_id,d=new Talent.$.Deferred;return BaseCollection.request({url:"task/UpdateTaskDate"+c,type:"Post",data:a}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},cancelCycle:function(a){var b={task_id:"",cycle_id:""},a=Talent._.extend({},b,a),c="?task_id="+a.task_id+"&cycle_id="+a.cycle_id,d=new Talent.$.Deferred;return BaseCollection.request({url:"task/CloseCycleTask"+c,type:"Get"}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},getCycleTask:function(a){var b={cycle_id:""},a=Talent._.extend({},b,a),c="task/GetCycleTask?cycle_id="+a.cycle_id,d=new Talent.$.Deferred;return BaseCollection.request({url:c,type:"get"}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},getTaskInfo:function(a){var b=new Talent.$.Deferred,c={task_id:"",data:""},a=Talent._.extend({},c,a),d="?task_id="+a.task_id+"&data="+a.data;return BaseCollection.requestV2({url:"task/TaskInfo"+d,type:"Get"}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b.promise()},getTaskInfoObj:function(a){var b={task_id:""},c=new Talent.$.Deferred,a=Talent._.extend({},b,a),d="?task_id="+a.task_id;return BaseCollection.requestV2({url:"task/TaskInfoObj"+d,type:"get"}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c},taskAccept:function(a){var b={start_date:"",end_date:"",parent_task_id:"",lab_type:"",lab_id:"",isLongTerm:""},a=Talent._.extend({},b,a),c="?start_date="+a.start_date+"&end_date="+a.end_date+"&task_id="+a.task_id+"&lab_id="+a.lab_id+"&lab_type="+a.lab_type+"&isLongTerm="+a.isLongTerm,d=new Talent.$.Deferred;return BaseCollection.request({url:"task/Accept"+c,type:"POST"}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},participatorAccept:function(a){var b={task_id:""},c=new Talent.$.Deferred,a=Talent._.extend({},b,a);return BaseCollection.request({url:"task/ParticipatorAccept",type:"post",data:a}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c},taskDeleteParticipator:function(a){var b={task_id:"",to_user_id:""},c=new Talent.$.Deferred,a=Talent._.extend({},b,a);return BaseCollection.request({url:"task/DeleteParticipator",type:"POST",data:a}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},taskDelete:function(a){var b={task_id:"",to_user_id:""},c=new Talent.$.Deferred,a=Talent._.extend({},b,a),d="?task_id="+a.task_id;return BaseCollection.request({url:"task/Delete"+d,type:"POST"}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},updateStatus:function(a){var b={task_id:"",status:""},a=Talent._.extend({},b,a),c="?task_id="+a.task_id+"&=status"+a.status,d=new Talent.$.Deferred;return BaseCollection.request({url:"task/UpdateStatus"+c,data:a,type:"POST"}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},taskSetMark:function(a){var b=new Talent.$.Deferred,c={task_id:"",type:""},a=Talent._.extend({},c,a);a.task_id,a.type;return BaseCollection.request({url:"task/Mark",type:"POST",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b.promise()},changeTask:function(a){var b={task_id:"",old_parent_task_id:"",parent_task_id:""},a=Talent._.extend({},b,a),c=new Talent.$.Deferred,d="?task_id="+a.task_id+"&parent_task_id="+a.parent_task_id+"&old_parent_task_id="+a.old_parent_task_id;return BaseCollection.requestV2({url:"task/ChangeTask"+d,type:"POST",data:a}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},updateTaskName:function(a){var b={task_id:"",TaskName:""},a=Talent._.extend({},b,a),c=new Talent.$.Deferred;return BaseCollection.request({url:"task/UpdateName?task_id="+a.task_id,type:"POST",data:a}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},UpdateDescription:function(a){var b={task_id:"",Description:""},a=Talent._.extend({},b,a),c=new Talent.$.Deferred;return BaseCollection.request({url:"task/UpdateDescription?task_id="+a.task_id,type:"POST",data:a}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()},taskAddParticipator:function(a){var b=new Talent.$.Deferred,c="?task_id="+a.task_id;return BaseCollection.request({url:"task/AddParticipator"+c,type:"POST",contentType:"application/json",data:JSON.stringify(a.users)}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b.promise()},taskDeleteParticipator:function(a){var b=new Talent.$.Deferred;return BaseCollection.request({url:"task/DeleteParticipator",type:"POST",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b.promise()},updateApplyUser:function(a){var b=new Talent.$.Deferred,c={to_user_id:"",task_id:""},a=Talent._.extend({},c,a);return BaseCollection.request({url:"task/UpdateApplyUser",type:"POST",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b.promise()},updateTaskPrincipalUser:function(a){var b=new Talent.$.Deferred,c={task_id:"",to_user_id:""},a=Talent._.extend({},c,a);return BaseCollection.request({url:"task/UpdatePrincipal",type:"POST",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b.promise()},addAttachment:function(a){var b=new Talent.$.Deferred,c={objId:"",dfsUrls:"",documents:[]},a=Talent._.extend({},c,a);return BaseCollection.requestV2({url:"task/AddAttachment",type:"POST",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b.promise()},deleteAttachment:function(a){var b=new Talent.$.Deferred,c={task_id:"",document_id:""},a=Talent._.extend({},c,a),d="?task_id="+a.task_id+"&document_id="+a.document_id;return BaseCollection.request({url:"task/DeleteAttachment"+d,type:"POST",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b.promise()},addFollower:function(a){var b={taskId:"",followers:[]},c=new Talent.$.Deferred,d=Talent._.extend({},b,a),e="task/AddFollower?taskId="+d.taskId;return BaseCollection.request({url:e,type:"post",contentType:"application/json",data:JSON.stringify(d.followers)}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c},deleteFollower:function(a){var b={taskId:"",toUserId:""},c=new Talent.$.Deferred,d=Talent._.extend({},b,a),e="task/Deletefollower?taskId="+d.taskId+"&toUserId="+d.toUserId;return BaseCollection.request({url:e,type:"post"}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c},evaluateTask:function(a){var b=new Talent.$.Deferred;return BaseCollection.request({url:"task/EvaluateTask",type:"POST",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b.promise()},membersTask:function(a){var b={task_id:""},a=Talent._.extend({},b,a),c="?task_id="+a.task_id,d=new Talent.$.Deferred;return BaseCollection.requestV2({url:"task/Members"+c,type:"GET"}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()}},LableCollection={searchClassData:function(a){var b=new Talent.$.Deferred,c={},a=Talent._.extend({},c,a);return BaseCollection.request({url:"Lable/Search",type:"POST",data:{"":a.filter}}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b},getLableData:function(a){var b=new Talent.$.Deferred,c={obj_id:"",obj_type:"1"},a=Talent._.extend({},c,a),d="lable/get";return 2==a.obj_type?d=d+"?obj_id="+a.obj_id+"&obj_type="+a.obj_type:a.to_userId&&(d+="?to_userId="+a.to_userId),BaseCollection.request({url:d,type:"Get"}).done(function(a){function c(b,d){Talent._.each(b,function(b){var e=b.id;d&&(b.fullName=d.fullName+"/"+b.name);var f=Talent._.where(a,{parent_id:e});f=Talent._.compact(f),f.length?(b.children=f,b.isEnd=!1):(b.children=null,b.isEnd=!0),c(f,b)})}var a=a.lables||[],d={};d.lables=a;var e=[{id:"0",parent_id:"0",name:"类别",fullName:"类别"}],f=Talent._.where(a,{parent_id:"0"});f=Talent._.compact(f),c(e),d.lables=e,b.resolve(d)}).fail(function(a){b.reject(a)}),b},putRenameLableData:function(a){var b=new Talent.$.Deferred,c={lable_id:"",name:""},a=Talent._.extend({},c,a);return BaseCollection.request({url:"lable/name",type:"Post",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b},deleteLableData:function(a){var b=new Talent.$.Deferred,c={lable_id:""},a=Talent._.extend({},c,a),d="lable/remove";return d=d+"?lable_id="+a.lable_id,BaseCollection.request({url:d,type:"delete"}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b},postAddLableData:function(a){var b=new Talent.$.Deferred,c={obj_id:"",obj_type:"1",name:"",parent_id:""},a=Talent._.extend({},c,a);return BaseCollection.request({url:"lable/add",type:"post",data:a}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b},getLabelFullName:function(a){var b=new Talent.$.Deferred,c={lableId:0},a=Talent._.extend({},c,a),d="Lable/GetFullName?lableId="+a.lableId;return BaseCollection.request({url:d,type:"get"}).done(function(a){b.resolve(a)}).fail(function(a){b.reject(a)}),b}},ProjectCollection={getProject:function(a){var b={app_id:0,app_type:0,to_user_id:0},c=new Talent.$.Deferred,a=Talent._.extend({},b,a);a.app_id,a.app_type,a.to_user_id;return BaseCollection.request({type:"Get",url:"Work/MyAssentWork",data:a}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c}},ShareCollection={addShare:function(a){}},UserSelectorCollection=Talent.Collection.extend({getContact:function(){var a=this;return this.viewType="Contact",a.deferred&&a.deferred.reject(),a.deferred=new $.Deferred,$.ajax({url:Context.getApiUrl("Contact?v=")+(new Date).getTime(),type:"GET",success:function(b){if("Contact"==a.viewType)if(b&&1==b.Code){var c=Talent._.values(b.Data);c.length>0?(Talent._.map(c,function(a){return a.MidAvatar=a.UserAvatar.Medium,a.imgTemplate=Talent._.convertImage({shape:"radius",name:a.Name,src:a.MidAvatar,bgColor:a.UserAvatar.Color})}),a.deferred.resolve(c)):a.deferred.resolve([])}else a.deferred.resolve([])}}),a.deferred.promise()},getSubordinate:function(){var a=this;this.viewType="Subordinates",a.deferred&&a.deferred.reject(),a.deferred=new $.Deferred;return $.ajax({url:Context.getApiUrl("org/GetMySubordinates?lv=2&type=0"),type:"GET",success:function(b){if("Subordinates"==a.viewType)if(b&&1==b.Code){var c=Talent._.values(b.Data);c.length>0?(Talent._.map(c,function(a){return a.User&&(a.User.imgTemplate=Talent._.convertImage({shape:"radius",name:a.User.Name,src:a.User.MidAvatar,bgColor:a.User.UserAvatar.Color})),a}),c=Talent._.filter(c,function(a){return a.User.Id!=Context.getUserInfo().Id}),c=Talent._.pluck(c,"User"),a.deferred.resolve(c)):a.deferred.resolve([])}else a.deferred.resolve([])}}),a.deferred.promise()},getSearch:function(a){var b=this;this.viewType="Search",b.deferred&&b.deferred.reject(),b.deferred=new $.Deferred;var c=a&&a.searchCondition||{};this.filters=c.name;var d=Context.getApiUrl("user?v="+(new Date).getTime()+"&filters="+encodeURIComponent(c.name)||"");return""==c.name?b.deferred.resolve([]):$.ajax({url:d,type:"GET",success:function(a){if("Search"==b.viewType)if(a&&1==a.Code){var c=a&&a.Data||{};if(c.Filters==b.filters){var d=c.SimpleUserModel||{};d=Talent._.values(d),Talent._.map(d,function(a){return a.MidAvatar=a.UserAvatar.Medium,a.imgTemplate=Talent._.convertImage({shape:"radius",name:a.Name,src:a.MidAvatar,bgColor:a.UserAvatar.Color})}),b.deferred.resolve(d)}}else b.deferred.resolve([])}}),b.deferred.promise()},getDepartmentData:function(){var a=new $.Deferred;return $.ajax({url:Context.getApiUrl("department/All"),type:"GET",success:function(b){if(b&&1==b.Code){var c=b.Data||[];Talent._.map(c,function(a,b){a.count=a.TotalUserCount,a.Data=[],a.type="department"}),a.resolve(c)}else a.resolve([])}}),a.promise()},getDepartment:function(){var a=this;this.viewType="Department",a.deferred&&a.deferred.reject(),a.deferred=new $.Deferred;return this.getDepartmentData().done(function(b){if("Department"==a.viewType){var c=b;c=Talent._.filter(c,function(a,b){return 0==a.PId}),a.deferred.resolve(c)}}),a.deferred.promise()},getDepartmentDetail:function(a){var b=this;this.viewType="Department",b.deferred&&b.deferred.reject(),b.deferred=new $.Deferred;var c=parseInt(a.id);return this.getDepartmentData().done(function(d){var e=d;e=Talent._.filter(e,function(a,b){return a.PId==c}),e=e||[],$.ajax({url:Context.getApiUrl("department/DepartmentOfUser?department_id=")+a.id,type:"GET",success:function(a){if("Department"==b.viewType){var c=a.Data||[];Talent._.map(c,function(a){return a.imgTemplate=Talent._.convertImage({shape:"radius",name:a.Name,src:a.MidAvatar,bgColor:a.UserAvatar.Color})}),e=c.concat(e),b.deferred.resolve(e)}}})}),b.deferred.promise()},invite:function(a){var b=new $.Deferred;return $.ajax({url:Context.getApiUrl("userinvite/inviteUser"),type:"POST",data:a}).done(function(a){b.resolve(a)}),b.promise()}}),ExperienceCollection={deleteShare:function(a){var b={obj_id:"",obj_type:"7",experience_id:""},a=Talent._.extend({},b,a),c="?experience_id="+a.experience_id+"&obj_id="+a.obj_id+"&obj_type="+a.obj_type,d=new Talent.$.Deferred;return BaseCollection.requestV2({url:"Experience/Delete"+c,type:"POST"}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},editShareContent:function(a){var b={experience_id:"",content:""},a=Talent._.extend({},b,a),c="?experience_id="+a.experience_id,d=new Talent.$.Deferred;return BaseCollection.requestV2({url:"Experience/Update"+c,type:"POST",data:{content:a.content}}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},editShareDate:function(a){var b={experience_id:"",startDate:"",endDate:""},a=Talent._.extend({},b,a),c="?experience_id="+a.experience_id+"&startDate="+a.startDate+"&endDate="+a.endDate,d=new Talent.$.Deferred;return BaseCollection.requestV2({url:"Experience/UpdateDate"+c,type:"POST",data:a}).done(function(a){d.resolve(a)}).fail(function(a){d.reject(a)}),d.promise()},addShare:function(a){var b={ObjId:"",ObjType:"7",Content:"",StartDate:"",EndDate:"",FileUrls:"",DocumentModels:[]},a=Talent._.extend({},b,a),c=new Talent.$.Deferred;return BaseCollection.requestV2({url:"Experience/Add",type:"POST",data:a}).done(function(a){c.resolve(a)}).fail(function(a){c.reject(a)}),c.promise()}},apiServer=BSGlobal.apiPath,Context={getGlobal:function(a){return BSGlobal[a]},changeHash:function(a,b,c){var d=decodeURIComponent(location.hash),e=d.split("?"),f=Context.parseUrl(d),g=[];if(url=null,c=1==c,"deleted"==b)for(var h=0,i=a.length;h<i;h++)delete f[a[h]];"add"==b&&(f=Talent._.extend({},f,a)),"eidt"==b&&(f=Talent._.extend({},f,a));for(var j in f)g.push(j+"="+f[j]);g.length?url=e[0]+"?"+g.join("&"):url=e[0],Talent.app.execute("history:navigate",url,c)},getLocalStorage:function(){if("object"==typeof localStorage)return localStorage;if("object"==typeof globalStorage)return globalStorage[location.host];throw new Error("local storage not available")},deleteGlobalProp:function(a){delete BSGlobal[a]},setGlobal:function(a,b){BSGlobal[a]=b},getTenantInfo:function(){return BSGlobal.tenantInfo},getUserInfo:function(){return BSGlobal.loginUserInfo},getStaticUrl:function(a){return"../../images/components/tita-widget/"+a},getApiUrl:function(a){var b=this.getUserInfo().Id,c=this.getTenantInfo().Id;return apiServer+"/api/v1/"+c+"/"+b+"/"+a},getApiUrlV2:function(a){var b=this.getUserInfo().Id,c=this.getTenantInfo().Id;return apiServer+"/api/v2/"+c+"/"+b+"/"+a},parseUrl:function(a){var b={};if(!a)return b;var c=a.indexOf("?");if(c>-1)for(var d=a.slice(c+1),e=d.split("&"),f=0;f<e.length;f++){var g=e[f].split("=");b[g[0]]=decodeURIComponent(g[1])}return b},getI18n:function(){var a={home_1:"动态",plan_1:"计划",work_1:"项目",document_1:"文件",workmate_1:"同事",app_1:"应用",task_1:"任务",task_2:"循环任务",schedule_1:"日程",share_1:"分享",sharing_1:"分享",follow_1:"立即关注",following_1:"正在关注",cancelfollow_1:"取消关注",myfollowmate_1:"我关注的",myfans_1:"我的粉丝",publishshare_1:"发分享",publishtask_1:"派任务",myfollowfeed_1:"与我相关",mypublishfeed_1:"我发表的",myleavefeed_1:"@我的",myreplayfeed_1:"回复我的",mycollectfeed_1:"我收藏的",myallfeed_1:"所有动态",message_1:"消息",remind_1:"提醒",myschedule_1:"我的日程",href_1:"常用链接",invitemate_1:"邀请同事",helpcenter_1:"帮助中心",onlineuser_1:"在线同事"},b={guide_1:"打开导览"};return BSGlobal&&BSGlobal.BSi18n?Talent._.extend({},BSGlobal.BSi18n,b):Talent._.extend({},a,b)},getAttachmentType:function(a){return{image:["jpg","png","gif","jpeg","JPG","PNG","GIF","JPEG"],file:["rar","zip","exe","pdf","txt","doc","docx","ppt","pptx","XLS","XLSX","RAR","ZIP","EXE","PDF","TXT","DOC","DOCX","PPT","PPTX","XLS","XLSX"],music:["mp3","wma","wav","flac","ape","ogg","aac","m4a","MP3","WMA","WAV","FLAC","APE","OGG","AAC","M4A"],video:["mp4","mkv","rm","rmvb","avi","3gp","flv","wmv","asf","mpeg","mpg","mov","ts","m4v"]}},getUploadOptions:function(a){var b=this.getGlobal("evn"),c=b&&"develop"==b?"tita-inc.com":"tita.com",d={validate:{format:[],onceLimt:20,allLimt:-1,nameLimt:-1},callbackName:"jsCallback",url:this.getApiUrl("Upload/PostFiles"),ajaxUrl:this.getApiUrl("Upload/PostFiles?format=json"),fileInputName:"file_upload",extendData:{domain:"document.domain="+c},error:{error_allLimt:"文件超出最大限度",error_format:"文件格式不合法",error_nameLimt:"名字长度不合格"},isPaste:!0,isDrag:!0,callbackValue:"parent._callback_"};return a&&(d=Talent._.extend({},d,a)),d},isAbsolutePath:function(){var a=this.getGlobal("titaHost")||"",b="http://"+location.host,c="";return c=a==b?"":a+"/u/"+this.getUserInfo().Id+"/Home",{host:a,webHost:c}},encodeScript:function(a){return 0==a.length?"":(s=a.replace(/</g,"&lt;"),s=s.replace(/>/g,"&gt;"),s)},dencodeScript:function(a){return 0==a.length?"":(s=a.replace(/&lt;/g,"<"),s=s.replace(/&gt;/g,">"),s)},formatDate:function(a){if(!a)return a;var b=moment().year(),c=a.split(" ");return moment(new Date(a)).year()==b&&(a=c[1]?moment(new Date(a)).format("M/D HH:mm"):moment(new Date(a)).format("M/D")),a},setPosition:function(a,b,c){var d={container:Talent.$("body"),pos:"bottom",leftBias:0,topBias:0,autoFrames:"body"},c=Talent._.extend({},d,c),e=c.container||Talent.$("body"),f=e.offset(),g=a.offset(),h=a.outerHeight(),i=a.outerWidth(),j=b.outerWidth(),k=b.outerHeight(),l={},m=g.top,n=g.left,o=m-f.top,p=n-f.left;switch(c.pos){case"top":l={top:o-k,left:p},"bottom";break;case"topCenter":l={top:o-k,left:p+i/2-j/2},"bottom";break;case"topRight":l={top:o-k,left:p+i-j},l.left<0&&(l.left=0),"bottom";break;case"bottom":l={top:o+h,left:p},"top";break;case"bottomCenter":l={top:o+h,left:p+i/2-j/2},"top";break;case"bottomRight":l={top:o+h,left:p+i-j},l.left<0&&(l.left=0),"top";break;case"left":l={top:o,left:p-j},"right";break;case"leftCenter":l={top:o+h/2-k/2,left:p-j},"right";break;case"leftBottom":l={top:o+h-k,left:p-j},"right";break;case"right":l={top:o,left:p+i},"left";break;case"rightCenter":l={top:o+h/2-k/2,left:p+i},"left";break;case"rightBottom":l={top:o+h-k,left:p+i},"left"}c.leftBias&&(l.left=l.left+c.leftBias),c.topBias&&(l.top=l.top+c.topBias);var q=Talent.$(window).height(),r=Talent.$(window).width(),s=Talent.$(document).scrollTop(),t=Talent.$(document).scrollLeft();if(f.top+l.top+k>q+s){var u=q+s-(f.top+l.top+k);l.top=l.top+u}if(f.top+l.top<s){var u=s-(f.top+l.top);l.top=l.top+u}if(f.left+l.left+j>r+t){var v=r+t-(f.left+l.left+j);l.left=l.left+v}if(f.left+l.left<t){var v=t-(f.left+l.left);l.left=l.left+v}b.css(l)},IsOpenYifangyun:function(){var a=Talent.Context.getGlobal("WebHead")||{},b=a.AppHead||[];return!!b.length&&!!_.findWhere(b,{AppId:"801"})},getUploadTipText:function(){return'<div style="text-align:left"><b style="display:block;font-size:14px;">支持拖拽上传<br>最多一次能上传20个</b>大小不超过20M</div>'},getAppHead:function(a){var b=this.getGlobal("WebHead");if(b){var c=b.AppHead||[],d=Talent._.findWhere(c,a);return d||null}}};_.TitaWidget_substring=function(a,b,c){if(!a)return"";for(var d=0,e="",f=/[^\x00-\xff]/g,g="",h=a.replace(f,"**").length,i=0;i<h&&(g=a.charAt(i).toString(),null!=g.match(f)?d+=2:d+=1,!(c&&h>b&&d+2>b))&&!(d>b);i++)e+=g;return c&&h>b&&(e+="…"),e},_.substring=function(a,b,c){if(!a)return"";for(var d=0,e="",f=/[^\x00-\xff]/g,g="",h=a.replace(f,"**").length,i=0;i<h&&(g=a.charAt(i).toString(),null!=g.match(f)?d+=2:d+=1,!(c&&h>b&&d+2>b))&&!(d>b);i++)e+=g;return c&&h>b&&(e+="…"),e},_.substringWithM=function(a,b,c){for(var d=0,e="",f=/[^\x00-\xff]/g,g="",h=a.replace(f,"**").length,i=0;i<h&&(g=a.charAt(i).toString(),null!=g.match(f)?d+=2:"m"==g||"w"==g?d+=2:d++,!(d>b));i++)e+=g;return c&&h>b&&(e+="…"),e},_.isStringBeyondLength=function(a,b){var c=/[^\x00-\xff]/g;return a.replace(c,"**").length>b},_.convertImage=function(a){var b="",a=a||{},c={className:"",size:30,shape:"radius",name:"",src:""};return a=_.extend({},c,a),a.bgColor?(50==a.size?a.subName=_.substring(a.name,6,!1):30==a.size?a.subName=_.substring(a.name,3,!1):64==a.size?a.subName=_.substring(a.name,6,!1):80==a.size&&(a.subName=_.substring(a.name,6,!1)),b=['<span class="',a.shape,"_img",a.size," ",a.className,'" style="background-color:',a.bgColor,';"  original-title="',a.name,'">',a.subName,"</span>"].join("")):b=['<img class="',a.shape,"_img",a.size," ",a.className,'" width="',a.size,'" height="',a.size,'" src="',a.src,'" original-title="',a.name,'" />'].join(""),b},_.TitaWidget_evaluation=function(a,b){var c={1:"tw-medal-grade-one-light",2:"tw-medal-grade-two-light",3:"tw-medal-grade-three-light"},d={1:"太棒了！",2:"干的不错！",3:"再接再厉！"},a=a||{},e={type:1,value:"",lvl:5,goal:2};a=_.extend({},e,a),a.value=parseInt(a.value),a.type=parseInt(a.type);var f=a.type;a.lvl||(a.lvl=5),a.goal||(a.goal=2);var g=["","",""];if(1==f){var h=Math.floor(a.value/a.goal);g=['<span class="evaluation-star-list">',"","</span>"];var i=0,j=Math.ceil(a.value/a.goal);h!=j&&(i=j);for(var k=1;k<=a.lvl;k++)g[1]+=k<=h?'<span class="icon-star-m-active"></span>':i==k?'<span class="icon-star-m-half-active"></span>':'<span class="icon-star-m-disabled"></span>';g[1]+='<div class="last-score"><span class="score-value">'+a.value+'</span><span class="value-unit">分</span></div>'}return 2==f&&(a.name&&"null"!=a.name||(a.name=d[a.value]),g[1]='<span class="result-'+[a.value]+'"><span class="'+c[a.value]+'"></span>'+a.name+"</span>"),'<span class="tt_evaluation">'+g.join("")+"</span>"};var supportT=function(){var a=document.body||document.documentElement,b=a.style;return void 0!==b.WebkitAnimation||void 0!==b.webkitAnimation||void 0!==b.MozAnimation||void 0!==b.OAnimation||void 0!==b.msAnimation||void 0!==b.animation}();_.animate=function(a,b,c,d,e){var b=b||"shake",c=c||"noraml",e=e||function(){};if(!supportT)return void e();"number"==typeof c?c*=100:c=""==c?300:{fast:200,normal:500,slow:1e3}[c]||500;var f=["UI_animated","UI_speed_"+c,"UI_ani_"+b];a.addClass(f.join(" "));setTimeout(function(){a.removeClass(f.join(" ")),e()},c)},_.privateTipText=function(a,b,c,d){var e=Context.getI18n(),f=b,g="仅相关人可见";if(f){if(d)switch(d){case 400:case 500:g="仅你和你上级可见";break;case 600:g="仅"+e.task_1+"成员可见"}else if(c)switch(c){case 3:g="仅团队成员可见";break;case 4:g="仅相关成员可见";break;case 8:4==a&&(g="仅共享者可见"),5==a&&(g="仅共享者可见");break;case 15:g="仅发起者的部门可见"}else{if(!a)return"仅自己可见";switch(a){case 1:g="仅@的人可见";break;case 20:g="仅"+e.task_1+"成员可见"}}return g}return"所有人可见"};var EmptyView=Talent.ItemView.extend({defaults:{emptyContext:"333333333"},template:jst["empty-view/empty"],className:"tt_common_emptyinit",initialize:function(a){this.settings=Talent._.extend({},this.defaults,this.options)},templateHelpers:function(){var a=this.settings.emptyContext?this.settings.emptyContext:this.model.get("emptyContext"),b=0;return a&&(b=a.replace(/<[^>].*?>/g,"").replace(/[&nbsp;]/g,"").length),{emptyContext:a,className:b>24?"small_content_emptyinit":"content_emptyinit"}}}),TDialogView=Talent.CompositeView.extend({template:jst["tdialog/dialog"],defaults:{id:"tdialog",type:"tipsy",arrowPos:"top",sure:!1,sureText:"确定",sureLink:"",cancel:!1,cancelText:"取消",arrow:1,minHeight:"37",minWidth:"50",maxWidth:"",fixed:!1,zindex:1001,quirkTheme:!1,showClosed:!1,skin:""},tagName:"div",className:"_tt_dialog",ui:{sure:".sure_dialog",sureText:".sure_dialog>span",cancel:".cancel_dialog",closed:".closed_dialog",dd:".ask_dialog"},events:function(){var a={};return a["click "+this.ui.sure]="onSureEvent",a["click "+this.ui.cancel]="onCancel",a["click "+this.ui.closed]="onCancel",a},initialize:function(){this.settings=Talent._.extend({},this.defaults,this.options),this.$el.attr("id",this.options.id),this.model.set({settings:this.settings}),this._init(),this.$el.on("mouseup",function(a){a.stopPropagation()}),"skin2"==this.settings.skin&&this.$el.addClass("tt-dialog-skin2")},_init:function(){var a={minWidth:this.settings.minWidth+"px",minHeight:this.settings.minHeight+"px","z-index":this.settings.zindex,position:this.settings.fixed?"fixed":"absolute"};this.settings.maxWidth&&""!=this.settings.maxWidth&&(a.maxWidth=this.settings.maxWidth+"px"),this.$el.css(a)},onSureEvent:function(a){var b=$(a.currentTarget);if($("#tdialog_mask").remove(),"function"==typeof this.settings.sure){if(void 0!=this.activeNode&&null!=this.activeNode){if(0==this.settings.sure(b))return}else this.settings.sure();this.close()}},onCancel:function(a){var b=$(a.currentTarget);this.trigger("hide",b),$("#tdialog_mask").remove(),"function"==typeof this.settings.cancel&&this.settings.cancel(b),this.close()},show:function(a,b,c){var d={className:"none",autoHide:!1,pos:"bottom",x:0,y:0,topBias:0,leftBias:0,arrowBias:0,zindex:999,autoFrames:"window",container:"",arrow:!1},e=Talent._.extend({},d,c);if("tipsy"==this.settings.type){var f=Talent.$('<div class="tipsy_dialog '+e.className+'_dialog"><b class="ico"></b><span class="content"></span></div>');f.append(b),this.$el.find(".content_dialog").empty().append(f)}else this.$el.find(".content_dialog").empty().append(b);if(this.settings.skin&&"skin2"==this.settings.skin){var g=/[^\x00-\xff]/g;b.replace(g,"**").length<47&&this.settings.skin&&"skin2"==this.settings.skin&&this.$el.css("text-align","center")}this.settings.quirkTheme&&(this.$el.find(".sure_dialog").removeClass("btn-sure").addClass("btn-cancel"),this.$el.find(".cancel_dialog").removeClass("btn-cancel").addClass("btn-sure")),a?this._showHere(a,e):($("body").append('<div class="mask" id="tdialog_mask"></div'),this.$el.css({top:"300px",left:"50%","margin-left":"-"+this.$el.width()/2})),this._autoHide(e),this.$el.show(),Talent._.animate(this.$el,"fadeInDown",3),this.$el.find(".content_dialog").off("click")},hide:function(){this.close()},setOptions:function(a){this.settings=Talent._.extend({},this.settings,a),this.model.set({settings:this.settings}),this.render()},onRender:function(){var a=this;this.$el.on("click",function(b){a.trigger("click"),b.stopPropagation()})},_stopMouseUpHandler:function(a){a.stopPropagation()},_autoHide:function(a){var b=this;1==a.autoHide&&setTimeout(function(){$("#tdialog_mask").remove(),b.trigger("hide"),b.close()},1500),"number"==typeof a.autoHide&&setTimeout(function(){b.trigger("hide"),b.close()},a.autoHide)},_showHere:function(a,b){this.activeNode=a||null;var c=b.container||Talent.$("body"),d=c.offset(),e=Talent.$("body").scrollTop(),f=Talent.$("body").scrollLeft(),g=a.offset(),h=a.outerHeight(),i=a.outerWidth(),j=b.width?b.width:this.$el.outerWidth(),k=b.height?b.height:this.$el.outerHeight(),l={},m={},n="",o=b.domOffTop?b.domOffTop:g.top,p=g.left,q=o-d.top,r=p-d.left;switch(b.pos){case"top":l={top:q-k-8,left:r},m={left:0},n="bottom";break;case"topCenter":l={top:q-k-8,left:r+i/2-j/2},m={left:j/2-8},n="bottom";break;case"topRight":l={top:q-k-8,left:r+i-j},l.left<0&&(l.left=0),m={left:j-16},n="bottom";break;case"bottom":l={top:q+h+8,left:r},m={left:0},n="top";break;case"bottomCenter":l={top:q+h+8,left:r+i/2-j/2},m={left:j/2-8},n="top";break;case"bottomRight":l={top:q+h+8,left:r+i-j},l.left<0&&(l.left=0),m={left:j-16},n="top";break;case"left":l={top:q,left:r-j},m={top:0},n="right";break;case"leftCenter":l={top:q+h/2-k/2,left:r-j},m={top:k/2-8},n="right";break;case"leftBottom":l={top:q+h-k,left:r-j},m={top:k-16},n="right";break;case"right":l={top:q,left:r+i},m={top:0},n="left";break;case"rightCenter":l={top:q+h/2-k/2,left:r+i},m={top:k/2-8},n="left";break;case"rightBottom":l={top:q+h-k,left:r+i},m={top:k-16},n="left"}b.leftBias&&(l.left=l.left+b.leftBias),b.topBias&&(l.top=l.top+b.topBias);var s=Talent.$(window).height(),t=Talent.$(window).width(),e=Talent.$(document).scrollTop(),f=Talent.$(document).scrollLeft();if(d.top+l.top+k>s+e){var u=s+e-(d.top+l.top+k);l.top=l.top+u}if(d.top+l.top<e){var u=e-(d.top+l.top);l.top=l.top+u}if(d.left+l.left+j>t+f){var v=t+f-(d.left+l.left+j);l.left=l.left+v}if(d.left+l.left<f){var v=f-(d.left+l.left);l.left=l.left+v}this.$el.css(l);var w=this.$el.find(".arrow");!1===b.arrow&&w.hide(),w.addClass(n),2===b.arrow&&("top"===n||"bottom"===n?w.addClass("arrow2"):w.addClass("horizontal_arrow2")),w.css(m)},onClose:function(){this.$el.find(".content_dialog").off("click")},changeSubmitBtn:function(a){1==a?(this.ui.sureText.text("确定"),this.ui.sure.removeClass("success_submint").removeClass("loading_submint")):2==a?(this.ui.sureText.text(""),this.ui.sure.removeClass("success_submint"),this.ui.sure.addClass("loading_submint")):(this.ui.sureText.text(""),this.ui.sure.removeClass("loading_submint"),this.ui.sure.addClass("success_submint"))}}),SetNoticeView=Talent.Layout.extend({template:jst["set-notice/set-notice"],className:"wrap_noticesetting_tita",defaults:{id:"tita"},regions:{userList:"div[data-name=person-list]"},ui:{dayInput:"div[data-name=day-input]",dayInputValue:"label[data-name=day-input-value]",dayDropdown:"div[data-name=day-dropdown]",dayDropdownWeek:"dl[data-name=day-dropdown-week]",dayDropdownMonth:"dl[data-name=day-dropdown-month]",dayDropdownDatepicker:"div[data-name=day-dropdown-datepicker]",hourWrap:"div[data-name=hour-wrap]",hourInputValue:"label[data-name=hour-input-value]",hourDropdown:"ul[data-name=hour-dropdown]",hourDropdown_li:"ul[data-name=hour-dropdown] li",minWrap:'div[data-name="minite-wrap"]',minInputValue:"label[data-name=minite-input-value]",minuteDropdown:"ul[data-name=minute-dropdown]",minuteDropdown_li:"ul[data-name=minute-dropdown] li",dayDropdown_li:"div[data-name=day-dropdown] li",decsWrap:"div[data-name=remind-desc-wrap]",decsInput:"textarea[data-name=remind-desc-input]",otherWrap:"li[data-name=day-other]",everyWeekWrap:"li[data-name=day-every-week]",everyWeekWrap_dd:"li[data-name=day-every-week] dd",everyMonthWrap:"li[data-name=day-every-month]",everyMonthWrap_dd:"li[data-name=day-every-month] dd",buttonCancelRemind:"a[data-name=remind-button-cancel-remind]",buttonCancel:"a[data-name=remind-button-cancel]",buttonSure:"a[data-name=remind-button-sure]",errorTip:"div[data-name=error-tip]",datePickerWrap:"div[data-name=day-dropdown-datepicker]"},events:function(){var a={};return a["click "+this.ui.dayInput]="_clickDayInputHandler",a["click "+this.ui.dayDropdown_li]="_checkoutDay",a["mouseover "+this.ui.dayDropdown_li]="_dayBoxRest",a["mouseover "+this.ui.otherWrap]="_overOtherWrapHandler",a["click "+this.ui.dayDropdownDatepicker]="_dayDropDownHandler",a["click "+this.ui.otherWrap]="_clickOtherWrapHandler",a["mouseover "+this.ui.everyWeekWrap]="_overEveryWeekWrapHandler",a["mouseover "+this.ui.everyMonthWrap]="_overEveryMonthWrapHandler",a["click "+this.ui.everyWeekWrap_dd]="_checkEveryWeekDDHandler",a["click "+this.ui.everyMonthWrap_dd]="_checkEveryMonthDDHandler",a["click "+this.ui.hourWrap]="_clickHourHandler",a["click "+this.ui.minWrap]="_clickMinHandler",a["click "+this.ui.hourDropdown_li]="_clickHourDropdown_liHandler",a["click "+this.ui.minuteDropdown_li]="_clickMinuteDropdown_liHandler",a["focus "+this.ui.decsInput]="_foucsDecsInputHandler",a["blur "+this.ui.decsInput]="_blurDecsInputHandler",a["keyup "+this.ui.decsInput]="_keyupInputHandler",a["click "+this.ui.buttonSure]="_sureHandler",a["click "+this.ui.buttonCancel]="_cancelHandler",a["click "+this.ui.buttonCancelRemind]="_cancelRemindHandler",a},initialize:function(){var a=this;this._dealDate(),this.$el.on("click",function(b){b.stopPropagation(),a._hideDropdown(),a.ui.minWrap.removeClass("cur_minite_time_nst"),a.ui.hourWrap.removeClass("cur_his_time_nst"),a.ui.dayInput.removeClass("cur_day_time_nst")}),this.$el.on("mouseup",function(a){a.stopPropagation()}),Talent.$(document).off("mouseup.Set-Notice-View"),Talent.$(document).on("mouseup.Set-Notice-View",function(){a.hide()}),this.userCollection=new Talent.Collection},onRender:function(){this._setNoticeUser(),this._bindDatePicker()},setPosition:function(a,b){this.node=a;var c=a.attr("data"),d=this;c=$.parseJSON(c),this.objId=c.objid||0,this.objType=c.objType||0,this._requsetFetch().done(function(a){var c=a[0],e=c.Users;Talent._.map(e,function(a){a.Id=a.userId,a.UserAvatar=a.Avatar}),d._resetData(c),d._setPostion(b),d.userCollection.reset(e)})},hide:function(){this.$el.hide()},_setPostion:function(a){var b={topBias:0,leftBias:0},a=(this.node,Talent._.extend({},b,a));Context.setPosition(this.node,this.$el,a),this.$el.show(),Talent._.animate(this.$el,"fadeInDown",3)},_setNoticeUser:function(){this.noticeUserView=new AddUserCompositeView({addUserSelectonOptions:{muti:!1,container:this.$el},collection:this.userCollection}),this.listenTo(this.noticeUserView,"addUser",function(a){this.userCollection.add(a)}),this.userList.show(this.noticeUserView)},_dayDropDownHandler:function(a){a.stopPropagation()},_bindDatePicker:function(){var a=this,b={format:"YYYY/MM/DD",singleDatePicker:!0,parentEl:this.ui.dayDropdownDatepicker,autoHide:!1,opens:"center"};this.ui.dayDropdownDatepicker.daterangepicker(b),this.ui.dayDropdownDatepicker.on("apply.daterangepicker",function(b,c){var d=c.startDate.format("YYYY/MM/DD");a.ui.dayInputValue.html(d).attr("uservalue",d),a.model.set({cyctype:0,day:d}),a.ui.dayInput.find("li,dd").removeClass("cur_nst"),a.ui.dayInput.find("li[uservalue^='"+d+"']").addClass("cur_nst"),a._hideDropdown()}),this.$el.find(".daterangepicker").bind("click mouseover",function(a){a.stopPropagation()})},_sureHandler:function(a){var b=Talent.$(a.currentTarget),c=this._validateData(),d=this.model.get("opsType");if(this._getUserIds(),!this.model.get("userIds").length)return void TipDialogView(b,"被提醒人不能为空",{container:this.$el,pos:"topCenter"});c.isValidate&&("update"==d?this._requsetUpdate():this._requsetAdd())},_getUserIds:function(){var a=this.userCollection.toJSON(),b=Talent._.pluck(a,"UserId");this.model.set("userIds",b)},_requsetFetch:function(){var a=new Talent.$.Deferred;return SetNoticeCollectoin.getData({obj_id:this.objId,obj_type:this.objType}).done(function(b){a.resolve(b)}),a},_requsetAdd:function(){var a=this.model.get("day"),b=this.model.get("hour"),c=this.model.get("minute"),d=this,e=a+" "+b+":"+c;this._cancelHandler(),SetNoticeCollectoin.postAddRemindData({obj_id:this.objId,obj_type:this.objType,content:this.model.get("content"),cyc_type:this.model.get("cyctype"),remind_user_ids:this.model.get("userIds").join(","),time:e}).done(function(a){d.node.addClass("icon-clock-active");var b=d.model.toJSON();b.time=e,d.trigger("sure",d.ui.buttonSure,b)})},_requsetUpdate:function(){var a=this.model.get("day"),b=this.model.get("hour"),c=this.model.get("minute"),d=this,e=a+" "+b+":"+c;this._cancelHandler(),SetNoticeCollectoin.postUpdateData({obj_id:this.objId,obj_type:this.objType,content:this.model.get("content"),cyc_type:this.model.get("cyctype"),remind_user_ids:this.model.get("userIds").join(","),time:e}).done(function(a){var b=d.model.toJSON();b.time=e,d.trigger("sure",d.ui.buttonSure,b)})},_cancelHandler:function(a){this.$el.hide()},_cancelRemindHandler:function(){var a=this;this._hideDropdown(),this.model.set({opsType:"add",day:"",content:""}),this._cancelHandler(),this._dealDate(),this.render(),SetNoticeCollectoin.getCleanRemindData({obj_id:this.objId,obj_type:this.objType}).done(function(){a.node.removeClass("icon-clock-active").addClass("icon-clock"),a.trigger("cancelRemind")})},_resetData:function(a){if(0==(a.Id||0))this.opsType="add",this.model.set({noticeid:0,opsType:"add",objType:0,objId:0,content:"",uservalue:0,cyctype:0});else{this.ui.buttonCancel.show();var b=a.Content.split("<b>");1==b.length&&(b=a.Content.split("(")),this.model.set({noticeid:this.options.id,opsType:"update",objType:this.options.objType,objId:this.options.objId,content:$.trim(b[0])}),this.ui.buttonCancelRemind.show();var c=a.CycType;c||(c="0"),c=""+c;var d=c.split("_");c=d[0];var e,f,g,h=a.Date;if(h&&(dateArr=h.split(" "),e=dateArr[0].replace(/-/g,"/"),f=dateArr[1].substr(0,2),g=dateArr[1].substr(3,5)),1==c)this.ui.dayInput.find("div[data-name=day-every-day]").trigger("click");else if(2==c)this.ui.dayInput.find("div[data-name=day-every-weekday]").trigger("click");else if(3==c)this.ui.dayDropdownWeek.find("dd[uservalue='"+d[1]+"']").trigger("click");else if(4==c)this.ui.dayDropdownMonth.find("dd[uservalue='"+d[1]+"']").trigger("click");else{var i=e;this.ui.dayInputValue.html(i),this.model.set({uservalue:i,cyctype:0});var j=this.ui.dayDropdown.find("li[uservalue='"+e+" 00:00']");j.length&&j.trigger("click")}a.Content&&this.ui.decsInput.val(a.Content).removeClass("default_nst"),this.ui.hourDropdown.find("li[label='"+f+"']").trigger("click"),this.ui.minuteDropdown.find("li[label='"+g+"']").trigger("click")}},_foucsDecsInputHandler:function(a){var b=Talent.$(a.currentTarget);Talent.$.trim(b.val())==b.attr("defaultvalue")&&b.val(""),b.removeClass("default_nst"),b.addClass("cur_desc_nst")},_blurDecsInputHandler:function(a){var b=Talent.$(a.currentTarget);""==Talent.$.trim(b.val())&&(b.val(b.attr("defaultvalue")),b.addClass("default_nst"),this.model.set("content","")),b.removeClass("cur_desc_nst")},_keyupInputHandler:function(a){var b=Talent.$(a.currentTarget),c=Talent.$.trim(b.val());this.model.set("content",c)},_clickHourDropdown_liHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget);this.model.set({label:b.attr("label"),hour:b.attr("uservalue")}),this.ui.hourInputValue.html(b.attr("label")),this.ui.hourDropdown.hide(),this.ui.hourDropdown_li.removeClass("cur_nst"),b.addClass("cur_nst"),this.ui.hourWrap.removeClass("cur_his_time_nst")},_clickMinuteDropdown_liHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget);this.model.set({label:b.attr("label"),minute:b.attr("uservalue")}),this.ui.minInputValue.html(b.attr("label")),this.ui.minuteDropdown.hide(),this.ui.minuteDropdown_li.removeClass("cur_nst"),b.addClass("cur_nst"),this.ui.minWrap.removeClass("cur_minite_time_nst")},_clickHourHandler:function(a){a.stopPropagation(),Talent.$(a.currentTarget).addClass("cur_his_time_nst"),this._hideDropdown(),this.ui.hourDropdown.show()},_clickMinHandler:function(a){a.stopPropagation(),Talent.$(a.currentTarget).addClass("cur_minite_time_nst"),this._hideDropdown(),this.ui.minuteDropdown.show()},_checkoutDay:function(a){var b=Talent.$(a.currentTarget);a.stopPropagation(),this.ui.dayInput.removeClass("cur_day_time_nst");var c=b.attr("uservalue"),d=c.split(" "),e=b.attr("data-name");"day-other"!=e&&"day-every-week"!=e&&"day-every-month"!=e&&(this.ui.decsWrap.css("visibility","visible"),this.ui.hourWrap.css("visibility","visible"),"day-every-day"==e?(this.ui.dayInputValue.html(b.attr("label")),this.model.set({cyctype:1,day:this._formatDate(new Date,"yyyy/MM/dd")})):"day-every-weekday"==e?(this.ui.dayInputValue.html(b.attr("label")),this.model.set({cyctype:3,day:this._formatDate(new Date,"yyyy/MM/dd")})):(this.ui.dayInputValue.html(d[0]),this.model.set({cyctype:0,day:d[0]})),this.ui.dayDropdown.hide(),this.ui.dayDropdown_li.removeClass("cur_nst"),b.addClass("cur_nst"))},_clickDayInputHandler:function(a){a.stopPropagation(),Talent.$(a.currentTarget).addClass("cur_day_time_nst"),this._hideDropdown(),this.ui.dayDropdown.show()},_overOtherWrapHandler:function(a){a.stopPropagation(),this._dayBoxRest(a),this.ui.dayDropdownDatepicker.data("daterangepicker").setEndDate(this.model.get("day")),this.ui.dayDropdownDatepicker.show(),this.ui.dayInput.removeClass("cur_day_time_nst"),this.ui.otherWrap.find("a:first").addClass("a_hover")},_clickOtherWrapHandler:function(a){a.stopPropagation();Talent.$(a.currentTarget);this._dayBoxRest(a),this.ui.datePickerWrap.show(),this.ui.otherWrap.find("a:first").addClass("a_hover"),this.ui.dayInput.removeClass("cur_day_time_nst")},_overEveryWeekWrapHandler:function(a){this._dayBoxRest(a),this.ui.dayDropdownWeek.show(),this.ui.dayInput.removeClass("cur_day_time_nst"),this.ui.dayDropdownWeek.find("a:first").removeClass("a_hover")},_overEveryMonthWrapHandler:function(a){this._dayBoxRest(a),this.ui.dayDropdownMonth.show(),this.ui.dayInput.removeClass("cur_day_time_nst"),this.ui.everyMonthWrap.find("a:first").removeClass("a_hover")},_checkEveryWeekDDHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget);this.ui.dayInputValue.html(b.attr("label")),this.model.set({cyctype:3,day:b.attr("uservalue")}),this.ui.dayDropdown.hide(),this.ui.dayDropdown_li.removeClass("cur_nst"),this.ui.everyWeekWrap_dd.removeClass("cur_nst"),this.ui.everyMonthWrap_dd.removeClass("cur_nst"),b.addClass("cur_nst"),this.ui.everyWeekWrap.find("a:first").addClass("a_hover"),this.ui.dayDropdown_li.removeClass("cur_day_time_nst")},_checkEveryMonthDDHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget);this.ui.dayInputValue.html(b.attr("label")),this.model.set({cyctype:4,day:b.attr("uservalue")}),this.ui.dayDropdown.hide(),this.ui.dayDropdown_li.removeClass("cur_nst"),this.ui.everyWeekWrap_dd.removeClass("cur_nst"),this.ui.everyMonthWrap_dd.removeClass("cur_nst"),b.addClass("cur_nst"),this.ui.everyMonthWrap.find("a:first").addClass("a_hover"),this.ui.dayDropdown_li.removeClass("cur_day_time_nst")},_dayBoxRest:function(a){a&&a.stopPropagation(),this.ui.dayDropdownWeek.hide(),this.ui.dayDropdownMonth.hide(),this.ui.dayDropdownDatepicker.hide(),this.ui.otherWrap.find("a:first").removeClass("a_hover"),this.ui.everyWeekWrap.find("a:first").removeClass("a_hover"),this.ui.everyMonthWrap.find("a:first").removeClass("a_hover")},_hideDropdown:function(){this.ui.dayDropdown.hide(),this.ui.dayDropdownWeek.hide(),this.ui.dayDropdownMonth.hide(),this.ui.dayDropdownDatepicker.hide(),this.ui.hourDropdown.hide(),this.ui.minuteDropdown.hide(),this.ui.datePickerWrap.hide()},_validateData:function(){var a=this,b={isValidate:!0,data:{}},c=this.model.get("content")||"一个提醒";if(c.replace(/[^\x00-\xff]/g,"**").length>40)return this.ui.errorTip.html('<span class="error">提醒内容不能超过20个汉字或40个字符</span>'),setTimeout(function(){a.ui.errorTip.html("")},1e3),b.isValidate=!1,b;c==this.ui.decsInput.attr("defaultvalue")&&(c=""),b.data.content=c;var d=this.model.get("cyctype"),e=this.model.get("hour"),f=this.model.get("day"),g=this.model.get("minute"),h=e+":"+g;if(1==d||2==d)b.data.cyc_type=d,b.data.time=f+" "+h;else if(3==d||4==d){var i=new Date,j=i.getFullYear(),k=i.getMonth()+1,l=i.getDate();k<10&&(k="0"+k),l<10&&(l="0"+l);var m=j+"/"+k+"/"+l+" ";b.data.cyc_type=d+"_"+f,b.data.time=m+h}else if(-1==d)b.data.cyc_type=d,b.data.time="";else if(b.data.cyc_type=d,b.data.time=f+" "+h+":00",new Date>new Date(b.data.time))return this.ui.errorTip.html('<span class="error">不能设置过去的时间</span>'),setTimeout(function(){a.ui.errorTip.html("")},1e3),b.isValidate=!1,b;return b},_dealDate:function(){var a="yyyy/MM/dd hh:mm",b=new Date,c=b.getFullYear(),d=b.getMonth(),e=b.getDate(),f=b.getHours(),g=b.getSeconds(),h=b.getDay(),i=f;23==f&&(b=new Date(c,d,e,f+1,n,g),c=b.getFullYear(),d=b.getMonth(),e=b.getDate(),f=b.getHours(),h=b.getDay());for(var j=[],k={6:"六",0:"日",1:"一",2:"二",3:"三",4:"四",5:"五"},l="",m="",n=0;n<7;n++){var o=new Date(c,d,e+n).getDay();m="",23==i?o<h?l="下周"+k[o]:o==h?(m="cur_nst",l="明天"):l="本周"+k[o]:o<h?l="下周"+k[o]:o==h?(m="cur_nst",l="今天"):l=o==h+1?"明天":"本周"+k[o],j.push('<li class="'+m+'" label="'+l+'" uservalue="'+this._formatDate(new Date(c,d,e+n),a)+'"><a href="javascript:void(0)">'+l+"</a></li>")}this.model.set("day7",j.join(""));for(var p=[],n=0;n<31;n++)p.push('<dd uservalue="'+(n+1)+'" label="每月'+(n+1)+'号"><a href="javascript:void(0)">'+(n+1)+"</a></dd>");this.model.set("month31",p.join(""));for(var q=[],r="",n=0;n<24;n++)r=n<10?"0"+n:n,q.push('<li label="'+r+'" uservalue="'+r+'"><a href="javascript:void(0)">'+r+"</a></li>");this.model.set("hour24",q.join(""));for(var s=["00","05","10","15","20","25","30","35","40","45","50","55"],t=[],n=0;n<s.length;n++)t.push('<li label="'+s[n]+'" uservalue="'+s[n]+'"><a href="javascript:void(0)">'+s[n]+"</a></li>");this.model.set("minite12",t.join(""));var u=this._formatDate(new Date(c,d,e,f,n),"yyyy/MM/dd"),v=23==i?f:f+1,w=v<10?"0"+v:v;this.model.set({nowHour:v,nowHourLabel:w,today:u,day:u,hour:v,minute:"00"})},_formatDate:function(a,b){var c={"M+":a.getMonth()+1,"d+":a.getDate(),"h+":a.getHours(),"m+":a.getMinutes(),"s+":a.getSeconds(),"q+":Math.floor((a.getMonth()+3)/3),S:a.getMilliseconds()};/(y+)/.test(b)&&(b=b.replace(RegExp.$1,(a.getFullYear()+"").substr(4-RegExp.$1.length)));for(var d in c)new RegExp("("+d+")").test(b)&&(b=b.replace(RegExp.$1,1==RegExp.$1.length?c[d]:("00"+c[d]).substr((""+c[d]).length)));return b},onClose:function(){Talent.$(document).off("click.Set-Notice-View")}}),ClassTreeItemView=Talent.CompositeView.extend({template:jst["class/class-tree-item"],tagName:"li",initialize:function(){this.userInfo=Context.getUserInfo(),this.collection=this.model.children},ui:{enterprise:"span[data-name=enterprise]",person:"span[data-name=person]",permission:"span[data-name=lock-permission]"},appendHtml:function(a,b){a.$el.find("ul:first").append(b.el)},templateHelpers:function(){var a=!0;return 2==this.userInfo.Role?a=!0:this.model.get("IsTenant")&&(a=!1),{isEdit:a}},onRender:function(){this.$el.attr({id:this.model.get("id"),parent_id:this.model.get("parent_id"),"data-end":this.model.get("isEnd"),fullName:this.model.get("fullName"),ifAddClass:this.model.get("IsAllowSetPersonalLable")}),this._headIcoTispy()},_headIcoTispy:function(){Talent.$(this.ui.enterprise).tipsy({fallback:"企业分类",gravity:"s"}),Talent.$(this.ui.person).tipsy({fallback:"个人分类",gravity:"s"}),Talent.$(this.ui.permission).tipsy({fallback:"该分类下不允许添加个人分类",gravity:"s"})}}),ClassNewFolderView=Talent.ItemView.extend({defaults:{type:"new",nameLen:200},template:jst["class/class-new"],tagName:function(){return"rename"==this.options.type?"div":"li"},ui:{inputwrap:"div[data-name=file-move-new-input-warp]",input:"div[data-name=file-move-new-input-warp] input",sure:"span[data-name=file-move-new-submit]",cancel:"span[data-name=file-move-new-cancel]",form:"form[data-name=file-move-new-form]"},events:function(){var a={};return a.click="_elHandler",a["focus "+this.ui.input]="_focusHandler",a["blur "+this.ui.input]="_blurHandler",a["keyup "+this.ui.input]="_keyupHandler",a["click "+this.ui.sure]="_sureHandler",a["click "+this.ui.cancel]="_cancelHandler",a["submit "+this.ui.form]="_sureHandler",a},templateHelpers:function(){return{type:this.settings.type}},initialize:function(){this.settings=Talent._.extend({},this.defaults,this.options),this.$el.attr("data-type","new-folder-form")},_elHandler:function(a){a.stopPropagation()},_focusHandler:function(a){Talent.$(a.currentTarget);this.ui.inputwrap.removeClass("input-error").addClass("input-focus")},_keyupHandler:function(a){var b=Talent.$(a.currentTarget),c=Talent.$.trim(b.val()),d=this.settings.nameLen;if(Talent._.isStringBeyondLength(c,d))return c=Talent._.substringWithM(c,d),b.val(c),!1},_blurHandler:function(a){var b=Talent.$(a.currentTarget),c=b.val();""==Talent.$.trim(c)&&this.ui.inputwrap.removeClass("input-focus").addClass("input-error")},_sureHandler:function(a){a.stopPropagation(),a.preventDefault();var b=Talent.$(a.currentTarget),c=this.ui.input.val();this.model.set("name",Talent.$.trim(c)),""==Talent.$.trim(c)?this.ui.inputwrap.removeClass("input-focus").addClass("input-error"):(this.trigger("submit",Talent.$.trim(c),b),this.close())},_cancelHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget);b.val();this.ui.inputwrap.removeClass("input-focus").removeClass("input-error"),this.trigger("cancel",this.model.get("name")),this.close()}}),ClassTreeCollectionView=Talent.CollectionView.extend({defaults:{isEdit:!1},itemView:ClassTreeItemView,tagName:"ul",events:function(){var a={};return a["click ul"]="_ulHandler",a["click li div[data-name=title]"]="_checkHandler",a["click li span[data-name=toggle]"]="_toggleHandler",a["click li a[data-name=deleted]"]="_deleteHandler",a["click li a[data-name=edit]"]="_editHandler",a},collectionEvents:{reset:"render"},initialize:function(a){this.options=a,this.settings=Talent._.extend({},this.defaults,this.options),this.activeFolder=this.$el.find("li:first"),this.$el.css({position:"relative"})},onShow:function(){this.settings.isEdit;this.$el.find("li:first").addClass("unfold")},itemViewOptions:function(){return{isEdit:this.settings.isEdit}},onAfterItemAdded:function(a){this.settings.isEdit||a.$el.find("div[data-name=klass-item-action]").remove()},_ulHandler:function(a){a.stopPropagation()},_toggleHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget).closest("li");"false"==b.attr("data-end")&&(b.hasClass("unfold")?b.removeClass("unfold"):b.addClass("unfold"))},_checkHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget),c=b.closest("li"),d=(c.attr("data-end"),b.find("div[data-name=title-name]")),e=parseInt(c.attr("id")),f=c.attr("fullName");if(void 0!=f){var g=f.toString(),h=/^(分类\/)/;g=g.replace(h,"")}var i=this.settings.isEdit;"new-folder-form"!=c.attr("data-type")&&(0!=e||i)&&(this.activeFolder=c,this.$el.find("li").removeClass("active"),c.addClass("active"),this.trigger("checked",this.activeFolder,{id:e,name:Talent.$.trim(d.html()),fullName:g,parent_id:parseInt(c.attr("parent_id"))}))},_deleteHandler:function(a){var b=this;a.stopPropagation();var c=Talent.$(a.currentTarget),d=Talent.$(a.currentTarget).closest("li"),e=d.attr("parent_id"),f=c.attr("id");ConfirmDialogView(c,"删除后，该分类下的子类也将删除，同时该分类下的内容将归到未分类下",{container:this.$el,pos:"topRight",topBias:20,sure:function(){b.trigger("delete",{id:f,li:d,call:function(){if(d.remove(),!b.$el.find('li[parent_id="'+e+'"]').length){var a=b.$el.find('li[id="'+e+'"]');a.hasClass("unfold")&&a.find(".icon_tv").remove()}}})}})},_editHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget),c=b.attr("id"),d=Talent.$(a.currentTarget).closest("li");this._rendRenameView(c,b,d)},_rendRenameView:function(a,b,c){this.renameView&&this.renameView.close();var d=b.closest("div[data-name=title]"),e=d.find("div[data-name=title-name]"),f=e.html();this.renameView=new ClassNewFolderView({type:"rename",model:new Talent.Model({name:f})}),this.listenTo(this.renameView,"submit",function(b){this.trigger("rename",{id:a,name:b,node:c,node_name:e})},this),this.listenTo(this.renameView,"close",function(a){e.html(this.renameView.model.get("name"))},this),e.html(this.renameView.render().$el),this.renameView.ui.input.focus()},onClose:function(){}}),ClassSearchView=Talent.ItemView.extend({defaults:{requeseSearchClassData:null},template:jst["class/class-search"],className:"class_search",ui:{content:".class_search_condition_input",lableUl:"ul[data-name=lable-ul]",lableList:"ul[data-name=lable-list]",lableNameItem:"li[data-name=lablename]",contentHolder:".class_search_condition_label",smemberHeaderInput:".class_search_header_input"},initialize:function(a){this.userInfo=Context.getUserInfo(),this.settings=Talent._.extend({},this.defaults,a),this.$el.on("click",function(a){a.stopPropagation()})},events:function(){var a={};return a["focusout .class_search_condition_input"]="onInputFocusOut",a["focusin .class_search_condition_input"]="onInputFocusin",a["click "+this.ui.lableNameItem]="_checkHandler",a["click "+this.ui.contentHolder]="_smemberHandler",a},onRender:function(){var a=this;this.$el.find("#lable-list").hide(),this.$el.find("#lableName").on("keyup",function(){a.lableList()}),this.$el.find("#lableName").on("keypress",function(b){13==b.which&&a.lableList()})},onInputFocusOut:function(a){this.ui.smemberHeaderInput.removeClass("input-focus"),""==this.ui.content.val()&&this.ui.contentHolder.show()},_checkHandler:function(a){var b=Talent.$(a.currentTarget);this.$el.find("#lableName").val(b.text());var c=b.attr("parentId"),d=b.attr("id"),e=b.attr("fullname");this.$el.find("#lableName").attr("parentId",c),this.$el.find("#lableName").attr("Ids",d),this.$el.find("#lable-list").hide();var f={};f.id=d,f.name=b.text(),f.fullname=e,this.trigger("checkedLable",f)},_smemberHandler:function(a){this.ui.contentHolder.hide();Talent.$(a.currentTarget);this.$el.find("#lableName").focus()},onInputFocusin:function(a){this.ui.smemberHeaderInput.addClass("input-focus"),this.ui.contentHolder.hide();var b=Talent.$.trim(this.ui.content.val());if(null==b||""==b)return void this.$el.find("#lable-list").hide()},lableList:function(){var a=this,b=Talent.$.trim(this.ui.content.val());if(null==b||""==b)return void this.$el.find("#lable-list").hide();var c=LableCollection.searchClassData;this.settings.searchClassData&&(c=this.settings.requeseSearchClassData),c({user_id:this.userInfo.Id,filter:b}).done(function(b){a._listPlan(b.lables)}).fail(function(a){})},_listPlan:function(a){var b="";null!=a&&a.length>0?Talent._.each(a,function(a){""!=a.name&&null!=a.name&&void 0!=a.name&&(b+='<li data-name="lablename" parentId ="'+a.parent_id+'" id="'+a.id+'">'+a.name+"</li>")}):b+="<li>无搜索结果</li>",this.ui.lableUl.empty(),this.ui.lableUl.append(b),this.$el.find("#lable-list").show()}}),ClassProjectTabItemView=Talent.ItemView.extend({className:"class_project_tab",template:jst["class/class-project-tab"],ui:{tabA:"a"},initialize:function(){this.$el.on("click",function(a){a.stopPropagation()})},events:function(){var a={};return a["click "+this.ui.tabA]="_clickTabName",a},_clickTabName:function(a){this.$el.find("a").removeClass("current");var b=Talent.$(a.currentTarget);b.addClass("current"),this.trigger("changeTree",b.attr("data-id"))},onRender:function(){}}),ClassView=Talent.Layout.extend({defaults:{showTitle:!1,showButtonSure:!1,showButtonAdd:!1,showButtonReset:!1,showButtonCancel:!1,isEdit:!1,isShowSearch:!1,isShowProjectTab:!1,multi:!1},template:jst["class/class"],className:"tt_class_tree",ui:{closed:"span[data-name=klass-move-close]",newFolder:"button[data-name=klass-move-new-folder]",submit:"button[data-name=klass-move-submit]",title:"div[data-name=title]",actionArea:"div[data-name=klass-action]",emptyArea:"div[data-name=empty]",buttonReset:"button[data-name=klass-move-reset]",buttonCancel:"button[data-name=klass-move-cancel]",searchClass:"div[data-name=search-class]"},regions:{tree:"div[data-name=tree]",emptyArea:"div[data-name=empty]",classProjectTab:'div[data-name="class-project-tab"]',checkedTypeList:"[data-name=class-data-checked]"},collectionEvents:{reset:"_collectionReset"},_collectionReset:function(){var a=this.settings.isEdit,b=this.collection.toJSON()[0],c=b.children||[];a?b.length&&this.model.set({id:b[0].id,name:b[0].name}):c.length?this.model.set({id:c[0].id,name:c[0].name}):this.model.set({id:0,name:""}),this.render(),this._renderEmptyView()},events:function(){var a={};return a["click "+this.ui.closed]="_closeHandler",a["click "+this.ui.submit]="_submitHandler",a["click "+this.ui.newFolder]="_newFolderHandler",a["click "+this.ui.buttonReset]="_resetHandler",a["click "+this.ui.buttonCancel]="_closeHandler",a["focus "+this.ui.newFolderForm_input]="_focusNewFolderHandler",a},initialize:function(a){this.settings=Talent._.extend({},this.defaults,this.options),this.addAjax=!1,this.model.set({id:0,name:"",parent_id:0}),Talent.$(document).on("mouseup.documentlist_permissions",function(){$(document).find(".documentlist_permissions").hide(),$(document).find(".activeClass").hide()}),this.$el.on("click",function(a){a.stopPropagation()}),this.settings.multi&&(this.checkedCollection=new Talent.Collection,a.checkedClassCollection&&(this.checkedCollection=a.checkedClassCollection))},onRender:function(){var a=this;this._customView(),this.settings.isShowProjectTab?(this._renderClassProjectTabView(),setTimeout(function(){a._changeClassViewCollection(2771)},0)):this._renderTreeView(),this.settings.isShowSearch&&this._searchView(),this.settings.multi&&this._renderCheckedClassCompositeView()},_renderClassProjectTabView:function(){var a=this;this.classProjectTabView=new ClassProjectTabItemView,this.classProjectTab.show(this.classProjectTabView),this.listenTo(this.classProjectTabView,"changeTree",function(b){a._changeClassViewCollection(b)})},_changeClassViewCollection:function(a){if(0!=a){var b=this.collection.toJSON(),c=b[0].children,d=[];Talent._.each(c,function(b){b.id==a&&d.push(b)}),b[0].children=d,this._renderTreeView(b),this.$el.find('li[id="'+a+'"]').addClass("unfold")}else this._renderTreeView()},_searchView:function(){var a=this;this.searchView=new ClassSearchView({requeseSearchClassData:this.settings.requeseSearchClassData}),this.listenTo(this.searchView,"checkedLable",function(b){var c=a.$el.find('div[data-name="tree"] li[id="'+b.id+'"]').attr("fullname");b.fullname=c,a.trigger("checkedLable",b),a._currentLiTree(b),a.settings.multi&&a.checkedCollection.push(b)}),this.ui.searchClass.append(this.searchView.render().el)},_currentLiTree:function(a){function b(a){var d=c.$el.find("div[data-name='tree'] li[id="+a+"]");if(d.length&&0!=a){var e=d.attr("parent_id");d.addClass("unfold"),b(e)}}var c=this,d=c.$el.find('div[data-name="tree"] li[id="'+a.id+'"]').attr("parent_id");b(d);var e=this.$el.find('div[data-name="tree"] li[id="'+a.id+'"]');this.$el.find('div[data-name="tree"] li').removeClass("active"),e.addClass("active"),this.activeFolder=e,this.model.set({id:a.id,name:a.name,fullName:a.fullname,parent_id:d});var f=this.$el.find('div[data-name="tree"] li[id="'+a.id+'"]').position();this.trigger("scrollTop",{id:a.id,top:f.top})},setPosition:function(a,b){var c=a.offset(),d=a.outerWidth(),e=a.outerHeight(),f=this.$el,g=f.outerWidth(),h={pos:"left"},b=Talent._.extend({},h,b);"right"==b.pos?this.$el.css({top:c.top+e+5,left:c.left-g+d}):this.$el.css({top:c.top+e+5,left:c.left})},_renderEmptyView:function(){var a=this.settings.isEdit,b='请到<a href="#set?page_id=class">个人设置</a>下设置分类';a&&(b="点击 添加类别 添加分类"),this.ui.emptyArea.hide();var c=this.collection.toJSON();if(c.length&&c[0]&&c[0].children)return void this.ui.emptyArea.hide();var d=new EmptyView({emptyContext:b});this.emptyArea.show(d),this.ui.emptyArea.show()},_customView:function(){this.settings.showTitle||this.ui.title.remove(),this.settings.showButtonSure||this.ui.submit.remove(),this.settings.showButtonAdd||this.ui.newFolder.remove(),this.settings.showButtonSure||this.settings.showButtonAdd||this.ui.actionArea.remove(),this.settings.showButtonReset||this.ui.buttonReset.remove(),this.settings.showButtonCancel||this.ui.buttonCancel.remove(),this.settings.multi||this.$el.find(".class_data_search_content_center,.class_data_search_content_right").remove()},_submitHandler:function(a){var b=Talent.$(a.currentTarget),c=null,d=null,e=null;""==this.model.get("name")?(d=this.searchView.$el.find("#lableName").attr("ids"),c=this.searchView.$el.find("#lableName").val(),e=this.searchView.$el.find("#lableName").attr("parentid")):(d=this.model.get("id"),c=this.model.get("name"),e=this.model.get("parent_id")),this.model.set("id",d),this.model.set("parent_id",e),this.model.set("name",c);var f=this.treeView.collection.models[0].children;f&&!f.length?this.trigger("submit",{id:"",name:"",parent_id:""},b):this.settings.multi?this.trigger("submit",this.checkedCollection.toJSON(),b):this.trigger("submit",{id:this.model.get("id"),name:this.model.get("name"),parent_id:this.model.get("parent_id")},b),this.close()},_resetHandler:function(a){Talent.$(a.currentTarget);this.trigger("reset")},_closeHandler:function(a){Talent.$(a.currentTarget);this.trigger("closed"),this.close()},_newFolderHandler:function(a){var b=Talent.$(a.currentTarget),c=this;this.newFolderView&&this.newFolderView.close(),this.newFolderView=new ClassNewFolderView,this.listenTo(this.newFolderView,"submit",function(a){this.trigger("new",{name:a,parent_id:this.model.get("id"),node:b,call:function(a){a.isEnd=!0;var b=new ClassTreeItemView({model:new Talent.Model(a)});c.activeFolder.find("ul:first").prepend(b.render().el),c.activeFolder.attr("data-end",!1),c.ui.emptyArea.hide();var d=a.parent_id;c._addTreeCollectionIcon(d)}})},this),this.listenTo(this.newFolderView,"cancel",function(a){"true"==this.activeFolder.attr("data-end")&&this.activeFolder.removeClass("unfold")},this);var d=this.activeFolder.attr("ifaddclass");this.activeFolder.attr("fullname");"false"!=d?(this.activeFolder.addClass("unfold"),this.activeFolder.find("ul:first").prepend(this.newFolderView.render().el),this.newFolderView.ui.input.focus()):c._tipDialogView(b,"该分类下不允许创建个人分类")},_addTreeCollectionIcon:function(a){var b=this.$el.find("li [id='"+a+"']");this.$el.find("#iconTv").removeAttr("id"),b.children(":first").prepend('<span id="iconTv"  class="icon_tv" data-name="toggle"></span>')},_tipDialogView:function(a,b,c){var d=this;this.tDialogView&&this.tDialogView.close(),this.tDialogView=new TDialogView({type:"tipsy",quirkTheme:!1,sure:function(){c&&c(),d.tDialogView.close()},cancel:function(){d.tDialogView&&d.tDialogView.close()}}),this.tDialogView.render().$el.appendTo("body"),this.tDialogView.show(a,b,{arrow:!1,pos:"topCenter",className:"warn"})},_renderTreeView:function(a){var b=this,c=Backbone.Model.extend({initialize:function(){var a=this.get("children");a&&(this.children=new d(a),this.unset("children"))}}),d=Talent.Collection.extend({model:c});if(a)var e=a;else var e=this.collection.toJSON();this.treeView=new ClassTreeCollectionView({collection:new d(e),isEdit:this.settings.isEdit}),this.activeFolder=this.treeView.$el,this.listenTo(this.treeView,"delete",function(a,c){b.trigger("delete",a,c)}),this.listenTo(this.treeView,"rename",function(a){a.node.attr("id")==this.activeFolder.attr("id")&&this.model.set("name",a.name),b.trigger("rename",a)}),this.listenTo(this.treeView,"rename",function(a){a.node.attr("id")==this.activeFolder.attr("id")&&this.model.set("name",a.name)}),this.listenTo(this.treeView,"checked",function(a,c){this.settings.multi?(this.activeFolder=a,b.checkedCollection.push({id:c.id,name:c.name,fullName:c.fullName,type:17}),b.trigger("checked",b.checkedCollection.toJSON())):(this.activeFolder=a,this.model.set({id:c.id,name:c.name,fullName:c.fullName,parent_id:c.parent_id}),this.trigger("checked",{id:c.id,name:c.name,fullName:c.fullName,parent_id:c.parent_id}))},this),this.tree&&this.tree.show(this.treeView),this.activeFolder=this.treeView.$el.find("ul:first").find("li:first"),this.activeFolder.addClass("active"),this.model.set({id:this.activeFolder.attr("id"),name:this.activeFolder.find("[data-name=title-name]:first"),fullName:this.activeFolder.attr("fullName"),parent_id:this.activeFolder.attr("parent_id")})},onClose:function(){Talent.$(document).off("click.documentlist_permissions"),this.tDialogView&&this.tDialogView.close()},_renderCheckedClassCompositeView:function(){var a=this;this.checkedClassCompositeView=new CheckedClassCompositeView({collection:a.checkedCollection}),this.checkedTypeList.show(this.checkedClassCompositeView)}}),WorkListItemView=Talent.ItemView.extend({template:jst["class/work-item"],tagName:"li",onRender:function(){this.$el.attr("id",this.model.get("WorkId"))}}),WorkListView=Talent.CompositeView.extend({defaults:{isDefaultChecked:!0},itemView:WorkListItemView,itemViewContainer:"ul",template:jst["class/work-list"],className:"tt_klass_work",events:{"click li":"_chekcoutItemHandler","click div[data-name=work-title]":"_toggleHandler"},ui:{workList:"ul[data-name=work-list]"},initialize:function(){this.settings=Talent._.extend({},this.defaults,this.options),this.collection.model=Talent.Model.extend({idAttribute:"WorkId"}),this.$el.on("click",function(a){a.stopPropagation()})},onRender:function(){this.settings.isDefaultChecked&&this.$el.find("li:first").addClass("active")},_toggleHandler:function(a){var b=Talent.$(a.currentTarget),c=b.next("ul"),d=c.is(":hidden");this.ui.workList.hide(),d?(b.find("span[data-name=toggle]").removeClass("icon-minus-square").addClass("icon-minus-square"),c.show()):(b.find("span[data-name=toggle]").removeClass("icon-minus-square").addClass("icon-plus-square"),c.hide())},_chekcoutItemHandler:function(a){var b=Talent.$(a.currentTarget),c=b.attr("id"),d=this.collection.get(parseInt(c));this.$el.find("li").removeClass("active"),b.addClass("active"),this.trigger("checked",{id:c,name:d.get("WorkName")})}}),WorkView=Talent.Layout.extend({defaults:{showTitle:!1,showButtonSure:!1,showButtonAdd:!1,showButtonCancel:!1,multi:!1},template:jst["class/work"],itemFolderTemplate:jst["class/class-move-item"],className:"tt_class_tree",ui:{closed:"span[data-name=work-move-close]",newFolder:"button[data-name=work-move-new-folder]",submit:"button[data-name=work-move-submit]",title:"div[data-name=work-move-title]",actionArea:"div[data-name=work-action]",emptyArea:"div[data-name=empty]",buttonCancel:"button[data-name=work-move-cancel]",buttonReset:"button[data-name=work-move-reset]"},regions:{workBox:"div[data-name=work-box]",workJoinBox:"div[data-name=work-box-join]",emptyArea:"div[data-name=empty]",checkedTypeList:"[data-name=class-data-checked]"},collectionEvents:{reset:"_collectionReset"},_collectionReset:function(){var a=this.collection.toJSON()||[],b=this.joinCollection.toJSON()||[];a.length?this.model.set({id:a[0].WorkId,name:a[0].WorkName}):b.length&&this.model.set({id:b[0].WorkId,name:b[0].WorkName}),this.render()},templateHelpers:function(){return{i18n:this.i18n}},events:function(){var a={};return a["click "+this.ui.closed]="_closeHandler",a["click "+this.ui.buttonCancel]="_closeHandler",a["click "+this.ui.buttonReset]="_resetHandler",a["click "+this.ui.submit]="_submitHandler",a["click "+this.ui.newFolder]="_newFolderHandler",a["focus "+this.ui.newFolderForm_input]="_focusNewFolderHandler",a},initialize:function(a){this.i18n=Context.getI18n(),this.settings=Talent._.extend({},this.defaults,this.options),this.addAjax=!1,this.model.set({id:0,name:""}),this.options.joinCollection?this.joinCollection=this.options.joinCollection:this.joinCollection=new Talent.Collection,this.listenTo(this.joinCollection,"reset",this._collectionReset),this.settings.multi&&(this.checkedCollection=new Talent.Collection,a.checkedClassCollection&&(this.checkedCollection=a.checkedClassCollection))},onRender:function(){this._customView(),this._rendWorkListView(this.workBox,this.collection,"create"),this._rendWorkListView(this.workJoinBox,this.joinCollection,"join"),this._renderEmptyView(),402==this.model.get("type")&&this.workJoinBox.$el.hide(),this.settings.multi&&this._renderCheckedClassCompositeView()},setPosition:function(a){var b=a.offset(),c=a.outerWidth(),d=a.outerHeight(),e=this.$el,f=e.outerWidth();"right"==pos?this.$el.css({top:b.top+d+5,left:b.left-f+c}):this.$el.css({top:b.top+d+5,left:b.left})},_renderEmptyView:function(){var a=this.model.get("type"),b="请在"+this.i18n.work_1+"功能下创建"+this.i18n.work_1;if(4!=a&&(b="暂无目标"),this.ui.emptyArea.hide(),this.collection.length||this.joinCollection.length)return void this.ui.emptyArea.hide();var c=new EmptyView({emptyContext:b});this.emptyArea.show(c),this.ui.emptyArea.show()},_customView:function(){this.settings.showTitle||this.ui.title.remove(),this.settings.showButtonSure||this.ui.submit.remove(),this.settings.showButtonAdd||this.ui.newFolder.remove(),this.settings.showButtonSure||this.settings.showButtonAdd||this.ui.actionArea.remove(),this.settings.multi||this.$el.find(".class_data_search_content_center,.class_data_search_content_right").remove()},_submitHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget),c=1==this.settings.multi?this.checkedCollection.toJSON():{id:this.model.get("id"),name:this.model.get("name")};this.trigger("submit",c,b)},_closeHandler:function(a){Talent.$(a.currentTarget);this.trigger("closed"),this.close()},_resetHandler:function(a){Talent.$(a.currentTarget);this.trigger("reset")},_rendWorkListView:function(a,b,c){var d=this,e="我负责的",f=!0;"join"==c&&(e="我参与的"),this.collection.length||"create"!=c||(f=!1),this.collection.length&&"join"==c&&(f=!1);var g=new WorkListView({collection:b,model:new Talent.Model({title:e}),isDefaultChecked:f});this.listenTo(g,"checked",function(a){d.settings.multi?d.checkedCollection.push({id:a.id,name:a.name,type:d.model.get("type")}):this.model.set({id:a.id,name:a.name});var a=1==d.settings.multi?d.checkedCollection.toJSON():a;this.trigger("checked",a)},this),a.show(g)},_renderCheckedClassCompositeView:function(){var a=this;this.checkedClassCompositeView=new CheckedClassCompositeView({collection:a.checkedCollection}),this.checkedTypeList.show(this.checkedClassCompositeView)}}),ClassComponentView=Talent.Layout.extend({template:jst["class/class-component"],className:"tt_class_dialog",regions:{classArea:"div[data-name=klass-content]",classEmptyArea:"div[data-name=klass-empty]",checkedTypeList:"[data-name=class-data-checked]"},defaults:{default:"work",isShowClassSearch:!0,isShowWork:!0,isShowTarget:!1,isShowClass:!0,multi:!1,isEdit:!0,requestClassData:null,requestWorkData:null,requestTargetData:null,requeseSearchClassData:null},ui:{klassTabLi:"ul[data-name=klass-tab] li",klassTab:"ul[data-name=klass-tab]",closed:"span[data-name=klass-close]",emptyArea:"div[data-name=empty]",newInputFolder:"button[data-name=klass-move-new-folder]",buttonSubmit:"button[data-name=klass-action-submit]",buttonCancel:"button[data-name=klass-action-cancel]",buttonReset:"button[data-name=klass-action-reset]",checkedTypeList:"[data-name=class-data-checked]"},modelEvents:{"change:type":"_typeChange"},_typeChange:function(){var a=this.model.get("type");this.tajax_work=!1,this.tajax_klass=!1,this.tajax_target=!1,17==a?(this._renderClassView(),this._requestClassData()):4==a?this.settings.isShowWork&&(this._renderWorkView(),this._requestWorkData(a)):this.settings.isShowTarget&&(this._renderTargetView(),this._requestWorkData(a))},templateHelpers:function(){return{i18n:this.i18n,isShowWork:this.settings.isShowWork,isShowTarget:this.settings.isShowTarget,isShowClass:this.settings.isShowClass,isMulti:this.settings.multi}},events:function(){var a={};return a["click li"]="_checkLiHandler",a["click "+this.ui.klassTabLi]="_clickTabHandler",a["click "+this.ui.closed]="_clickClosedHandler",a["click "+this.ui.newInputFolder]="_clickAddInputHandler",a["click "]="_stopPropagation",a},initialize:function(a){var b=this;if(this.settings=Talent._.extend({},this.defaults,a),1==this.settings.multi&&this.$el.addClass("multi"),void 0===a.isShowTarget){Context.getAppHead({AppId:"402"})&&(this.settings.isShowTarget=!0)}this.i18n=Context.getI18n(),this.tajax_work=!1,this.tajax_klass=!1,this.tajax_target=!1,this.userInfo=Context.getUserInfo(),this.model.set({id:0,name:""}),this.classCollection=new Talent.Collection,this.workCreatCollection=new Talent.Collection,this.workJoinCollection=new Talent.Collection,this.targetCreatCollection=new Talent.Collection,this.targetJoinCollection=new Talent.Collection,this.settings.multi&&(this.checkedCollection=new Talent.Collection,a.checkedClassCollection&&(this.checkedCollection=a.checkedClassCollection)),this.$el.on("mouseup",function(a){a.stopPropagation()}),Talent.$(document).on("mouseup.kclass"+this.cid,function(){b.close()});var c=this.settings;c.isShowClass&&this.model.set("type",17,{silent:!0}),!c.isShowClass&&c.isShowWork&&this.model.set("type",4,{silent:!0}),c.isShowClass||c.isShowWork||!c.target||this.model.set("type",402,{silent:!0})},_stopPropagation:function(a){a.stopPropagation()},onRender:function(){this._initCustom();var a=this.model.get("type")||17;17==a?(this._renderClassView(),this._requestClassData()):(this._renderWorkView(),this._requestWorkData(a))},onClose:function(){this.model.set({type:17,id:0,name:"",isEnd:!0},{silent:!0}),Talent.$(document).off("mouseup.kclass"+this.cid)},show:function(a,b){Context.setPosition(a,this.$el,b),this.$el.show()},_initCustom:function(){var a=this.model.get("type")||17;this.ui.klassTabLi.removeClass("active"),this.ui.klassTab.find("li[data-type="+a+"]").addClass("active")},_submitHandler:function(a){var a=1==this.settings.multi?this.checkedCollection.toJSON():{type:this.model.get("type"),id:this.model.get("id"),name:this.model.get("name")};this.trigger("submit",a),this.close()},_cancelHandler:function(){this.trigger("cancel"),this.close()},_resetHandler:function(){this.settings.multi&&this.checkedCollection.reset(),this.trigger("reset")},_clickTabHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget),c=b.attr("data-type");this.ui.klassTabLi.removeClass("active"),b.addClass("active"),this.model.set("type",parseInt(c))},_clickClosedHandler:function(){this.close(),this.trigger("closed")},_requestClassData:function(){var a=this;if(!this.tajax_work){this.tajax_work=!0;(this.settings.requestClassData||this._deferredClassData()).done(function(b){a.classCollection.reset(b.lables)}).fail(function(){a.tajax_work=!1})}},_deferredClassData:function(){var a=new Talent.$.Deferred;return LableCollection.getLableData({obj_id:this.userInfo.Id,obj_type:1}).done(function(b){a.resolve(b)}).fail(function(){a.reject(resp)}),a},_renderClassView:function(){var a=this;this.classView&&this.classView.close();var b=1!=this.settings.multi;this.classView=new ClassView({collection:this.classCollection,model:this.model,isEdit:this.settings.isEdit,showButtonSure:!0,showButtonAdd:b,showButtonReset:!0,showButtonCancel:!0,isShowSearch:this.settings.isShowClassSearch,requeseSearchClassData:this.settings.requeseSearchClassData,multi:this.settings.multi,checkedClassCollection:this.checkedCollection}),this.listenTo(this.classView,"new",function(a){var b=this;(0,LableCollection.postAddLableData)({obj_id:this.userInfo.Id,obj_type:"1",name:a.name,parent_id:a.parent_id}).done(function(b){a.call(b)}).fail(function(c){b._tipDialogView(a.node,c)})}),this.listenTo(this.classView,"delete",function(a){this._requestDelete(a)}),this.listenTo(this.classView,"rename",function(a){this._requestReName(a)},this),this.listenTo(this.classView,"checked",function(b){this.settings.multi?a.checkedCollection.push(b):this.model.set({type:17,id:b.id,name:b.name},{silent:!0})},this),this.listenTo(this.classView,"closed",function(){this._cancelHandler()}),this.listenTo(this.classView,"reset",function(){this._resetHandler()}),this.listenTo(this.classView,"submit",function(a){this._submitHandler(a)},this),this.listenTo(this.classView,"scrollTop",function(a){var b=this.$el.find(".tt_tree_view").height()/2;this.$el.find(".tt_tree_view").animate({scrollTop:a.top-b})},this),this.classArea.show(this.classView)},_requestDelete:function(a){var b=this;LableCollection.deleteLableData({lable_id:a.id}).done(function(c){a.call(),b.trigger("delete",a)}).fail(function(c){b._tipDialogView(a.li,c)})},_requestReName:function(a){LableCollection.putRenameLableData({lable_id:a.id,name:a.name}).done(function(){a.node_name.html(a.name)})},_requestWorkData:function(a){var b=this,c=1,d=1;if(4==a){if(this.tajax_klass)return;this.tajax_klass=!0;var e=this.settings.requestWorkData||ProjectCollection.getProject}else{if(this.tajax_target)return;this.tajax_target=!0,c=402,d=402;var e=this.settings.requestTargetData||ProjectCollection.getProject}e({app_id:c,app_type:d}).done(function(c){var d=c.CreateWorks||[],e=c.JoinWorks||[];4==a?(b.workCreatCollection.reset(d),b.workJoinCollection.reset(e)):(b.targetCreatCollection.reset(d),b.targetJoinCollection.reset(e))})},_clickCancelHandler:function(){this.trigger("cancel"),this.close()},_renderWorkView:function(){var a=this;this.workView&&this.workView.close(),this.workView=new WorkView({collection:this.workCreatCollection,joinCollection:this.workJoinCollection,model:this.model,showButtonSure:!0,showButtonAdd:!1,multi:this.settings.multi,checkedClassCollection:this.checkedCollection}),this.listenTo(this.workView,"checked",function(b){a.settings.multi?a.checkedCollection.push(b):(this.$el.find(".tt_tree_view li").removeClass("active"),this.$el.find('.tt_tree_view li[id="'+b.id+'"]').addClass("active"),this.model.set({type:4,id:b.id,name:b.name},{silent:!0}))},this),this.listenTo(this.workView,"submit",function(a){this._submitHandler(a)},this),this.listenTo(this.workView,"closed",function(a){this._clickCancelHandler()},this),this.listenTo(this.workView,"reset",function(a){this._resetHandler()},this),this.classArea.show(this.workView)},_renderTargetView:function(){var a=this;this.targetView&&this.targetView.close(),this.targetView=new WorkView({collection:this.targetCreatCollection,joinCollection:this.targetJoinCollection,model:this.model,showButtonSure:!0,showButtonAdd:!1,multi:this.settings.multi,checkedClassCollection:this.checkedCollection}),this.listenTo(this.targetView,"checked",function(b){a.settings.multi?a.checkedCollection.push(b):(this.$el.find(".tt_tree_view li").removeClass("active"),this.$el.find('.tt_tree_view li[id="'+b.id+'"]').addClass("active"),this.model.set({type:4,id:b.id,name:b.name},{silent:!0}))},this),this.listenTo(this.targetView,"submit",function(a){this._submitHandler(a)},this),this.listenTo(this.targetView,"closed",function(a){this._clickCancelHandler()},this),this.listenTo(this.targetView,"reset",function(a){this._resetHandler()},this),this.classArea.show(this.targetView)},_tipDialogView:function(a,b,c){this.tDialogView&&this.tDialogView.close(),this.tDialogView=new TDialogView({type:"tipsy"}),this.tDialogView.render().$el.appendTo("body"),this.tDialogView.show(a,b,{arrow:!1,pos:"top",className:"warn",autoHide:!0})}}),CheckedClassItemView=Talent.ItemView.extend({tagName:"li",template:jst["class/checked-class-item"],initialize:function(){},ui:{delItem:".smember_btn_reduce"},events:function(){var a={};return a["click "+this.ui.delItem]="_deleteItem",a},onRender:function(){},_deleteItem:function(){this.trigger("deleteItem",this.model)}}),CheckedClassCompositeView=Talent.CompositeView.extend({defaults:{emptyContext:"请从左侧点击选择"},itemView:CheckedClassItemView,template:_.template("<ul></ul>"),itemViewContainer:"ul",emptyView:EmptyView,initialize:function(){},events:function(){return{}},onRender:function(){var a=this;this.on("itemview:deleteItem",function(b){a.collection.remove(b.model)})},itemViewOptions:function(){return{emptyContext:this.defaults.emptyContext}}}),YFYLoginView=Talent.ItemView.extend({template:jst["uploader/yfy-login-item"],className:"YFY-login-containter",ui:{form:"form"},show:function(){this.ui.form.submit(),this.trigger("formSubmit")}}),UploaderComponentPreviewItemView=Talent.ItemView.extend({template:jst["uploader/uploader-component-preview-item"],tagName:"li",className:"item_up",ui:{iconImg:"div[data-name=tita-upload-preview-icon]",itemLi:"div[data-name=tita-upload-preview-item]"},events:{"click a[data-name=tita-upload-preview-deleted]":"_delItem"},templateHelpers:function(){var a=this.model.get("FileName"),b=a.lastIndexOf("."),c=this.model.get("MediaType"),d=13-c.length,e=(this.model.get("imageUrl"),this.model.get("isFromYFY")),f=this.model.get("isImage");return e&&(f=!1),a=a.substring(0,b),a=_.substring(a,d,!0)+"."+c,{FileName:a,isImage:f}},_delItem:function(a){this.trigger("deleteItem"),a.stopPropagation()},initialize:function(){this.isClose=!1},onRender:function(){var a=this.model.get("isImage");this.model.get("isFromYFY")&&(a=!1),a&&this._renderImg(),this.$el.attr({id:this.model.cid})},_renderImg:function(){var a=this,b=new Image;b.onload=function(){if(!a.isClose){var c=b.width,d=b.height,e=100,f=100,g=a.fixImgSize(c,d,e,f);a.imgSize={width:g.w,height:g.h},b.width=g.w,b.height=g.h,a.ui.iconImg.html(b)}},b.onerror=function(){a.ui.itemLi.html('<div class="warnattachmenttip">读取文件 '+a.model.get("FileName")+" 失败</div>"),a.$el.delay(3e3).slideUp(200)},b.src=this.model.get("imageUrl")},fixImgSize:function(a,b,c,d){var e={w:0,h:0},f=a,g=b,h=c,i=d;if(f>0&&g>0){var j=h/i,k=f/g;f>h||g>i?k>j?(e.w=h,e.h=g*(h/f)):(e.w=f*(i/g),e.h=i):(e.w=f,e.h=g)}else e.w=f,e.h=g;return e},onClose:function(){this.isClose=!0}}),UploaderComponentPreviewView=Talent.CollectionView.extend({itemView:UploaderComponentPreviewItemView,tagName:"ul",className:"tita-upload-preview",initialize:function(){var a=this;this.on("itemview:deleteItem",function(b){a.delItem(b)})},onRender:function(){},delItem:function(a){this.collection.remove(a.model),this.trigger("deleteItem",this.collection.toJSON())}}),LoadingBoxView=Talent.ItemView.extend({defaults:{y:20},template:Talent._.template('<span class="img-load"></span><span>正在加载亿方云...</span>'),className:"loadingBoxView",initialize:function(a){this.settings=Talent._.extend({},this.defaults,a),this.$el.on("mouseup",function(a){a.stopPropagation()})},onRender:function(){this.$el.css({position:"absolute",width:580,"z-index":1100,border:"1px solid #DDD",height:306,"box-shadow":"#DDD 0px 0px 4px","background-color":"#fff",top:"50%",left:"50%","margin-left":-290,"margin-top":-290,"padding-top":247})},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),UploaderComponentView=Uploader.UploaderComponentView.extend({template:jst["uploader/uploader-component"],loadingTemplate:Talent._.template('<div id="<%= timestamp %>" class="loading_up"></div>'),errorTemplate:Talent._.template('<div class="warnattachmenttip"><%= msg %></div>'),PreviewView:UploaderComponentPreviewView,dealOptions:function(a){var b=Context.getUploadOptions();this.options=Talent._.extend({},this.defaults,b,a)},ui:{uploadNewFile:"[data-name=file]",YFYbtn:"#fc_upload",uploadType:"[data-name=upload-type]",dfsBtn:"[data-name=dfs-upload]"},events:function(){var a={};return a["mouseover "+this.ui.uploadNewFile]="showPop",a["mouseout "+this.ui.uploadNewFile]="hidePop",a["click "+this.ui.uploadNewFile]="hidePop",a["click "+this.ui.uploadNewFile]="_showUploadTypeMenu",a["click "+this.ui.YFYbtn]="_uptoFangCloud",a["mouseup.uploader-component "+this.ui.uploadType]="_clickUploadTypeHandler",a},initialize:function(a){var b=this;this.dealOptions(a),this.options.errorTime=3e3,this.model=new Talent.Model(this.options);var c=this.options.data||[];this.fileCollection=new this.FileCollection(c),this.checkedFileCollection=new this.CheckedFileCollection,this.recentFileCollection=new this.RecentFileCollection,this.templateHelpers=this.model.get("text"),Talent.$("body").off("click.upload"),Talent.$("body").on("click.upload",function(){b.hideUploadDropdown()}),this.options.PreviewView&&(this.PreviewView=this.options.PreviewView),this.options.RecentUploadView&&(this.RecentUploadView=this.options.RecentUploadView),this.options.loadingTemplate&&(this.loadingTemplate=this.options.loadingTemplate),this.options.errorTemplate&&(this.errorTemplate=this.options.errorTemplate),this.options.template&&(this.template=this.options.template)},onRender:function(){var a=this.options.container;this.options.openYFY||this.ui.uploadNewFile.parent().css({overflow:"hidden",position:"relative"}),""==a&&(this.options.container=this.$el),0==Talent.$(a).find(".upload_node").length&&this.$el.appendTo(Talent.$(a).find(".uploader_container")),this.renderUploaderFormView(),this.renderPreviewListView(),this.options.isShowExistFile&&this.renderRecentUploadView()},renderPreviewListView:function(){var a=this,b=this.options.container;this.previewCompositeView=new this.PreviewView({collection:this.fileCollection,model:this.model}),this.previewCompositeView.on("deleteItem",function(b){a.trigger("deleteItem",a._dealBeforeTriggerUploadEndDate(a.fileCollection.toJSON()),a._dealBeforeTriggerUploadEndDate(b))}),Talent.$(b).find(".preview_container").append(this.previewCompositeView.render().$el)},showPop:function(a){var b=Talent.$(a.currentTarget);b.data("tipsy")||b.tipsy({title:function(){return Context.getUploadTipText()},gravity:"sw",html:!0,trigger:"manual"}),this.ui.uploadNewFile.tipsy("show")},hidePop:function(){this.ui.uploadNewFile.tipsy("hide")},_clickUploadTypeHandler:function(a){a.stopPropagation()},_showUploadTypeMenu:function(a){a.stopPropagation();var b=this;if(this.options.openYFY){var c=Talent.$(a.currentTarget),d=c.outerWidth(),e=c.outerHeight();this.ui.uploadType.css({position:"absolute",top:e+10,left:(d-82)/2,"z-index":"1000"}),this.ui.uploadType.show(),Talent.$(document).off("mouseup.uploader-component"),Talent.$(document).on("mouseup.uploader-component",function(){b.ui.uploadType.hide(),Talent.$(document).off("mouseup.uploader-component")})}},renderUploaderFormView:function(){var a=this;this.options.fileCollection=this.fileCollection,this.uploaderView=new Uploader.UploaderView(this.options),this.uploaderView.on("formViewRender",function(b){a.onAfterFormViewRender(b)}),this.uploaderView.render(),this._dealUploaderStatus(this.uploaderView)},_dealUploaderStatus:function(a){var b=this;a.on("formViewRender",function(a){b.onAfterFormViewRender(a)}),a.on("uploadStart",function(a){b.showLoadingView(a),b.trigger("uploadStart",a)}),a.on("uploadEnd",function(a){b.ui.uploadType&&b.ui.uploadType.hide();var c=a.timestamp,d=b.onAfterUpload&&b.onAfterUpload(a);d[0].timestamp=c;var e=Talent._.filter(d,function(a){return 1==a.IsSuccess});e.length<d.length&&TipDialogView(b.ui.uploadNewFile,"文件应大于0KB且小于20MB",{container:b.$el,pos:"topLeft",minWidth:160}),b.hideLoadingView(a),b.fileCollection.add(e),b.trigger("uploadEnd",b._dealBeforeTriggerUploadEndDate(b.fileCollection.toJSON()),b._dealBeforeTriggerUploadEndDate(e))}),a.on("error",function(a){""!=a.message&&(b.hideLoadingView(a),b.showErrorView(a),b.trigger("error",a))})},_dealBeforeTriggerUploadEndDate:function(a){var b={};if(b.dfs=[],b.YFYresp=[],a&&a.length)for(var c=0;c<a.length;c++)if(a[c].isFromYFY){var d={};d.relatedFileId=a[c].id,d.fileType=a[c].fileType,d.size=a[c].size,d.name=a[c].FileName,a[c].thumbnail?d.thumbnailGenerated=!0:d.thumbnailGenerated=!1,d.documentSource=3,d.shareCode=a[c].share_code,b.YFYresp.push(d)}else a[c].DfsPath&&b.dfs.push(a[c].DfsPath);return b},onAfterUpload:function(a){var b=a.Result;return b?this._dealOnAfterUploadData(b):this._dealOnAfterUploadData(a)},_dealOnAfterUploadData:function(a){var b=this;return Talent._.map(a,function(a){var c=a.MediaType?a.MediaType.toLowerCase():a.type_icon.toLowerCase();return/^jpg|png|gif|jpeg|image|JPG|PNG|GIF|JPEG$/.test(c)?(a.isImage=!0,a.imageUrl=a.ClientUrl?a.ClientUrl:a.thumbnail,a.imageUrl||(a.isImage=!1)):(/^(rar|zip|exe|pdf|txt|doc|docx|ppt|pptx|xls|xlsx)$/.test(c)?fileIconName=c:/^(mp3|wma|wav|flac|ape|ogg|aac|m4a)$/.test(c)?fileIconName="music":/^(mp4|mkv|rm|rmvb|avi|3gp|flv|wmv|asf|mpeg|mpg|mov|ts|m4v)$/.test(c)?fileIconName="video":fileIconName="file",a.isImage=!1,a.fileType=fileIconName),a.FileName||(a.FileName=a.name),a.Msg||(a.Msg="上传成功"),a.MediaType=a.fileType=b._dealFileType(a.FileName),a.timestamp=(new Date).getTime(),a}),a},_dealFileType:function(a){var b=a.split(".");return newStr=b[b.length-1]},_dealYFYUploaderData:function(a){this.ui.uploadType.hide();var b=this.onAfterUpload&&this.onAfterUpload(a);this.fileCollection.add(b),this.trigger("uploadEnd",this._dealBeforeTriggerUploadEndDate(this.fileCollection.toJSON()),this._dealBeforeTriggerUploadEndDate(b))},_uptoFangCloud:function(a){a.stopPropagation();var b=this;this.loadingBoxView=new LoadingBoxView,Talent.$("body").append(this.loadingBoxView.render().$el),this.loadingBoxView.show(),YFYColleciton.getYifangyun().done(function(a){if(a&&a.host){var c=Context.getGlobal("yifangyunjs");require([c],function(){b.YFYLoginView=new YFYLoginView({model:new Talent.Model(a)}),b.YFYLoginView.on("formSubmit",function(){setTimeout(function(){b.loadingBoxView.hide(),b.renderYFYView()},2e3)}),b.$el.append(b.YFYLoginView.render().$el),b.YFYLoginView.show()})}})},renderYFYView:function(){var a=this;FangCloud.choose({success:function(b){Talent._.map(b,function(a){a.isFromYFY=!0}),a._dealYFYUploaderData(b)}}),this._setYFYViewPositoon(),Talent.$(document).off("mouseup.close-yfy-iframe"),Talent.$(document).on("mouseup.close-yfy-iframe",function(){FangCloud&&FangCloud.closeChooser(),a.ui.uploadType.hide()}),Talent.app.vent.on("route",function(a,b,c){FangCloud.closeChooser()}),Talent.$("#fangcloud_choose").css("z-index","1100")},_setYFYViewPositoon:function(){var a=parseInt($(document).scrollTop()),b=parseInt($("#fangcloud_choose").css("top"));$("#fangcloud_choose").css("top",a+b)},_addFileItem:function(a){var b=[];Talent._.each(a,function(a){a.DfsPath&&b.push(a.DfsPath)}),b.length&&this.trigger("addAttachment",b.join(","))},showLoadingView:function(a){var b=this.options.container;Talent.$(b).find(".loading_container").append(this.loadingTemplate({timestamp:a.timestamp}))},hideLoadingView:function(a){var b=this.options.container,c=a.timestamp;Talent.$(b).find(".loading_container").find("#"+c).hide()},onClose:function(){Talent.$(document).off("mouseup.uploader-component"),Talent.$(document).off("mouseup.close-yfy-iframe")}}),PrivateRangView=Talent.ItemView.extend({defaults:{privateValue:1,sort:[1,3,2],publicOptions:{name:"公开",des:"所有人可见"},privateOptions:{name:"私密",des:"仅@的人可见"},departmentOptions:{name:"部门可见",des:"仅我的部门可见"}},className:"qunartipwrapmvc",template:jst["private-range/private-range"],events:{"click ul":"_ulClickHandler","click li":"_liClickHandler"},modelEvents:{"change:privateValue":"render"},templateHelpers:function(){return{depId:this.depId,publicOptions:this.settings.publicOptions,privateOptions:this.settings.privateOptions,departmentOptions:this.settings.departmentOptions}},initialize:function(a){this.settings=Talent._.extend({},this.defaults,this.options);var b=this;this.userInfo=Context.getUserInfo(),this.depId=this.userInfo.DepartmentId||0,this.status=0,this.mappingData={1:this.settings.publicOptions,2:this.settings.privateOptions,3:this.settings.departmentOptions},Talent.$(document).off("mouseup.private-range"),Talent.$(document).on("mouseup.private-range",function(a){b.status=0,b.hide()}),this.$el.off("mouseup.private-range"),this.$el.on("mouseup.private-range",function(a){a.stopPropagation()}),this.model.set({visibility:1==this.settings.privateValue?1:2,privateObjType:3==this.settings.privateValue?15:0,privateObjId:3==this.settings.privateValue?this.depId:0,privateValue:this.settings.privateValue||1},{slient:!0}),this._formatData()},hide:function(){this.$el.hide()},onRender:function(){var a=this.model.get("privateValue");this.$el.find("li").removeClass("cur"),this.$el.find("li[id ="+a+"]").addClass("cur")},onClose:function(){this.$el.off("mouseup.private-range"),Talent.$(document).off("mouseup.PubList-Range"),this.status=0},show:function(a,b){var c={leftBias:"",topBias:""},d=Talent._.extend({},c,b);if(1==this.status)return this.status=0,void this.$el.hide();this.status=1,this.$el.css({position:"absolute","z-index":999});var e={pos:"bottom"};e=Talent._.extend({},e,d),Context.setPosition(a,this.$el,b),this.$el.css({display:"block"})},getDefaultPrivateText:function(a){var a=a||this.settings.privateValue;return this.mappingData[a]},_formatData:function(){var a=this.settings.sort,b=this.mappingData,c={1:{type:"public"},2:{type:"private"},3:{type:"department"}},d=[];a.length||alert("sort不能为空");for(var e=0;e<a.length;e++){var f=a[e],g=b[f];g&&(g=Talent._.extend(g,c[f]),d.push(g))}this.model.set("data",d)},_ulClickHandler:function(a){a.stopPropagation()},_liClickHandler:function(a){var b=Talent.$(a.currentTarget);if(b.hasClass("disabled"))return!1;var c=parseInt(b.attr("data-visibility"));this.model.set({visibility:c,text:b.find("span").html(),privateObjType:b.attr("objType")||0,privateObjId:b.attr("objId")||0,privateValue:b.attr("id")}),this.trigger("selected",this.model.toJSON()),this.status=0,this.$el.hide()}}),TRicheditorView=Talent.ItemView.extend({defaults:{uploadOptions:"",forbiddenBtn:["backcolor","video","fontcolor","fontsize","link","html","fontfamily","subscript","superscript","underline"]},template:Talent._.template(""),className:"tt-rich-editor",initialize:function(a){var a=a||{},b=Context.getUploadOptions();b.onAfterUpload=function(a){return a.Result[0].ClientUrl},this.settings=Talent._.extend({},this.defaults,a),this.settings.uploadOptions=b,a&&a.uploadOptions&&(this.settings.uploadOptions=Talent._.extend({},b,a.uploadOptions)),this.settings.uploadOptions.uploadUrl=this.settings.uploadOptions.url,Talent.$("body").on("click mouseup",".redactor_modal",function(a){a.stopPropagation()}),this.$el.on("mouseup",".redactor_box",function(a){a.stopPropagation()})},onShow:function(){this._renderEditorView()},callMethods:function(){var a=arguments[0],b=Array.prototype.slice.call(arguments,1);return this.richEditor.ui.redactor[a]&&this.richEditor.ui.redactor[a].apply(this.richEditor.ui.redactor,b)},_renderEditorView:function(){this.richEditor=new Richeditor({uploadOptions:this.settings.uploadOptions,forbiddenBtn:this.settings.forbiddenBtn,model:this.model}),this.listenTo(this.richEditor,"all",function(a){this.trigger(a)}),this.$el.html(this.richEditor.render().el),this.richEditor.onShow()},onClose:function(){this.richEditor&&this.richEditor.close()}}),TaskCreateDropDownItemView=Talent.ItemView.extend({template:Talent._.template("<%=name%>"),tagName:"li",templateHelpers:function(){return{name:Talent._.TitaWidget_substring(this.model.get("name"),60,!0)}},initialize:function(){var a=this.model.get("name");this.model.set("name",a.replace(/<br\/>/g,""))}}),TaskCreateDropDownCollectionView=Talent.CollectionView.extend({itemView:TaskCreateDropDownItemView,className:"ux_task_list",tagName:"ul",ui:{liName:"li"},events:function(){var a={};return a["click "+this.ui.liName]="_clickName",a},initialize:function(a){},onRender:function(){},_clickName:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget),c=Talent._.unescape(b.html());c&&""!=c&&this.trigger("choose",c)},onClose:function(){}}),TaskCreateClassView=Talent.ItemView.extend({defaults:{disable:!1,parentEl:"",classDialogOptions:{}},className:"task-create-class-wraper clearfix",template:jst["task-create/task-create-class"],ui:{formKlass:'[data-name="task-create-class"]',formKlassName:'[data-name="task-create-class-name"]',classContainer:'[data-name="class-area"]'},events:function(){var a={};return a["click "+this.ui.formKlass]="_clickClassHandler",a},modelEvents:{"change:labelName":"_changeLabName"},templateHelpers:function(){return this.settings.classOptions},initialize:function(a){this.settings=Talent._.extend({},a,a.classOptions),this.settings.classOptions=Talent._.extend({},this.defaults,a.classOptions)},_clickClassHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget);this.settings.classOptions.disable||(this.ui.formKlassName.addClass("active"),this._renderKlassView(b))},_renderKlassView:function(a){var b=this.settings.classDialogOptions;this.classComponentView&&this.classComponentView.close(),this.classComponentView=new ClassComponentView(b),this.listenTo(this.classComponentView,"submit",function(a){if(!a.id&&!this.model.get("labelId"))return this.ui.formKlassName.removeClass("active");this.model.set({labelType:a.type,labelId:a.id,labelName:a.name})}),this.listenTo(this.classComponentView,"reset",function(){this.model.set({labelType:0,labelId:null,labelName:""}),this.classComponentView.close(),this.ui.formKlassName.removeClass("active")}),this.listenTo(this.classComponentView,"reset",function(){this.model.set({labelType:0,labelId:null,labelName:""}),this.classComponentView.close(),this.ui.formKlassName.removeClass("active")}),this.settings.parentEl.append(this.classComponentView.render().el),this.classComponentView.show(a,{container:this.settings.parentEl,pos:"bottom",topBias:-44})},_changeLabName:function(){var a=this.model.get("labelName"),b=this.model.get("labelId"),a=Talent._.substringWithM(a,6,!0);b&&""!=a||(a="分类/项目",this.ui.formKlassName.removeClass("active")),this.ui.formKlassName.html(a)},onClose:function(){this.classComponentView&&this.classComponentView.close()}}),TaskCreateNameView=Talent.ItemView.extend({defaults:{parentEl:"",defaultText:"输入任务名称",iconShow:!0,iconClassName:"icon-task-txt",dropdownData:[],showBorderLeft:!0},template:jst["task-create/task-create-name"],ui:{taskName:'input[data-name="task-create-name"]',dropDown:'[data-name="task-create-name-dropdown"]'},className:"ns-task-create-name",events:function(){var a={};return a["focus "+this.ui.taskName]="_onFocus",a["keyup "+this.ui.taskName]="_onKeyHandler",a["keydown "+this.ui.taskName]="_onKeyHandler",a["input "+this.ui.taskName]="_onKeyHandler",a["blur "+this.ui.taskName]="_unFocus",a["change "+this.ui.taskName]="_onInputChange",a},initialize:function(){this.settings=Talent._.extend({},this.defaults,this.options.nameOptions),this.uxAddTaskContainer=this.options.parentEl,this.localStroage=Context.getLocalStorage(),this.userInfo=Context.getUserInfo(),this.settings.iconShow||this.$el.addClass("no-icon"),this.onIME=!1},templateHelpers:function(){return this.settings},onRender:function(){var a=this.localStroage,b=a.getItem("TaskCreateName_"+this.userInfo.Id+this.model.get("id"));!this.model.get("taskTitle")&&b&&(this.ui.taskName.val(b),this.model.set({taskTitle:b}),this.trigger("keyup",this.ui.taskName))},_onInputChange:function(a){var b=this.$(a.currentTarget),c=this.settings.dropdownData;""==Talent.$.trim(b.val())&&c&&c.length&&this._renderDropDown(),this.trigger("change",b)},_unFocus:function(a){var b=this.$(a.currentTarget),c=this;this.uxAddTaskContainer.removeClass("input-focus"),this.blurTag=!0,setTimeout(function(){c.blurTag&&c.settings.dropdownData.length&&c.ui.dropDown.hide()},300),this.trigger("unfocus",b)},_onFocus:function(a){var b=this.$(a.currentTarget),c=this.options.nameOptions.dropdownData;this.uxAddTaskContainer.addClass("input-focus"),c&&c.length&&""==b.val()&&this._renderDropDown(),this.trigger("focus",b)},_renderDropDown:function(){var a=this,b=this.options.nameOptions.dropdownData,c=this.ui.dropDown;this.dropDownView&&this.dropDownView.close(),this.dropDownView=new TaskCreateDropDownCollectionView({collection:new Talent.Collection(b)}),c.html(this.dropDownView.render().el).show(),this.listenTo(this.dropDownView,"choose",function(b){this.blurTag=!1,this.model.set("taskTitle",b),this.ui.taskName.val(b,this.ui.taskName),this.trigger("keyup",this.ui.taskName),c.hide(),a.localStroage.setItem("TaskCreateName_"+this.userInfo.Id+this.model.get("id"),b)})},_onKeyHandler:function(a){var b="",c="";a.type&&(b=a.type),(a.keyCode||"0"==a.keyCode)&&(c=a.keyCode),b&&"keydown"==b&&(this.onIME="0"==c||"229"==c);var d=this.$(a.currentTarget),e=$.trim(d.val()),f=this.ui.uxAddTaskContainer;""!=e&&this.ui.dropDown.hide(),e.length>500&&(e=_.TitaWidget_substring(e,500,!1),d.val(e)),this.localStroage.setItem("TaskCreateName_"+this.userInfo.Id+this.model.get("id"),e),this.model.set("taskTitle",e),13!=c||"keyup"!=b||this.onIME?this.trigger("keyup",d):""==e?(f.removeClass("input-focus").addClass("border-warn"),setTimeout(function(){f.removeClass("border-warn")},1500)):this.trigger("submit",d)}}),TaskCreatePrincipleView=Talent.ItemView.extend({template:jst["task-create/task-create-principle"],ui:{principle:'[data-name="task-create-principle-inner"]'},className:"ns-task-principle",events:function(){return{}},modelEvents:{"change:principalUser":"render"},templateHelpers:function(){return this.settings},initialize:function(){this.settings=Talent._.extend({},this.options,this.options.principalOptions)},onRender:function(){this._bindUserSelect()},_bindUserSelect:function(){var a=this;this.userSelectorView=new UserSelector({collection:new UserSelectorCollection}),this.userSelectorView.addNode(this.$el,{muti:!1}),this.$el.on("submit",function(b,c){b.stopPropagation(),a.trigger("changePrincipal",{user:c,node:a.$(b.currentTarget)})})},onClose:function(){this.userSelectorView&&this.userSelectorView.close()}}),TaskCreateDateView=Talent.ItemView.extend({defaults:{dateOptions:{showBorderLeft:!0,pos:"bottomRight"},dataTimeRangeOptions:{isShowDateView:!0,isShowCycleView:!0,isShowLongView:!0,count:2,rangepickerOptions:{timePicker:!0}},parentEl:""},template:jst["task-create/task-create-date"],ui:{dateBox:"[data-name=task-create-date-box]",dateIcon:"[data-name=task-create-date-ico]",dateArea:'[data-name="task-create-date-area"]'},className:"ns-task-create-date",events:function(){var a={};return a["click "+this.ui.dateBox]="_showPop",a["mouseup "+this.ui.dateBox]=function(a){a.stopPropagation()},a},modelEvents:{"change:isCycle":"_changeCycle","change:startDate change:endDate change:isLongTerm":"_renderDate","change:cycStartDate change:cycEndDate":"_renderDate","change:cycStartHour change:cycStartMinute change:cycEndHour change:cycEndMinute":"_renderDate"},templateHelpers:function(){this.model.toJSON();return Talent._.extend({},this.settings,{dateTip:this.getDateTip(),cycleTip:this._getCycleTaskHtml(),showBorderLeft:this.settings.dateOptions.showBorderLeft})},initialize:function(a){this.settings=Talent._.extend({},this.defaults,this.options),this.settings.dateOptions=Talent._.extend({},this.defaults.dateOptions,this.options.dateOptions),this.settings.dataTimeRangeOptions=Talent._.extend({},this.defaults.dataTimeRangeOptions,this.options.dataTimeRangeOptions),this.settings.dataTimeRangeOptions.rangepickerOptions=Talent._.extend({},this.defaults.dataTimeRangeOptions.rangepickerOptions,this.options.dataTimeRangeOptions.rangepickerOptions)},onRender:function(){var a="se";"bottom"==this.settings.dateOptions.pos&&(a="sw"),this.$("[original-title]").tipsy({gravity:a}),1==this.settings.dataTimeRangeOptions.count&&this.model.set("endDate",this.model.get("startDate"),{silent:!0})},_changeCycle:function(){this.render(),this.model.get("isCycle")||this.ui.dateIcon.addClass("icon-task-during-active")},_showPop:function(a){a&&a.stopPropagation();var b=this.$(a.currentTarget);this.dateTimePickerView&&this.dateTimePickerView.close();var c=Talent._.extend({},this.settings.dataTimeRangeOptions,{viewType:this.model.get("isCycle")?"cycle":this.model.get("isLongTerm")?"long":"date",model:this.model});this.dateTimePickerView=new DateTimePickerView(c),this.listenTo(this.dateTimePickerView,"sure",function(a,b){this.trigger("selectDate",this.ui.dateBox,this.model.toJSON())}),this.settings.parentEl.append(this.dateTimePickerView.render().el),this.dateTimePickerView.onShow(),this.dateTimePickerView.show(b,{container:this.settings.parentEl,pos:this.settings.dateOptions.pos})},getDateTip:function(){var a=this.model.get("startDate"),b=this.model.get("endDate"),c=moment(new Date(a)),d=moment(new Date(b)),e=this.model.get("isLongTerm"),f="起止时间：",g="YYYY/MM/DD HH:mm",h=this.settings.dataTimeRangeOptions.rangepickerOptions;return h&&!h.timePicker&&(g="YYYY/MM/DD"),f+=e?c.format("YYYY/MM/DD")+"-长期":c.format(g)+"-"+d.format(g),1==this.settings.dataTimeRangeOptions.count&&(f=c.format("YYYY/MM/DD")),f},_getCycleTaskHtml:function(){var a="循环周期：",b=this.model.toJSON(),c=b.cycType,d=b.isCycle,e=b.cycStartHour+":"+b.cycStartMinute,f=b.cycEndHour+":"+b.cycEndMinute,g=b.cycStartDayTxt,h=b.cycEndDayTxt;return this.isFirstRender||!d?"设置循环时间":(1==c?(a+="每天",a+=" "+e,a+=" - "+f):2==c?(a+="每个工作日",a+=" "+e,a+=" - "+f):3==c?(a+="每周",a+=" "+g+" "+e+" - "+h+" "+f):4==c&&(a+="每月",a+=" "+g+"日 "+e+" - "+h+"日 "+f),a)},_renderDate:function(){var a=this.getDateTip();this.model.toJSON();if(this.model.get("isCycle"))return void this._renderCycle();this.ui.dateBox.attr("original-title",a),this.ui.dateIcon.addClass("icon-task-during-active")},_renderCycle:function(){var a=this._getCycleTaskHtml();this.ui.dateBox.attr("original-title",a),this.ui.dateIcon.addClass("icon-action-cycle-active")},onClose:function(){this.dateTimePickerView&&this.dateTimePickerView.close()}}),TaskCreateWorkHourView=Talent.ItemView.extend({defaults:{showBorderLeft:!0,parentEl:"body",hourDropdownOpitons:{pos:"bottomRight"}},className:"task-create-work-hour-box",template:jst["task-create/task-create-workhour"],ui:{workhour:'[data-name="task-create-workhour"]'},events:function(){var a={};return a["click "+this.ui.workhour]="_renderWorkHourView",a},modelEvents:{"change:hourDate":"render","change:minuteDate":"render"},templateHelpers:function(){return{workHour:this._formateDate(),showBorderLeft:this.settings.showBorderLeft}},initialize:function(){this.settings=Talent._.extend({},this.options,this.options.hourDateOptions)},_renderWorkHourView:function(a){var b=this.$(a.currentTarget);a.stopPropagation(),this.workHourView&&this.workHourView.close(),this.workHourView=new WorkHourView({model:new Talent.Model({hourDate:this.model.get("hourDate"),minuteDate:this.model.get("minuteDate")})}),this.listenTo(this.workHourView,"sure",function(a){this.model.set({hourDate:a.hourDate,minuteDate:a.minuteDate})});var c=Talent._.extend({},this.settings.hourDropdownOpitons);c.container=this.settings.parentEl,this.workHourView.show(b,c)},_formateDate:function(){var a=this.model.get("hourDate"),b=this.model.get("minuteDate"),c="",d=[{minute:"0",hour:"00"},{minute:"15",hour:"25"},{minute:"30",hour:"50"},{minute:"45",hour:"75"}];if(a&&b){var e=_.findWhere(d,{minute:b});c=a+"."+e.hour}if(!a&&b){var e=_.findWhere(d,{minute:b});c="0."+e.hour}return a&&!b&&(c=a+".00"),a||b||(c=""),c},onClose:function(){this.workHourView&&this.workHourView.close()}}),TaskCreateParticipatorView=Talent.ItemView.extend({template:jst["task-create/task-create-participator"],ui:{participator:'[data-name="task-create-participator"]'},events:function(){var a={};return a["click "+this.ui.participator]="_showAddUser",a},modelEvents:{"change:participatorsCount":"render"},_showAddUser:function(a){var b=this.$(a.currentTarget);this.trigger("toggleAddUser",b)},templateHelpers:function(){return this.settings},initialize:function(){this.settings=Talent._.extend({},this.options,this.options.participatorOptions)},onClose:function(){}}),TaskCreateApplyUserView=Talent.ItemView.extend({template:jst["task-create/task-create-apply-user"],className:"ns-task-create-applyuser",ui:{deleteApplyUser:'[data-name="task-create-delete-applyuser"]',applyUser:'[data-name="task-create-applyuser"]'},events:function(){var a={};return a["click "+this.ui.deleteApplyUser]="_deleteApprover",a},modelEvents:{"change:applyUser":"render"},templateHelpers:function(){return this.settings},initialize:function(){this.settings=Talent._.extend({},this.options,this.options.applyUserOptions)},onRender:function(){var a=this;this.userSelectorView=new UserSelector({collection:new UserSelectorCollection}),this.userSelectorView.addNode(this.ui.applyUser,{muti:!1}),this.ui.applyUser.on("submit",function(b,c){b.stopPropagation(),a._checkApplyUser(c)})},_checkApplyUser:function(a){if(a.userId=a.Id,this.model.get("principalUser").Id==a.Id)return void TipDialogView(this.ui.applyUser,"负责人和审批人不能是同一人",{pos:"topCenter",container:this.settings.parentEl,topBias:48});this.model.set("applyUser",a)},_deleteApprover:function(a){var b=this,c=Talent.$(a.currentTarget);a.stopPropagation(),ConfirmDialogView(c,"此操作不可恢复，您确定删除吗？",{sure:function(){b.model.set({applyUser:null})},pos:"bottom",topBias:32,leftBias:-20,container:this.settings.parentEl})},onClose:function(){}}),TaskCreateExternalPersonView=Talent.ItemView.extend({template:jst["task-create/task-create-external-person"],ui:{externalPerson:'[data-name="task-create-extend-person"]'},events:function(){var a={};return a["click "+this.ui.externalPerson]="_showExternalPerson",a},modelEvents:{"change:extend_user":"render"},templateHelpers:function(){return this.settings},initialize:function(){this.settings=Talent._.extend({},this.options,this.options.extendPersonOptions)},_showExternalPerson:function(a){var b=this.$(a.currentTarget);this.trigger("showExtendPerson",b)},onClose:function(){}}),TaskCreateReplaceView=Talent.ItemView.extend({defaults:{parentEl:""},template:jst["task-create/task-create-replace"],className:"create-replace-box",ui:{checkWraper:'[data-name="task-create-replace-check-wraper"]',replace:'[data-name="task-create-replace-check"]',replaceLabel:'[data-name="task-create-replace-label"]'},events:function(){var a={};return a["click "+this.ui.checkWraper]="_checkReplace",a},modelEvents:{"change:isCanReplace":"render","change:replaceRadioChecked":"_radioCheckedEvent"},templateHelpers:function(){return this.settings},initialize:function(){this.settings=Talent._.extend({},this.options,this.options.replaceOptions),this.userInfo=Context.getUserInfo(),this.model.set({replaceRadioChecked:!1,isCanReplace:!1},{silent:!0}),this.userSelectorView=new UserSelector({collection:new UserSelectorCollection})},onRender:function(){this.$("[original-title]").tipsy({gravity:"s"})},_checkReplace:function(){var a=(this.ui.replace,this.model.toJSON()),b=(a.principalUser,a.replaceRadioChecked);a.isCanReplace&&(b?(this.model.set("replaceRadioChecked",!1),this._radioCheckedEvent(),this.trigger("cancelReplace")):(this.model.set("replaceRadioChecked",!0),this._radioCheckedEvent(),this._bindUserSelector()))},_radioCheckedEvent:function(){if(this.model.get("replaceRadioChecked")){var a=this.model.get("principalUser");this.model.set({publisher:a}),this.ui.replace.removeClass("checkbox").addClass("checkbox-checked"),this.ui.replaceLabel.text("代ta发起："+a.Name)}else this.model.set({publisher:null},{silent:!0}),this.userSelectorView.unBindNodeEvents(this.ui.replaceLabel),this.ui.replace.removeClass("checkbox-checked").addClass("checkbox"),this.ui.replaceLabel.text("代ta发起")},_bindUserSelector:function(){var a=this;this.userSelectorView.addNode(this.ui.replaceLabel,{muti:!1,bias:{left:-35,top:0}}),this.ui.replaceLabel.on("submit",function(b,c){if(c.Id==a.userInfo.Id)return void TipDialogView(a.ui.replaceLabel,"不能选择自己作为代发人",{container:a.settings.settings,pos:"topCenter",topBias:48});a.ui.replaceLabel.text("代ta发起："+c.Name),a.model.set({publisher:c}),a.trigger("publisherChanged")})},onClose:function(){this.userSelectorView&&this.userSelectorView.close()}}),TaskCreateBottomView=Talent.Layout.extend({template:jst["task-create/task-create-bottom"],defaults:{privateRangeOptions:{privateValue:2,sort:[2,3,1],privateOptions:{name:"私密",des:"仅任务成员可见"},publicOptions:{name:"公开",des:"所有人可见"},departmentOptions:{name:"部门可见",des:"仅我的部门可见"}},nameOptions:!1,shape:"line",parentEl:"",bottomOptions:{isShowFileUpload:!0,isShowPrivateBtn:!0,isShowPrivateDropDown:!0,isShowMessage:!0,isShowPackUpBtn:!0,pubBtnText:"发布"}},className:"task-create-bottom-box",ui:{uploadNewFile:".upload_new_file",pubBtn:'[data-name="set-pub-btn"]',toggle:'[data-name="toggle"]',msgTip:'[data-name="data-message"]',publishWraper:'[data-name="publish-wraper"]',privated:"div[data-name=task-create-private]",privatedCaret:'[data-name="range-caret"]',attachment:"a[data-name=file]"},events:function(){var a={};return a["click "+this.ui.pubBtn]="_submitTask",a["click "+this.ui.toggle]="_toggle",a["click "+this.ui.msgTip]="_msgTip",a["click "+this.ui.privated]="_renderPrivateView",a},modelEvents:{"change:sendUserStatus":"_changeUserMessage"},templateHelpers:function(){var a=this.settings.privateRangeOptions.privateValue,b=this.privateView&&this.privateView.getDefaultPrivateText(a)||"";return this.settings.bottomOptions.privateText=b,this.settings.bottomOptions},initialize:function(a){this.settings=Talent._.extend({},this.defaults,this.options),this.settings.bottomOptions=Talent._.extend({},this.defaults.bottomOptions,this.options.bottomOptions),this.settings.privateRangeOptions=Talent._.extend({},this.defaults.privateRangeOptions,this.options.privateRangeOptions),this.model.set({packUp:"line"==this.settings.shape,visibility:this.settings.privateRangeOptions.privateValue}),this.privateView=new PrivateRangView(this.settings.privateRangeOptions),this.listenTo(this.privateView,"selected",function(a){this.model.set({privateText:a.text,visibility:a.visibility,privateObjType:a.privateObjType,privateObjId:a.privateObjId,privateValue:a.privateValue});var b=a.text;2!=a.privateValue&&3!=a.privateValue||(b='<i class="icon-lock" data-name="lock" style=""></i>'+a.text),this.ui.privated.html(b),this.settings.bottomOptions.isShowPrivateDropDown&&this.ui.privated.append(this.ui.privatedCaret)})},onRender:function(){this._renderUploadView(),this._customizeRange()},closeView:function(){this.privateView&&this.privateView.hide()},_customizeRange:function(){this.settings.bottomOptions.isShowPrivateDropDown?this.ui.privated.addClass("pointer"):this.ui.privatedCaret.remove()},_renderUploadView:function(){var a=this;this.uploaderView=new UploaderComponentView({container:this.$el,openYFY:Context.IsOpenYifangyun()}),this.uploaderView.on("uploadEnd",function(){a.trigger("uploadClose",a._getUploadFile())}),this.uploaderView.on("deleteItem",function(){a.trigger("uploadClose",a._getUploadFile())}),this.uploaderView.on("error",function(b){a.$el.find('div[id="'+b.timestamp+'"]').remove()}),this.ui.attachment.html(this.uploaderView.render().$el)},_renderPrivateView:function(a){if(this.settings.bottomOptions.isShowPrivateDropDown){a.stopPropagation();var b=Talent.$(a.currentTarget);this.$el.append(this.privateView.render().$el),this.privateView.show(b,{container:this.$el.parent(),pos:"topRight"})}},changePubBtnDisable:function(a){var b=this.ui.pubBtn;a?b.removeClass("btn-disabled"):b.addClass("btn-disabled")},_msgTip:function(a){var b=this.$(a.currentTarget),c=!b.hasClass("checkbox-checked");c?this._checkNum():this.model.set("sendUserStatus",c)},_checkNum:function(a){var b=this,c=a||!1;SMSCollection.getSmsCheck({to_user_id:b.model.get("principalUser").Id}).done(function(a){1==a?(c||b.model.set("sendUserStatus",!0),b.model.set("telephone",""),b.model.set("is_notify",0),b.model.set("setCheck",!1)):2==a||4==a?c?b.model.get("sendUserStatus")&&(b.model.set("sendUserStatus",!1),b._moreMessagePop()):b._moreMessagePop():3==a&&(c?b.model.get("sendUserStatus")&&(b.model.set("sendUserStatus",!1),b._hasNoNumberPop()):b._hasNoNumberPop())}).fail(function(a){b.model.set("sendUserStatus",!1)})},_moreMessagePop:function(){var a=this;this.saveDialog&&this.saveDialog.close(),this.saveDialog=new TDialogView({sure:!0,cancel:!1,type:"tipsy",showClosed:!1,minWidth:300,arrow:!0,autoHide:!1,sure:function(){a.saveDialog.$el.hide()}}),$("body").append(this.saveDialog.render().$el),this.saveDialog.show(this.ui.msgTip,"目前您企业的短信已超出许可量，请联系超管进行短信充值",{className:"warn",leftBias:8})},_hasNoNumberPop:function(){var a=this;this.saveDialog&&this.saveDialog.close(),this.saveDialog=new TDialogView({type:"",showClosed:!0,arrow:!0,sure:!0,cancel:!0,autoHide:!1,minWidth:350,sure:function(){var b=a.saveDialog.$el.find('input[name="telephone"]').val();if(!a._validatePhoneNum(b))return a.saveDialog.$el.find('input[name="telephone"]').parent().addClass("input-error"),a.saveDialog.$el.find(".errortext_mcsmt").html("请填写正确的11位手机号码"),!1;var c=a.model.get("setCheck")?1:0;a.model.set("is_notify",c),a.model.set("telephone",b),a.model.set("sendUserStatus",!0)}}),this.$el.parent().append(this.saveDialog.render().$el),this.saveDialog.show(this.ui.msgTip.parent(),'<div class="ux_create_task_pop"><h2>请填写负责人的手机号码</h2><div class="input-default"><input type="text" name="telephone" class=""></div><div class="errortext_mcsmt"></div><div class="checkbox_wrap"><a href="javascript:void(0);" title="" class="checkbox"><span class="ico"></span></a><span>通知对方添加手机号，避免您重复填写</span></div></div>',{leftBias:0,pos:"bottom",container:this.$el.parent()}),this.saveDialog.$el.find('input[name="telephone"]').on("focus",function(){a.saveDialog.$el.find('input[name="telephone"]').parent().addClass("input-focus")}),this.saveDialog.$el.find('input[name="telephone"]').on("blur",function(){a.saveDialog.$el.find('input[name="telephone"]').parent().removeClass("input-focus")}),this.saveDialog.$el.find('input[name="telephone"]').on("keyup",function(){a.saveDialog.$el.find(".errortext_mcsmt").html(""),a.saveDialog.$el.find('input[name="telephone"]').parent().removeClass("input-error")}),this.saveDialog.$el.find(".checkbox").on("click",function(b){var c=Talent.$(b.currentTarget),d=!c.hasClass("checkbox-checked");a.model.set("setCheck",d),c.hasClass("checkbox-checked")?c.removeClass("checkbox-checked"):c.addClass("checkbox-checked")}),this.saveDialog.$el.find(".closed_dialog").on("click",function(){return!0})},_changeUserMessage:function(){var a=this.model.get("sendUserStatus"),b=this.ui.msgTip;b.removeClass("checkbox checkbox-checked"),a?b.addClass("checkbox-checked").attr({"original-title":"取消短信通知负责人"}):b.addClass("checkbox").attr({"original-title":"短信通知负责人"})},_validatePhoneNum:function(a){var b=/^1((3[0-9])|(5[012356789])|(8[01256789])|(4[7]))\d{8}$/;return!!RegExp(b).test(a)},_toggle:function(a){a.stopPropagation();var b=this.model.get("packUp"),c=this.$(a.currentTarget),d=c.find(".l"),e=c.find(".r");this.model.set("packUp",!b),e.removeClass("icon-arrow-up-double icon-arrow-down-double"),this.ui.publishWraper.removeClass("packup"),b?(e.addClass("icon-arrow-up-double"),d.text("收起")):(e.addClass("icon-arrow-down-double"),this.ui.publishWraper.addClass("packup"),d.text("更多信息")),this.trigger("openAdvancedMode",c,{open:!b})},_submitTask:function(a){var b=this.$(a.currentTarget);if(this.model.get("pubBtnIsActive"))return this.settings.nameOptions&&!this.model.get("taskTitle")?void this.trigger("onSubmitError"):void this.trigger("onSubmit",b)},_getUploadFile:function(){var a=this.uploaderView.fileCollection.where({Msg:"上传成功"});return new Talent.Collection(a).toJSON()},onClose:function(){this.saveDialog&&this.saveDialog.close(),this.privateView&&this.privateView.close()}}),TaskCreateAddUserItemView=Talent.ItemView.extend({template:jst["task-create/task-create-add-user-item"],tagName:"li",ui:{uxUserArea:".ux_user_area"},initialize:function(){if(this.model.has("name")){this.model.set("departmentTag",!0);var a='<span class="square" >'+this.model.get("name").substr(0,1)+"</span>";this.model.set("Name",this.model.get("name")),this.model.set("imgTemplate",a),this.model.set("HasAvatar","")}else this.model.set("departmentTag",!1)},onRender:function(){this.model.has("UserAvatar")?(this.userAvatar=this.model.get("UserAvatar"),this.userAvatar.HasAvatar&&this.$el.find("img").addClass("radius_img30")):this.userAvatar="",this.$el.find("[title]").tipsy({gravity:"s"})},events:function(){var a={};return a["mouseover "+this.ui.uxUserArea]="_changeHideNode",a["mouseout "+this.ui.uxUserArea]="_changeShowNode",a["click "+this.ui.uxUserArea]="_deleteUser",a},_deleteUser:function(a){this.trigger("deleteUser",this.model),a.stopPropagation()},_changeHideNode:function(a){var b=Talent.$(a.currentTarget);this.userAvatar.HasAvatar?b.find("img").hide():b.find("span").hide()},_changeShowNode:function(a){var b=Talent.$(a.currentTarget);this.userAvatar.HasAvatar?b.find("img").show():b.find("span").show()}}),TaskCreateAddUserCompositeView=Talent.CompositeView.extend({itemView:TaskCreateAddUserItemView,className:"task-create-member-list",itemViewContainer:"ul",template:jst["task-create/task-create-add-user-composite"],ui:{addUserBtn:'em[data-name="add-user-btn"]'},initialize:function(a){this.userInfo=Context.getUserInfo()},modelEvents:{},onRender:function(){var a=this;this.on("itemview:deleteUser",function(b){a.collection.remove(b.model),$("body .tipsy").remove(),a.trigger("deleteUserApi",b.model),a.trigger("selectUser",a.collection.toJSON())}),this.userSelectorView=new UserSelector({collection:new UserSelectorCollection}),this.userSelectorView.addNode(this.ui.addUserBtn,{muti:!0}),this.ui.addUserBtn.on("submit",function(b,c){b.stopPropagation(),c.data?a._changeResponsible(c.data):a._changeResponsible(c)})},addChildView:function(a,b,c){this.closeEmptyView();var d=this.getItemView(a),e=this.collection.indexOf(a),f=Marionette.getOption(this,"itemViewOptions");_.isFunction(f)&&(f=f.call(this,a,e));var g=this.buildItemView(a,d,f);this.addChildViewEventForwarding(g),this.children.add(g),g.render(),this.$el.find(this.itemViewContainer).find("li:first-child").length?this.$el.find(this.itemViewContainer).find("li:first-child").before(g.el):this.$el.find(this.itemViewContainer).append(g.el),this._isShown&&Marionette.triggerMethod.call(g,"show"),this.triggerMethod("after:item:added",g)},_changeResponsible:function(a){if(a.length>0){var b=0;Talent._.each(a,function(a){"department"==a.type?b+=a.totalUserCount:b++});var c=this.collection.length+b,d=this._checkParticipatorsLimit(c);d&&(this._smemberListSelect(a),this.trigger("selectUser",this.collection.toJSON()))}else{var c=this.collection.length+1,d=this._checkParticipatorsLimit(c);d&&(this._smemberSelect(a),this.trigger("selectUser",this.collection.toJSON()))}},_checkParticipatorsLimit:function(a){var b=this.model.get("participatorsLimit");return!(a>b)||(TipDialogView(this.ui.addUserBtn,"参与者不能超过"+b+"人",{container:this.$el,pos:"top",topBias:47}),!1)},_smemberListSelect:function(a){var b=this,c=0,d=new Talent.Collection;_.each(a,function(a){if(a.Id)var e=b.collection.where({Id:a.Id});else var e=b.collection.where({id:a.id});e.length>0?c++:d.add(a)}),c==a.length?TipDialogView(this.ui.addUserBtn,"添加的人都已存在",{container:this.$el,pos:"top",topBias:47}):(this.trigger("addUserApi",d.toJSON()),_.each(d.models,function(a){b.collection.add(a)}))},_smemberSelect:function(a){if(a=a||{},this.collection.where({Id:a.Id}).length>0)return void TipDialogView(this.ui.addUserBtn,"该联系人已存在",{container:this.$el,pos:"top",topBias:43});var b=this.model.get("principalUser").Id;if(a.Id==b)return void TipDialogView(this.ui.addUserBtn,"ta已是任务负责人，不能成为参与人",{container:this.$el,pos:"top",topBias:43});var c=this.model.get("publisher");if(c&&c.Id==a.Id)return void TipDialogView(this.ui.addUserBtn,"ta已是任务发起人，不能成为参与人",{container:this.$el,pos:"top",topBias:43});this.userInfo.Id!=a.Id||c||(TipDialogView(this.ui.addUserBtn,"只有在代别人发布任务的时候才能成为参与人",{container:this.$el,pos:"top",topBias:43}),this.trigger("addSelf"));var d=new Talent.Collection(a);this.trigger("addUserApi",d.toJSON()),this.collection.add(a)},onClose:function(){this.tDialogViewError&&this.tDialogViewError.close(),this.userSelectorView&&this.userSelectorView.close(),Talent.$(".tipsy").remove()}}),TaskCreateAddExtendUserView=Talent.ItemView.extend({template:Talent._.template('<input data-name="task-create-extend-user" value="<%=extendUser%>" placeHolder="填写外部联系人"/>'),className:"task-create-extend-user",ui:{uxInput:'input[data-name="task-create-extend-user"]'},events:function(){var a={};return a["focus "+this.ui.uxInput]="_onFocus",a["blur "+this.ui.uxInput]="_onBlur",a},initialize:function(a){this.parentEl=a.parentEl},onRender:function(){},_onFocus:function(a){Talent.$(a.currentTarget);this.parentEl.addClass("input-focus")},_onBlur:function(a){var b=Talent.$(a.currentTarget);this.parentEl.removeClass("input-focus"),this.model.set("extendUser",b.val())}}),i18n=Context.getI18n(),TaskCreateView=Talent.Layout.extend({defatuls:{id:"",shape:"default",templateName:"default",extraClass:"",richEditorOptions:{defaultText:"详细说明"},extendPersonOptions:!1,applyUserOptions:{showBorderLeft:!0},participatorOptions:{limit:100,showBorderLeft:!1},replaceOptions:{showBorderLeft:!0},hourDateOptions:!1,hourDropdownOpitons:{pos:"bottomRight"},principalOptions:{showBorderLeft:!0},classOptions:{disable:!1,showBorderLeft:!1},classDialogOptions:{},nameOptions:{defaultText:"输入"+i18n.task_1+"名称",iconShow:!0,iconClassName:"icon-task-txt",dropdownData:[],showBorderLeft:!0},dateOptions:{showBorderLeft:!0,pos:"bottomRight"},dataTimeRangeOptions:{},bottomOptions:{isShowFileUpload:!0,isShowPrivateBtn:!0,isShowPrivateDropDown:!0,isShowMessage:!0,isShowPackUpBtn:!0,pubBtnText:"发布"},privateRangeOptions:{},requestSubmit:function(){return new Talent.$.Deferred},toUserId:""},template:jst["task-create/task-create"],className:"tt-task-create",ui:{uxAddTaskContainer:'[data-name="task-create-add-input"]',uxMemberList:'[data-name="task-create-member-list"]',uxExtend:'[data-name="task-create-extend"]',uxAddInput:'[data-name="task-create-add-input"]',uxRicheditor:'[data-name="task-create-richeditor"]',uxTools:'[data-name="task-create-tools"]',bottomArea:'[data-name="task-create-bottom"]',uxTaskContent:'input[data-name="task-create-name"]',principle:'[data-name="task-create-principle-inner"]',richEditorContent:".redactor_editor",richEditorDefaultLabel:".redactor_box label",richEditorBox:".redactor_box",uxExtendUser:'input[name="extend_user"]',uxExtendArea:'[data-name="task-create-layout-extend"]',pubBtn:'[data-name="set-pub-btn"]'},regions:{uxAddInput:'[data-name="task-create-add-input"]',uxTools:'[data-name="task-create-tools"]',bottomArea:'[data-name="task-create-bottom"]',uxMemberList:'[data-name="task-create-member-list"]',uxRicheditor:'[data-name="task-create-richeditor"]',uxExtend:'[data-name="task-create-extend"]',classArea:'[data-name="task-create-class"]',inputArea:'[data-name="task-create-name"]',principleArea:'[data-name="task-create-principle-area"]',taskDateArea:'[data-name="task-create-date"]',workHourArea:'[data-name="task-create-hour-date"]',participatorArea:'[data-name="task-create-participator"]',applyUserArea:'[data-name="task-create-apply-user"]',externalPersonArea:'[data-name="task-create-external-person"]',replaceArea:'[data-name="task-create-replace"]',uxExtendArea:'[data-name="task-create-layout-extend"]'},events:function(){return{}},modelEvents:{"change:taskTitle":"_onValueChange","change:code":"_onValueChange"},initialize:function(a){this.defaults;this.userInfo=Context.getUserInfo(),this.tenantId=Context.getGlobal("tenantInfo").Id,this.settings=Talent._.extend({},this.defatuls,a),this.model.set("id",this.settings.id),this._customTemplate();for(var b in a)"object"==typeof a[b]&&(this.settings[b]=Talent._.extend({},this.defatuls[b],a[b]));this.settings.extraClass&&this.$el.addClass(this.settings.extraClass),this.participatorCollection=new Talent.Collection,this.listenTo(this.participatorCollection,"add remove reset",function(){this._synNum()}),this.localStorage=Context.getLocalStorage(),this.initModelData=this.model.toJSON(),this._initData()},onRender:function(){this._renderBottomView(),this._renderAll(),this._customModuleShow()},onShow:function(){},_customModuleShow:function(){var a=this.settings;"line"!=a.shape&&this._showAdvancedMode(),a.classOptions||this.$el.addClass("task-create-none-class"),a.applyUserOptions&&this._getCurrentUserApproval(),a.participatorOptions&&this._renderAddUserCompositeView(),a.richEditorOptions||this.ui.uxRicheditor.hide(),a.classOptions||a.nameOptions||a.principalOptions||a.dateOptions||this.ui.uxAddTaskContainer.remove(),a.hourDateOptions||a.participatorOptions||a.extendPersonOptions||a.applyUserOptions||a.replaceOptions||this.ui.uxTools.remove()},_customTemplate:function(){this.settings.template&&(this.template=this.settings.template),"dateRichEditor"==this.settings.templateName&&(this.settings=Talent._.extend({},this.settings,{privateRangeOptions:!1,extendPersonOptions:!1,applyUserOptions:!1,participatorOptions:!1,replaceOptions:!1,hourDateOptions:!1,principalOptions:!1,classOptions:!1,nameOptions:!1,dateOptions:{showBorderLeft:!1,pos:"bottom"},dataTimeRangeOptions:{isShowDateView:!1,isShowCycleView:!1,isShowLongView:!0,count:2,isShowTab:!1,rangepickerOptions:{timePicker:!1,format:"YYYY/MM/DD"}}}),this.settings.bottomOptions=Talent._.extend({},this.settings.bottomOptions,{isShowPrivateBtn:!1,isShowMessage:!1,isShowPackUpBtn:!1}),this.template=jst["task-create/task-create-customize-date-richeditor"],this.$el.addClass("tt-task-create-date-richeditor")),"workhour"==this.settings.templateName&&(this.settings=Talent._.extend({},this.settings,{privateRangeOptions:!1,extendPersonOptions:!1,applyUserOptions:!1,participatorOptions:!1,replaceOptions:!1,principalOptions:!1,classOptions:!1,nameOptions:{iconShow:!1,defaultText:"工作内容",showBorderLeft:!1},hourDateOptions:{showBorderLeft:!0},hourDropdownOpitons:{pos:"bottomRight"},dateOptions:{showBorderLeft:!0,pos:"bottomRight",isShowTab:!1},dataTimeRangeOptions:{isShowTab:!1,count:1,rangepickerOptions:{maxDate:moment(),isShowCycleView:!1,isShowLongView:!1}}}),this.settings.bottomOptions=Talent._.extend({},this.settings.bottomOptions,{isShowPrivateBtn:!1,isShowMessage:!1}),this.template=jst["task-create/task-create-customize-work-hour"])},_renderAll:function(){for(var a=this.settings,b=[{condition:a.classOptions,method:"_renderClassView"},{condition:a.principalOptions,method:"_renderPrincipleView"},{condition:a.hourDateOptions,method:"_renderWorkHourView"},{condition:a.participatorOptions,method:"_renderParticipatorsView"},{condition:a.applyUserOptions,method:"_renderApplyUserView"},{condition:a.extendPersonOptions,method:"_renderExternalPersonView"},{condition:a.replaceOptions,method:"_renderReplacerView"},{condition:a.nameOptions,method:"_renderTaskCreateNameView"},{condition:a.dateOptions,method:"_renderDateView"},{condition:a.richEditorOptions,method:"_renderRichEditor"}],c=0,d=b.length;c<d;c++)b[c].condition&&this[b[c].method]()},_getUserInfo:function(){var a=this,b=this.settings.toUserId;UserCollection.getData({ids:[b].join(",")}).done(function(c){var d=c[b];d&&a.model.set({principalUser:{Id:d.Id,Name:d.Name,Email:d.Email}})}).fail(function(a){})},_submitSuccess:function(){var a=this,b=this.localStorage,c=this.model.get("id"),d=this.model.get("publisher");b.removeItem("TaskCreateName_"+this.userInfo.Id+c),b.removeItem("TaskCreateDes_"+this.userInfo.Id+c),this._initData(),this.render();var e=this.bottomView.ui.pubBtn;d?this._tipMessage(e,{msg:"查看代他人发起的任务到任务中心-代发任务",sureText:"马上查看",cancelText:"我知道了",sure:function(){a.Dialog.close(),Talent.$(document).trigger("click")},container:a.$el,cancel:!0,pos:"topRight",sureLink:"#more/tasks?relation=4"}):TipDialogView(e,"已发布成功",{pos:"topRight",container:a.$el,className:"success"}),this.TAjaxIng=!1},_submitError:function(a){if(this.TAjaxIng=!1,a){TipDialogView(this.bottomView.ui.pubBtn,a,{pos:"topRight",container:this.$el})}},_invalidError:function(){this.ui.uxAddTaskContainer.css("border-color","red"),this.ui.uxAddTaskContainer.animate({"border-color":"#aaa"},2e3)},_onValueChange:function(){var a=this.model.get("code");this.settings.nameOptions&&(a=this.model.get("taskTitle")),this.bottomView&&this.bottomView.model.set("pubBtnIsActive",!!a)},_initData:function(){this.participatorCollection.reset([]);var a={participatorsCount:0,participators:"",principalUser:{Id:this.userInfo.Id,Name:this.userInfo.Name},applyUser:"",publisher:null,labelId:"",labelType:"",labelName:"",taskTitle:"",startDate:moment().format("YYYY/MM/DD 08:00"),endDate:moment().format("YYYY/MM/DD 18:00"),isCycle:!1,isLongTerm:!1,hourDate:"",minuteDate:"",extendUser:"",cycType:2,cycStartDay:"",cycEndDay:"",cycStartHour:"08",cycStartMinute:"00",cycEndHour:"18",cycEndMinute:"00",visibility:1,privateObjType:0,privateObjId:0,code:"",sendUserStatus:!1,file:[]},b=this.settings.dataTimeRangeOptions;b&&b.rangepickerOptions&&(a.startDate=b.rangepickerOptions.startDate||moment().format("YYYY/MM/DD 08:00"),a.endDate=b.rangepickerOptions.endDate||moment().format("YYYY/MM/DD 18:00"));var c=Talent._.extend({},a,this.initModelData);this.model.set(c,{silent:!0}),""!=this.settings.toUserId&&this._getUserInfo()},_synNum:function(){this.model.set("participatorsCount",this.participatorCollection.length)},_onSubmitForm:function(){var a=this,b=(this.model.toJSON(),this.formatPostData()),c=this.settings.participatorOptions.limit,d=this.bottomView.ui.pubBtn;if(!this.TAjaxIng){if(this.TAjaxIng=!0,this.model.get("participatorsCount")>c)return void TipDialogView(this.$('[data-name="set-pub-btn"]'),"参与者不能超过"+c+"人",{container:this.$el,pos:"topRight"});this.model.has("telephone")&&this.model.has("is_notify")&&this._addBothPhoneNum(),d.html("正在"+this.settings.bottomOptions.pubBtnText+"……"),this.settings.requestSubmit(b,this.model.toJSON()).done(function(){a._submitSuccess()}).fail(function(b){d.html(a.settings.bottomOptions.pubBtnText),a._submitError(b)})}},formatPostData:function(){var a=this.model.toJSON(),b={Participators:a.participatorsCount?this._getParticipators(this.participatorCollection.models):[],MessageUsers:[],TaskName:Talent._.escape(a.taskTitle),PrincipalUser:a.principalUser.Id,StartDate:a.startDate,EndDate:a.endDate,Importance:!1,Visibility:3==a.visibility?2:a.visibility,DepartmentId:a.privateObjId,Description:a.code,FileUrls:this._getFileUrls(),RemindTime:"",RemindContent:"",RemindType:0,hourDate:a.hourDate,minuteDate:a.minuteDate,extend_user:a.extendUser,CycType:"",CycStartDate:"",CycStartTime:"",CycEndDate:"",CycEndTime:"",ApplyUserId:a.applyUser&&a.applyUser.Id?a.applyUser.Id:0,IsLongTerm:a.isLongTerm,LabId:a.labelId,LabType:a.labelType,PublisherId:a.publisher?a.publisher.Id:0,documents:this._getYFYFile()};if(a.sendUserStatus){var c=this.model.get("principalUser"),d={Email:c.Email,Name:c.Name,Id:c.Id};b.MessageUsers=[d]}var e=a.cycStartHour+":"+a.cycStartMinute,f=a.cycEndHour+":"+a.cycEndMinute;return a.isCycle&&(b.CycType=a.cycType,b.CycStartDate=a.cycStartDay,b.CycStartTime=moment().format("YYYY/MM/DD")+" "+e,b.CycEndTime=moment().format("YYYY/MM/DD")+" "+f,b.CycEndDate=a.cycEndDay,b.IsLongTerm=!1),b},_addBothPhoneNum:function(){var a=this.model.get("telephone"),b=this.model.get("principalUser").Id,c=this.model.get("is_notify");(0,SMSCollection.postSmsNotifyAddNum)({phoneNum:a,to_user_id:b,is_notify:c})},_getFileUrls:function(){var a=[];return _.each(this.model.get("file"),function(b){b.DfsPath&&a.push(b.DfsPath)}),a.join(",")},_getYFYFile:function(){var a=[];return _.each(this.model.get("file"),function(b){if(b.isFromYFY){var c={};c.relatedFileId=b.id,c.name=b.FileName,c.size=b.size,c.fileType=b.MediaType,c.shareCode=b.share_code,b.imageUrl?c.thumbnailGenerated=!0:c.thumbnailGenerated=!1,c.documentSource=3,a.push(c)}}),a},_getParticipators:function(a){var b=new Talent.Collection([]);return _.each(a,function(a){if(a.get("departmentTag")){var a=new Talent.Model({Email:a.get("Name")+":"+a.get("id")+":dep_members",Name:a.get("Name"),Id:a.get("id")});b.add(a)}else{var a=new Talent.Model({Email:a.get("Email"),Name:a.get("Name"),Id:a.get("Id")});b.add(a)}}),b.toJSON()},_renderRichEditor:function(){var a=this,b=this.settings.richEditorOptions.defaultText;this.richEditor=new TRicheditorView({model:this.model,richEditorOptions:this.settings.richEditorOptions}),this.listenTo(this.model,"change:code",function(){var a=this.localStorage,b=this.ui.richEditorContent.html()||"",c=b.toLowerCase();/(<(img|table)[^>]*>)/g.test(c)||(c=c.replace(/(<[^>]*>(<[^>]*>|&nbsp;)?(<\/[^>]*>)?)|&nbsp;/g,""),""==(c=Talent.$.trim(c))&&(b="")),this.model.set("code",b),a.setItem("TaskCreateDes_"+this.userInfo.Id+this.model.get("id"),b),this.ui.richEditorDefaultLabel.html(""),this._changePubBtn()}),this.listenTo(this.richEditor,"focusEditor",function(){this.ui.richEditorBox.addClass("redactor_box_focus"),this.ui.uxRicheditor.addClass("has-focus"),this.bottomView&&this.bottomView.closeView()}),this.listenTo(this.richEditor,"unfocusEditor",function(){this.ui.richEditorBox.removeClass("redactor_box_focus"),this.ui.uxRicheditor.removeClass("has-focus"),this.trigger("desUnfocus",this.model.toJSON())}),this.listenTo(this.richEditor,"emptyCode",function(){this.model.set("code",""),this.ui.richEditorDefaultLabel.html(b)}),this.uxRicheditor.show(this.richEditor),this.ui.richEditorContent=this.$(".redactor_editor"),this.ui.richEditorBox=this.$(".redactor_box"),this.ui.richEditorBox.find("label").length||this.ui.richEditorBox.append("<label></label>"),this.ui.richEditorDefaultLabel=this.$(".redactor_box label");var c=this.localStorage,d=c.getItem("TaskCreateDes_"+this.userInfo.Id+this.model.get("id"));d?(this.richEditor.callMethods("setCode",d),this.model.set("code",d)):this.ui.richEditorDefaultLabel.html(b),this.ui.richEditorDefaultLabel.on("click",function(b){a.ui.richEditorContent.trigger("focus")})},_renderBottomView:function(){var a=this;this.bottomView=new TaskCreateBottomView({model:this.model,shape:this.settings.shape,bottomOptions:this.settings.bottomOptions,nameOptions:this.settings.nameOptions,privateRangeOptions:this.settings.privateRangeOptions,parentEl:this.$el}),this.listenTo(this.bottomView,"openAdvancedMode",function(a,b){b.open?this._hideAdvancedMode():this._showAdvancedMode()}),this.listenTo(this.bottomView,"onSubmitError",function(){this._invalidError()}),this.listenTo(this.bottomView,"onSubmit",function(a){this._onSubmitForm(a)}),this.listenTo(this.bottomView,"uploadClose",function(b){a.model.set("file",b)}),this.listenTo(this.bottomView,"resetData",function(){a.model.set(a.initData)}),this.bottomArea.show(this.bottomView)},_renderClassView:function(){this.classView=new TaskCreateClassView({model:this.model,parentEl:this.$el,classOptions:this.settings.classOptions,classDialogOptions:this.settings.classDialogOptions}),this.classArea.show(this.classView)},_renderTaskCreateNameView:function(){this.inputView=new TaskCreateNameView({model:this.model,parentEl:this.ui.uxAddTaskContainer,nameOptions:this.settings.nameOptions}),this.listenTo(this.inputView,"keyup",function(){this._changePubBtn()}),this.listenTo(this.inputView,"submit",function(){this._onSubmitForm()}),this.inputArea.show(this.inputView)},_changePubBtn:function(){if(!this.settings.nameOptions){var a=this.model.get("code");return void(a&&""!=a?this.bottomView.changePubBtnDisable(!0):this.bottomView.changePubBtnDisable(!1))}var b=Talent.$.trim(this.model.get("taskTitle"));b&&""!==b?this.bottomView.changePubBtnDisable(!0):this.bottomView.changePubBtnDisable(!1)},_renderPrincipleView:function(){this.principleView=new TaskCreatePrincipleView({model:this.model,principalOptions:this.settings.principalOptions}),this.listenTo(this.principleView,"changePrincipal",function(a){this._changePrincipalAfter(a.user),this.trigger("changePrincipal",this.model.toJSON())}),this.principleArea.show(this.principleView)},_changePrincipalAfter:function(a){if(!this.settings.applyUserOptions)return void this.model.set({principalUser:a});var b=this.model.get("applyUser");if(b&&b.Id==a.Id)return void this.model.set({applyUser:null,isCanReplace:!0,principalUser:a});var c=Talent._.filter(this.participatorCollection.toJSON(),function(b){return b.Id!=a.Id});this.participatorCollection.reset(c),this.model.set("participatorsCount",c.length),a.Id!=this.model.get("principalUser").Id&&this._getApprovalUserData(a.Id),this.model.set({principalUser:a,isCanReplace:a.Id!=this.userInfo.Id})},_renderDateView:function(){this.taskDateView=new TaskCreateDateView({model:this.model,parentEl:this.$el,dateOptions:this.settings.dateOptions,dataTimeRangeOptions:this.settings.dataTimeRangeOptions}),this.listenTo(this.taskDateView,"selectDate",function(a,b){this.trigger("selectDate",a,this.model.toJSON())}),this.taskDateArea.show(this.taskDateView)},_getCurrentUserApproval:function(){var a=this.model.get("applyUser"),b=this.model.get("principalUser").Id;this.settings.applyUserOptions&&!a&&this._getApprovalUserData(b)},_getApprovalUserData:function(a){var b=this;(0,OrgCollection.getToUserIdSuperior)({to_user_id:a}).done(function(a){b.model.set("applyUser",a)})},_renderWorkHourView:function(){this.workHourView=new TaskCreateWorkHourView({model:this.model,parentEl:this.$el,hourDateOptions:this.settings.hourDateOptions,hourDropdownOpitons:this.settings.hourDropdownOpitons}),this.workHourArea.show(this.workHourView)},_renderParticipatorsView:function(){this.participatorView=new TaskCreateParticipatorView({model:this.model,participatorOptions:this.settings.participatorOptions}),this.listenTo(this.participatorView,"toggleAddUser",function(){this._showAddUserArea()}),this.participatorArea.show(this.participatorView)},_showAddUserArea:function(){this.uxExtendArea.show(this.addUserCompositeView),this.ui.uxExtendArea.is(":hidden")||"extend"==this.currentExtend?(this._showExtendArea(),this.currentExtend="adduser"):this._hideExtendArea()},_renderAddUserCompositeView:function(){var a=this;this.addUserCompositeView=new TaskCreateAddUserCompositeView({collection:this.participatorCollection,model:this.model}),this.listenTo(this.addUserCompositeView,"selectUser",function(b){var c=0;Talent._.each(b,function(a){"department"==a.type?c+=a.totalUserCount:c++}),a.model.set("participatorsCount",c),a.participatorCollection.reset(b)}),this.listenTo(this.addUserCompositeView,"addSelf",function(){this.model.set({replaceRadioChecked:!0,publisher:this.model.get("principalUser")})})},_renderAddExtendUserItemView:function(){this.addExtendUserItemView||(this.addExtendUserItemView=new TaskCreateAddExtendUserView({model:this.model,parentEl:this.ui.uxExtendArea}))},_showExtendPersonArea:function(){this.uxExtendArea.show(this.addExtendUserItemView),this.ui.uxExtendArea.is(":hidden")||"adduser"==this.currentExtend?(this._showExtendArea(),this.addExtendUserItemView.ui.uxInput.focus(),this.currentExtend="extend"):this._hideExtendArea()},_hideExtendArea:function(){this.ui.uxExtendArea.hide(),this.ui.uxRicheditor.removeClass("has-extend")},_showExtendArea:function(){this.ui.uxExtendArea.show(),this.ui.uxRicheditor.addClass("has-extend")},_renderApplyUserView:function(){this.applyUserView=new TaskCreateApplyUserView({model:this.model,applyUserOptions:this.settings.applyUserOptions,parentEl:this.$el}),this.applyUserArea.show(this.applyUserView)},_renderExternalPersonView:function(){this.externalPersonView=new TaskCreateExternalPersonView({model:this.model,extendPersonOptions:this.settings.extendPersonOptions}),this.listenTo(this.externalPersonView,"showExtendPerson",function(){this._showExtendPersonArea()}),this.externalPersonArea.show(this.externalPersonView),this._renderAddExtendUserItemView()},_renderReplacerView:function(){this.replaceView=new TaskCreateReplaceView({model:this.model,replaceOptions:this.settings.replaceOptions,parentEl:this.$el}),this.listenTo(this.replaceView,"cancelReplace",function(){var a=this.participatorCollection.findWhere({Id:this.userInfo.Id});a&&this.participatorCollection.remove(a)}),this.listenTo(this.replaceView,"publisherChanged",function(){var a=this.model.get("publisher");this.participatorCollection.remove(this.participatorCollection.findWhere({Id:a.Id}))}),this.replaceArea.show(this.replaceView)},_showAdvancedMode:function(){this.ui.uxTools&&this.ui.uxTools.show(),this.ui.uxRicheditor&&this.ui.uxRicheditor.show()},_hideAdvancedMode:function(){this.ui.uxTools&&this.ui.uxTools.hide(),this.ui.uxRicheditor&&this.ui.uxRicheditor.hide(),this.ui.uxExtendArea.hide()},_tipMessage:function(a,b){var c={msg:"",kclass:"warn",leftBias:0,topBias:0,sureText:"确定",cancelText:"取消",sure:!1,cancel:!1,autoHide:!1,pos:"topCenter",quirkTheme:!1},d=Talent._.extend({},c,b);this.Dialog&&this.Dialog.close(),this.Dialog=new TDialogView({type:"tipsy",quirkTheme:d.quirkTheme,sureText:d.sureText,cancelText:d.cancelText,sure:d.sure,cancel:d.cancel,sureLink:d.sureLink}),d.container.append(this.Dialog.render().$el),this.Dialog.show(a,d.msg,{pos:d.pos,arrow:!1,autoHide:d.autoHide,className:d.kclass,leftBias:d.leftBias,topBias:d.topBias,container:d.container})},onClose:function(){Talent.$("body .redactor_dropdown").remove(),this.Dialog&&this.Dialog.close()}}),ExperienceView=Talent.Layout.extend({defaults:{id:"ExperienceView",requestSubmit:function(){return new Talent.$.Deferred}},template:jst["experience/experience"],className:"experience-view-twidget",initialize:function(a){this.settings=Talent._.extend({},this.defaults,a)},regions:{content:"[data-name=experience-contant]"},onRender:function(){},show:function(a,b){this._renderDialogView(a,b)},_renderDialogView:function(a,b){var c=this;this.dialogView||(this._renderTaskCreateView(),this.dialogView=new TDialogView({showClosed:!0,sure:!1,type:"dialog",cancel:!1}),this.listenTo(this.dialogView,"hide",function(){this.trigger("hide")}),b.container.append(this.dialogView.render().$el),this.dialogView.$el.on("mouseup",function(a){a.stopPropagation()}),Talent.$(document).off("mouseup.TT-Dialog-View-Confirm"),Talent.$(document).on("mouseup.TT-Dialog-View-Confirm",function(){Talent.$(document).off("mouseup.TT-Dialog-View-Confirm"),c.dialogView.close(),c.trigger("hide")})),this.dialogView.show(a,this.$el,b)},_renderTaskCreateView:function(){var a={privateRangeOptions:!1,extendPersonOptions:!1,applyUserOptions:!1,participatorOptions:!1,replaceOptions:!1,hourDateOptions:!1,principalOptions:!1,classOptions:!1,nameOptions:!1,dateOptions:!1,bottomOptions:{isShowFileUpload:!0,isShowPrivateBtn:!1,isShowMessage:!1,isShowPackUpBtn:!1,pubBtnText:"发布"},id:this.settings.id};a.requestSubmit=this.settings.requestSubmit,this.taskCreateView=new TaskCreateView(a),this.content.show(this.taskCreateView)},onClose:function(){this.dialogView&&this.dialogView.close()}}),TaskItemStatusView=Talent.ItemView.extend({template:jst["task-list/plan-item-status"],className:"tt_changestatusview",events:function(){var a={};return a["click li"]="changeStatusFun",a},templateHelpers:function(){var a=!1,b=this.model.get("isChildTask");return void 0!=typeof b&&(a=b),{isChildTask:a}},initialize:function(){var a=this;Talent.$(document).off("mouseup.Task-Item-Status-View"),Talent.$(document).on("mouseup.Task-Item-Status-View",function(){a.hide()}),this.$el.on("mouseup.Task-Item-Status-View",function(a){a.stopPropagation()})},changeStatusFun:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget),c=b.attr("status");this.hide(),this.model.set("status",parseInt(c)),this.trigger("click:status",this.model.toJSON())},show:function(a,b){Context.setPosition(a,this.$el,b),this.$el.css({position:"absolute","z-index":99}).show()},hide:function(){this.$el.hide()},onClose:function(){Talent.$(document).off("click.Task-Item-Status-View")}}),TaskListItemView=Talent.CompositeView.extend({tagName:"li",className:"planitem",itemViewContainer:".child-list",template:jst["task-list/task-list-item"],modelEvents:{change:"renderAfterCollectData","change:tasks":"_resetCollection"},ui:{kClass:".klass_ttpl"},events:function(){var a={};return a["mouseenter "+this.ui.kClass]="_mouseenterkKlass",a["mouseleave "+this.ui.kClass]="_mouseleavekKlass",a},initialize:function(a){this.i18n=Context.getI18n(),this.settings=Talent._.extend({},a),this.userInfo=Context.getUserInfo(),this.counter=this.model.get("counter"),this.tTipClass=!1,delete this.settings.model,delete this.settings.collection,this.settings.childrenModel[this.model.get("taskId")]=this.model;var b=this.model.get("tasks")||[],c=this.model.get("currentDeploy"),d=!!b.length&&this.settings.deployAll;this.model.set({isChildTask:this.settings.isChildTask,detail_checked:this.settings.compositeModel.get("detail_checked")&&this.settings.hasDetailodel,currentDeploy:void 0==c?d:c},{silent:!0});var e=Talent.Collection.extend({initialize:function(){this.model=Talent.Model.extend({idAttribute:"taskId"})}});0!=b.length&&(this.collection=new e(b))},templateHelpers:function(){var a=(this.model.toJSON(),{1:"进行中 ",2:"已完成",3:"已延迟",4:"已取消",0:"未开始",6:"暂停中",5:"未接受"}),b=this.model.get("status"),c=this.model.get("startDate"),d=this.model.get("deadLine"),e=this.model.get("time")?this.model.get("time"):"",f="";f="push-screen-id="+this.model.get("Id");var g=this.model.get("counter");g.workTimeTotal=this.counter.workTimeTotal;var h=Talent._.extend({},this.options,{loginUserId:Context.getUserInfo().Id,StatusTip:a[b],startDate:this.isThisYear(c),deadLine:this.isThisYear(d),fromNow:this._fromNow(d),createDate:this.isThisYear(this.model.get("createDate")),i18n:this.i18n,time:e,url:f,context:Context,counter:g,taskName:this.model.get("taskName")});return delete h.isChildTask,delete h.deployAll,h},onRender:function(){if(this.$(".plan_list_li").first().addClass(this.model.get("currentDeploy")?"border-over":""),this.model.get("isChildTask")){var a=this.model.collection,b=a.length,c=this.model,d=a.indexOf(c);d==b-1&&this.$(".border-left").first().addClass("last")}},_resetCollection:function(){var a=this.model.get("tasks")||[],b=Talent.Collection.extend({initialize:function(){this.model=Talent.Model.extend({idAttribute:"taskId"})}});a.length>0&&(this.collection=new b(a))},_mouseenterkKlass:function(a){var b=this,c=Talent.$(a.currentTarget),d=this.model.get("labelId");d&&"0"!=d&&(c.data("tipsy")?this.tTipClass||c.tipsy("show"):17!=this.model.get("labelType")?(c.tipsy({gravity:$.fn.tipsy.autoNS,html:!0,trigger:"manual",title:function(){return'<div class="class_tip_content">'+b.model.get("labelName")+"</div>"}}),c.tipsy("show")):(this.tTipClass=!0,LableCollection.getLabelFullName({lableId:d}).done(function(a){b.tTipClass=!1,c.tipsy({gravity:$.fn.tipsy.autoNS,html:!0,trigger:"manual",title:function(){return'<div class="class_tip_content">'+a+"</div>"}}),c.tipsy("show")})))},_mouseleavekKlass:function(a){var b=Talent.$(a.currentTarget);b.data("node")&&b.tipsy("hide")},isThisYear:function(a){if(!a)return"";var b=moment().year(),a=new Date(a);return b==moment(a).format("YYYY")?moment(a).format("MM/DD"):moment(a).format("YYYY/MM/DD")},_fromNow:function(a){var b=moment().year(),c=moment().month()+1,d=moment().date(),a=new Date(a),e=moment(a).format("YYYY"),f=moment(a).format("MM"),g=moment(a).format("DD");return b==e&&c==f?g-d+1:999},itemViewOptions:function(){return Talent._.extend({},this.settings,{isShowKclass:!1,isChildTask:!0})},renderAfterCollectData:function(){this.getCollectionData(),this.render()},getCollectionData:function(){if(this.collection.length>0){this.children.each(function(a){a.getCollectionData()});var a=this.collection.toJSON();this.model.set({tasks:a},{silent:!0})}}}),TaskListView=Talent.CompositeView.extend({defaults:{isShowKclass:!0,isShowOwnerTag:!1,quirkOwnerTag:!1,isShowStar:!0,isShowSetRemind:!1,objType:7,isShowDelete:!1,isChildTask:!1,deployAll:!0,pageSize:50,isShowPercent:!1,isShowCommentTotal:!0,isShowTaskTotal:!0,isShowExperienceTotal:!0,isShowBusinessTripTotal:!0,isShowMeetingTotal:!0,isShowMoreBtn:!1,isShowToggle:!1,hasDetailodel:!1,addChildViewTop:!1,data:!1,classComponentViewOptions:{},requestData:function(a){return new Talent.$.Deferred}},itemView:TaskListItemView,tagName:"div",className:"tt_planlist",template:jst["task-list/task-list"],itemViewContainer:".list-container",currentPage:1,ui:{submit:".submint",planitem:".planitem",notice:'span[data-name="notice_plan"]',done:".status_ttpl",setMark:'span[data-name="set-mark"]',deletePlan:'span[data-name="plan-delete"]',tipsyNode:"[original-title]",iconCycle:'span[data-name="task-cycle"]',updateKlass:'[data-name="update-klass"]',taskName:'[data-name="taskName"]',packup:'[data-name="packup"]',showMore:'[data-name="showmore"]'},modelEvents:{"change:detail_checked":"render"},events:function(){var a={};return a["click "+this.ui.notice]="_bindNotice",a["click "+this.ui.done]="_changeStatus",a["click "+this.ui.setMark]="_setMark",a["click "+this.ui.deletePlan]="_checkDelete",a["mouseup "+this.ui.deletePlan]="_stopMouseUpEvent",a["click "+this.ui.updateKlass]="_clickUpdateKlass",a["mouseup "+this.ui.updateKlass]="_stopMouseUpEvent",a["click "+this.ui.taskName]="_onClickName",a["mouseenter "+this.ui.tipsyNode]="_showTipHandler",a["mouseleave "+this.ui.tipsyNode]="_hideTipHandler",a["mouseenter "+this.ui.iconCycle]="_showTitle",a["mouseleave "+this.ui.iconCycle]="_hideTipHandler",a["click "+this.ui.packup]="_togglePackHandler",a["click "+this.ui.showMore]="_showMore",a},initialize:function(a){var b=this;this.childrenModel={},this.settings=_.extend({},this.defaults,a,{childrenModel:this.childrenModel,compositeModel:this.model});var c=this.options.classComponentViewOptions||{};this.settings.classComponentViewOptions=Talent._.extend({},this.defaults.classComponentViewOptions,c),this._customSettings(),this.settings.addChildViewTop&&(this.addChildView=this.addChildViewTop),delete this.settings.model,delete this.settings.collection,Talent.app.vent.on("GlobalTaskListItemModel",function(a,c){var d=b.childrenModel[a];d&&d.set(c)}),this._initData(),this.model.set("currentPage",this.currentPage)},_customSettings:function(){var a=Context.getGlobal("tenant_function");if(a&&"object"==typeof a){var b=a.IsUseMeet,c=a.IsUseBusinessTrip;this.settings.isShowMeetingTotal=b,this.settings.isShowBusinessTripTotal=c}},_initData:function(){if(!this.settings.data)return void this._requestData().done(function(a){self._addDataToCollection(a)});this._addDataToCollection(this.settings.data)},_requestData:function(){var a=new Talent.$.Deferred;return this.settings.requestData(this.model.toJSON()).done(function(b){a.resolve(b)}).fail(function(b){a.reject(b)}),a},_addDataToCollection:function(a){var a=a||options.data,b=Talent.Collection.extend({initialize:function(){this.model=Talent.Model.extend({idAttribute:"taskId"})}});this.collection=new b;var a=this._formatData(a||[]);this.collection.reset(a)},itemViewOptions:function(){return delete this.settings.emptyView,this.settings},addChildViewTop:function(a,b,c){var d=this.getItemView(a),e=this.collection.indexOf(a),f=Marionette.getOption(this,"itemViewOptions");_.isFunction(f)&&(f=f.call(this,a,e));var g=this.buildItemView(a,d,f);this.addChildViewEventForwarding(g),this.children.add(g),g.render(),this.$el.find(this.itemViewContainer).children("li:first-child").length?this.$el.find(this.itemViewContainer).children("li:first-child").before(g.el):this.$el.find(this.itemViewContainer).append(g.el),this._isShown&&Marionette.triggerMethod.call(g,"show"),this.triggerMethod("after:item:added",g)},onRender:function(){this.$(".planitem").first().css({borderTop:"none"}),this.settings.isShowMoreBtn||this.hideMoreBtn()},_showMore:function(a){var b=this.$(a.currentTarget),c=this;this.isLoading||(b.find("span").text("加载中..."),this.currentPage+=1,this.model.set("currentPage",this.currentPage),this.settings.data?this.trigger("showMore",b,this.currentPage,this._formatData):this._requestData().done(function(a){var a=c._formatData(a);c.collection.add(a),c.trigger("showMore",b,this.currentPage,this._formatData)}),this.isLoading=!0)},loadingCompelte:function(){this.isLoading=!1,this.ui.showMore.find("span").text("查看更多")},hideMoreBtn:function(){this.ui.showMore.hide()},showMoreBtn:function(){this.ui.showMore.show()},_formatData:function(a){function b(c){Talent._.each(c,function(c){var d=c.taskId;if(d){var e=Talent._.where(a,{parentTaskId:d});if(e=Talent._.compact(e),!e.length)return void(c.tasks=[]);c.tasks=e,Talent._.each(e,function(a){a.level=c.level+1}),b(e)}})}var a=a||[];if(a.length){var c=Talent._.where(a,{parentTaskId:null})||[];return Talent._.each(c,function(a){a.level=1}),b(c),c}},_togglePackHandler:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget),c=this._getChildModelByNode(b),d=c.toJSON();d.tasks&&d.tasks.length?c.set({currentDeploy:!d.currentDeploy}):this.trigger("openSub",b,c,this._formatData)},_setMark:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget),c=this,d=this._getChildModelByNode(b);if(d){var e=!d.get("isMark"),f=d.get("taskId");if(e)var g=1;else var g=2;PlanCollection.postPlanSetMark({plan_id:f,type:g}).done(function(a){Talent.$(b).tipsy("hide"),d.set("isMark",e)}).fail(function(a){TipDialogView(b,a,{container:c.$el,topBias:15,pos:"bottomRight",className:"warn"})})}},_bindNotice:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget);b.find(".notice");this.setNoticeView&&this.setNoticeView.close(),this.setNoticeView=new SetNoticeView,this.listenTo(this.setNoticeView,"cancelRemind",function(){this._getChildModelByNode(b).set("isRemind",!1)}),this.listenTo(this.setNoticeView,"sure",function(a,c){this._getChildModelByNode(b).set({isRemind:!0,time:Context.formatDate(c.time)})}),this.$el.append(this.setNoticeView.render().el),this.setNoticeView.setPosition(b,{leftBias:5,topBias:8,container:this.$el,pos:"bottomRight",caretBias:229})},_changeStatus:function(a){a.stopPropagation();var b=this,c=Talent.$(a.currentTarget),d=this._getChildModelByNode(c);d.get("editStatusable")&&(this.planItemStatusView&&this.planItemStatusView.close(),this.planItemStatusView=new TaskItemStatusView({model:new Talent.Model({status:d.get("status"),id:d.get("taskId"),isChildTask:d.get("isChildTask")})}),this.listenTo(this.planItemStatusView,"click:status",function(a){d.get("status")!=a.status&&PlanCollection.PutUpdateStatus({plan_item_id:a.id,Status:a.status}).done(function(e){2==a.status&&d.get("isAddExperience")?b._renderSummaryView(c,d,a):d.set("status",a.status)}).fail(function(a){TipDialogView(c,a,{container:b.$el,topBias:-30,className:"warn"}),d.set("isApply",!0)})}),this.planItemStatusView.render(),this.$el.append(this.planItemStatusView.$el),this.planItemStatusView.show(c,{container:this.$el,pos:"bottomCenter",topBias:8}))},_stopMouseUpEvent:function(a){a.stopPropagation()},_checkDelete:function(a){var b=this,c=Talent.$(a.currentTarget);ConfirmDialogView(c,"此操作不可恢复，您确定删除吗？",{pos:"bottomRight",type:"tipsy",className:"ask",container:this.$el,sure:function(){var a=c.attr("data-id");b._sureDelFun(c,a)}})},_sureDelFun:function(a,b){var c=this,d=this.childrenModel[b];PlanCollection.deleteData({plan_item_id:b}).done(function(){d.collection.remove(d),c.trigger("delete",a,d)}).fail(function(b){TipDialogView(a,b,{container:c.$el,topBias:-25,pos:"bottomRight",className:"warn"})})},_clickUpdateKlass:function(a){a.stopPropagation();var b=Talent.$(a.currentTarget),c=this._getChildModelByNode(b),d=b.attr("data-id"),e=b.attr("data-type"),f=b.attr("data-lab");this._renderKlassView(b,"update",{id:d,label_type:e||0,label_id:f||null,isShowWorkLable:c.get("IsShowWorkLable"),model:c})},_renderKlassView:function(a,b,c){var d=c&&c.label_type&&0!=c.label_type?c.label_type:17,e=this.settings.classComponentViewOptions;e.model=new Talent.Model({type:d}),this.classComponentView&&this.classComponentView.close(),this.classComponentView=new ClassComponentView(e),this.listenTo(this.classComponentView,"submit",function(d){0!=d.id&&("update"==b?this._requestUpdateKlass({planItem_id:c.id,label_type:d.type,label_id:d.id,label_name:d.name},a):c.model.set({label_type:d.type,label_id:d.id,label_name:d.name}))}),this.listenTo(this.classComponentView,"new",function(a){LableCollection.postAddLableData({obj_id:this.userInfo.Id,obj_type:"1",name:a.name,parent_id:a.parent_id}).done(function(b){a.call(b)})}),this.listenTo(this.classComponentView,"reset",function(){c.label_type&&this._requestUpdateKlass({planItem_id:c.id,label_type:0,label_id:null,label_name:""},a)}),this.$el.append(this.classComponentView.render().el),this.classComponentView.show(a,{container:this.$el,pos:"bottom",leftBias:-1})},_requestUpdateKlass:function(a,b){var c=this,d=a.planItem_id,e=a.label_id,f=a.label_type,g=a.label_name;PlanCollection.postUpdateLable({planItem_id:d,lable_id:e,lable_type:f}).done(function(a){c._getChildModelByNode(b).set({labelId:e,labelType:f,labelName:g})}).fail(function(a){TipDialogView(b,a,{container:c.$el,topBias:-30})})},_renderSummaryView:function(a,b,c){var d=this;this.summaryView&&this.summaryView.close(),this.summaryView=new ExperienceView({id:b.get("taskId"),requestSubmit:function(a,e){var f=new Talent.$.Deferred;return ExperienceCollection.addShare({ObjId:b.get("taskId"),ObjType:7,Content:e.code,FileUrls:a.FileUrls,StartDate:e.startDate,EndDate:e.endDate,DocumentModels:a.documents}).done(function(a){setTimeout(function(){d.summaryView.close()},1e3);var e=Talent._.clone(b.get("counter"));e.experienceTotal+=1,b.set({counter:e}),b.set("status",c.status),f.resolve(a)}).fail(function(a){f.reject(a)}),f}}),this.listenTo(this.summaryView,"hide",function(){b.set("status",c.status)}),this.$el.append(this.summaryView.render()),this.summaryView.show(a,{container:this.$el,topBias:-30})},_showTipHandler:function(a){var b=Talent.$(a.currentTarget);b.data("tipsy")||b.tipsy({gravity:$.fn.tipsy.autoNS,tirgger:"manual"}),b.tipsy("show")},_hideTipHandler:function(a){Talent.$(a.currentTarget).tipsy("hide")},_showTitle:function(a){a.stopPropagation();var b=this,c=Talent.$(a.currentTarget),d=c.attr("data-cys");if(c.data("tipsy"))return void c.tipsy("show");TaskCollection.getCycleTask({cycle_id:d}).done(function(a){var b=a.CycType,d=a.CycStartDate,e=a.CycEndDate,f={0:"零",1:"一",2:"二",3:"三",4:"四",5:"五",6:"六",7:"七"},g={1:"每天",2:"每个工作日",3:"每周"+(d==e?f[d]:f[d]+"-"+f[e]),4:"每月"+(d==e?d:d+"-"+e)};c.tipsy({gravity:$.fn.tipsy.autoNS,title:function(){return g[b]},trigger:"manual"}),c.tipsy("show")}).fail(function(a){TipDialogView(b.ui.icon_cycle,a,{container:b.$el,topBias:-15})})},_getChildModelByNode:function(a){var b=a.attr("data-id");if(!b){b=JSON.parse(a.attr("data")).objid}return this.childrenModel[b]},_onClickName:function(a){a.stopPropagation(),a.preventDefault();var b=this,c=b.$(a.currentTarget),d=c.attr("id"),e=this.childrenModel[d];Talent.app.vent.trigger("global-pull-screen",d,"task",e)},onClose:function(){Talent.$(document).off("click.Plan-List-Composite:PlanSetNotice"),this.planItemStatusView&&this.planItemStatusView.close(),this.classComponentView&&this.classComponentView.close(),this.summaryView&&this.summaryView.close(),Talent.app.vent.off("GlobalTaskListItemModel")}}),titaWidget={TaskListView:TaskListView};return titaWidget}),function(a){a.fn.extend({slimScroll:function(b){var c={width:"auto",height:"250px",size:"7px",color:"#000",position:"right",distance:"1px",start:"top",opacity:.4,alwaysVisible:!1,disableFadeOut:!1,railVisible:!1,railColor:"#333",railOpacity:.2,railDraggable:!0,railClass:"slimScrollRail",barClass:"slimScrollBar",wrapperClass:"slimScrollDiv",allowPageScroll:!1,wheelStep:20,touchScrollStep:200,borderRadius:"7px",railBorderRadius:"7px"},d=a.extend(c,b);return this.each(function(){function c(b){if(j){var b=b||window.event,c=0;b.wheelDelta&&(c=-b.wheelDelta/120),b.detail&&(c=b.detail/3);var f=b.target||b.srcTarget||b.srcElement;a(f).closest("."+d.wrapperClass).is(v.parent())&&e(c,!0),b.preventDefault&&!u&&b.preventDefault(),u||(b.returnValue=!1)}}function e(a,b,c){u=!1;var e=a,f=v.outerHeight()-A.outerHeight();if(b&&(e=parseInt(A.css("top"))+a*parseInt(d.wheelStep)/100*A.outerHeight(),e=Math.min(Math.max(e,0),f),e=a>0?Math.ceil(e):Math.floor(e),A.css({top:e+"px"})),p=parseInt(A.css("top"))/(v.outerHeight()-A.outerHeight()),e=p*(v[0].scrollHeight-v.outerHeight()),c){e=a;var g=e/v[0].scrollHeight*v.outerHeight();g=Math.min(Math.max(g,0),f),A.css({top:g+"px"})}v.scrollTop(e),v.trigger("slimscrolling",~~e),h(),i()}function f(a){window.addEventListener?(a.addEventListener("DOMMouseScroll",c,!1),a.addEventListener("mousewheel",c,!1)):document.attachEvent("onmousewheel",c)}function g(){o=Math.max(v.outerHeight()/v[0].scrollHeight*v.outerHeight(),s),A.css({height:o+"px"});var a=o==v.outerHeight()?"none":"block";A.css({display:a})}function h(){if(g(),clearTimeout(m),p==~~p){if(u=d.allowPageScroll,q!=p){var a=0==~~p?"top":"bottom";v.trigger("slimscroll",a)}}else u=!1;if(q=p,o>=v.outerHeight())return void(u=!0);A.stop(!0,!0).fadeIn("fast"),d.railVisible&&z.stop(!0,!0).fadeIn("fast")}function i(){d.alwaysVisible||(m=setTimeout(function(){d.disableFadeOut&&j||k||l||(A.fadeOut("slow"),z.fadeOut("slow"))},1e3))}var j,k,l,m,n,o,p,q,r="<div></div>",s=30,u=!1,v=a(this);if(v.parent().hasClass(d.wrapperClass)){var w=v.scrollTop();if(A=v.closest("."+d.barClass),z=v.closest("."+d.railClass),g(),a.isPlainObject(b)){if("height"in b&&"auto"==b.height){v.parent().css("height","auto"),v.css("height","auto");var x=v.parent().parent().height();v.parent().css("height",x),v.css("height",x)}if("scrollTo"in b)w=parseInt(d.scrollTo);else if("scrollBy"in b)w+=parseInt(d.scrollBy);else if("destroy"in b)return A.remove(),z.remove(),void v.unwrap();e(w,!1,!0)}}else if(!(a.isPlainObject(b)&&"destroy"in b)){d.height="auto"==d.height?v.parent().height():d.height;var y=a(r).addClass(d.wrapperClass).css({position:"relative",overflow:"hidden",width:d.width,height:d.height});v.css({overflow:"hidden",width:d.width,height:d.height});var z=a(r).addClass(d.railClass).css({width:d.size,height:"100%",position:"absolute",top:0,display:d.alwaysVisible&&d.railVisible?"block":"none","border-radius":d.railBorderRadius,background:d.railColor,opacity:d.railOpacity,zIndex:90}),A=a(r).addClass(d.barClass).css({background:d.color,width:d.size,position:"absolute",top:0,opacity:d.opacity,display:d.alwaysVisible?"block":"none","border-radius":d.borderRadius,BorderRadius:d.borderRadius,MozBorderRadius:d.borderRadius,WebkitBorderRadius:d.borderRadius,zIndex:99}),B="right"==d.position?{right:d.distance}:{left:d.distance};z.css(B),A.css(B),v.wrap(y),v.parent().append(A),v.parent().append(z),d.railDraggable&&A.bind("mousedown",function(b){var c=a(document);return l=!0,t=parseFloat(A.css("top")),pageY=b.pageY,c.bind("mousemove.slimscroll",function(a){currTop=t+a.pageY-pageY,A.css("top",currTop),e(0,A.position().top,!1)}),c.bind("mouseup.slimscroll",function(a){l=!1,i(),c.unbind(".slimscroll")}),!1}).bind("selectstart.slimscroll",function(a){return a.stopPropagation(),a.preventDefault(),!1}),z.hover(function(){h()},function(){i()}),A.hover(function(){k=!0},function(){k=!1}),v.hover(function(){j=!0,h(),i()},function(){j=!1,i()}),v.bind("touchstart",function(a,b){a.originalEvent.touches.length&&(n=a.originalEvent.touches[0].pageY)}),v.bind("touchmove",function(a){if(u||a.originalEvent.preventDefault(),a.originalEvent.touches.length){e((n-a.originalEvent.touches[0].pageY)/d.touchScrollStep,!0),n=a.originalEvent.touches[0].pageY}}),g(),"bottom"===d.start?(A.css({top:v.outerHeight()-A.outerHeight()}),e(0,!0)):"top"!==d.start&&(e(a(d.start).position().top,null,!0),d.alwaysVisible||A.hide()),f(this)}}),this}}),a.fn.extend({slimscroll:a.fn.slimScroll})}(jQuery),define("$.slimscroll",function(){}),define("pullScreenWidget",["talent","UserSelector","$.tipsy","moment","richeditor","Uploader","$.slimscroll"],function(Talent,UserSelector,Ttipsy,moment,Richeditor,Uploader,SlimScroll){function PullScreenView(a){return PullScreenLayoutView.instance||(PullScreenLayoutView.instance=new PullScreenLayoutView(a)),PullScreenLayoutView.instance}var jst=function(){return this.JST=this.JST||{},this.JST["pull-screen/push-screen-app"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+="";return __p},this.JST["pull-screen/push-screen-layout"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\t\n\t<div class="action" data-name="pull-screen-action">\n\t\t',showFullScreenButton&&(__p+='\n\t\t<a href="javascript:void(0);" class="open-screen" data-name="open-full-screen-button" target="_blank">全屏查看</a>\n\t\t'),__p+='\n\t\t<span class="close-pull-screen" data-name="pull-screen-close"></span>\n\t</div>\n\t<div data-name="pull-screen-content">\n\t\t<iframe src="" width="100%" frameborder="0"  style="display:none" data-name="pull-screen-iframe"></iframe>\n\t</div>\n\t<div data-name="pull-screen-load"></div>\n';return __p},this.JST["task-detail/error-layout-message"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="tt_errotracker">\n\t<div class="noaccess clearfix">\n\t\t<div class="img_na"></div>\n\t\t<div class="text_ma">\n\t\t\t<div class="workhi_tma">\n\t\t\t\t<br/><br/>\n\t\t\t\t'+(null==(__t=content)?"":__t)+"\n\t\t\t</div>\n\t\t\t",subContent&&(__p+='\n\t\t\t<div class="reason_tma">'+(null==(__t=subContent)?"":__t)+"</div>\n\t\t\t"),__p+="\n\t\t</div>\n\t</div>\n</div>";return __p},this.JST["task-detail/select-plan-task-relate"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="plan-task-list-dialog">\n\t<div class="title">关联任务</div>\n\t\n\t<div class="select-list" data-name="plan-active-list">\n\t\t<div class="item-select" data-name="plan-relate-year">\n\t\t\t<span class="arrow-drop"></span>\n\t\t\t<label>'+(null==(__t=activeYear.GroupName)?"":__t)+'</label>\n\t\t\t<ul class="list-data" data-name="plan-relate-year-list">\n\n\t\t\t\t',_.each(YearList,function(a){__p+="\n\t\t\t\t\t<li ",yearId==a.GroupId&&(__p+='class="active"'),__p+=' id="'+(null==(__t=a.GroupId)?"":__t)+'">'+(null==(__t=a.GroupName)?"":__t)+"\n\t\t\t\t\t</li>\n\t\t\t\t"}),__p+='\n\t\t\t</ul>\n\t\t</div>\n\t\t<div class="item-select" data-name="plan-relate-month">\n\t\t\t<span class="arrow-drop" ></span>\n\t\t\t<label>'+(null==(__t=activeMonth.TagName)?"":__t)+'</label>\n\t\t\t<ul class="list-data" data-name="plan-relate-month-list">\n\t\t\t\t',_.each(monthList,function(a){__p+="\n\t\t\t\t\t<li ",monthId==a.TagId&&(__p+='class="active" '),__p+=' id="'+(null==(__t=a.TagId)?"":__t)+'">'+(null==(__t=a.TagName)?"":__t)+"</li>\n\t\t\t\t"}),__p+='\n\t\t\t</ul>\n\t\t</div>\n\t\t<div class="item-select" data-name="plan-relate-week">\n\t\t\t<span class="arrow-drop" ></span>\n\t\t\t<label>'+(null==(__t=activeWeek.Name)?"":__t)+"</label>\n\t\t\t<ul class=\"list-data\" data-name='plan-relate-week-list'>\n\t\t\t\t",_.each(weekList,function(a){__p+="\n\t\t\t\t\t<li ",weekId==a.PlanTableId&&(__p+='class="active" '),__p+=' id="'+(null==(__t=a.PlanTableId)?"":__t)+'">'+(null==(__t=a.Name)?"":__t)+"</li>\n\t\t\t\t"}),__p+='\n\t\t\t</ul>\n\t\t</div>\n\n\t\t<div class="item-select task-select" data-name="plan-relate-task">\n\t\t\t<span class="arrow-drop" data-name="plan-relate-task-drop"></span>\n\t\t\t<label data-name="plan-relate-task-label">正在加载…</label>\n\t\t\t<div data-name="plan-relate-task-list"></div>\n\t\t</div>\t\n\t</div>\n\t\n\t<div class="uibutton clearfix">\n\t\t',isShowButtomReset&&(__p+='\n\t\t<a data-name="task-relate-reset" href="javascript:void(0);" class="btn btn-cancel reset-button">取消关联</a>\n\t\t'),__p+='\n\t\t<a data-name="task-relate-sure" href="javascript:void(0);" class="btn btn-sure">确定</a>\n\t\t<a data-name="task-relate-cancel" href="javascript:void(0);" class="btn btn-cancel">取消</a>\n\t</div>\n</div>\n';return __p},this.JST["task-detail/share-range-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<a href="/u/'+(null==(__t=User.Id)?"":__t)+'">\n\n\t',0==User.UserAvatar.HasAvatar?__p+="\n\t\t\t\t\t\t\t\t\n\t\t"+(null==(__t=_.convertImage({className:"",src:User.Avatar,size:30,shape:"radius",name:User.Name,bgColor:User.UserAvatar.Color}))?"":__t)+"\n\t":__p+='\n\t\t<img class="radius_img30" alt="'+(null==(__t=User.Name)?"":__t)+'" src="'+(null==(__t=User.UserAvatar.Small)?"":__t)+'">\n\t',__p+="\n\t",0==Type&&(__p+='<span class="del_sr" id="'+(null==(__t=User.Id)?"":__t)+'" data-name="delete"><i class="ico"></i></span>'),__p+="\n</a>\n\n";return __p},this.JST["task-detail/share-range"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n<h4>"+(null==(__t=title)?"":__t)+'</h4>\n<ul class="list_sr">\n\t',isEdit&&(__p+='\n\t<li class="button_sr"><a href="javascript:void(0);" title="" class="add_sr" data-name="add"><span></span></a></li>\n\t'),__p+="\n</ul>\n";return __p},this.JST["task-detail/task-accept-pop"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="title">'+(null==(__t=title)?"":__t)+'</div>\n\n<div class="pop_container">\n\t<h2>所属分类/项目:</h2>\n\t\n\t<div class="classes">\n\t\t',4==labelType&&(__p+='\n\t\t\t<span class="icon-work-small"></span>\n\t\t'),__p+="\n\t\t<span>"+(null==(__t=labelName)?"":__t)+'</span>\n\t</div>\n</div>\n<div class="pop_container start-end-date" data-name="task-detail-accept-date-box">\n\t<h2>起止时间:</h2>\n\t<div class="input-default">\n\t\t',classEditable?(__p+='\n\t\t\t<input type="text" title="" value="'+(null==(__t=startDate)?"":__t)+" - "+(null==(__t=isLongTerm?"长期":endDate)?"":__t)+'" data-name="task-detail-accept-date" ',cycleId>0&&(__p+='style="color:#aaa;"'),__p+=">\n\t\t"):(__p+='\n\t\t\t<span class="input" ',cycleId>0&&(__p+='style="color:#aaa;"'),__p+=">\n\t\t\t\t"+(null==(__t=startDate)?"":__t)+" - "+(null==(__t=isLongTerm?"长期":endDate)?"":__t)+'"\n\t\t\t</span>\n\t\t'),__p+='\n\t</div>\n</div>\n\n<div class="uibutton">\n\t<a href="javascript:void(0);" class="btn btn-sure sure_dialog" data-name="task-detail-accept-sure"><span>确定</span></a>\n\t<a href="javascript:void(0);" class="btn btn-cancel cancel_dialog" data-name="task-detail-accept-cancel">取消</a>\n</div>\n';return __p},this.JST["task-detail/task-action"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n",isApply&&(__p+='\n\t<span class="icon-approval-ing"></span>\n'),__p+='\n<ul class="btnlist_pdtb">\n\t',editStatusable?__p+='\n\t\t<li class="plandetail_status" data-name="task-set-status">\n\t\t\t<a href="javascript:void(0);" class="status_bpdtb tt_actionstatus_'+(null==(__t=status)?"":__t)+'" original-title="'+(null==(__t=StatusTip)?"":__t)+'">\n\t\t\t\t<span class="ico"></span>\n\t\t\t</a>'+(null==(__t=StatusTip)?"":__t)+"\n\t\t</li>\n\t":__p+='\n\t\t<li class="past_pdtb">\n\t\t\t<a href="javascript:void(0);" class="status_bpdtb tt_actionstatus_'+(null==(__t=status)?"":__t)+'_disable" original-title="'+(null==(__t=StatusTip)?"":__t)+'">\n\t\t\t\t<span class="ico"></span>\n\t\t\t\t</a>'+(null==(__t=StatusTip)?"":__t)+"\n\t\t</li>\n\t",__p+="\n\t",deleteable&&(__p+='\n\t\t<li>\n\t\t\t<a href="javascript:void(0);" class="del_bpdtb" original-title="删除" data-name="set-task-delete"></a>\n\t\t</li>\n\t'),__p+="\n\t",isAccept&&2==relation&&(__p+='\n\t\t<li>\n\t\t\t<span class="icon-quit-task" original-title="退出任务" data-name="quit-task"></span>\n\t\t</li>\n\t'),__p+='\n\n\t<li>\n\t\t<a href="javascript:void(0);" class="icon-action-alarm-clock-over ',isRemind&&(__p+="icon-action-alarm-clock-highlight-over"),__p+='" data=\'{"objid":"'+(null==(__t=taskId)?"":__t)+'","objType":"7"}\' data-name="set-task-notice" original-title="',isRemind?__p+="已设提醒":__p+="设置提醒",__p+='"></a>\n\t</li>\n\t',0!=relation&&6!=relation&&4!=relation&&5!=relation||(__p+='\n\t\t<li>\n\t\t\t<span class="icon-task-'+(null==(__t=6==relation?"followed":"follow")?"":__t)+'" original-title="'+(null==(__t=6==relation?"取消关注":"关注")?"":__t)+'" data-name="follow-btn"></span>\n\t\t</li>\n\t'),__p+="\n\t",1!=relation&&2!=relation&&3!=relation||(__p+='\n\t\t<li> \n\t\t\t<a href="javascript:void(0);" class="icon-action-star-over \t',isMark&&(__p+="icon-action-star-highlight-over"),__p+='" data-name="set-task-star" original-title="',isMark?__p+="取消星标":__p+="标为星标",__p+='"></a>\n\t\t</li>\n\t'),__p+="\n</ul>";return __p},this.JST["task-detail/task-add-do"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)isShowTask&&(__p+='\n<a href="javascript:void(0)" class="btn" data-name="distribute_task">分解'+(null==(__t=i18n.task_1)?"":__t)+"</a>\n"),__p+="\n",isShowWorkTime&&(__p+='\n<a href="javascript:void(0)" class="btn" data-name="task-work-hour">添加工时</a>\n'),__p+="\n",isShowMeeting&&(__p+='\n\t<a href="javascript:void(0)" class="btn" data-name="task-meet">添加会议</a>\n'),__p+="\n",isShowTravel&&(__p+='\n\t<a href="javascript:void(0)" class="btn" data-name="task-travel">添加出差</a>\n'),__p+="\n",isShowShare&&(__p+='\n<a href="javascript:void(0)" class="btn" data-name="task-share">添加心得</a>\n'),__p+="\n";return __p},this.JST["task-detail/task-apply-detail"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="task-detail-moduletitle">\n\t<div class="icon">\n\t\t<span class="icon-chapter-highlight icon-dt"></span>\n\t\t<em class="caret"></em>\n\t</div>\n\t<div class="text">审批(<span data-name="task-detail-apply-total">'+(null==(__t=total)?"":__t)+'</span>)</div>\n</div>\n\n\n<div class="module-content">\n\t<div data-name="task-detail-apply-list"></div>\n</div>\t\n';return __p},this.JST["task-detail/task-base-info"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)cycleId&&""!=cycleId&&(__p+='\n\t<div class="base-item" data-name="cycle-area">\n\t\t<div class="left-eb">\n\t\t\t<span class="icon-cycle ico-eb"></span>\n\t\t\t<span>循环周期</span>\n\t\t</div>\n\t\t',cycleable?__p+='\n\t\t\t<span data-name="task-edit-cycle">'+(null==(__t=cycleHtml)?"":__t)+"</span>\n\t\t":cycleable||(__p+='\n\t\t\t<span data-name="task-edit-cycle">'+(null==(__t=cycleHtml)?"":__t)+"</span>\n\t\t"),__p+="\n\t\t",cycleable&&(__p+='\n\t\t\t<a href="javascript:void(0);" class="edit-button" data-name="task-edit-cycle-edit">修改</a>\n\t\t\t<a href="javascript:void(0);" class="edit-button" data-name="task-detail-cancel-cycle" >取消循环</a>\n\t\t'),__p+="\n\t\t\n\t</div>\n"),__p+='\n\n<div class="base-item" data-name="date-area">\n\t<div class="left-eb">\n\t\t<span class="icon-date ico-eb"></span>\n\t\t<span>起止时间</span>\n\t</div>\n\n\t',editable&&0==cycleId?(__p+="\n\t\t",startDate||deadLine?(__p+='\n\t\t\t<span data-name="set-task-date">'+(null==(__t=startDate)?"":__t)+" -- ",isLongTerm?__p+="长期":__p+=null==(__t=deadLine)?"":__t,__p+="</span>\n\t\t"):__p+='\n\t\t\t<span data-name="task-dem">开始时间 - 结束时间</span>\n\t\t',__p+="\n\t\t\n\t"):(__p+="\n\t\t",startDate||deadLine?(__p+="\n\t\t\t"+(null==(__t=startDate)?"":__t)+" - ",isLongTerm?__p+="长期":__p+=null==(__t=deadLine)?"":__t,__p+="\n\t\t"):__p+="\n\t\t\t未设置\n\t\t",__p+="\n\t"),__p+="\n\t",editable&&0==cycleId&&(__p+='\n\t<a href="javascript:void(0)" class="edit-button" data-name="task-detail-date-edit" >修改</a>\n\t'),__p+="\n\t",!isLongTerm&&2!=status&&startDate&&(__p+="\n\t\t",isDeadLine?(__p+='\n\t\t\t<span class="remain overdue">已过期 ',0!=remainDay&&(__p+=(null==(__t=remainDay)?"":__t)+" 天"),__p+="</span>\n\t\t"):__p+='\n\t\t\t<span class="remain">剩余 <span class="num">'+(null==(__t=remainDay)?"":__t)+"</span>\t天</span>\n\t\t",__p+="\n\t\t\n\t"),__p+='\n\t\n</div>\n\t\n\n<ul class="all-more" data-name="task-detail-all-info" style="display:',isPackUp?__p+="block":__p+="none",__p+='">\n\t<li class="item-am">\n\t\t<div class="base-item-warp">\n\t\t\t<div class="base-item" data-name="prical-area">\n\t\t\t\t<div class="left-eb">\n\t\t\t\t\t<span class="icon-person ico-eb"></span>\n\t\t\t\t\t<span>负责人</span>\n\t\t\t\t</div>\n\t\t\t\t'+(null==(__t=_.TitaWidget_substring(principalUser.name,6,!0))?"":__t)+"\n\t\t\t\t",editable&&(__p+='\n\t\t\t\t\t<a href="javascript:void(0);" class="edit-button" data-name="task-transfer-user">转交</a>\n\t\t\t\t'),__p+='\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="base-item-warp">\n\t\t\t<div class="base-item">\n\t\t\t\t<div class="left-eb">\n\t\t\t\t\t<span class="icon-person-add ico-eb"></span>\n\t\t\t\t\t<span>发起人</span>\n\t\t\t\t</div>\n\t\t\t\t'+(null==(__t=_.TitaWidget_substring(user.name,6,!0))?"":__t)+'\n\t\t\t</div>\n\t\t</div>\n\t</li>\n\t<li class="item-am">\n\t\t<div class="base-item-warp">\n\t\t\t<div class="base-item" data-name="participators-area">\n\t\t\t\t<div class="left-eb ico-eb">\n\t\t\t\t\t<span class="icon-box-add ico-eb"></span>\n\t\t\t\t\t<span>参与人</span>\n\t\t\t\t</div>\n\t\t\t\t<ul class="partner users-radius">\n\t\t\t\t\t',participators.length>0?(__p+="\n\t\t\t\t\t\t",_.each(participators,function(a){__p+="\n\t\t\t\t\t\t\t\t<li ",editable&&(__p+='class="eidt-del"'),__p+=">\n\t\t\t\t\t\t\t\t\t<span>"+(null==(__t=a.name)?"":__t)+"</span>\n\t\t\t\t\t\t\t\t\t",editable&&(__p+='\n\t\t\t\t\t\t\t\t\t<em class="icon-task-close" id="'+(null==(__t=a.userId)?"":__t)+'" data-name="task-detail-parnter-delete"></em>\n\t\t\t\t\t\t\t\t\t'),__p+="\n\t\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t"):editable||participators.length||(__p+="\n\t\t\t\t\t\t<li>未设置</li>\n\t\t\t\t\t"),__p+="\n\t\t\t\t\t",editable&&(__p+='\n\t\t\t\t\t\t<li class="last-add"><a href="javascript:void(0);" data-name="task-add-partner" ',participators.length>0&&(__p+='style="display:none"'),__p+=">添加</a></li>\n\t\t\t\t\t"),__p+='\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\n\t\t<div class="base-item-warp">\n\t\t\t<div class="base-item" data-name="apply-area">\n\t\t\t\t<div class="left-eb">\n\t\t\t\t\t<span class="icon-seal ico-eb"></span>\n\t\t\t\t\t<span>审批人</span>\n\t\t\t\t</div>\n\t\t\t\t<span data-name="task-apply-wrap">\n\t\t\t\t',applyUser&&applyUser.name?(__p+='\n\t\t\t\t<ul class="users-radius apply-eb">\n\t\t\t\t\t<li ',editApplyUserable&&(__p+='class="eidt-del"'),__p+=">\n\t\t\t\t\t\t<span>"+(null==(__t=applyUser.name)?"":__t)+"</span>\n\t\t\t\t\t\t",editApplyUserable&&(__p+='\n\t\t\t\t\t\t\t<em class="icon-task-close" data-id="'+(null==(__t=applyUser.userId)?"":__t)+'" data-name="task-apply-user-delete"></em>\n\t\t\t\t\t\t'),__p+="\n\t\t\t\t\t</li>\n\t\t\t\t</ul>\n\t\t\t\t"):(__p+="\n\t\t\t\t\t",editable?__p+='\n\t\t\t\t\t\t<a href="javascript:void(0)" class="task-edit-apply-user" data-name="task-apply-user-add">添加</a>\n\t\t\t\t\t':__p+="\n\t\t\t\t\t\t未设置\n\t\t\t\t\t",__p+="\n\t\t\t\t"),__p+="</span>\n\t\t\t\t",editApplyUserable&&applyUser&&applyUser.name&&(__p+='\n\t\t\t\t\t<a href="javascript:void(0);" class="edit-button" data-name="task-apply-user-edit">修改</a>\n\t\t\t\t'),__p+='\n\t\t\t\t</span>\n\t\t\t</div>\n\t\t</div>\n\t</li>\n\t<li class="item-am">\n\t\t<div class="base-item-warp">\n\t\t\t<div class="base-item" data-name="class-container-wrap">\n\t\t\t\t<div class="left-eb">\n\t\t\t\t\t<span class="icon-box-four ico-eb"></span>\n\t\t\t\t\t<span>分类/项目</span>\n\t\t\t\t</div>\n\t\t\t\t<span data-name="task-class-text">\n\t\t\t\t',4==labelType?__p+='\n\t\t\t\t\t<span class="icon-work-small"></span>&nbsp;\n\t\t\t\t\t<a href="#work?work_id='+(null==(__t=labelId)?"":__t)+'" target="_blank">\n\t\t\t\t'+(null==(__t=labelName)?"":__t)+"</a>\n\t\t\t\t":(labelType,__p+="\n\t\t\t\t\t"+(null==(__t=labelName)?"":__t)+"\n\t\t\t\t"),__p+="\n\t\t\t\t</span>\n\n\t\t\t\t",labelEditable&&(__p+='\n\t\t\t\t\t<a href="javascript:void(0)" data-name="task-edit-class"  class="edit-button">修改</a>\n\n\t\t\t\t\t<div  data-name="class-area"></div>\n\t\t\t\t'),__p+='\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="base-item-warp">\n\t\t\t<div class="base-item">\n\t\t\t\t<div class="left-eb">\n\t\t\t\t\t<span class="icon-lock-open ico-eb"></span>\n\t\t\t\t\t<span>可见范围</span>\n\t\t\t\t</div>\n\t\t\t\t'+(null==(__t=privateText)?"":__t)+'\n\t\t\t</div>\n\t\t</div>\n\t</li>\n</ul>\n<div class="slide-toggle"  data-name="task-detail-toggle">\n\t<div class="toggle-cont">\n\t',isPackUp?__p+='\n\t\t<span class="txt">属性收起</span><span class="icon icon-arrow-up"></span>\n\t':__p+='\n\t\t<span class="txt">属性展开</span><span class="icon icon-arrow-down"></span>\n\t',__p+='\n\t</div>\n</div>\n\n<div class="base-item uploader" data-name="task-detail-attachment">\n\t<div class="left-eb">\n\t\t<span class="icon-upfile-highlight"></span>\n\t\t<span>附件</span>\n\t</div>\n\t',1!=relation&&2!=relation&&3!=relation&&5!=relation||!isAccept||(__p+='\n\t<div class="uploader_container" data-name="task-detail-attachment-button"></div>\n\t<div class="error_container"></div>\n\t<div class="loading_container"></div>\n\t'),__p+='\n</div>\n<div class="attachments" data-name="task-detail-attachment-list" ></div>\n';return __p},this.JST["task-detail/task-detail-layout"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div data-name="task-detail-unaccept"></div>\n<div data-name="task-detail-relate"></div>\n<div data-name="task-detail-action"></div>\n<div data-name="task-detail-scroll" class="task-detail-scroll">\n\t<div data-name="task-detail-info"></div>\n\t<div class="task-extra-info" data-name="ux-customizetDatas"></div>\n\t<div data-name="task-detail-evaluation"></div>\n\t<div data-name="task-detail-base-info"></div>\n\t<div data-name="task-detail-container">\n\t\t<div data-name="task-detail-add-do"></div>\n\t\t<div data-name="ux-edittask-area"></div>\n\t\t<div data-name="task-apply"></div>\n\t\t<div data-name="task-detail-task-list"></div>\n\t\t<div data-name="task-detail-work-hour"></div>\n\t\t<div data-name="task-detail-meet"></div>\n\t\t<div data-name="task-detail-travel"></div>\n\t\t<div data-name="task-detail-share"></div>\n\t\t<div data-name="task-detail-comment"></div>\n\t\t<div data-name="task-detail-track"></div>\n\t\t<div data-name="task-detail-follower"></div>\n\t\t<div class="task-share-user" data-name="task-share-user">\n\t\t</div>\t\n\t</div>\n</div>';return __p},this.JST["task-detail/task-feed"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="task-detail-moduletitle">\n\t<div class="icon">\n\t\t<span class="icon-message-hightlight icon-dt"></span>\n\t\t<em class="caret"></em>\n\t</div>\n\t<div class="text">沟通</div>\n</div>\n<div class="module-content" data-name="task-detail-task-feed"></div>';return __p},this.JST["task-detail/task-file"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="ux_edittask_upload">\n\t<span class="icon-task-upload-enable"></span>\n\t<span>'+(null==(__t=i18n.task_1)?"":__t)+'附件</span>\n</div>\n<div class="ux_edittask_fileupload" data-name="ux-upload-list"></div>\n<div class=""';return __p},this.JST["task-detail/task-info"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n\n<div class="status icon-status-'+(null==(__t=status)?"":__t)+'"></div>\n\n\n',editable?__p+='\n\t<div class="input-default task-edit"  data-name="task-detail-name">\n\t\t<textarea class="task-title-input input-default">'+(null==(__t=taskName)?"":__t)+"</textarea>\n\t</div>\n":__p+='\n\t<div class="task-title" data-name="task-name">'+(null==(__t=taskName)?"":__t)+"</div>\n",__p+='\n\t\n<div class="task-detail-des">\n\n\t',editable?(__p+="\n\t\t",description&&""!=description?__p+='\n\t\t\t<a href="javascript:void(0)" class="task-detail-add" data-name="task-detail-descript-add" style="display:none">添加描述</a>\n\t\t\t<div class="input-default task-edit tt-rich-content clearfix"  data-name="task-detail-descript" >'+(null==(__t=description)?"":__t)+"</div>\n\t\t":__p+='\n\t\t\t<a href="javascript:void(0)" class="task-detail-add" data-name="task-detail-descript-add">添加描述</a>\n\t\t\t<div class="input-default task-edit"  data-name="task-detail-descript" style="display:none">'+(null==(__t=description)?"":__t)+"</div>\n\t\t",__p+="\n\t"):(__p+='\n\t\t<div class="task-title tt-rich-content clearfix">\n\t\t\t',description&&(__p+="\n\t\t\t\t"+(null==(__t=description)?"":__t)+"\n\t\t\t"),__p+="\n\t\t</div>\n\t"),__p+='\n\t<div class="input-default des-edit" data-name="task-detail-descript-edit" ></div>\n</div>\n\n';return __p},this.JST["task-detail/task-meet-detail"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="task-detail-moduletitle">\n\t<div class="icon">\n\t\t<span class="icon-meet icon-dt"></span>\n\t\t<em class="caret"></em>\n\t</div>\n\t<div class="text">会议(<span data-name="task-detail-meet-total">'+(null==(__t=total)?"":__t)+'</span>)</div>\n</div>\n\n<div class="module-content" data-name="task-travel-list">\n\t<div class="_tt_loading_m">努力加载中…</div>\n</div>';return __p},this.JST["task-detail/task-quick"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)isShowAll&&(__p+='\n<ul data-name="task-quick-list">\n\t',_.each(quickList,function(a,b){__p+="\n\t\t",a.isShow&&(__p+='\n\t\t<li class="item-tq radius-tq" data-key="'+(null==(__t=a.key)?"":__t)+'" original-title="'+(null==(__t=a.name)?"":__t)+'">\n\t\t\t<span class="ico ico-'+(null==(__t=a.icon)?"":__t)+'"></span>\n\t\t</li>\n\t\t',b+1!=quickList.length&&(__p+='\n\t\t\t<li class="border"></li>\n\t\t'),__p+="\n\t\t"),__p+="\n\t"}),__p+='\n</ul>\n<div class="radius_all" data-name="task-quick-all" original-title="收起">\n\t<a href="javascript:void(0)" class="ico ico-all" data-name="quick-do"></a>\n</div>\n');return __p},this.JST["task-detail/task-relate"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n\t\t<em></em>\n\t\t<span original-title="只有发起人和负责人可以修改关联" data-name="task-relate-text">\n\t\t\t',parentId?__p+="\n\t\t\t\t与"+(null==(__t=i18n.task_1)?"":__t)+'<span class="edit-task-link" id="'+(null==(__t=parentId)?"":__t)+'" data-name="edit-task-link">'+(null==(__t=parentName)?"":__t)+"</span>\n\t\t\t\t&nbsp;关联&nbsp;\n\t\t\t":__p+="\n\t\t\t\t暂无关联\n\t\t\t",__p+="\n\t\t</span>\n\t\t",!isAccept||1!=relation&&3!=relation||4==labelType||(__p+='\n\t\t<span class="relate">\n\t\t\t<a href="javascript:void(0)" class="ux_edit_plan_color" data-name="edit-task-plan">修改关联</a>\n\t\t'),__p+='\n\t\t<a href="http://service.tita.com/pages/viewpage.action?pageId=590574" target="_blank" class="icon-help"></a>\n\t\t</span>\n\t\t\n';return __p},this.JST["task-detail/task-share-detail"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="task-detail-moduletitle" name="share">\n\t<div class="icon">\n\t\t<span class="icon-notepad-pen icon-dt"></span>\n\t\t<em class="caret"></em>\n\t</div>\n\t<div class="text">心得(<span data-name="task-detail-share-total">'+(null==(__t=experienceTotal)?"":__t)+'</span>)</div>\n</div>\n<div class="module-content" data-name="task-detail-share-list"></div>';return __p},this.JST["task-detail/task-share-list-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="bar">\n\t<div class="left">\n\t\t心得日期: \n\t\t',isEdit?__p+='\n\t\t<a href="javascript:void(0);" class="editable" data-name="task-detail-share-time"  id="'+(null==(__t=commentId)?"":__t)+'">'+(null==(__t=dateText)?"":__t)+"</a>\n\t\t":__p+="\n\t\t<span>"+(null==(__t=dateText)?"":__t)+"</span>\n\t\t",__p+='\n\t</div>\n\t<span class="right">填写人：'+(null==(__t=publishUser.name)?"":__t)+"</span>\n\n\t",isEdit&&(__p+='\n\t\t<span class="del" data-name="task-detail-share-delete" id="'+(null==(__t=commentId)?"":__t)+'">\n\t\t\t<span class="icon-dialog-closed"></span>\n\t\t</span>\n\t'),__p+='\n</div>\n<div class="item-content">\n\t',isEdit?__p+='\n\t\t<div class="clearfix" data-name="task-detail-share-edit" id="'+(null==(__t=commentId)?"":__t)+'">'+(null==(__t=content)?"":__t)+'</div>\n\t\t<div data-name="task-detail-share-rich"></div>\n\t':__p+='\n\t\t<div class="clearfix">'+(null==(__t=content)?"":__t)+"</div>\n\t",__p+='\n</div>\n<div data-name="task-detail-share-attachment"></div>\n\n';return __p},this.JST["task-detail/task-share-list"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n",isShowCreate&&(__p+='\n<div class="add-area">\n\t<div class="topinput" data-name="task-detail-share-new">填写心得</div>\n\t<div class="share-new" data-name="task-detail-share-new-box"></div>\n</div>\n'),__p+='\n<ul data-name="task-detail-share-list"></ul>\n',isShowMore&&(__p+='\n<div class="task-detail-show-more" data-name="task-detail-share-more" >\n\t<span class="txt" data-name="task-detail-share-more-text">展开</span>&nbsp;<span class="tip_title">全部心得</span>&nbsp;<em class="icon-arrow-down-2t" data-name="task-detail-share-icon"></em>\n</div>\n');return __p},this.JST["task-detail/task-task-detail"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="task-detail-moduletitle">\n\t<div class="icon">\n\t\t<span class="icon-task-lighthight icon-dt"></span>\n\t\t<em class="caret"></em>\n\t</div>\n\t<div class="text">'+(null==(__t=iTask)?"":__t)+'(<span data-name="task-detail-task-total">'+(null==(__t=total)?"":__t)+'</span>)</div>\n</div>\n\n\n<div class="module-content">\n\t<div data-name="task-detail-task-add"></div>\n\t<div data-name="task-detail-task-list"></div>\n\t<div class="work_hour_content_wraper" data-name="task-detail-work-hour-list-box">\n\t\t<ul data-name="task-detail-work-hour-list"></ul>\n\t\t',isShowMore&&(__p+='\n\t\t<div class="task-detail-show-more" data-name="task-detail-task-more" >\n\t\t\t<span class="txt" data-name="task-detail-task-more-text">展开</span>&nbsp;<span class="tip_title">全部'+(null==(__t=iTask)?"":__t)+'</span>&nbsp;<em class="icon-arrow-down-2t" data-name="task-detail-task-icon"></em>\n\t\t</div>\n\t\t'),__p+="\n\t</div>\t\n</div>";return __p},this.JST["task-detail/task-title"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="_tt_moduletitle">\n\t<div class="icon task"><b></b><em></em></div>\n\t<div class="text">'+(null==(__t=task_1)?"":__t)+'（<span class="tasknum">11</span>）</div>\n</div>';return __p},this.JST["task-detail/task-track"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="task-detail-moduletitle">\n\t<div class="icon">\n\t\t<span class="icon-page-pen-edit icon-dt"></span>\n\t\t<em class="caret"></em>\n\t</div>\n\t<div class="text">操作记录</div>\n</div>\n<div class="module-content" data-name="task-detail-task-track" ></div>';return __p},this.JST["task-detail/task-travel-detail"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="task-detail-moduletitle">\n\t<div class="icon">\n\t\t<span class="icon-plane icon-dt"></span>\n\t\t<em class="caret"></em>\n\t</div>\n\t<div class="text">出差(<span data-name="task-detail-travel-total">'+(null==(__t=total)?"":__t)+'</span>)</div>\n</div>\n\n\n<div class="module-content" data-name="task-travel-list">\n\t<div class="_tt_loading_m">努力加载中…</div>\n</div>';return __p},this.JST["task-detail/task-travel-list-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="common-list-item-left">\n\t<span class="title-icon-wraper">\n\t\t<span class="title-icon '+(null==(__t={2:"icon-plane-small",1:"icon-meet"}[viewType])?"":__t)+'"></span>\n\t</span>\n\t\n\t',2==viewType&&(__p+='\n\t<span class="common-item-title-wraper">地点:</span> \n\t'),__p+='\n\t<div class="common-item-title '+(null==(__t=editable?"editable":"")?"":__t)+'" data-name="item-title">'+(null==(__t=title)?"":__t)+"</div>\n\t",editable&&(__p+='\n\t\t<div class="common-item-title-edit input-default input-focus" data-name="item-edit">\n\t\t\t<input type="text"  value="'+(null==(__t=title)?"":__t)+'" data-name="item-title-input">\n\t\t</div>\n\t'),__p+='\n\t\t\n</div>\n<div class="common-list-item-right">\n\t<span class="toggle-item-detail" data-name="toggle-item-detail">\n\t\t',open?__p+='\n\t\t\t<span class="txt">收起</span>\n\t\t\t<em class="icon-arrow-up"></em>\n\t\t':__p+='\n\t\t\t<span class="txt">详情</span>\n\t\t\t<em class="icon-arrow-down"></em>\n\t\t',__p+='\n\t</span>\n\n\t<span class="item-delete-wraper">\n\t\t',editable&&(__p+='\n\t\t\t<a href="javascript:void(0)" class="item-delete" id="'+(null==(__t=id)?"":__t)+'" data-name="item-delete">删除</a>\n\t\t'),__p+='\n\t</span>\n</div>\n<div class="common-list-item-detail" data-name="item-detail" style="display:',open?__p+="block":__p+="none",__p+='">\n\t<div class="detail-item clearfix" data-name="item-time">\n\t\t<span class="detail-item-left">时间：</span>\n\t\t<div class="detail-item-right" data-name="detail-time-right">\n\t\t\t<span data-name="item-time-container" original-title="起止时间：'+(null==(__t=startDate)?"":__t)+" - "+(null==(__t=endDate)?"":__t)+'">\n\t\t\t\t<span class="'+(null==(__t=editable?"link-style":"")?"":__t)+'" data-name="startDate">'+(null==(__t=startDate)?"":__t)+'</span>\n\t\t\t\t - \n\t\t\t\t<span class="'+(null==(__t=editable?"link-style":"")?"":__t)+'" data-name="endDate">'+(null==(__t=endDate)?"":__t)+"</span>\n\t\t\t</span>\n\t\t</div>\n\t</div>\n\t",editable?(__p+='\n\t\t<div class="detail-item clearfix" data-name="contract-user">\n\t\t\t<span class="detail-item-left">外部联系人：</span>\n\t\t\t<div class="detail-item-right">\n\t\t\t\t',contractUser?__p+='\n\t\t\t\t<span class="contractUserTitle">'+(null==(__t=contractUser)?"":__t)+'</span>\n\t\t\t\t<div class="contract-wraper input-default input-focus" data-name="contract-edit">\n\t\t\t\t\t<input  type="text"  value="'+(null==(__t=contractUser)?"":__t)+'" data-name="contract-edit-input">\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t\t':__p+='\n\t\t\t\t\t<a href="javascript:void(0)" data-name="addContractUser">添加</a>\n\t\t\t\t\t<span class="contractUserTitle" style="display:none"></span>\n\t\t\t\t\t<div class="contract-wraper input-default input-focus"  data-name="contract-edit">\n\t\t\t\t\t\t<input  type="text"  value="'+(null==(__t=contractUser)?"":__t)+'" data-name="contract-edit-input">\n\t\t\t\t\t</div>\n\t\t\t\t',__p+="\n\t\t\t</div>\n\t\t</div>\n\t"):contractUser&&(__p+='\n\t\t<div class="detail-item clearfix" data-name="contract-user">\n\t\t\t<span class="detail-item-left">外部联系人：</span>\n\t\t\t<div class="detail-item-right">\n\t\t\t\t'+(null==(__t=contractUser)?"":__t)+"\n\t\t\t</div>\n\t\t</div>\n\t"),__p+="\n\t",1==viewType&&(__p+="\n\t\t",editable?__p+='\n\t\t\t<div class="detail-item">\n\t\t\t\t<span class="detail-item-left">参与者：</span>\n\t\t\t\t<div class="detail-item-right" data-name="detail-participator">\n\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t':!editable&&participantUsers&&participantUsers.length&&(__p+='\n\t\t\t<div class="detail-item">\n\t\t\t\t<span class="detail-item-left">参与者：</span>\n\t\t\t\t<div class="detail-item-right">\n\t\t\t\t\t',_.each(participantUsers,function(a){__p+="\n\t\t\t\t\t\t"+(null==(__t=_.convertImage({src:a.avatar.Small,size:30,name:a.name,bgColor:a.avatar.Color}))?"":__t)+"\n\t\t\t\t\t"}),__p+="\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t"),__p+="\n\t"),__p+='\n\t<div class="detail-item clearfix">\n\t\t<span class="detail-item-left">备注:</span>\n\t\t<div class="detail-item-right">\n\t\t\t',editable?(__p+='\n\t\t\t\t<div data-name="detail-description" class="detail-description editable" ',description||(__p+='style="display:none;"'),__p+=">"+(null==(__t=description)?"":__t)+'</div>\n\t\t\t\t<div data-name="richeditor-area" style="display:none;"></div>\n\t\t\t\t<a href="javascript:void(0)" data-name="add-description-btn" ',description&&(__p+='style="display:none;"'),__p+=">添加</a>\n\t\t\t"):(__p+='\n\t\t\t\t<div class="detail-description">',description?__p+=null==(__t=description)?"":__t:__p+="未添加备注",__p+="</div>\n\t\t\t"),__p+="\n\t\t\t\n\t\t</div>\n\t</div>\n\n\t",(attachments&&attachments.length||editable)&&(__p+='\n\t\t<div class="detail-item clearfix">\n\t\t\t<span class="detail-item-left">附件：</span>\n\t\t\t<div data-name="detail-attachment" class="detail-item-right uploader_container '+(null==(__t=editable?"addFileClass":"")?"":__t)+'">\n\t\t\t</div>\n\t\t</div>\n\t'),__p+='\n\t<div class="detail-item clearfix">\n\t\t<span class="detail-item-left">创建人:</span>\n\t\t<span class="detail-item-right">'+(null==(__t=publisher.name)?"":__t)+"</span>\n\t</div>\n</div>";return __p},this.JST["task-detail/task-travel-list"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div data-name="task-create-container"></div>\n<ul class="task-detail-common-list-module" data-name="task-detail-travel-list">\n</ul>';return __p},this.JST["task-detail/task-unaccept"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="ux_edittask_accept">\n\t',2!=relation||isAccept?(__p+="\n\t\t",isAccept||0!=isTransfer||(__p+='\n\t\t\t<div class="ux_edittask_accept_local" data-name="accept-container">\n\t\t\t\t<div class="width238" >\n\t\t\t\t\t<a href="javascript:void(0)" class="btn btn-sure btn-ea" data-name="accept-task" data-type="2">接受'+(null==(__t=i18n.task_1)?"":__t)+'</a>\n\t\t\t\t\t<a href="javascript:void(0)" class="btn btn-cancel last btn-ea" data-name="transfer-task">转交他人</a>\n\t\t\t\t</div>\n\t\t\t\t<div data-name="accept-area"></div>\n\t\t\t</div>\n\t\t'),__p+="\n\t\t",1==isTransfer&&(__p+='\n\t\t\t<div class="ux_edittask_accept_other" data-name="ux-edittask-appe" >\n\t\t\t\t<span>此'+(null==(__t=i18n.task_1)?"":__t)+"转交给"+(null==(__t=_.substring(transferUser.name,6,!0))?"":__t)+'负责</span>\n\t\t\t\t<a href="javascript:void(0)" class="btn btn-sure " data-name="sure-transfer">确定</a>\n\t\t\t\t<a href="javascript:void(0)" class="btn btn-cancel" data-name="cancel-transfer">取消</a>\n\t\t\t</div>\t\n\t\t'),__p+="\n\t"):__p+='\n\t\t<div class="ux_edittask_accept_local">\n\t\t\t<div class="width238">\n\t\t\t\t<a href="javascript:void(0)" class="btn btn-sure btn-ea" data-name="participate-task">参与'+(null==(__t=i18n.task_1)?"":__t)+'</a>\n\t\t\t\t<a href="javascript:void(0)" class="btn btn-cancel last btn-ea" data-name="refuse-task">不参与</a>\n\t\t\t</div>\n\t\t</div>\n\t',__p+="\n</div>";return __p},this.JST["task-detail/task-work-hour-detail"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="task-detail-moduletitle">\n\t<div class="icon">\n\t\t<span class="icon-clock-t icon-dt"></span>\n\t\t<em class="caret"></em>\n\t</div>\n\t<div class="text">工时(<span data-name="task-detail-work-hour-total">'+(null==(__t=workHourTotal)?"":__t)+'</span>)</div>\n</div>\n\n\n<div class="module-content" data-name="task-detail-work-hour-list">\n\t<div class="_tt_loading_m">努力加载中…</div>\n</div>';return __p},this.JST["task-detail/task-work-hour-list-item-detail"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="description clearfix">\n\t<span class="title">工时备注:</span>\n\t<div class="content">\n\t\t',editable?(__p+="\n\t\t\t",description&&""!=description?__p+='\n\t\t\t<div data-name="task-detail-workhour-des-edit" class="des_text">'+(null==(__t=description)?"":__t)+"</div>\n\t\t\t":__p+='\n\t\t\t<a href="javascript:void(0)"  data-name="task-detail-workhour-des-add">添加</a>\n\t\t\t',__p+='\n\t\t\t<div class="des_edit input-default input-focus" data-name="task-detail-workhour-des-rich"></div>\n\t\t'):(__p+='\n\t\t\t<div class="redactor_editor">\n\t\t\t\t',description?__p+="\n\t\t\t\t\t"+(null==(__t=description)?"":__t)+"\n\t\t\t\t":__p+="\n\t\t\t\t\t未添加备注\n\t\t\t\t",__p+="\n\t\t\t</div>\n\t\t"),__p+="\n\t</div>\n</div>\n",(attachments.length||editable)&&(__p+='\n\t<div class="description clearfix">\n\t\t<span class="title">附件：</span>\n\t\t<div class="content uploader_container" data-name="task-detail-work-hour-attachment-add">\n\t\t\t<div data-name="task-detail-workhour-attachment-list"></div>\n\t\t</div>\n\t</div>\n');return __p},this.JST["task-detail/task-work-hour-list-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="item-box clearfix">\n\t<div class="item_left">\n\t\t<div class="name_il" data-name="task-detail-workhour-name">'+__e(name)+"</div>\n\t\t",editable&&(__p+='\n\t\t<div class="name_input input-default input-focus" data-name="task-detail-workhour-name-input">\n\t\t\t<input type="text"/>\n\t\t</div>\n\t\t'),__p+='\n\t</div>\n\t<div class="task_item_right" data-name="task-detail-workhour-right">\n\t\t',editable?(__p+='\n\t\t\t<span class="date_il ',isLoginUser&&(__p+="pointer"),__p+='" id="'+(null==(__t=id)?"":__t)+'" data-name="task-detail-workhour-date" >'+(null==(__t=time)?"":__t)+"</span>\n\t\t"):__p+='\n\t\t\t<span class="date_il" id="'+(null==(__t=id)?"":__t)+'" >'+(null==(__t=time)?"":__t)+"</span>\n\t\t",__p+="\n\t\t",editable?(__p+='\n\t\t\t<span class="work_hour ',isLoginUser&&(__p+="pointer"),__p+='" id="'+(null==(__t=id)?"":__t)+'"  data-name="task-detail-workhour-hour">'+(null==(__t=hoursTotal)?"":__t)+"h</span>\n\t\t"):(__p+='\n\t\t\t<span class="work_hour ',isLoginUser&&(__p+="pointer"),__p+='" >'+(null==(__t=hoursTotal)?"":__t)+"h</span>\n\t\t"),__p+='\n\t\t<span class="del_il">\n\t\t\t',editable&&(__p+='\n\t\t\t\t<a href="javascript:void(0)" id="'+(null==(__t=id)?"":__t)+'" data-name="task-detail-workhour-delete">删除</a>\n\t\t\t'),__p+='\n\t\t</span>\n\t\t<span class="detail_il" data-name="task-detail-workhour-item-detail-btn">\n\t\t\t<span class="txt">详情</span>\n\t\t\t<em class="icon-drop-down"></em>\n\t\t</span>\n\t\t\n\t</div>\n</div>\n<div  data-name="task-detail-workhour-item-detail-box">\n\t\n</div>';return __p},this.JST["task-detail/task-work-hour-list"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="title_wh">\n\t<div class="left">\n\t\t'+(null==(__t=_.convertImage({className:"radius_img30",src:user.avatar.Small,size:30,name:user.name,bgColor:user.avatar.Color}))?"":__t)+"\n\t\t<span >"+(null==(__t=user.name)?"":__t)+'的工时总计：</span>\n\t</div>\n\t<span class="work_hour" data-name="task-detail-work-hour-total">'+(null==(__t=totalHours)?"":__t)+'h</span>\n\t<div class="right" data-name="task-detail-work-hour-user-toggle">\n\t\t',showList?__p+='\n\t\t\t<span class="txt">收起</span>\n\t\t\t<em class="icon-drop-up" data-name="task-detail-work-hour-user-toggle-ico"></em>\n\t\t':__p+='\n\t\t\t<span class="txt">展开</span>\n\t\t\t<em class="icon-drop-down" data-name="task-detail-work-hour-user-toggle-ico"></em>\n\t\t',__p+='\n\t</div>\n</div>\n<div class="work_hour_content_wraper" data-name="task-detail-work-hour-list-box" ',showList?__p+='style="display:block"':__p+='style="display:none"',__p+='>\n\t<ul data-name="task-detail-work-hour-list"></ul>\n\t',isShowMore&&(__p+='\n\t<div class="task-detail-show-more" data-name="task-detail-work-hour-more" >\n\t\t<span class="txt" data-name="task-detail-work-hour-more-text">展开</span>&nbsp;<span class="tip_title">全部工时</span>&nbsp;<em class="icon-arrow-down-2t" data-name="task-detail-work-hour-icon"></em>\n\t</div>\n\t'),__p+="\n</div>\t\n\n\n\n";return __p},this.JST["task-detail/user-list"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<em class="ux_add_btn"></em>\n<ul></ul>';return __p},this.JST["empty-view/empty"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="content_emptyinit">\n\t<div class="className">'+(null==(__t=emptyContext)?"":__t)+"</div>\n</div>";return __p},this.JST["operation-status/operation-status"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<ul>\n\t<li status="2"><a href="javascript:void(0);" title="">\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-2"></span>已完成\n\t</a></li>\n\t<li status="1"><a href="javascript:void(0);" title="" >\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-1"></span>进行中</a></li>\n\t<li status="4"><a href="javascript:void(0);" title="" >\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-4"></span>已取消\n\t</a></li>\n\t<li status="3"><a href="javascript:void(0);" title="" >\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-3"></span>已延迟\n\t</a></li>\n\t<li status="6"><a href="javascript:void(0);" title="" >\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-6"></span>暂停中\n\t</a></li>\n\t<li status="0"><a href="javascript:void(0);" title="" >\n\t\t<span class="ico icon-taskStatus'+(null==(__t=isChildTask?"-s":"")?"":__t)+'-0"></span>未开始\n\t</a></li>\n</ul>\n';return __p},this.JST["uploader/uploader-component-preview-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="cont_up">\n\t<div class="img_up" data-name="tita-upload-preview-icon">\n\t\t',isImage?__p+="\n\t\t\n\t\t":__p+='\n\t\t<span class="ico_up file-'+(null==(__t=fileType)?"":__t)+'"></span>\n\t\t',__p+='\n\t</div>\n</div>\n\n<div class="name_up">'+(null==(__t=FileName)?"":__t)+'</div>\n<div class="action_up">\n\t<a href="javascript:void(0);" data-name="tita-upload-preview-deleted">删除</a>\n</div>\n';return __p},this.JST["uploader/uploader-component"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<a href="javascript:void(0);" title="" class="upload_node ',openYFY||(__p+="upload_new_file"),__p+='" data-name="file">文件/图片</a>\n',openYFY&&(__p+='\n\t<div class="tt_upload_type_container" data-name="upload-type">\n\t\t<dl class="upload_type_item"><span class="upload_new_file" data-name="dfs-upload">本地上传</span></dl>\n\t\t<dl class="upload_type_item"><span id="fc_upload" class="fang_cloud_btn">亿方云</span></dl>\n\t</div>\n');return __p},this.JST["uploader/yfy-login-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<iframe frameborder="0" name="yfy_login" style="display: none;"></iframe>\n<form action="'+(null==(__t=host)?"":__t)+'/open/yfy_user/login" method="POST" target="yfy_login" style="display:none">\n    <input type="hidden" name="enterprise_id" value="'+(null==(__t=enterprise_id)?"":__t)+'">\n    <input type="hidden" name="platform_id" value="'+(null==(__t=platform_id)?"":__t)+'">\n    <input type="hidden" name="version" value="'+(null==(__t=version)?"":__t)+'">\n    <input type="hidden" name="timestamp" value="'+(null==(__t=timestamp)?"":__t)+'">\n    <input type="hidden" name="token" value="'+(null==(__t=token)?"":__t)+'">\n    <input type="hidden" name="email" value="'+(null==(__t=email)?"":__t)+'">\n</form>';return __p},this.JST["date-time-picker/date-time-cycle"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<h2>设置循环时间</h2>\n<div class="cycle_task_container">\n\t<div class="cycle_type_list" data-name="date-time-picker-tab">\n\t\t<ul>\n\t\t\t<li cyctype="2">\n\t\t\t\t<a href="javascript:void(0)" class="radio ',2==cycType&&(__p+="radio-checked"),__p+='"></a>\n\t\t\t\t<span>每个工作日</span>\n\t\t\t</li>\n\t\t\t<li cyctype="1">\n\t\t\t\t<a href="javascript:void(0)" class="radio ',1==cycType&&(__p+="radio-checked"),__p+='"></a>\n\t\t\t\t<span>每天</span>\n\t\t\t</li>\n\t\t\t<li cyctype="3">\n\t\t\t\t<a href="javascript:void(0)" class="radio ',3==cycType&&(__p+="radio-checked"),__p+='"></a>\n\t\t\t\t<span>每周</span>\n\t\t\t</li>\n\t\t\t<li cyctype="4">\n\t\t\t\t<a href="javascript:void(0)" class="radio ',4==cycType&&(__p+="radio-checked"),__p+='"></a>\n\t\t\t\t<span>每月</span>\n\t\t\t</li>\n\t\t</ul>\n\t</div>\n\t<div class="cycle_type_date">\n\t\t<div class="cycle_time clearfix">\n\t\t\t<span>开始时间</span>\n\t\t\t',3!=cycType&&4!=cycType||(__p+='\n\t\t\t\t<div class="day_time_nst first-col">\n\t\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycStartDayTxt)?"":__t)+'</label>\n\t\t\t\t\t<ul class="dayvalues_nst" data-name="date-time-dropdown">\n\t\t\t\t\t\t',_.each(dateData,function(a,b){__p+="\n\t\t\t\t\t\t\t<li ",cycStartDayTxt==a&&(__p+='class="cur_nst"'),__p+='>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" index="'+(null==(__t=b)?"":__t)+'" data-type="1">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t"),__p+='\n\t\t\t<div class="day_time_nst">\n\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycStartHour)?"":__t)+'</label>\n\t\t\t\t<ul class="dayvalues_nst"  data-name="date-time-dropdown">\n\t\t\t\t\t',_.each(hours,function(a){__p+="\n\t\t\t\t\t\t<li ",cycStartHour==a&&(__p+='class="cur_nst"'),__p+='>\n\t\t\t\t\t\t\t<a href="javascript:void(0)" hour="'+(null==(__t=a)?"":__t)+'" data-type="3">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+='\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<div class="date-time-colon">:</div>\n\t\t\t<div class="day_time_nst">\n\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycStartMinute)?"":__t)+'</label>\n\t\t\t\t<ul class="dayvalues_nst" data-name="date-time-dropdown">\n\t\t\t\t\t',_.each(minites,function(a){__p+="\n\t\t\t\t\t\t<li ",cycStartMinute==a&&(__p+='class="cur_nst"'),__p+='>\n\t\t\t\t\t\t\t<a href="javascript:void(0)" minite="'+(null==(__t=a)?"":__t)+'" data-type="5">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+='\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t\t<div class="cycle_time clearfix">\n\t\t\t<span>结束时间</span>\n\t\t\t',3!=cycType&&4!=cycType||(__p+='\n\t\t\t\t<div class="day_time_nst first-col">\n\t\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycEndDayTxt)?"":__t)+'</label>\n\t\t\t\t\t<ul class="dayvalues_nst" data-name="date-time-dropdown">\n\t\t\t\t\t\t',_.each(dateData,function(a,b){__p+="\n\t\t\t\t\t\t\t<li ",cycEndDayTxt==a&&(__p+='class="cur_nst"'),__p+='>\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" index="'+(null==(__t=b)?"":__t)+'" data-type="2">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t"}),__p+="\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t"),__p+='\n\t\t\t<div class="day_time_nst">\n\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycEndHour)?"":__t)+'</label>\n\t\t\t\t<ul class="dayvalues_nst" data-name="date-time-dropdown">\n\t\t\t\t\t',_.each(hours,function(a){__p+="\n\t\t\t\t\t\t<li ",cycEndHour==a&&(__p+='class="cur_nst"'),__p+=' >\n\t\t\t\t\t\t\t<a href="javascript:void(0)" hour="'+(null==(__t=a)?"":__t)+'" data-type="4">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+='\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<div class="date-time-colon">:</div>\n\t\t\t<div class="day_time_nst">\n\t\t\t\t<a class="triday_nst" href="javascript:void(0)" data-name="date-time-set-btn"></a>\n\t\t\t\t<label data-name="date-time-set-btn">'+(null==(__t=cycEndMinute)?"":__t)+'</label>\n\t\t\t\t<ul class="dayvalues_nst" data-name="date-time-dropdown">\n\t\t\t\t\t',_.each(minites,function(a){__p+="\n\t\t\t\t\t\t<li ",cycEndMinute==a&&(__p+='class="cur_nst"'),__p+='>\n\t\t\t\t\t\t\t<a href="javascript:void(0)" minite="'+(null==(__t=a)?"":__t)+'" data-type="6">'+(null==(__t=a)?"":__t)+"</a>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+='\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n</div>\n<div class="buttons clearfix">\n\t<a href="javascript:void(0)" class="btn btn-cancel reset-cycle" data-name="data-time-picker-reset-cycle">取消循环</a>\n\t<div class="right-part">\n\t\t<a href="javascript:void(0)" class="btn btn-sure" data-name="data-time-picker-sure-cycle">确定</a>\n\t\t<a href="javascript:void(0)" class="btn btn-cancel" data-name="data-time-picker-close-cycle">取消</a>\n\t</div>\n</div>';return __p},this.JST["date-time-picker/date-time-long"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="clearfix">\n\t<div class="date-long-left" data-name="date-time-long-date">\n\t</div>\n\t<div class="date-long-right">\n\t\t<div class="date-check" data-name="date-time-long-check">\n\t\t\t<span class="checkbox checkbox-checked" data-name="date-time-long-input"></span><span>长期</span>\n\t\t</div>\n\t</div>\n</div>\n<div class="buttons clearfix">\n\t<span class="btn btn-cancel cancel-long" data-name="date-time-long-candellong">取消长期</span>\n\t<span class="btn btn-cancel" data-name="date-time-long-candel">取消</span>\n\t<span class="btn btn-success" data-name="date-time-long-sure">确定</span>\n</div>';return __p},this.JST["date-time-picker/date-time-picker-tab"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n\t",isShowDateView&&(__p+='\n\t<li class="item-tab ',"date"==viewType&&(__p+="active"),__p+='" data-type="date">起止时间</li>\n\t'),__p+="\n\t",isShowCycleView&&(__p+='\n\t<li class="item-tab ',"cycle"==viewType&&(__p+="active"),__p+='" data-type="cycle" >循环时间</li>\n\t'),__p+="\n\t",isShowLongView&&(__p+='\n\t<li class="item-tab ',"long"==viewType&&(__p+="active"),__p+='" data-type="long" >长期</li>\n\t');return __p},this.JST["date-time-picker/date-time-picker"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="cont-box" data-name="date-time-picker-content"></div>';return __p},this.JST["task-create/task-create-add-user-composite"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<em class="ux_add_btn" data-name="add-user-btn"></em>\n<ul></ul>';return __p},this.JST["task-create/task-create-add-user-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)departmentTag?__p+='\n\t<a href="javascript:void(0)" title="删除:'+(null==(__t=Name)?"":__t)+'" id="'+(null==(__t=id)?"":__t)+'" class="ux_user_area department">'+(null==(__t=imgTemplate)?"":__t)+"</a>\n":__p+='\n\t<a href="javascript:void(0)" title="删除:'+(null==(__t=Name)?"":__t)+'" id="'+(null==(__t=Id)?"":__t)+'" class="ux_user_area">'+(null==(__t=imgTemplate)?"":__t)+"</a>\n";return __p},this.JST["task-create/task-create-apply-user"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<span class="task-create-tools-item task-create-applyuser-wraper" title="审批人">\n\t<a class="task-create-tools-link task-create-applyuser-icon '+(null==(__t=applyUser?"task-create-applyuser-icon-active":"")?"":__t)+'" href="javascript:void(0)" data-name="task-create-applyuser">审批人：\n\t\t',applyUser&&applyUser.Name?__p+="\n\t\t\t"+(null==(__t=_.substring(applyUser.Name,6,!0))?"":__t)+" \n\t\t":__p+="\n\t\t\t无\n\t\t",__p+="\n\t</a>\n\t",applyUser&&applyUser.Name&&(__p+='\n\t\t<span data-name="task-create-delete-applyuserr"  data-id="'+(null==(__t=applyUser.Id)?"":__t)+'" class="task-create-delete-applyuser-wraper"><span  class="icon-task-close"  data-name="task-create-delete-applyuser" ></span></span>\n\t'),__p+="\n</span>\n";return __p},this.JST["task-create/task-create-bottom"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="task-create-bottom-wraper clearfix">\n\t',isShowFileUpload&&(__p+='\n\t<div class="uploader_container" style="position: relative;"><a title="" href="javascript:void(0);" data-name="file" ></a></div>\n\t'),__p+='\n\t<div class="ux_publish">\n\t\t<span data-name="publish-wraper" class="publish-wraper '+(null==(__t=packUp&&isShowPackUpBtn?"packup":"")?"":__t)+'">\n\t\t\t',isShowMessage&&(__p+='\n\t\t\t\t<div class="msg">\n\t\t\t\t\t<a href="javascript:void(0);" class="check checkbox'+(null==(__t=sendUserStatus?"-checked":"")?"":__t)+'" data-name="data-message">\n\t\t\t\t\t\t<span class="ico"></span>\n\t\t\t\t\t</a>\n\t\t\t\t\t<span class="txt" original-title="'+(null==(__t=sendUserStatus?"取消短信通知负责人":"短信通知负责人")?"":__t)+'">短信通知</span>\n\t\t\t\t</div>\n\t\t\t\t\n\t\t\t'),__p+="\n\t\t\t",isShowPrivateBtn&&(__p+='\n\t\t\t<div class="set-private-area" data-name="task-create-private">\n\t\t\t\t',"public"!==privateText.type&&(__p+='<i class="icon-lock" data-name="lock" style=""></i>'),__p+=(null==(__t=privateText.name)?"":__t)+'\n\t\t\t\t<i class="caret" data-name="range-caret"></i>\n\t\t\t</div>\n\t\t\t'),__p+="\n\t\t</span>\n\t\t\n\t\t",isShowPackUpBtn&&(__p+='\n\t\t<span class="toggle" data-name="toggle">\n\t\t\t<span class="l">'+(null==(__t=packUp?"更多信息":"收起")?"":__t)+'</span>\n\t\t\t<span class="r icon-arrow-'+(null==(__t=packUp?"down":"up")?"":__t)+'-double"></span>\n\t\t</span>\n\t\t'),__p+='\n\n\t\t<a class="btn btn-sure btn-disabled" href="javascript:void(0);" title="'+(null==(__t=pubBtnText)?"":__t)+'" data-name="set-pub-btn">'+(null==(__t=pubBtnText)?"":__t)+'</a>\n\t</div>\n</div>\n<div class="error_container"></div>\n<div class="preview_container"></div>\n<div class="loading_container"></div> ';return __p},this.JST["task-create/task-create-class"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n\t",showBorderLeft&&(__p+='\n\t\t<span class="border"></span>\n\t'),__p+='\n\t<div class="task-create-class-innder '+(null==(__t=disable?"disable":"")?"":__t)+'" data-name="task-create-class" >\n\t\t<span data-name="task-create-class-name" class="task-create-class-name">\n\t\t\t',labelId&&labelName?__p+="\n\t\t\t\t"+(null==(__t=_.substringWithM(labelName,6,!0))?"":__t)+"\n\t\t\t":__p+="\n\t\t\t\t分类/项目\n\t\t\t",__p+="\n\t\t</span>\n\t\t",4!=labelType&&(__p+='\n\t\t\t<span class="icon-arrow-down"></span>\n\t\t'),__p+="\n\t</div>\n\n\n\n";return __p},this.JST["task-create/task-create-customize-date-richeditor"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="task-create-laytout-input layout-border" data-name="task-create-add-input">\n\t<div class="task-create-add-task-container" data-name="task-create-add-task-container">\n\t\t<div class="task-create-date-container" data-name="task-create-date"></div>\n\t</div>\n\t\n</div>\n<div class="task-create-richeditor layout-border" data-name="task-create-richeditor"></div>\n<div class="task-create-bottom" data-name="task-create-bottom"></div>\n\n';return __p},this.JST["task-create/task-create-customize-work-hour"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="task-create-laytout-input layout-border" data-name="task-create-add-input">\n\t<div class="task-create-add-task-container" data-name="task-create-add-task-container">\n\t\t<div class="task-create-name-container" data-name="task-create-name"></div>\n\t\t<div class="task-create-right-part">\n\t\t\t<div class="task-create-date-container" data-name="task-create-date"></div>\n\t\t\t<div class="task-create-tools-item-wraper" data-name="task-create-hour-date"></div>\n\t\t</div>\n\t</div>\n\t\n</div>\n<div class="task-create-richeditor layout-border" data-name="task-create-richeditor"></div>\n<div class="task-create-bottom" data-name="task-create-bottom"></div>\n\n';return __p},this.JST["task-create/task-create-date"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+="\n",isCycle?__p+='\n\t<div class="task-create-date-inner" data-name="task-create-date-box" original-title="'+(null==(__t=cycleTip)?"":__t)+'">\n\t\t<span class="ico icon-action-cycle-active" data-name="task-create-date-ico"></span>\n\t</div>\n':__p+='\n\t<div class="task-create-date-inner" data-name="task-create-date-box" original-title="'+(null==(__t=dateTip)?"":__t)+'">\n\t\t\t<span class="ico icon-task-during" data-name="task-create-date-ico"></span>\n\t</div>\n';return __p},this.JST["task-create/task-create-external-person"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<span class="task-create-tools-item" data-name="task-create-extend-person" title="外部联系人">\n\t<a href="javascript:void(0)" class="task-create-tools-link task-create-add-icon ',extendUser&&(__p+="task-create-add-icon-active"),__p+='">外部联系人</a>\n</span>\n';return __p},this.JST["task-create/task-create-name"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+="\n\n",iconShow&&(__p+='\n\t<span class="ico-name '+(null==(__t=iconClassName)?"":__t)+'"></span>\n'),__p+='\n<input class="'+(null==(__t=iconShow?"has-icon":"")?"":__t)+'" data-name="task-create-name" type="text" placeholder="'+(null==(__t=defaultText)?"":__t)+'" value="'+(null==(__t=taskTitle)?"":__t)+'" />\n\n<div data-name="task-create-name-dropdown"></div>\n';return __p},this.JST["task-create/task-create-participator"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<span data-name="task-create-participator" class="task-create-tools-item task-create-participator" title="'+(null==(__t=participatorsCount?participatorsCount+"人":"添加参与者")?"":__t)+'">\n\t<a href="javascript:void(0)" class="task-create-tools-link task-create-add-icon '+(null==(__t=participatorsCount?"task-create-add-icon-active":"")?"":__t)+'" >\n\t\t'+(null==(__t=participatorsCount?"参与者："+participatorsCount+"人":"参与者")?"":__t)+"\n\t</a>\n</span>\n";return __p},this.JST["task-create/task-create-principle"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<div class="task-create-principle">\n\t<span class="task-create-principle-inner" data-name="task-create-principle-inner">\n\t\t<span class="icon-task-creater"></span>\n\t\t<label class="task-create-principle-label" data-name=\'task-create-principle-label\' >'+(null==(__t=_.substring(principalUser.Name,6,!0))?"":__t)+"负责</label>\n\t</span>\n</div>\n";return __p},this.JST["task-create/task-create-replace"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<div class="task-create-tools-item task-create-replace '+(null==(__t=isCanReplace?"":"disable")?"":__t)+'" original-title="'+(null==(__t=isCanReplace?"点击可切换任务发起人":"不可以代自己发起任务")?"":__t)+'">\n\t\t\t\t\n\t<span class="task-create-replace-check-wraper" data-name="task-create-replace-check-wraper">\n\t\t',isCanReplace?(__p+="\n\t\t\t",replaceRadioChecked?__p+='\n\t\t\t\t<span class="task-create-replace-check checkbox checkbox-checked" data-name="task-create-replace-check"></span>\n\t\t\t':__p+='\n\t\t\t\t<span class="task-create-replace-check checkbox" data-name="task-create-replace-check"></span>\n\t\t\t',__p+="\n\t\t"):__p+='\n\t\t\t<span class="task-create-replace-check checkbox-default-disable %>"></span>\n\t\t',__p+='\n\t</span>\n\t<span class="task-create-replace-label" data-name="task-create-replace-label">代ta发起</span>\n\t<span class="task-create-help">\n\t\t<a href="http://service.tita.com/pages/viewpage.action?pageId=590556" target="_blank" class="icon-help"></a>\n\t</span>\n</div>\n\n';return __p},this.JST["task-create/task-create-workhour"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)showBorderLeft&&(__p+='\n\t<span class="border"></span>\n'),__p+='\n<span class="task-create-tools-item task-create-workhour"  data-name="task-create-workhour"\n\ttitle="'+(null==(__t=hourDate||minuteDate?"修改工时":"设置工时")?"":__t)+'">\n\t<a class="task-create-tools-link task-create-add-icon '+(null==(__t=workHour?"task-create-add-icon-active":"")?"":__t)+'">\n\t\t'+(null==(__t=workHour?workHour+" 小时":"工时")?"":__t)+"\n\t</a>\n</span>\n";return __p},this.JST["task-create/task-create"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="task-create-laytout-input layout-border" data-name="task-create-add-input">\n\t<div class="task-create-add-task-container" data-name="task-create-add-task-container">\n\t\t<div class="task-create-class" data-name="task-create-class"></div>\n\t\t<div class="task-create-name-container" data-name="task-create-name"></div>\n\t\t<div class="task-create-right-part">\n\t\t\t<div class="task-create-principle-area" data-name="task-create-principle-area"></div>\n\t\t\t<div class="task-create-date-container" data-name="task-create-date"></div>\n\t\t</div>\n\t</div>\n\t\n</div>\n<div class="task-create-layout-tools clearfix layout-border" data-name="task-create-tools">\n\t\t<div class="task-create-tools-item-wraper" data-name="task-create-hour-date"></div>\n\t\t<div class="task-create-tools-item-wraper" data-name="task-create-participator"></div>\n\t\t<div class="task-create-tools-item-wraper" data-name="task-create-apply-user"></div>\n\t\t<div class="task-create-tools-item-wraper" data-name="task-create-external-person"></div>\n\t\t<div class="task-create-tools-item-wraper" data-name="task-create-replace"></div>\n\n</div>\n<div class="task-create-layout-extend layout-border" data-name="task-create-layout-extend">\n\t<div class="task-create-layout-member-list " data-name="task-create-member-list"></div>\n\t<div class="task-create-layout-extend-user " data-name="task-create-extend"></div>\n</div>\n\n<div class="task-create-richeditor layout-border" data-name="task-create-richeditor"></div>\n<div class="task-create-bottom" data-name="task-create-bottom"></div>\n\n';return __p},this.JST["img-preview/img-preview-content-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="img_ip"><img src="'+(null==(__t=smallUrl)?"":__t)+'" ></div>';return __p},this.JST["img-preview/img-preview-content"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="bg_ip" data-name="img-preview-overlay" style="width:'+(null==(__t=dialogW)?"":__t)+"px;height:"+(null==(__t=dialogH)?"":__t)+'px"></div>\n\n<div class="wrap_ip">\n\t<div class="contant_ip">\n\t\t<div class="origin_ip">\n\t\t\t<span class="icon-img-left left_oip" data-name="origin-left" style="margin-top:'+(null==(__t=originPageTop)?"":__t)+'px"></span>\n\t\t\t<span class="icon-img-right right_oip" data-name="origin-right" style="margin-top:'+(null==(__t=originPageTop)?"":__t)+'px"></span>\n\t\t\t<div class="see_ip" data-name="origin-box">\n\t\t\t\t<img src="" width="100" height="100"  data-name="origin-img">\n\t\t\t</div>\n\t\t\t\n\t\t</div>\n\t\t<div class="thumbnail_ip">\n\t\t\t<div class="action_tip" data-name="thumb-pre"><span class="icon-img-pre-small"></span></div>\n\t\t\t<div class="list_tip" data-name="thumb-list-box">\n\t\t\t\t<ul data-name="thumb-list">\n\t\t\t\t</ul>\n\t\t\t</div>\n\t\t\t<div class="action_tip" data-name="thumb-next"><span class="icon-img-next-small"></span></div>\n\t\t</div>\n\t\t\n\t\t\n\t</div>\n\t<div data-name="img-preview-info"></div>\n</div>\n';return __p},this.JST["img-preview/img-preview-info"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<span class="name_">'+(null==(__t=fileName)?"":__t)+'</span>\n<ul class="action_ip">\n\t<li><span class="icon-img-origin"></span><a href="'+(null==(__t=previewUrl)?"":__t)+'" target="_blank">原文件</a></li>\n\t<li><span class="icon-img-down"></span><a href="'+(null==(__t=downloadUrl)?"":__t)+'">下载</a></li>\n\t\x3c!-- <li id="'+(null==(__t=documentId)?"":__t)+'" data-name="img-preview-delete"><span class="icon-img-delete"></span><a href="javascript:void(0);">删除</a></li> --\x3e\n</ul>';return __p},this.JST["img-preview/img-preview"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+="";return __p},this.JST["attachment-list/attachment-list-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="cont_afb">\n\t<div class="img_afb">\n\t\t',isImage?__p+='\n\t\t<img src="'+(null==(__t=smallUrl)?"":__t)+'">\n\t\t':__p+='\n\t\t<span class="ico_afb file-'+(null==(__t=fileType)?"":__t)+'"></span>\n\t\t',__p+="\n\t</div>\n</div>\n\n",isImage&&1==documentSource&&(__p+='\n<span class="shade_afb" data-name="feed-attachment-preview-dialog"></span>\n<span class="icon-zoom-in zoom-afb" data-name="feed-attachment-preview-button"></span>\n\n'),__p+='\n<div class="name_afb">'+(null==(__t=fileName)?"":__t)+'</div>\n<div class="action_afb">\n\t<a href="'+(null==(__t=downloadUrl)?"":__t)+'">下载</a>\n\t',deleteable&&(__p+='\n\t<a href="javascript:void(0);" data-name="attachment-deleted" id="'+(null==(__t=documentId)?"":__t)+'">删除</a>\n\t'),__p+="\n\t",isPreview&&(__p+="\n\t\t",isImage&&1==documentSource?__p+='\n\t\t\t<a href="javascript:void(0);" data-name="feed-attachment-preview">预览</a>\n\t\t':__p+='\n\t\t\t<a href="'+(null==(__t=previewUrl)?"":__t)+'" target="_blank">预览</a>\n\t\t',__p+="\n\t"),__p+="\n</div>\n\n";return __p},this.JST["publish-dynamic/publish-mblog"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\r\n<div class="box_pm" data-name="mblog-box">\r\n\t<div class="content_pm input-default" data-name ="new-content-wrap">\r\n\t\t',defaultValue&&(__p+='\r\n\t\t\t<div><label data-name="new-defaultvalue">'+(null==(__t=defaultValue)?"":__t)+"</label></div>\r\n\t\t"),__p+='\r\n\t\t<div class="input_pm">\r\n\t\t\t<textarea  data-name="new-content" style="resize:none;">'+(null==(__t=value)?"":__t)+'</textarea>\r\n\t\t</div>\r\n\t\t<div class="count_pm">\r\n\t\t\t',isLimit?__p+='\r\n\t\t\t\t<span class="num_pm" data-name="count">'+(null==(__t=total)?"":__t)+"</span>/"+(null==(__t=maxlength)?"":__t)+"\r\n\t\t\t":__p+='\r\n\t\t\t\t<span class="num_pm" data-name="count">'+(null==(__t=total)?"":__t)+"</span>\r\n\t\t\t",__p+='\r\n\t\t\t\r\n\t\t</div>\r\n\t</div>\r\n\t<div class="action_pm">\r\n\t\t<ul class="list_pm">\r\n\t\t\t',isShowAttachment&&(__p+='\r\n\t\t\t<li class="ament_pm uploader_container"><a title="" href="javascript:void(0);" data-name="file" ></a></li>\r\n\t\t\t'),__p+="\r\n\t\t\t",isShowAt&&(__p+='\r\n\t\t\t<li class="at_pm" data-name="at">\r\n\t\t\t\t<span class="icon-at"></span>\r\n\t\t\t\t<a href="javascript:void(0);" title="">'+(null==(__t=atText)?"":__t)+"</a>\r\n\t\t\t</li>\r\n\t\t\t"),__p+="\r\n\t\t\t",isShowAtAll&&(__p+='\r\n\t\t\t<li class="atall_pm" data-name="atall">\r\n\t\t\t\t<span class="icon-at"></span>\r\n\t\t\t\t<a title="" href="javascript:void(0);" ></span>'+(null==(__t=atAllText)?"":__t)+"</a>\r\n\t\t\t</li>\r\n\t\t\t"),__p+="\r\n\r\n\t\t\t",isShowEmotion&&(__p+='\r\n\t\t\t<li class="emotion_pm" data-name="emotion">\r\n\t\t\t\t<span class="icon-emotion"></span>\r\n\t\t\t\t<a title="" href="javascript:void(0);"></span>'+(null==(__t=emotionText)?"":__t)+"</a></li>\r\n\t\t\t"),__p+='\r\n\t\t</ul>\r\n\r\n\t\t<button class="btn btn-sure btn-disabled" data-name="submit">'+(null==(__t=submitText)?"":__t)+'</button>\r\n\t\t<button class="cancel_pm" data-name="cancel">取消</button>\r\n\t\t',isShowRange&&(__p+='\r\n\t\t<span class="quna_pm" id="1" isvisible="0" data-name="range"><i class="icon-lock" data-name="lock"></i><span data-name="range-cont">'+(null==(__t=privateText)?"":__t)+'</span><i class="caret" data-name="range-caret"></i></span>\r\n\t\t'),__p+="\r\n\t\t",isShowSendSms&&(__p+='\r\n\t\t\t<span class="pub_message" data-name="mblog-sms">\r\n\t\t\t\t<span class="checkbox" data-name="mblog-sms-input"></span>\r\n\t\t\t\t<span  data-name="mblog-sms-text" original-title="被@的同事将会收到短信通知">短信通知</span>\r\n\t\t\t</span>\r\n\t\t'),__p+='\r\n\t\t\r\n\t</div>\r\n\t<div id="attachmentViewBox_homeMblog" class="error_container"></div>\r\n\t<div id="attachmentViewBox_homeMblog" class="preview_container"></div>\r\n\t<div id="attachmentViewBox_homeMblog" class="loading_container"></div>\r\n</div>\r\n';return __p},this.JST["publish-dynamic/publist-mblog-toreply"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<span>回复</span>&nbsp;<span class="closed_pm" data-name="to-reply-closed">'+(null==(__t=toUserName)?"":__t)+"&nbsp;×</span>";return __p},this.JST["emotion/emotion-body"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){__p+='<table class="emotion-table-size-'+(null==(__t=currentData.size)?"":__t)+'">\n\t';var emotions=currentData.emticons,colNum="small"==currentData.size?14:7,rowNum=Math.ceil(emotions.length/colNum),item=null;__p+="\n\t";for(var i=0;i<rowNum;i++){__p+="\n\t\t<tr>\n\t\t\t";for(var j=0;j<colNum&&i*colNum+j<emotions.length;j++)__p+="\n\t\t\t\t",item=emotions[i*colNum+j],__p+='\n\t\t\t\t<td>\n\t\t\t\t\t<span class="td-border"></span>\n\t\t\t\t\t<img data-name="emotion-img" src="'+(null==(__t=currentData.host+item.address)?"":__t)+'"  title="'+(null==(__t=item.name)?"":__t)+'">\n\t\t\t\t</td>\n\t\t\t';__p+="\n\t\t</tr>\t\t\n\t"}__p+="\n\t\t\n</table>"}return __p},this.JST["emotion/emotion-tab"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)for(var i=0,len=data.length;i<len;i++)__p+='\n\t<div class="emotion-tab-item '+(null==(__t=data[i].name==currentTab?"tab-active":"")?"":__t)+'" data-id="'+(null==(__t=data[i].name)?"":__t)+'">\n\t\t'+(null==(__t=data[i].name)?"":__t)+"\n\t</div>\n";return __p},this.JST["emotion/emotion"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="emotion-tab-container" data-name="emotion-tab-container">\n\n</div>\n<div class="emotion-body-container" data-name="emotion-body-container">\n\n</div>';return __p},this.JST["work-hour/work-hour"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){__p+='<div class="task-create-work-hour-pop">\n\t<div class="ux_hour_list">\n\t\t<h2>小时</h2>\n\t\t<div class="hour_list">\n\t\t\t';for(var i=0;i<25;i++)__p+='\n\t\t\t\t<a href="javascript:void(0)" ',""!=hourDate&&hourDate==i&&(__p+='class="current"'),__p+='data-time="'+(null==(__t=i)?"":__t)+'">\n\t\t\t\t\t',__p+=i<=9?"\n\t\t\t\t\t\t0"+(null==(__t=i)?"":__t)+"\n\t\t\t\t\t":"\n\t\t\t\t\t\t"+(null==(__t=i)?"":__t)+"\n\t\t\t\t\t",__p+="\n\t\t\t\t</a>\n\t\t\t";__p+='\n\t\t\t\n\t\t</div>\n\t</div>\n\t<div class="ux_minite_list">\n\t\t<h2>分钟</h2>\n\t\t<div class="minite_list">\n\t\t\t<a href="javascript:void(0)"  data-time="0" ',""!==minuteDate&&0==minuteDate&&(__p+='class="current"'),__p+='>00</a>\n\t\t\t<a href="javascript:void(0)"  data-time="15" ',15==minuteDate&&(__p+='class="current"'),__p+='>15</a>\n\t\t\t<a href="javascript:void(0)"  data-time="30" ',30==minuteDate&&(__p+='class="current"'),__p+='>30</a>\n\t\t\t<a href="javascript:void(0)"  data-time="45" ',45==minuteDate&&(__p+='class="current"'),__p+=">45</a>\n\t\t</div>\n\t</div>\n</div>"}return __p},this.JST["class/checked-class-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="checked_name">'+(null==(__t=name)?"":__t)+'</div>\n<a href="javascript:void(0)" data-handler="Delete" class="smember_btn_reduce">\n\t<span></span>\n</a>';return __p},this.JST["class/class-component"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="top_cd">\n\t',isMulti&&(__p+='\n\t<div class="top_title">选择分类</div>\n\t'),__p+='\n\t<ul class="tab_cd" data-name="klass-tab">\n\t\t',isShowClass&&(__p+='\n\t\t<li data-type="17">选择分类</li>\n\t\t'),__p+="\n\t\t",isShowWork&&(__p+='\n\t\t\t<li data-type="4">选择'+(null==(__t=i18n.work_1)?"":__t)+"</li>\n\t\t"),__p+="\n\t\t",isShowTarget&&(__p+='\n\t\t\t<li data-type="402">选择目标</li>\n\t\t'),__p+='\n\t</ul>\n\t<span class="icon-dialog-closed closed_cd" data-name="klass-close"></span>\n</div>\n<div class="box_cd" >\n\t<div data-name="klass-content" class="plan-klass-content"></div>\n</div>';return __p},this.JST["class/class-new"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<form data-name="file-move-new-form">\n\t',"rename"!=type&&(__p+='\n\t<div class="title_tv">\n\t'),__p+='\n\t\t<div class="new_tv">\n\t\t\t<div class="input-default input_ntv" data-name="file-move-new-input-warp">\n\t\t\t\t<input type="text" value="'+(null==(__t=name)?"":__t)+'">\n\t\t\t</div>\n\t\t\t<span class="btn_ntv icon-radius-success-over" data-name="file-move-new-submit"></span>\n\t\t\t<span class="btn_ntv icon-radius-error-over" data-name="file-move-new-cancel"></span>\n\t\t</div>\n\t',"rename"!=type&&(__p+="\n\t</div>\n\t"),__p+="\n</form>";return __p},this.JST["class/class-rename"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<form data-name="rename-form">\n\t<div class="input-default input_ridl" data-name="rename-inputwrap">\n\t\t<input type="text" value="'+(null==(__t=name)?"":__t)+'">\n\t</div>\n\t<a class="btn btn-sure" data-name="rename-sure">确定</a>\n\t<a class="btn btn-cancel" data-name="rename-cancel">取消</a>\n</form>\n';return __p},this.JST["class/class-search"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="class_search_form_container">\n\t<div class="class_search_header_input">\n\t\t<label class="class_search_condition_label" data-name="smember-condition">搜索分类</label>\n\t\t<input  autocomplete="off" id="lableName" class="class_search_condition_input smemberInput " type="text"  name="content"></input>\n\t\t<span class="icon-search"></span>\n\t</div>\n\t<div class="lable-list" id="lable-list" data-name="lable-list">\n\t\t<ul class="lable-ul" data-name="lable-ul" id="lable-ul"></ul>\n\t</div>\n</div>';return __p},this.JST["class/class-tree-component"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="class_data_pop_header">\n\t'+(null==(__t=title)?"":__t)+'\n\t<a href="javascript:void(0)" class="icon-dialog-closed" data-handler="Close"></a>\n</div>\n<div class="class_data_pop_content">\n\t<div class="class_data_search_content_left">\n\t\t<div class="tab">\n\t\t\t<span class="class active" data-name="all">所有分类</span>\n\t\t\t',1==pluginType&&(__p+='<span class="project" data-name="project">所有项目</span>'),__p+='\n\t\t</div>\n\t\t<div class="class_data_type_list"></div>\n\t</div>\n\t<div class="class_data_search_content_center">\n\t\t<span class="smember_search_arrow_icon search_arrow_icon"></span>\n\t</div>\n\t<div class="class_data_search_content_right">\n\t\t<span>已选类别</span>\n\t\t<div class="class_data_checked_type_list"></div>\n\t</div>\n</div>\n<div class="smember_footer">\n\t<a href="javascript:void(0)" class="btn btn-cancel" data-handler="clean">清除全部</a>\n\t<a href="javascript:void(0)" class="btn cancel_rd" data-handler="Cancel">取消</a>\n\t<a href="javascript:void(0)" class="btn btn-sure sure_rd" data-handler="Submit">确定</a>\n</div>   ';return __p},this.JST["class/class-tree-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="title_tv" data-name="title">\n\n\t',0==isEnd&&(__p+='\n\t<span class="icon_tv" data-name="toggle"></span>\n\t'),__p+="\n\t","undefined"!=typeof IsTenant&&IsTenant?(__p+='\n\t\t<span class="icon-enterprise_icon" data-name="enterprise"></span>\n\t\t<div class="text_tv_parent">\n\t\t\t<div class="text_tv text_width" data-name="title-name">'+(null==(__t=name)?"":__t)+"</div>\n\t\t\t",IsAllowSetPersonalLable||(__p+='\n\t\t\t\t<span class="m-lock icon-lock" data-name="lock-permission"></span>\n\t\t\t'),__p+="\n\t\t</div>\n\t"):"undefined"==typeof IsTenant||IsTenant?__p+='\n\t\t<div class="text_tv" data-name="title-name">'+(null==(__t=name)?"":__t)+"</div>\n\t":__p+='\n\t\t<span class="icon-personal_img" data-name="person"></span>\n\t\t<div class="text_tv_parent">\n\t\t\t<div class="text_tv personal" data-name="title-name">'+(null==(__t=name)?"":__t)+"</div>\n\t\t</div>\n\t",__p+="\n\t",0!=id&&isEdit&&(__p+="\n\t\t","undefined"==typeof IsTenant||IsTenant||(__p+='\n\t\t\t<div class="action_ttv" data-name="klass-item-action">\n\t\t\t\t<a href="javascript:void(0);" data-name="edit" id="'+(null==(__t=id)?"":__t)+'">编辑</a>\n\t\t\t\t<a href="javascript:void(0);" data-name="deleted" data-end="'+(null==(__t=isEnd)?"":__t)+'" id="'+(null==(__t=id)?"":__t)+'">删除</a>\n\t\t\t</div> \n\t\t'),__p+="  \n\t"),__p+="\n</div>\n<ul></ul>";return __p},this.JST["class/class"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="title_rd" data-name="title">\n    <h2>我的分类</h2>\n    <span class="icon-dialog-closed closed_rd" data-name="klass-move-close"></span>\n</div>\n<div class="cont_rd">\n    <div class="tt_tree_view">\n        <div data-name="class-project-tab"></div>\n        <div data-name="search-class"></div>\n        <div data-name="tree" class="moveTreeList">\n            <div class="_tt_loading_m">努力加载中…</div>\n        </div>\n        <div data-name="empty"></div>\n    </div>\n    <div class="class_data_search_content_center">\n        <span class="smember_search_arrow_icon search_arrow_icon"></span>\n    </div>\n    <div class="class_data_search_content_right">\n        <span>已选类别</span>\n        <div class="class_data_checked_type_list" data-name=\'class-data-checked\'></div>\n    </div>\n</div>\n<div class="bottom_rd" data-name="klass-action">\n    <button class="btn btn-cancel reset_rd" data-name="klass-move-reset">清空选项</button>\n    <button class="btn btn-cancel new_rd" data-name="klass-move-new-folder">添加分类</button>\n    <button class="btn btn-cancel cancel_rd" data-name="klass-move-cancel">取消</button>\n    <button class="btn btn-sure sure_rd" data-name="klass-move-submit">确定</button>\n</div>\n';return __p},this.JST["class/work-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<span class="icon-work-small"></span><span>'+(null==(__t=WorkName)?"":__t)+"</span>";return __p},this.JST["class/work-list"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<div class="title_kw" data-name="work-title">\n\t<span class="icon-minus-square" data-name="toggle"></span><span>'+(null==(__t=title)?"":__t)+'</span>\n</div>\n<ul data-name="work-list"></ul>';return __p},this.JST["class/work"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="title_rd" data-name="work-move-title">\n\t<h2>'+(null==(__t=i18n.work_1)?"":__t)+'分类</h2>\n\t<span class="icon-dialog-closed closed_rd" data-name="work-move-close"></span>\n</div>\n<div class="cont_rd">\n\t<div class="tt_tree_view">\n\t\t<div data-name="work-box">\n\t\t\t<div class="_tt_loading_m">努力加载中…</div>\n\t\t</div>\n\t\t<div data-name="work-box-join"></div>\n\t\t<div data-name="empty"></div>\n\t</div>\n\t<div class="class_data_search_content_center">\n\t\t<span class="smember_search_arrow_icon search_arrow_icon"></span>\n\t</div>\n\t<div class="class_data_search_content_right">\n\t\t<span>已选类别</span>\n\t\t<div class="class_data_checked_type_list" data-name=\'class-data-checked\'></div>\n\t</div>\n</div>\n<div class="bottom_rd" data-name="work-action">\n\t<button class="btn btn-cancel reset_rd" data-name="work-move-reset">清空选项</button>\n\t<button class="btn btn-cancel new_rd" data-name="work-move-new-folder">新建项目</button>\n\t<button class="btn btn-cancel cancel_rd" data-name="work-move-cancel">取消</button>\n\t<button class="btn btn-sure sure_rd" data-name="work-move-submit">确定</button>\n\t\n</div>';return __p},this.JST["evaluation/evaluation-dimension-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="dimension-title">'+__e(name)+'</label>\n<div class="star-list-container" data-name="star-container">\n</div>';return __p},this.JST["evaluation/evaluation-dimension"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<label class="evaluation-title">维度评分</label>\n<div class="evaluation-dimension-container eval-item">\n\t<ul></ul>\n</div>';return __p},this.JST["evaluation/evaluation-edit"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<ul class="evaluation-list">\n',isShowScores&&(__p+='\n<li class="evaluation-score" data-name="evaluation-edit-score">\n</li>\n'),__p+="\n",isShowDimensions&&(__p+='\n<li class="evaluation-dimension" data-name="evaluation-edit-dimension">\n</li>\n'),__p+="\n",isShowMedal&&(__p+='\n<li class="evaluation-medal clearfix" data-name="evaluation-edit-medal">\n</li>\n'),__p+='\n<li class="evaluation-comment">\n\t<label class="evaluation-title">评语</label>\n\t<div class="evaluation-comment eval-item">\n\t\t<textarea class="comment" placeholder="完成的不错，继续努力！" data-name="comment">'+__e(remark)+'</textarea>\n\t</div>\n</li>\n</ul>\n<div class="evaluation-operate">\n\t<span class="btn btn-sure  btn-disabled" data-name="evaluation-save">确定</span><span class="btn btn-cancel"  data-name="evaluation-cancel">取消</span>\n\t\n</div>\n';return __p},this.JST["evaluation/evaluation-list-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)evaluateInfos.length&&(scoreInfos||medalInfos)?(__p+='\n\t<div class="evaluation-item">\n\t  <div class="evaluation-preview clearfix">\n\t  \t',editable&&(__p+='\n\t\t\t<div class="preview-operate">\n\t\t\t\t<span class="btn btn-sure" data-name="evaluation-edit">修改评价</span>\n\t\t\t</div>\n\t\t'),__p+='\n\t\t<div class="preview-detail">\n\t\t\t<div class="evaluation-user" origin-title="'+__e(user.Name)+'">\n\t\t\t\t'+(null==(__t=_.convertImage({className:"",src:user.Avatar.Small,size:30,shape:"radius",name:user.Name,bgColor:user.Avatar.Color}))?"":__t)+'\n\t\t\t\t\n\t\t    </div>\n\t\t    <ul class="preview-list">\n\t\t    \t<li class="preview-score">\n\t\t    \t\t ',medalInfos.length&&(__p+='\n\t\t\t    \t\t <div class="label-name">奖章</div>\n\t\t\t    \t\t <div class="evaluation-result">\n\t\t\t    \t\t \t'+(null==(__t=_.TitaWidget_evaluation(medalInfos[0]))?"":__t)+"\n\t\t\t    \t\t</div>\n\t\t    \t\t "),__p+="\n\t\t    \t\t ",scoreInfos.length&&(__p+='\n\t\t\t    \t\t <div class="label-name">评分</div> \n\t\t\t    \t\t <div class="evaluation-result">\n\t\t\t    \t\t \t'+(null==(__t=_.TitaWidget_evaluation(scoreInfos[0]))?"":__t)+"\n\t\t\t    \t\t</div>\n\t\t    \t\t "),__p+='\n\t\t    \t</li>\n\t\t    \t<li class="preview-comment">\n\t\t    \t\t<div class="label-name">评语</div>\n\t\t    \t\t<p class="evaluation-result">\n\t\t    \t\t\t',substringRemark!=remark?(__p+="\n\t\t\t    \t\t\t",0==commentShowAll?__p+="\n\t\t\t    \t\t        "+__e(substringRemark)+'<a href="javascript:void(0);"  class="show-all" data-name="show-comment">展开</a>\t\n\t\t\t    \t\t     ':__p+="\n\t\t\t    \t\t        "+__e(remark)+'<a href="javascript:void(0);" class="show-all" data-name="show-comment">收起</a>\t\n\t\t\t    \t\t     ',__p+="\n\t\t    \t\t\t"):__p+="\n\t\t\t\t\t\t\t"+__e(remark)+"\n\t\t    \t\t\t",__p+="\n\t    \t\t\t</p>\n\t\t    \t</li>\n\t\t    </ul>\n\t\t    ","simple"==viewMode&&dimensionInfos&&dimensionInfos.length>0&&(__p+='\n\t\t\t\t<a href="javascript:void(0)" class="show-detail" data-name="showDetail-top">维度评分<span class="icon-arrow-down-double"></span></a>\n\t\t\t'),__p+="\n\t\t</div>\n\t\t",dimensionInfos.length&&(__p+='\n\t\t\t<div class="evaluation-dimension" data-name="evaluation-weidu-list">\n\t\t\t\t<ul class="clearfix" >\n\t\t\t\t\t',_.each(dimensionInfos,function(a,b){__p+='\n\t\t\t   \t\t\t<li class="preview-dimension-item">\n\t\t\t\t\t\t\t<label>'+__e(a.name)+'：</label>\n\t\t\t\t\t\t\t<span class="item-value"><span class="score-value">'+__e(a.value)+"</span>分</span>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"}),__p+='\n\t\t\t\t</ul>\n\t\t\t\t<a href="javascript:void(0)" class="show-detail arrow-up" data-name="showDetail">维度评分<span class="icon-arrow-up-double"></span></a>\n\t\t\t</div>\n\t\t'),__p+=" \n\t</div>  \n"):(__p+="\n\t",isAdd&&(__p+='\n\t<div class="evaluation-item">\n\t\t<div class="evaluation-none">\n\t\t\t<span class="text_none">'+(null==(__t=evaluationObject)?"":__t)+"</span>\n\t\t\t",editable&&(__p+='\n\t\t\t<span class="btn btn-sure" data-name="do-evaluation">现在评价</span>\n\t\t\t'),__p+="\n\t\t</div>\n\t</div>\n\t"),__p+="\n");return __p},this.JST["evaluation/evaluation-medal"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)isShowRadio?__p+='\n<label class="evaluation-title radio" data-name="radio">奖章鼓励</label>\n':__p+='\n<label class="evaluation-title">奖章鼓励</label>\n',__p+='\n<div class="evaluation-medal-containner eval-item clearfix" data-name="evaluation-edit-medal">\n\t',_.each(data,function(a,b){__p+="\n\t\t",cType==a.cType&&2==type?__p+='\n\t\t<div class="medal medal-active-'+(null==(__t=b)?"":__t)+" medal-hover-"+(null==(__t=b)?"":__t)+'" data-ctype="'+__e(a.cType-1)+'"  data-value="'+__e(a.value)+'" data-index="'+(null==(__t=b)?"":__t)+'">\n\t\t\t<span class="'+(null==(__t=a.className)?"":__t)+'-light "></span>\n\t\t\t<span>'+__e(a.name)+"</span>\n\t\t</div>\n\t\t":__p+='\n\t\t<div class="medal medal-hover-'+(null==(__t=b)?"":__t)+'" data-ctype="'+__e(a.cType)+'"  data-value="'+__e(a.value)+'" data-index="'+(null==(__t=b)?"":__t)+'">\n\t\t\t<span class="'+(null==(__t=a.className)?"":__t)+'"></span>\n\t\t\t<span>'+__e(a.name)+"</span>\n\t\t</div>\n\t\t",__p+="\n\t"}),__p+="\n</div>";return __p},this.JST["evaluation/evaluation-score"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n",isShowRadio?__p+='\n\t<label class="evaluation-title radio" data-name="radio">'+(null==(__t=name||"综合评分")?"":__t)+"</label>\n":__p+='\n\t<label class="evaluation-title">'+(null==(__t=name||"综合评分")?"":__t)+"</label>\n",__p+="\n<div class=\"evaluation-score-container eval-item\" data-name='evaluation-edit-score'></div>\n\n\n";return __p},this.JST["evaluation/evaluation-star"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj){__p+='<ul class="evaluation-star-list">\n\t';for(var i=1;i<=lvl;i++){var dataValue=i*goal;__p+="\n\t\t",dataValue<=value?__p+='\n\t\t   <li class="icon-star-m-active" original-title="评分:'+__e(dataValue)+'分" data-value="'+__e(dataValue)+"\" data-index='"+__e(i-1)+'\' data-name="star"></li>\n\t\t':__p+='\n\t\t   <li class="icon-star-m-default" original-title="评分:'+__e(dataValue)+'分" data-value="'+__e(dataValue)+"\" data-index='"+__e(i-1)+'\' data-name="star"></li>\n\t\t',__p+="\n    "}__p+="\n</ul>\n",value&&(__p+='\n<div class="last-score">\n\t<span class="score-value">'+__e(value)+'</span><span class="value-unit">分</span>\n</div>\n')}return __p},this.JST["experience/experience"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="head-ev">填写心得</div>\n<div data-name="experience-contant"></div>';return __p},this.JST["task-apply/task-apply-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="apply_left">\n    <div class="apply_date">\n        <span class="blue_date">'+(null==(__t=startDate)?"":__t)+"</span><span>"+(null==(__t=startHour)?"":__t)+"</span>\n    </div>\n    ","approval"!=type&&(__p+='\n        <div class="apply_date ">\n            <span class="blue_date">',startDate!=endDate&&(__p+=null==(__t=endDate)?"":__t),__p+="</span><span>"+(null==(__t=endHour)?"":__t)+"</span>\n        </div>\n    "),__p+='\n    <div class="apply_middel">\n    \t',"approval"==type&&(__p+='<div class="apply_pen"></div>'),__p+="\n\t    ","argeed"==type&&(__p+='<div class="apply_ok"></div>'),__p+="\n\t    ","rejected"==type&&(__p+='<div class="apply_wrong"></div>'),__p+="\n\t    ","approval"!=type&&(__p+='\n\t        <div class="apply_tree"></div>\n\t        <div class="apply_end"></div>\n\t    '),__p+="\n\t    ","approval"!=type||isEditApplyAble||(__p+='\n\t        <div class="apply_tree"></div>\n\t        <div class="apply_end"></div>\n\t    '),__p+=' \n\t</div>\n</div>\n\n<div class="apply_right">\n    <div class="apply_msg">'+(null==(__t=txtTemplate)?"":__t)+"</div>\n   ","approval"!==type&&(__p+='\n        <div class="apply_msg">'+(null==(__t=applyUser.name)?"":__t)+"：<span>","argeed"==type?__p+="已同意":"rejected"==type&&(__p+="已驳回"),__p+="</span></div>\n   "),__p+="\n   ",isEditApplyAble||"approval"!=type||(__p+='\n        <div class="apply_msg">待审批</div>\n   '),__p+="\n",isEditApplyAble&&(__p+='\n    <div class="apply_item_edit">\n        <button class="btn btn-sure" data-name="sure-item">同意</button>\n        <button class="btn btn-cancel" data-name="cancel-item">驳回</button>\n    </div>\n'),__p+="\n</div>\n",applyDescription&&(__p+='\n\t<div class="apply_refuse_content">驳回理由：<span>'+(null==(__t=applyDescription)?"":__t)+"</span></div>\n"),__p+="\n";return __p},this.JST["task-apply/task-apply"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)isShowAllButton&&(__p+='\n<div class="apply_all" data-name="task-apply-all">\n\t<button class="btn btn-sure" data-name="task-apply-sure-all">全部同意</button>\n\t<button class="btn btn-cancel" data-name="task-apply-cancel-all">全部驳回</button>\n</div>\n'),__p+='\n<div data-name="task-apply-list"></div>';return __p},this.JST["set-notice/set-notice"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n\t<div class="outer_nst">\n\t\t<div class="content_nst">\n\t\t\t<div class="wrap_time_nst clearfix">\n\t\t\t\t<span class="timelabel_nst mylock">提醒时间</span>\n\t\t\t\t<div class="day_time_nst" data-name="day-input">\n\t\t\t\t\t<a class="triday_nst " href="javascript:void(0)"></a>\n\t\t\t\t\t<label cyctype="0" uservalue="'+(null==(__t=today)?"":__t)+'" data-name="day-input-value">'+(null==(__t=today)?"":__t)+'</label>\n\t\t\t\t\t<div class="day_timewrap_nst" data-name="day-dropdown">\n\t\t\t\t\t\t\n\t\t\t\t\t\t<ul class="dayvalues_nst">\n\t\t\t\t\t\t\t'+(null==(__t=day7)?"":__t)+'\n\t\t\t\t\t\t\t<li label="其它日期" uservalue="0" class="other_nst" data-name="day-other">\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)">其它日期</a>\n\t\t\t\t\t\t\t\t<div class="day-timepicker" data-name="day-dropdown-datepicker"></div>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li class="everyday_nst" label="每天" uservalue="1" data-name="day-every-day"><a href="javascript:void(0);">每天</a></li>\n\t\t\t\t\t\t\t<li class="everyworkday_nst" label="每个工作日" uservalue="2" data-name="day-every-weekday"><a href="javascript:void(0);">每个工作日</a></li>\n\t\t\t\t\t\t\t<li label="每周" uservalue="3" class="weektime_nst" data-name="day-every-week">\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)">每周</a>\n\t\t\t\t\t\t\t\t<dl class="weektimevalue_nst" data-name="day-dropdown-week">\n\t\t\t\t\t\t\t\t\t<dd uservalue="2" label="每周一"><a href="javascript:void(0)">周一</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="3" label="每周二"><a href="javascript:void(0)">周二</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="4" label="每周三"><a href="javascript:void(0)">周三</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="5" label="每周四"><a href="javascript:void(0)">周四</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="6" label="每周五"><a href="javascript:void(0)">周五</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="7" label="每周六"><a href="javascript:void(0)">周六</a></dd>\n\t\t\t\t\t\t\t\t\t<dd uservalue="1" label="每周日"><a href="javascript:void(0)">周日</a></dd>\n\t\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t\t<li label="每月" uservalue="11" class="monthtime_nst" data-name="day-every-month">\n\t\t\t\t\t\t\t\t<a href="javascript:void(0)" >每月</a>\n\t\t\t\t\t\t\t\t<dl class="monthtimevalue_nst" data-name="day-dropdown-month">\n\t\t\t\t\t\t\t\t\t'+(null==(__t=month31)?"":__t)+'\n\t\t\t\t\t\t\t\t</dl>\n\t\t\t\t\t\t\t</li>\n\t\t\t\t\t\t</ul>\n\t\t\t\t\t</div>\n\t\t\t\t</div>\n\t\t\t\t<div class="his_time_nst" data-name="hour-wrap">\t\t\n\t\t\t\t\t<a class="tritime_nst " href="javascript:void(0)"></a>\t\t\t\n\t\t\t\t\t<label class="timecur_nst" uservalue="'+(null==(__t=nowHour)?"":__t)+'" label="'+(null==(__t=nowHour)?"":__t)+'" data-name="hour-input-value">'+(null==(__t=nowHourLabel)?"":__t)+'</label>\n\t\t\t\t\t<ul class="timevalues_nst" data-name="hour-dropdown">\n\t\t\t\t\t\t'+(null==(__t=hour24)?"":__t)+'\n\t\t\t\t\t</ul>\t\t\t\t\t\n\t\t\t\t</div>\n\t\t\t\t<div class="minite_time_nst"  data-name="minite-wrap">\n\t\t\t\t\t<a class="triminite_nst " href="javascript:void(0)"></a>\n\t\t\t\t\t<label class="minitecur_nst" uservalue = "00" label="00" data-name="minite-input-value">00</label>\n\t\t\t\t\t<ul class="minitevalues_nst" data-name="minute-dropdown">\n\t\t\t\t\t\t'+(null==(__t=minite12)?"":__t)+'\n\t\t\t\t\t</ul>\n\t\t\t\t</div>\n\t\t\t</div>\n\t\t\t<div data-name="person-list"></div>\n\t\t\t<div class="desc_nst" data-name="remind-desc-wrap">\n\t\t\t\t<textarea class="default_nst" defaultValue="提醒内容" data-name="remind-desc-input">提醒内容</textarea>\n\t\t\t</div>\n\n\t\t\t<div class="tip_nst" data-name="error-tip"></div>\n\t\t\t<div class="btn_nst">\n\t\t\t\t<a class="btn btn-candel" href="javascript:void(0)" data-name="remind-button-cancel-remind">取消提醒</a>\n\t\t\t\t<a class="btn btn-sure" href="javascript:void(0)"  data-name="remind-button-sure">确定</a>\n\t\t\t\t<a class="btn btn-candel" href="javascript:void(0)" data-name="remind-button-cancel">取消</a>\n\t\t\t</div>\n\t\t</div>\n\t</div>';return __p},this.JST["add-user/add-user-composite"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="title-pl">'+(null==(__t=title)?"":__t)+'</div>\n<div class="list-pl">\n<em class="ux_add_btn"></em>\n<ul></ul>\n</div>';return __p},this.JST["add-user/add-user-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)"undefined"!=typeof type&&"department"==type?__p+='\n<a href="javascript:void(0)" title="删除:'+(null==(__t=name)?"":__t)+'" id="'+(null==(__t=id)?"":__t)+'" class="square">'+(null==(__t=_.TitaWidget_substring(name,2,!1))?"":__t)+"</a>\n":__p+='\n<a href="javascript:void(0)" title="删除:'+(null==(__t=Name)?"":__t)+'" id="'+(null==(__t=Id)?"":__t)+'" class="ux_user_area">'+(null==(__t=_.convertImage({src:UserAvatar.Small,size:30,name:Name,bgColor:UserAvatar.Color}))?"":__t)+"</a>\n";return __p},this.JST["feed/feed-action-more"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n\t<ul>\n\t\t",detail&&(__p+='<li data-name="feed-action-detail"><a href="'+(null==(__t=detailUrl)?"":__t)+'" target="_blank">查看详情</a></li>'),__p+="\n\t\t",deleted&&(__p+='<li data-name="feed-action-del">删除</li>'),__p+="\n\t\t",setTop&&(__p+='<li data-name="feed-action-top">',isTop?__p+="取消置顶":__p+="置顶",__p+="</li>"),__p+="\n\t</ul>\n";return __p},this.JST["feed/feed-action"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<div class="refer_fb">\n\t<span class="time_fb">'+(null==(__t=createDate)?"":__t)+"</span>\n\t&nbsp;&nbsp;<span>"+(null==(__t=postSource)?"":__t)+'</span>\n</div>\n<ul class="action_fb">\n\t\n\t',isShowReply&&(__p+='\n\t\t<li data-name="feed-action-reply">\n\t\t\t<span class="icon-dialogue"></span><span>回复</span>\n\t\t</li>\n\t'),__p+="\n\t",isShowCollect&&(__p+='\n\t\t<li class="line_afb">|</li>\n\t\t<li data-name="feed-action-collect">\n\t\t\t<span class="icon-heart"></span><span>',isCollect?__p+="取消收藏":__p+="收藏",__p+="</span>\n\t\t</li>\n\t\t\n\t"),__p+="\n\t",isShowPraise&&(__p+='\n\t\t<li class="line_afb">|</li>\n\t\t<li data-name="feed-action-praise">\n\t\t\t<span class="icon-hand"></span><span>',isPraise?__p+="取消赞":__p+="赞",__p+="</span>\n\t\t</li>\n\t"),__p+="\n\t",isShowReward&&(__p+='\n\t<li class="line_afb">|</li>\n\t<li data-name="feed-action-beg">\n\t\t<span class="ico-gold-coin"></span><span>讨赏</span>\n\t</li>\n\t<li class="line_afb">|</li>\n\t<li data-name="feed-action-reward">\n\t\t<span class="ico-money-bag"></span><span>打赏</span>\n\t</li>\n\t'),__p+="\n</ul>";return __p},this.JST["feed/feed-attachment-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="cont_afb">\n\t<div class="img_afb">\n\t\t',isImage?__p+='\n\t\t<img src="'+(null==(__t=smallUrl)?"":__t)+'">\n\t\t':__p+='\n\t\t<span class="ico_afb file-'+(null==(__t=fileType)?"":__t)+'"></span>\n\t\t',__p+="\n\t</div>\n</div>\n\n",isImage&&1==documentSource&&(__p+='\n<span class="shade_afb" data-name="feed-attachment-preview-dialog"></span>\n<span class="icon-zoom-in zoom-afb" data-name="feed-attachment-preview-button"></span>\n\n'),__p+='\n<div class="name_afb">'+(null==(__t=fileName)?"":__t)+'</div>\n<div class="action_afb">\n\t<a href="'+(null==(__t=downloadUrl)?"":__t)+'" ',3==documentSource&&(__p+='target="_blank" '),__p+=">下载</a>&nbsp;\n\t",deleteable&&(__p+='\n\t<a href="javascript:void(0);" data-name="attachment-deleted" id="'+(null==(__t=documentId)?"":__t)+'">删除</a>&nbsp;\n\t'),__p+="\n\t",isPreview&&(__p+="\n\t\t",isImage&&1==documentSource?__p+='\n\t\t\t<a href="javascript:void(0);" data-name="feed-attachment-preview">预览</a>\n\t\t':(__p+='\n\t\t\t<a href="',1==documentSource&&(__p+=null==(__t=webHost.host)?"":__t),__p+=(null==(__t=previewUrl)?"":__t)+'" target="_blank">预览</a>&nbsp;\n\t\t'),__p+="\n\t"),__p+="\n</div>\n\n";return __p},this.JST["feed/feed-attachment-list"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<ul class="list_afb"></ul>';return __p},this.JST["feed/feed-comment-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n\t<div class="left_cb">\n\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=publishUser.userId)?"":__t)+'" traget="_blank">\n\t\t'+(null==(__t=_.convertImage({className:"avatar_small_fl",src:publishUser.avatar.medium,size:30,shape:"radius",name:publishUser.name,bgColor:publishUser.avatar.color}))?"":__t)+'\n\t\t</a>\n\t</div>\n\t<div class="right_cb">\n\t\t<div class="dynamic_cb clearfix">\n\t\t\t<span class="name_box_ccb">\n\t\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=publishUser.userId)?"":__t)+'" class="name_dcb" traget="_blank">'+(null==(__t=publishUser.name)?"":__t)+"</a>",2==commentType&&(__p+='&nbsp;回复&nbsp;<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=parentUser.userId)?"":__t)+'" class="name_dcb">'+(null==(__t=parentUser.name)?"":__t)+'</a>&nbsp;<span class="dehua_dcb" data-name="feed-dehua" data-parent-id="'+(null==(__t=parentCommentId)?"":__t)+'">的话</span>'),__p+="\n\t\t\t：</span>"+(null==(__t=toggleContent)?"":__t)+"\n\t\t\t",contentMax&&(__p+="\n\t\t\t\t",contentShowAll?__p+='\n\t\t\t\t<a href="javascript:void(0);" class="slide_fb" data-name="comment-content-slide">收起&nbsp;<b class="icon-drop-up" ></b></a>\n\t\t\t\t':__p+='\n\t\t\t\t<a href="javascript:void(0);" class="slide_fb" data-name="comment-content-slide">展开&nbsp;<b class="icon-drop-down" ></b></a>\n\t\t\t\t',__p+="\n\t\t\t"),__p+='\n\t\t</div>\n\t\t<div data-name="feed-comment-attachment"></div>\n\t\t<div class="refer_cb">\n\t\t\t',isPrivate&&(__p+='\n\t\t\t<span class="icon-lock-thin lock_fb" data-name="feed-comment-lock" original-title=""></span>\n\t\t\t'),__p+='\n\t\t\t<span class="time_cb">'+(null==(__t=createDate)?"":__t)+'</span>\n\t\t\t<div class="action_cb">\n\t\t\t\t',isEdit&&(__p+='\n\t\t\t\t<a href="javascript:void(0);" data-name="feed-comment-deleted" id="'+(null==(__t=commentId)?"":__t)+'">删除</a>&nbsp;\n\t\t\t\t'),__p+='\n\t\t\t\t<a href="javascript:void(0);" data-name="feed-comment-reply" id="'+(null==(__t=commentId)?"":__t)+'">回复</a>\n\t\t\t</div>\n\t\t</div>\n\t</div>\n';return __p},this.JST["feed/feed-comment-list"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="total_fl" data-name="feed-comment-total">共<span data-name="feed-comment-total-num">'+(null==(__t=total)?"":__t)+'</span>条回复&nbsp;<b class="icon-drop-down" data-name="feed-comment-total-ico"></b></div>\n',total&&total>0&&(__p+='\n<div data-name="comment-list"></div>\n'),__p+="\n";return __p},this.JST["feed/feed-daily"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\t<dt>\n\t\t<span class="type_stfb">'+(null==(__t=dailyType)?"":__t)+'</span>&nbsp;\n\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+(null==(__t=url)?"":__t)+'" class="name_stfb" target="_blank">'+(null==(__t=name)?"":__t)+"</a>\n\t\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t\t",1==dailySubmit.type?__p+='\n\t\t<span class="icon-right icos_dfb"></span>':2==dailySubmit.type&&(__p+='\n\t\t<span class="icon-right-delay icos_dfb"></span>'),__p+='<span class="status_stfb">'+(null==(__t=dailySubmit.content)?"":__t)+"</span>&nbsp;&nbsp;&nbsp;&nbsp;"+(null==(__t=evaluation)?"":__t)+'\n\t</dt>\n\t<dd data-name="feed-daily-content">\n\t\t \n\t</dd>';return __p},this.JST["feed/feed-extra-info-list-item"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<span class="key_eifb">'+(null==(__t=name)?"":__t)+"：</span>",1==valueType?__p+='<a href="'+(null==(__t=value)?"":__t)+'" target="_blank">'+(null==(__t=value)?"":__t)+"</a>":__p+=null==(__t=value)?"":__t,__p+="\n\n";return __p},this.JST["feed/feed-item-source"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n",6==feedType||7==feedType?(__p+='\n\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=publishUser.userId)?"":__t)+'" hidefocus="true" class="name_ifb" traget="_blank">'+(null==(__t=publishUser.name)?"":__t)+"</a>\n\t",publishUser.userMark&&(__p+='<img src="'+(null==(__t=publishUser.userMark.logo)?"":__t)+'" original-title="'+(null==(__t=publishUser.userMark.mark_name)?"":__t)+'" class="mark_fb" data-name="feed-user-mark">'),__p+="\n"):(__p+="\n\t",app&&0==isInAppPage&&(__p+="\n\t\t",app.appUrl?__p+='\n\t\t<a href="'+(null==(__t=app.appUrl)?"":__t)+'" hidefocus="true" class="app_ifb" target="_blank">'+(null==(__t=app.appName)?"":__t)+"</a>\n\t\t":__p+='\n\t\t\t<span class="app_ifb" span>'+(null==(__t=app.appName)?"":__t)+"</span>\n\t\t",__p+="\n\t\t",2!=app&&3!=app||!app.appObjeName||(__p+='\n\t\t\t<a href="'+(null==(__t=app.appObjeUrl)?"":__t)+'" hidefocus="true" class="name_ifb">'+(null==(__t=app.appObjeName)?"":__t)+'</a><span class="txt_ifb">中</span>\n\t\t'),__p+="\n\t"),__p+="\n\t",obj&&0==isInAppPage&&(__p+="\n\t\t",15==obj.objType?__p+='\n\t\t<span class="app_ifb" target="_blank">'+(null==(__t=obj.objName)?"":__t)+"</span> \n\t\t":__p+='\n\t\t<a href="'+(null==(__t=obj.objUrl)?"":__t)+'" hidefocus="true" class="app_ifb" target="_blank">'+(null==(__t=obj.objName)?"":__t)+"</a> \n\t\t",__p+='\n\t\t<span class="cont_ifb">'+(null==(__t=sourceCont)?"":__t)+"</span>\n\t\t\n\t"),__p+='\n\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=publishUser.userId)?"":__t)+'" hidefocus="true" class="name_ifb" traget="_blank">\n\t\t'+(null==(__t=publishUser.name)?"":__t)+"</a>",publishUser.userMark&&(__p+='<img src="'+(null==(__t=publishUser.userMark.logo)?"":__t)+'" original-title="'+(null==(__t=publishUser.userMark.mark_name)?"":__t)+'" class="mark_fb" data-name="feed-user-mark">'),__p+="\n"),__p+='\n<span class="cont_ifb">'+(null==(__t=sourceTypeCont)?"":__t)+"</span>\n",isTop&&(__p+='<span class="top_fl"></span>'),__p+="\n\n";return __p},this.JST["feed/feed-item"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="left_fb" data-name="feed-left">\n\t\n</div>\n<div class="right_fb">\n\t<div data-name="feed-main"></div>\n\t<div data-name="feed-content"></div>\n\t<div data-name="feed-actoin"></div>\n</div>\n<div class="submain_fb" data-name="feed-sub-main">\n\t<div data-name="feed-comment"></div>\n</div>\n<div data-name="feed-pubblog"></div>';return __p},this.JST["feed/feed-left"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)app&&0==isInAppPage?(__p+="\n\t\n\t\n\t",203==appId&&6==feedType&&obj&&4==obj.objType&&3==obj.objSubType||7==feedType?__p+='\n\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=publishUser.userId)?"":__t)+'" hidefocus="true" traget="_blank">\n\t'+(null==(__t=_.convertImage({className:"avatar_fl",src:publishUser.avatar.medium,size:50,shape:"radius",name:publishUser.name,bgColor:publishUser.avatar.color}))?"":__t)+"\n\t":(__p+="\n\t\t",app.appObjeLogo?(__p+="\n\t\t\t",app.appObjeUrl?__p+='\n\t\t\t<a href="'+(null==(__t=app.appObjeUrl)?"":__t)+'"><img width="50" height="50" src="'+(null==(__t=app.appObjeLogo)?"":__t)+'" alt="图片" class="avatar_fl radius_img50" traget="_blank" /></a>\n\t\t\t':__p+='\n\t\t\t\t<img width="50" height="50" src="'+(null==(__t=app.appObjeLogo)?"":__t)+'" alt="图片" class="avatar_fl radius_img50" traget="_blank" />\n\t\t\t',__p+="\n\t\t"):(__p+="\n\t\t\t",app.url?__p+='\n\t\t\t<a href="'+(null==(__t=app.url)?"":__t)+'"><img width="50" height="50" src="'+(null==(__t=app.appLogo)?"":__t)+'" alt="图片" class="avatar_fl radius_img50" traget="_blank" /></a>\n\t\t\t':__p+='\n\t\t\t<img width="50" height="50" src="'+(null==(__t=app.appLogo)?"":__t)+'" alt="图片" class="avatar_fl radius_img50" traget="_blank" />\n\t\t\t',__p+="\n\t\t"),__p+="\n\t\t\n\t"),__p+="\n\n\n\n"):(__p+="\n\t",void 0!==obj&&obj&&0==isInAppPage?(__p+="\n\t\t",3==obj.objType||4==obj.objType?__p+='\n\t\t\t<a href="'+(null==(__t=obj.objUrl)?"":__t)+'" hidefocus="true"><img width="50" height="50" src="'+(null==(__t=obj.objLogo)?"":__t)+'" alt="图片" class="avatar_fl radius_img50" traget="_blank" /></a>\n\t\t':15==obj.objType?__p+="\n\t\t\t"+(null==(__t=_.convertImage({className:"avatar_fl",src:"",size:50,shape:"radius",name:obj.objName,bgColor:obj.objColor}))?"":__t)+"\n\t\t":__p+='\n\t\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=publishUser.userId)?"":__t)+'" hidefocus="true" traget="_blank">\n\t\t\t'+(null==(__t=_.convertImage({className:"avatar_fl",src:publishUser.avatar.medium,size:50,shape:"radius",name:publishUser.name,bgColor:publishUser.avatar.color}))?"":__t)+"\n\t\t\t</a>\n\t\t",__p+="\n\t"):__p+='\n\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=publishUser.userId)?"":__t)+'" hidefocus="true" traget="_blank">\n\t\t'+(null==(__t=_.convertImage({className:"avatar_fl",src:publishUser.avatar.medium,size:50,shape:"radius",name:publishUser.name,bgColor:publishUser.avatar.color}))?"":__t)+"\n\t\t</a>\n\t",__p+="\n");return __p},this.JST["feed/feed-list"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div data-name="feed-list-box"></div>\n',isEnd||(__p+='\n<div class="more_fl" data-name="feed-more">\n\t<span data-name="feed-more-text">查看更多</span>&nbsp;<span class="icon-arrow-down"></span>\n</div>\n');return __p},this.JST["feed/feed-main"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="edit_fb" data-name="feed-top-action">\n\t',isShowSlideMore&&(__p+='\n\t<span class="down_fb" data-name="feed-action-slide"><b class="icon-arrow-down"></b></span>\n\t'),__p+='\n</div>\n<div class="lock_area_fb">\n\t',isPrivate&&(__p+='<span class="icon-lock-round lock_lafb"></span>'),__p+=(null==(__t=privateTipText)?"":__t)+'\n</div>\n<div class="info_fb" data-name="feed-source">\n\t\n</div>\n<div class="clearfix clear_fb"></div>\n\n';return __p},this.JST["feed/feed-okr"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="right_wfb">\n\n\t<div class="person_wfb">\n\t\t',2!=status&&principalUser?__p+="\n\t\t当前处理人："+(null==(__t=principalUser.name)?"":__t)+'\n\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=principalUser.userId)?"":__t)+'" hidefocus="true" traget="_blank">\n\t\t'+(null==(__t=_.convertImage({className:"avatar_small_fl",src:principalUser.avatar.small,size:30,shape:"radius",name:principalUser.name,bgColor:principalUser.avatar.color}))?"":__t)+"\n\t\t</a>\n\t\t":__p+='\n\t\t评分：<span class="score_wfb">'+(null==(__t=score)?"":__t)+"</span>分\n\t\t",__p+='\n\t</div>\n\t<div class="time_wtb">\n\t\t\t'+(null==(__t=startDate)?"":__t)+"—"+(null==(__t=deadline)?"":__t)+'\n\t</div>\n</div>\n\n<dl class="cont_wfb">\n\t<dt>\n\t\t<div class="type_wfb"><span class="icon_wfb icon-xs-403"></span>考核</div>\n\t\t<div>\n\t\t\t<a href="'+(null==(__t=url)?"":__t)+'" class="name_tfb" data-name="feed-task-name" target="_blank">'+(null==(__t=assessName)?"":__t)+'</a>\n\t\t</div>\n\t</dt>\n\t<dd>\n\t\t<span class="des_wfb">进度</span>\n\t\t<div class="flow_wfb">\n\t\t\t<ul class="workflow_fb clearfix ',2==status&&(__p+="complete-all"),__p+='">\n\t\t\t\t',_.each(step,function(a,b){__p+="\n\t\t\t\t\t",2==status&&b==step.length-1?__p+='\n\t\t\t\t\t<li class="'+(null==(__t=a.className)?"":__t)+' active">\n\t\t\t\t\t\t<div class="content"><span class="ico-complete"></span>&nbsp;'+(null==(__t=a.stepName)?"":__t)+"</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t":2==a.status?__p+='\n\t\t\t\t\t<li class="active">\n\t\t\t\t\t\t<div class="content">'+(null==(__t=b+1)?"":__t)+(null==(__t=a.stepName)?"":__t)+"</div>\n\t\t\t\t\t</li>\n\t\t\t\t\t":(__p+='\n\t\t\t\t\t\t<li class="'+(null==(__t=a.className)?"":__t)+" ",b==step.length-1&&(__p+="last_wfb"),__p+='" ',4==step.length?__p+='\n\t\t\t\t\t\t\t\tstyle="width:15.62%"\n\t\t\t\t\t\t\t':__p+='\n\t\t\t\t\t\t\t\tstyle="width:23%"\n\t\t\t\t\t\t\t',__p+='>\n\t\t\t\t\t\t\t<div class="content">\n\t\t\t\t\t\t\t\t',step.length>=4&&2==status&&0==b?__p+='\n\t\t\t\t\t\t\t\t\t<span class="ico-omit-highlight"></span>\n\t\t\t\t\t\t\t\t':step.length>=4&&2!=status&&3==b?__p+='\n\t\t\t\t\t\t\t\t\t<span class="ico-omit"></span>\n\t\t\t\t\t\t\t\t':1==a.status?__p+='\n\t\t\t\t\t\t\t\t\t<span class="ico-complete"></span>\n\t\t\t\t\t\t\t\t':3==a.status&&(__p+="\n\t\t\t\t\t\t\t\t\t"+(null==(__t=b+1)?"":__t)+"\n\t\t\t\t\t\t\t\t"),__p+="\n\t\t\t\t\t\t\t</div>\n\t\t\t\t\t\t</li>\n\t\t\t\t\t"),__p+="\n\t\t\t\t"}),__p+="\n\t\t\t</ul>\n\t\t</div>\n\t</dd>\n</dl>\n\n";return __p},this.JST["feed/feed-plan"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='<dt>\n\t<span class="type_stfb">\n\t\t',2==feedType?__p+="\n\t\t目标\n\t\t":3==feedType?__p+="\n\t\t考核表\n\t\t":__p+="\n\t\t计划表\n\t\t",__p+="\n\t</span>\n\t",app?__p+='\n\t\t<a href="'+(null==(__t=app.appObjeUrl)?"":__t)+'" hidefocus="true" class="skip_mmfed" target="_blank">'+(null==(__t=app.appObjeName)?"":__t)+"</a>\n\t":__p+='\n\t\t<a href="'+(null==(__t=planTableUrl)?"":__t)+'" class="name_stfb">'+(null==(__t=planTableName)?"":__t)+"</a>\n\t",__p+="\n</dt>\n";return __p},this.JST["feed/feed-praise"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n\t<div class="cont_pfb">\n\t\t<span class="icon-hand-round-',isPraise?__p+="-active":__p+="highlight",__p+=' icos_prb" data-name="feed-praise-praise"></span>\n\t\t',total>10&&(__p+='<span data-name="feed-praise-all">'),__p+="\n\t\t",_.each(praisesList,function(a,b){__p+='\n\t\t<a href="'+(null==(__t=a.url)?"":__t)+'">'+(null==(__t=a.name)?"":__t)+"</a>",b+1<praisesList.length&&(__p+=","),__p+="\n\t\t"}),__p+="&nbsp;",total>10&&(__p+="等&nbsp;"+(null==(__t=total)?"":__t)+"&nbsp;"),__p+="人觉得很赞",total>10&&(__p+="</span>"),__p+="\n\t</div>\n";return __p},this.JST["feed/feed-share"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n",isShowIco&&(__p+='<span class="icon-quotes-left"></span>&nbsp;'),__p+="\n"+(null==(__t=content)?"":__t)+"\n",contentMax&&(__p+="\n\n\t",contentShowAll?__p+='\n\t<a href="javascript:void(0);" class="slide_fb" data-name="content-slide">收起&nbsp;<b class="icon-drop-up" ></b></a>\n\t':__p+='\n\t<a href="javascript:void(0);" class="slide_fb" data-name="content-slide">展开&nbsp;<b class="icon-drop-down" ></b></a>\n\t',__p+="\n"),__p+="\n",isShowIco&&(__p+='&nbsp;<span class="icon-quotes-right"></span>'),__p+="\n";return __p},this.JST["feed/feed-signin-track"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+="\n",_.each(timeSites,function(a,b){__p+="\n<li ",b==timeSites.length-1&&(__p+='class="end_ssfb"'),__p+=">\n\t",__p+=0==b?'\n\t\t<span class="icon-round-up-star"></span>\n\t':'\n\t\t<span class="icon-round-down-end"></span>\n\t',__p+='\n\t<span class="time_ssfb">'+(null==(__t=a.time)?"":__t)+'</span><span class="text_ssfb">签到地点：'+(null==(__t=a.site)?"":__t)+"</span>\n\t",timeSites.length>defaultCount&&b==timeSites.length-1&&(__p+='\n\t&nbsp;&nbsp;&nbsp;&nbsp;\n\t<a href="javascript:void(0);" class="slide_fb" data-name="feed-signin-slide">\n\t\t',singinTrackShowAll?__p+='\n\t\t收起（5）<b class="icon-drop-up"></b>\n\t\t':__p+='\n\t\t展开（5）<b class="icon-drop-down"></b>\n\t\t',__p+="\n\t</a>\n\t"),__p+="\n</li>\n\n"});return __p},this.JST["feed/feed-signin"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div class="cont_sfb">\n\t<span class="type_sfb">移动签到</span>\n\t<span class="name_sfb">'+(null==(__t=date)?"":__t)+'</span>\n\t&nbsp;&nbsp;&nbsp;&nbsp;<span class="des_dfb">工作计时：</span><span class="full_sfb">'+(null==(__t=workHours)?"":__t)+"小时</span>\n</div>\n";return __p},this.JST["feed/feed-tab-list"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<div data-name="feed-tab"></div>\n<div data-name="feed-list"></div>\n<div data-name="feed-list-empty"></div>\n';return __p},this.JST["feed/feed-tab"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='\n<ul class="nav_tabs" data-name="feed-nav">\n\t<li data-name="aboutme-all">\n\t\t<a href="'+(null==(__t=hash)?"":__t)+'feedType=aboutme-all" data-trigger="false">'+(null==(__t=i18n.myfollowfeed_1)?"":__t)+'</a>\n\t\t<span class="red-remind" data-name="feed-aboutme-indicator"></span>\n\t</li>\n\t<li>\n\t\t<a href="'+(null==(__t=hash)?"":__t)+'feedType=department" data-trigger="false">部门动态</a>\n\t\t<span class="red-remind" data-name="feed-department-indicator"></span>\n\t</li>\n\t<li>\n\t\t<a href="'+(null==(__t=hash)?"":__t)+'feedType=all" data-trigger="false">'+(null==(__t=i18n.myallfeed_1)?"":__t)+'</a>\n\t\t<span class="red-remind" data-name="feed-all-indicator"></span>\n\t</li>\n</ul>\n<div data-name="feed-search" class="feed-search"></div>\n<ul class="sub-tab-nav" data-name="feed-sub-nav">\n\t<li class="active"><a href="'+(null==(__t=hash)?"":__t)+'feedType=aboutme-all"  data-trigger="false">所有</a></li>\n\t<li><a href="'+(null==(__t=hash)?"":__t)+'feedType=aboutme-replyme" data-trigger="false">'+(null==(__t=i18n.myreplayfeed_1)?"":__t)+'</a></li>\n\t<li><a href="'+(null==(__t=hash)?"":__t)+'feedType=aboutme-tome" data-trigger="false">'+(null==(__t=i18n.myleavefeed_1)?"":__t)+'</a></li>\n\t<li><a href="'+(null==(__t=hash)?"":__t)+'feedType=aboutme-fromme" data-trigger="false">'+(null==(__t=i18n.mypublishfeed_1)?"":__t)+'</a></li>\n\t<li><a href="'+(null==(__t=hash)?"":__t)+'feedType=aboutme-collect" data-trigger="false">'+(null==(__t=i18n.mycollectfeed_1)?"":__t)+"</a></li>\n</ul>\n\n\n\n";return __p},this.JST["feed/feed-task-app"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="right_tfb">\n\n\t<span class="status_tfb icon-status-'+(null==(__t=status)?"":__t)+'"></span>\n\t<div class="person_tfb">\n\t\t',counter.workTimeTotal>0&&(__p+='\n\t\t<b class="hour_tfb">\n\t\t\t<span class="icon-work-hour-small"></span>\n\t\t\t'+(null==(__t=counter.workTimeTotal)?"":__t)+"\n\t\t</b>\n\t\t"),__p+="\n\t\t",(principalUser&&principalUser.userId)!=publishUser.userId?(__p+='\n\t\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=publishUser.userId)?"":__t)+'" hidefocus="true" traget="_blank">\n\t\t\t\t'+(null==(__t=_.convertImage({className:"avatar_small_fl",src:publishUser.avatar.small,size:30,shape:"radius",name:publishUser.name,bgColor:publishUser.avatar.color}))?"":__t)+"\n\t\t\t</a>\n\t\t\t",app&&901==app.appId?__p+="提交给":__p+="安排给",__p+="\n\t\t"):__p+="\n\t\t负责人："+(null==(__t=principalUser.name)?"":__t)+"\n\t\t",__p+='\n\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=principalUser.userId)?"":__t)+'" hidefocus="true" traget="_blank">\n\t\t'+(null==(__t=_.convertImage({className:"avatar_small_fl",src:principalUser.avatar.small,size:30,shape:"radius",name:principalUser.name,bgColor:principalUser.avatar.color}))?"":__t)+'\n\t\t</a>\n\t</div>\n\t<div class="time_ftb">\n\t\t',evaluation||"2"==status?__p+="\n\t\t\t"+(null==(__t=evaluation)?"":__t)+"\n\t\t":(__p+="\n\t\t\t","undefined"!=typeof isLongTerm&&isLongTerm?__p+="\n\t\t\t长期":__p+=null==(__t=date)?"":__t,__p+="\n\t\t"),__p+='\n\t</div>\n</div>\n\n<dl class="cont_tfb">\n\t<dt>\n\t\t<span class="type_tfb">',isCycle&&(__p+="循环"),__p+=(null==(__t=typeName)?"":__t)+"</span>\n\t\t<div>\n\t\t\t",isPush?__p+='\n\t\t\t\t<a href="'+(null==(__t=webHost.host)?"":__t)+(null==(__t=url)?"":__t)+'" class="name_tfb" data-name="feed-task-name" target="_blank">'+(null==(__t=taskName)?"":__t)+"</a>\n\t\t\t":__p+='\n\t\t\t\t<a href="'+(null==(__t=webHost.host)?"":__t)+(null==(__t=url)?"":__t)+'" class="name_tfb" target="_blank">'+(null==(__t=taskName)?"":__t)+"</a>\n\t\t\t",__p+='\n\t\t\t<b class="icos_tfb">\n\t\t\t\t',counter.taskTotal>0&&(__p+='\n\t\t\t\t\t<span class="icon-plan-task item_icon_tfb" original-title="有任务"></span>\n\t\t\t\t\t<span>'+(null==(__t=counter.taskTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.businessTripTotal>0&&(__p+='\n\t\t\t\t\t<span class="icon-plan-trip item_icon_tfb" original-title="有出差"></span>\n\t\t\t\t\t<span>'+(null==(__t=counter.businessTripTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.experienceTotal>0&&(__p+='\n\t\t\t\t\t<span class="icon-plan-summarize item_icon_tfb" original-title="有心得"></span>\n\t\t\t\t\t<span>'+(null==(__t=counter.experienceTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.meetTotal>0&&(__p+='\n\t\t\t\t\t<span class="icon-plan-meeting item_icon_tfb" original-title="有会议"></span>\n\t\t\t\t\t<span>'+(null==(__t=counter.meetTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.attachmentTotal>0&&(__p+='\n\t\t\t\t\t<span class="icon-plan-attachment item_icon_tfb" original-title="有附件"></span>\n\t\t\t\t\t<span>'+(null==(__t=counter.attachmentTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+='\n\t\t\t</b>\n\t\t</div>\n\t</dt>\n\t<dd>\n\t\t<span class="des_tfb">',description?__p+=null==(__t=description)?"":__t:__p+="暂无描述",__p+="</span>\n\t</dd>\n</dl>\n\n";return __p},this.JST["feed/feed-task"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="right_tfb">\n\n\t<span class="status_tfb icon-status-'+(null==(__t=status)?"":__t)+'"></span>\n\t<div class="person_tfb">\n\t\t',counter.workTimeTotal>0&&(__p+='\n\t\t<b class="hour_tfb">\n\t\t\t<span class="icon-work-hour-small"></span>\n\t\t\t'+(null==(__t=counter.workTimeTotal)?"":__t)+"h\n\t\t</b>\n\t\t"),__p+="\n\t\t",(principalUser&&principalUser.userId)!=publishUser.userId?(__p+='\n\t\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=publishUser.userId)?"":__t)+'" hidefocus="true" traget="_blank">\n\t\t\t\t'+(null==(__t=_.convertImage({className:"avatar_small_fl",src:publishUser.avatar.small,size:30,shape:"radius",name:publishUser.name,bgColor:publishUser.avatar.color}))?"":__t)+"\n\t\t\t</a>\n\t\t\t",app&&901==app.appId?__p+="提交给":__p+="安排给",__p+="\n\t\t"):__p+="\n\t\t负责人："+(null==(__t=principalUser.name)?"":__t)+"\n\t\t",__p+='\n\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=principalUser.userId)?"":__t)+'" hidefocus="true" traget="_blank">\n\t\t'+(null==(__t=_.convertImage({className:"avatar_small_fl",src:principalUser.avatar.small,size:30,shape:"radius",name:principalUser.name,bgColor:principalUser.avatar.color}))?"":__t)+'\n\t\t</a>\n\t</div>\n\t<div class="time_ftb">\n\t\t',evaluation||"2"==status?__p+="\n\t\t\t"+(null==(__t=evaluation)?"":__t)+"\n\t\t":(__p+="\n\t\t\t","undefined"!=typeof isLongTerm&&isLongTerm?__p+="\n\t\t\t长期":__p+=null==(__t=date)?"":__t,__p+="\n\t\t"),__p+='\n\t</div>\n</div>\n\n<dl class="cont_tfb">\n\t<dt>\n\t\t<span class="type_tfb">',isCycle&&(__p+="循环"),__p+=(null==(__t=typeName)?"":__t)+"</span>\n\t\t<div>\n\t\t\t",isPush?__p+='\n\t\t\t\t<a href="'+(null==(__t=webHost.host)?"":__t)+(null==(__t=url)?"":__t)+'" class="name_tfb" data-name="feed-task-name" target="_blank">'+(null==(__t=taskName)?"":__t)+"</a>\n\t\t\t":__p+='\n\t\t\t\t<a href="'+(null==(__t=webHost.host)?"":__t)+(null==(__t=url)?"":__t)+'" class="name_tfb" target="_blank">'+(null==(__t=taskName)?"":__t)+"</a>\n\t\t\t",__p+='\n\t\t\t<b class="icos_tfb">\n\t\t\t\t',counter.taskTotal>0&&(__p+='\n\t\t\t\t\t<span class="icon-plan-task item_icon_tfb" original-title="有任务"></span>\n\t\t\t\t\t<span>'+(null==(__t=counter.taskTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.businessTripTotal>0&&(__p+='\n\t\t\t\t\t<span class="icon-plan-trip item_icon_tfb" original-title="有出差"></span>\n\t\t\t\t\t<span>'+(null==(__t=counter.businessTripTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.experienceTotal>0&&(__p+='\n\t\t\t\t\t<span class="icon-plan-summarize item_icon_tfb" original-title="有心得"></span>\n\t\t\t\t\t<span>'+(null==(__t=counter.experienceTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.meetTotal>0&&(__p+='\n\t\t\t\t\t<span class="icon-plan-meeting item_icon_tfb" original-title="有会议"></span>\n\t\t\t\t\t<span>'+(null==(__t=counter.meetTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+="\n\t\t\t\t",counter.attachmentTotal>0&&(__p+='\n\t\t\t\t\t<span class="icon-plan-attachment item_icon_tfb" original-title="有附件"></span>\n\t\t\t\t\t<span>'+(null==(__t=counter.attachmentTotal)?"":__t)+"</span>\n\t\t\t\t"),__p+='\n\t\t\t</b>\n\t\t</div>\n\t</dt>\n\t<dd>\n\t\t<div class="label_tfb" data-name="feed-lable">\n\t\t\t',4==labelType?__p+='\n\t\t\t<span class="icon-work-small ico_tfb"></span>\n\t\t\t':labelType&&(__p+='\n\t\t\t<span class="icon-app-micro-'+(null==(__t=labelType)?"":__t)+' ico_tfb"></span>\n\t\t\t'),__p+="<span>"+(null==(__t=labelName)?"":__t)+'</span>\n\t\t</div>\n\t\t<span class="des_tfb">',description?__p+=null==(__t=description)?"":__t:__p+="暂无描述",__p+="</span>\n\t</dd>\n</dl>\n\n";return __p},this.JST["feed/feed-track"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)total>defaultCount&&(__p+='\n<div class="total_fl" data-name="task-track-slide">共<span data-name="feed-comment-total-num">'+(null==(__t=total)?"":__t)+"</span>条操作&nbsp;",taskTrackShowAll?__p+='<b class="icon-drop-up"></b>':__p+='<b class="icon-drop-down"></b>',__p+="</div>\n"),__p+="\n\n<dl>\n\t",_.each(comments,function(a,b){__p+="\n\t",1==comments.length?__p+='\n\t\t<dd class="one_tkfb">\n\t':b==comments.length-1?__p+='\n\t\t<dd class="last_tkfb">\n\t':__p+="\n\t\t<dd>\n\t",__p+='\n\t\t<div class="left_tkfb">\n\t\t\t',b==comments.length-1?__p+='\n\t\t\t<span class="icon-point-round-lighthight ico_tkfb"></span><span class="date_tkfb new_tkfb">'+(null==(__t=a.dealCreateDate)?"":__t)+"</span>\n\t\t\t":(__p+="\n\t\t\t\t",a.isShowIco&&(__p+='<span class="icon-point-round ico_tkfb"></span>'),__p+='<span class="date_tkfb">'+(null==(__t=a.dealCreateDate)?"":__t)+"</span>\n\t\t\t"),__p+='\n\t\t</div>\n\t\t<div class="cont_tkfb">\n\t\t\t',a.publishUser&&(__p+="\n\t\t\t"+(null==(__t=a.publishUser.name)?"":__t)+":&nbsp;&nbsp;"),__p+=(null==(__t=a.content)?"":__t)+"\n\t\t</div>\n\t\t\n\t"}),__p+="\n</dl>";return __p},this.JST["feed/feed-work"]=function(obj){function print(){__p+=__j.call(arguments,"")}obj||(obj={});var __t,__p="",__e=_.escape,__j=Array.prototype.join;with(obj)__p+='\n<div class="right_wfb">\n\n\t<span class="status_wfb icon-status-'+(null==(__t=status)?"":__t)+'"></span>\n\t<div class="person_wfb">\n\t\t',counter.workTimeTotal>0&&(__p+='\n\t\t<b class="hour_wfb">\n\t\t\t<span class="icon-work-hour-small"></span>\n\t\t\t'+(null==(__t=counter.workTimeTotal)?"":__t)+"\n\t\t</b>\n\t\t"),__p+="\n\t\t",(principalUser&&principalUser.userId)!=publishUser.userId?(__p+='\n\t\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=publishUser.userId)?"":__t)+'" hidefocus="true" traget="_blank">\n\t\t\t\t'+(null==(__t=_.convertImage({className:"avatar_small_fl",src:publishUser.avatar.small,size:30,shape:"radius",name:publishUser.name,bgColor:publishUser.avatar.color}))?"":__t)+"\n\t\t\t</a>\n\t\t\t",app&&901==app.appId?__p+="提交给":__p+="安排给",__p+="\n\t\t"):__p+="\n\t\t负责人："+(null==(__t=principalUser.name)?"":__t)+"\n\t\t",__p+='\n\t\t<a href="'+(null==(__t=webHost.webHost)?"":__t)+"#italent/home?name=TalentProfile-record&to_user_id="+(null==(__t=principalUser.userId)?"":__t)+'" hidefocus="true" traget="_blank">\n\t\t'+(null==(__t=_.convertImage({className:"avatar_small_fl",src:principalUser.avatar.small,size:30,shape:"radius",name:principalUser.name,bgColor:principalUser.avatar.color}))?"":__t)+'\n\t\t</a>\n\t</div>\n\t<div class="time_wtb">\n\t\t',evaluation||"2"==status?__p+="\n\t\t\t"+(null==(__t=evaluation)?"":__t)+"\n\t\t":(__p+="\n\t\t\t","undefined"!=typeof isLongTerm&&isLongTerm?__p+="\n\t\t\t长期":__p+=null==(__t=date)?"":__t,__p+="\n\t\t"),__p+='\n\t</div>\n</div>\n\n<dl class="cont_wfb">\n\t<dt>\n\t\t<div class="type_wfb"><span class="icon_wfb icon-xs-'+(null==(__t=labIcoType.ico)?"":__t)+'"></span>'+(null==(__t=labIcoType.text)?"":__t)+'</div>\n\t\t<div>\n\t\t\t<a href="'+(null==(__t=webHost.host)?"":__t)+(null==(__t=obj&&obj.objUrl)?"":__t)+'" class="name_tfb" data-name="feed-task-name" target="_blank">'+(null==(__t=workName)?"":__t)+'</a>\n\t\t\n\t\t</div>\n\t</dt>\n\t<dd>\n\t\t<span class="des_wfb">',description?__p+=null==(__t=description)?"":__t:__p+="暂无描述",__p+="</span>\n\t</dd>\n</dl>\n\n";return __p},this.JST["feed/search-form"]=function(obj){obj||(obj={});var __t,__p="",__e=_.escape;with(obj)__p+='<form>\r\n<div class="input-default">\r\n\t<a href="javascript:void(0);" title="" class="button_sfl" data-type="submit-content" ><span class="icon-search"></span></a>\r\n\t<input type="text" data-type="new-content" autocomplete="off" />\r\n</div>\r\n</form>';return __p},this.JST}(),apiServer=BSGlobal.apiPath,Context={getGlobal:function(a){return BSGlobal[a]},changeHash:function(a,b,c){var d=decodeURIComponent(location.hash),e=d.split("?"),f=Context.parseUrl(d),g=[];if(url=null,c=1==c,"deleted"==b)for(var h=0,i=a.length;h<i;h++)delete f[a[h]];"add"==b&&(f=Talent._.extend({},f,a)),"eidt"==b&&(f=Talent._.extend({},f,a));for(var j in f)g.push(j+"="+f[j]);g.length?url=e[0]+"?"+g.join("&"):url=e[0],Talent.app.execute("history:navigate",url,c)},getLocalStorage:function(){if("object"==typeof localStorage)return localStorage;if("object"==typeof globalStorage)return globalStorage[location.host];throw new Error("local storage not available")},deleteGlobalProp:function(a){delete BSGlobal[a]},setGlobal:function(a,b){BSGlobal[a]=b},getTenantInfo:function(){return BSGlobal.tenantInfo},getUserInfo:function(){return BSGlobal.loginUserInfo},getStaticUrl:function(a){return"../../images/components/tita-widget/"+a},getApiUrl:function(a){var b=this.getUserInfo().Id,c=this.getTenantInfo().Id;return apiServer+"/api/v1/"+c+"/"+b+"/"+a},getApiUrlV2:function(a){var b=this.getUserInfo().Id,c=this.getTenantInfo().Id;return apiServer+"/api/v2/"+c+"/"+b+"/"+a},parseUrl:function(a){var b={};if(!a)return b;var c=a.indexOf("?");if(c>-1)for(var d=a.slice(c+1),e=d.split("&"),f=0;f<e.length;f++){var g=e[f].split("=");b[g[0]]=decodeURIComponent(g[1])}return b},getI18n:function(){var a={home_1:"动态",plan_1:"计划",work_1:"项目",document_1:"文件",workmate_1:"同事",app_1:"应用",task_1:"任务",task_2:"循环任务",schedule_1:"日程",share_1:"分享",sharing_1:"分享",follow_1:"立即关注",following_1:"正在关注",cancelfollow_1:"取消关注",myfollowmate_1:"我关注的",myfans_1:"我的粉丝",publishshare_1:"发分享",publishtask_1:"派任务",myfollowfeed_1:"与我相关",mypublishfeed_1:"我发表的",myleavefeed_1:"@我的",myreplayfeed_1:"回复我的",mycollectfeed_1:"我收藏的",myallfeed_1:"所有动态",message_1:"消息",remind_1:"提醒",myschedule_1:"我的日程",href_1:"常用链接",invitemate_1:"邀请同事",helpcenter_1:"帮助中心",onlineuser_1:"在线同事"},b={guide_1:"打开导览"};return BSGlobal&&BSGlobal.BSi18n?Talent._.extend({},BSGlobal.BSi18n,b):Talent._.extend({},a,b)},getAttachmentType:function(a){return{image:["jpg","png","gif","jpeg","JPG","PNG","GIF","JPEG"],file:["rar","zip","exe","pdf","txt","doc","docx","ppt","pptx","XLS","XLSX","RAR","ZIP","EXE","PDF","TXT","DOC","DOCX","PPT","PPTX","XLS","XLSX"],music:["mp3","wma","wav","flac","ape","ogg","aac","m4a","MP3","WMA","WAV","FLAC","APE","OGG","AAC","M4A"],video:["mp4","mkv","rm","rmvb","avi","3gp","flv","wmv","asf","mpeg","mpg","mov","ts","m4v"]}},getUploadOptions:function(a){var b=this.getGlobal("evn"),c=b&&"develop"==b?"tita-inc.com":"tita.com",d={validate:{format:[],onceLimt:20,allLimt:-1,nameLimt:-1},callbackName:"jsCallback",url:this.getApiUrl("Upload/PostFiles"),ajaxUrl:this.getApiUrl("Upload/PostFiles?format=json"),fileInputName:"file_upload",extendData:{domain:"document.domain="+c},error:{error_allLimt:"文件超出最大限度",error_format:"文件格式不合法",error_nameLimt:"名字长度不合格"},isPaste:!0,isDrag:!0,callbackValue:"parent._callback_"};return a&&(d=Talent._.extend({},d,a)),d},isAbsolutePath:function(){var a=this.getGlobal("titaHost")||"",b="http://"+location.host,c="";return c=a==b?"":a+"/u/"+this.getUserInfo().Id+"/Home",{host:a,webHost:c}},encodeScript:function(a){return 0==a.length?"":(s=a.replace(/</g,"&lt;"),s=s.replace(/>/g,"&gt;"),s)},dencodeScript:function(a){return 0==a.length?"":(s=a.replace(/&lt;/g,"<"),s=s.replace(/&gt;/g,">"),s)},formatDate:function(a){if(!a)return a;var b=moment().year(),c=a.split(" ");return moment(new Date(a)).year()==b&&(a=c[1]?moment(new Date(a)).format("M/D HH:mm"):moment(new Date(a)).format("M/D")),a},setPosition:function(a,b,c){var d={container:Talent.$("body"),pos:"bottom",leftBias:0,topBias:0,autoFrames:"body"},c=Talent._.extend({},d,c),e=c.container||Talent.$("body"),f=e.offset(),g=a.offset(),h=a.outerHeight(),i=a.outerWidth(),j=b.outerWidth(),k=b.outerHeight(),l={},m=g.top,n=g.left,o=m-f.top,p=n-f.left;switch(c.pos){case"top":l={top:o-k,left:p},"bottom";break;case"topCenter":l={top:o-k,left:p+i/2-j/2},"bottom";break;case"topRight":l={top:o-k,left:p+i-j},l.left<0&&(l.left=0),"bottom";break;case"bottom":l={top:o+h,left:p},"top";break;case"bottomCenter":l={top:o+h,left:p+i/2-j/2},"top";break;case"bottomRight":l={top:o+h,left:p+i-j},l.left<0&&(l.left=0),"top";break;case"left":l={top:o,left:p-j},"right";break;case"leftCenter":l={top:o+h/2-k/2,left:p-j},"right";break;case"leftBottom":l={top:o+h-k,left:p-j},"right";break;case"right":l={top:o,left:p+i},"left";break;case"rightCenter":l={top:o+h/2-k/2,left:p+i},"left";break;case"rightBottom":l={top:o+h-k,left:p+i},"left"}c.leftBias&&(l.left=l.left+c.leftBias),c.topBias&&(l.top=l.top+c.topBias);var q=Talent.$(window).height(),r=Talent.$(window).width(),s=Talent.$(document).scrollTop(),t=Talent.$(document).scrollLeft();if(f.top+l.top+k>q+s){var u=q+s-(f.top+l.top+k);l.top=l.top+u}if(f.top+l.top<s){var u=s-(f.top+l.top);l.top=l.top+u}if(f.left+l.left+j>r+t){var v=r+t-(f.left+l.left+j);l.left=l.left+v}if(f.left+l.left<t){var v=t-(f.left+l.left);l.left=l.left+v}b.css(l)},IsOpenYifangyun:function(){var a=Talent.Context.getGlobal("WebHead")||{},b=a.AppHead||[];return!!b.length&&!!_.findWhere(b,{AppId:"801"})},getUploadTipText:function(){return'<div style="text-align:left"><b style="display:block;font-size:14px;">支持拖拽上传<br>最多一次能上传20个</b>大小不超过20M</div>'},getAppHead:function(a){var b=this.getGlobal("WebHead");if(b){var c=b.AppHead||[],d=Talent._.findWhere(c,a);return d||null}}};_.TitaWidget_substring=function(a,b,c){if(!a)return"";for(var d=0,e="",f=/[^\x00-\xff]/g,g="",h=a.replace(f,"**").length,i=0;i<h&&(g=a.charAt(i).toString(),null!=g.match(f)?d+=2:d+=1,!(c&&h>b&&d+2>b))&&!(d>b);i++)e+=g;return c&&h>b&&(e+="…"),e},_.substring=function(a,b,c){if(!a)return"";for(var d=0,e="",f=/[^\x00-\xff]/g,g="",h=a.replace(f,"**").length,i=0;i<h&&(g=a.charAt(i).toString(),null!=g.match(f)?d+=2:d+=1,!(c&&h>b&&d+2>b))&&!(d>b);i++)e+=g;return c&&h>b&&(e+="…"),e},_.substringWithM=function(a,b,c){for(var d=0,e="",f=/[^\x00-\xff]/g,g="",h=a.replace(f,"**").length,i=0;i<h&&(g=a.charAt(i).toString(),null!=g.match(f)?d+=2:"m"==g||"w"==g?d+=2:d++,!(d>b));i++)e+=g;return c&&h>b&&(e+="…"),e},_.isStringBeyondLength=function(a,b){var c=/[^\x00-\xff]/g;return a.replace(c,"**").length>b},_.convertImage=function(a){var b="",a=a||{},c={className:"",size:30,shape:"radius",name:"",src:""};return a=_.extend({},c,a),a.bgColor?(50==a.size?a.subName=_.substring(a.name,6,!1):30==a.size?a.subName=_.substring(a.name,3,!1):64==a.size?a.subName=_.substring(a.name,6,!1):80==a.size&&(a.subName=_.substring(a.name,6,!1)),b=['<span class="',a.shape,"_img",a.size," ",a.className,'" style="background-color:',a.bgColor,';"  original-title="',a.name,'">',a.subName,"</span>"].join("")):b=['<img class="',a.shape,"_img",a.size," ",a.className,'" width="',a.size,'" height="',a.size,'" src="',a.src,'" original-title="',a.name,'" />'].join(""),b},_.TitaWidget_evaluation=function(a,b){var c={1:"tw-medal-grade-one-light",2:"tw-medal-grade-two-light",3:"tw-medal-grade-three-light"},d={1:"太棒了！",2:"干的不错！",3:"再接再厉！"},a=a||{},e={type:1,value:"",lvl:5,goal:2};a=_.extend({},e,a),a.value=parseInt(a.value),a.type=parseInt(a.type);var f=a.type;a.lvl||(a.lvl=5),a.goal||(a.goal=2);var g=["","",""];if(1==f){var h=Math.floor(a.value/a.goal);g=['<span class="evaluation-star-list">',"","</span>"];var i=0,j=Math.ceil(a.value/a.goal);h!=j&&(i=j);for(var k=1;k<=a.lvl;k++)g[1]+=k<=h?'<span class="icon-star-m-active"></span>':i==k?'<span class="icon-star-m-half-active"></span>':'<span class="icon-star-m-disabled"></span>';g[1]+='<div class="last-score"><span class="score-value">'+a.value+'</span><span class="value-unit">分</span></div>'}return 2==f&&(a.name&&"null"!=a.name||(a.name=d[a.value]),g[1]='<span class="result-'+[a.value]+'"><span class="'+c[a.value]+'"></span>'+a.name+"</span>"),'<span class="tt_evaluation">'+g.join("")+"</span>"};var supportT=function(){var a=document.body||document.documentElement,b=a.style;return void 0!==b.WebkitAnimation||void 0!==b.webkitAnimation||void 0!==b.MozAnimation||void 0!==b.OAnimation||void 0!==b.msAnimation||void 0!==b.animation}();_.animate=function(a,b,c,d,e){var b=b||"shake",c=c||"noraml",e=e||function(){};if(!supportT)return void e();"number"==typeof c?c*=100:c=""==c?300:{fast:200,normal:500,slow:1e3}[c]||500;var f=["UI_animated","UI_speed_"+c,"UI_ani_"+b];a.addClass(f.join(" "));setTimeout(function(){a.removeClass(f.join(" ")),e()},c)},_.privateTipText=function(a,b,c,d){var e=Context.getI18n(),f=b,g="仅相关人可见";if(f){if(d)switch(d){case 400:case 500:g="仅你和你上级可见";break;case 600:g="仅"+e.task_1+"成员可见"}else if(c)switch(c){case 3:g="仅团队成员可见";break;case 4:g="仅相关成员可见";break;case 8:4==a&&(g="仅共享者可见"),5==a&&(g="仅共享者可见");break;case 15:g="仅发起者的部门可见"}else{if(!a)return"仅自己可见";switch(a){case 1:g="仅@的人可见";break;case 20:g="仅"+e.task_1+"成员可见"}}return g}return"所有人可见"};var LoadingView=Talent.ItemView.extend({defaults:{y:20},template:Talent._.template('<span class="img-load"></span><span>努力加载中...</span>'),className:"tt_common_loading",initialize:function(a){this.settings=Talent._.extend({},this.defaults,a)},onRender:function(){this.$el.css({"padding-top":this.settings.y-16})},hide:function(){this.$el.hide()},show:function(){this.$el.show()}}),PullScreenLayoutView=Talent.Layout.extend({defaults:{topBias:0,position:"right",width:820,duration:500,id:"",type:"task",showFullScreenButton:!1,status:""},template:JST["pull-screen/push-screen-layout"],className:"pull-screen-container",regions:{detailContainer:"[data-name=pull-screen-content]",loading:"[data-name=pull-screen-load]"},ui:{detailContainer:"[data-name=pull-screen-content]",iframe:"[data-name=pull-screen-iframe]",closed:"[data-name=pull-screen-close]",loading:"[data-name=pull-screen-load]",openScreen:"[data-name=open-full-screen-button]",actionBox:"[data-name=pull-screen-action]"},templateHelpers:function(){return{showFullScreenButton:this.settings.showFullScreenButton,isShowIfame:"iframe"==this.settings.status}},events:function(){var a={};return a["click "+this.ui.closed]="_closeHandler",a},initialize:function(a){var b=this;this.settings=Talent._.extend({},this.defaults,a),this.height=Talent.$(window).height(),this.isIdEmpty=!0,this.$el.on("click",function(a){a.stopPropagation()}),Talent.$(document).on("click.Pull-Screen-Region-View",function(a){b.model.set("id","",{silent:!0}),b.closed()}),Talent.$(window).on("resize.Pull-Screen-Region-View",function(){b.height=Talent.$(window).height(),b.$el.height(b.height)}),this._getRouterData(),this._listenGlobalEvent(),this.viewModel=new Talent.Model,this._initSet()},onRender:function(){this.model.get("id")&&this.open()},onClose:function(){},open:function(){var a=this,b=this.model.get("id");b&&(Context.changeHash({pullScreeId:b,pullScreenOpen:!0,pullScreenType:this.model.get("type")},"add",!1),this._pushAnimate().done(function(){a._fullScreenUrl(),a._renderViewByType()}))},closed:function(a){var b=this,c=this.settings;a&&a.stopPropagation(),c.close=!0,this._closeView(),Context.changeHash(["pullScreeId","pullScreenOpen","pullScreenType"],"deleted",!1),c.close=!0,this.$el.stop().animate(this._dealAnimationData(c),c.duration,function(){b.ui.iframe.hide()})},_initSet:function(){"left"==this.settings.position?this.$el.css({top:this.settings.topBias+"px",left:-this.settings.width,width:this.settings.width,height:this.height-this.settings.topBias}):this.$el.css({top:this.settings.topBias,right:-this.settings.width,width:this.settings.width,height:this.height})},_getRouterData:function(){var a=this,b=Talent.app.request("history:getQueryObject"),c=new Talent.$.Deferred;return b.done(function(b){a.routerData=b||{};var c=a.routerData.pullScreeId||"";a.routerData.pullScreeId=c,a.routerData.pullScreenOpen=b.pullScreenOpen||!1,a.routerData.pullScreenType=b.pullScreenType||"",a.model.set("id",c,{silent:!0}),a.model.set("pullScreenOpen",b.pullScreenOpen),a.model.set("type",b.pullScreenType)}),c},_listenGlobalEvent:function(){var a=this;Talent.app.vent.on("global-pull-screen",function(b,c,d,e){var b=b;if(!b||""==b)return void alert("请给我id,不能显示详情页");a.viewModel=d||new Talent.Model,a.model.set({id:b,type:c}),a._idChangeHandler()}),Talent.app.vent.on("global-pull-screen",function(b){"closed"==b&&(a.model.set({id:"",type:""},{silent:!0}),a.closed())})},_idChangeHandler:function(){var a=(this.settings.duration,this),b=this.settings;b.close=!0,Context.changeHash(["pullScreeId","pullScreenOpen","pullScreenType"],"deleted",!1),this.$el.stop().animate(this._dealAnimationData(b),b.duration,function(){a.closed(),a._fullScreenUrl(),a.open()})},_closeView:function(){this.taskDetailView&&this.taskDetailView.close()},_renderViewByType:function(){var a=this.model.get("type");if(this.ui.actionBox.show(),"iframe"==this.settings.status)return void this._renderIframe();"task"==a&&this._renderTaskDetailView()},_closeHandler:function(a){this.closed(),this.trigger("closed")},_renderLoadingView:function(){this.loadingView=new LoadingView({y:this.height/2}),this.loading.show(this.loadingView)},_pushAnimate:function(){this.ui.iframe.hide(),this._renderLoadingView();var a=this.settings;a.close=!1;var b=new Talent.$.Deferred;return this.$el.stop().animate(this._dealAnimationData(a),a.duration,function(){b.resolve()}),b},_fullScreenUrl:function(){var a=this.model.get("type"),b="";"task"==a&&(b="#more/taskinfo?id="+this.model.get("id")),""!=b&&this.settings.showFullScreenButton?this.ui.openScreen.attr("href",b).show():this.ui.openScreen.hide()},_renderTaskDetailView:function(){this.taskDetailView=new TaskDetailView({id:this.model.get("id"),topBias:this.settings.topBias,model:this.viewModel||new Talent.Model}),this.listenTo(this.taskDetailView,"getDataAfter",function(){this.loadingView&&this.loadingView.close()}),this.detailContainer.show(this.taskDetailView)},_renderIframe:function(){var a=this,b=this.model.get("id"),c=Context.getUserInfo(),d=(Context.getGlobal("env"),this.height),e=Context.getGlobal("webPath"),f=(Context.getGlobal("env"),"//www."+e+"/"+c.Id+"/ITalentHome?v="+(new Date).getTime()+"#more/taskinfo?Id="+b);this.ui.iframe.css({height:d+"px"});var g=this.ui.iframe[0];g.attachEvent?g.attachEvent("onload",function(){a.ui.iframe.show(),a.loadingView&&a.loadingView.close()}):g.onload=function(){a.ui.iframe.show(),a.loadingView&&a.loadingView.close()},g.src=f},_dealAnimationData:function(a){var b,c={};return b="left"===a.position||"right"===a.position?a.close?"-"+a.width+"px":"0px":a.close?"-"+a.height+"px":"0px",c[a.position]=b,c},onClose:function(){Talent.$(document).off("click.Pull-Screen-Region-View"),Talent.$(window).off("resize.Pull-Screen-Region-View")}}),titaWidget={PullScreenView:PullScreenView};return titaWidget}),function(a,b,c,d){function e(b,c){this.element=a(b),this.settings=a.extend({},j,c),this._defaults=j,this._name=i,this._title=this.element.attr("title"),this.mode="hide",this.init()}function f(){var a=b.navigator.msMaxTouchPoints,d="ontouchstart"in c.createElement("div");return!(!a&&!d)}function g(b){var c=b.clone();c.css("visibility","hidden"),a("body").append(c);var d=c.outerHeight();return c.remove(),d}function h(c){var d,e,f,h=c.tooltip(),i=c.element,j=c,k=a(b),l=10;switch(j.settings.position){case"top":e=i.offset().left+i.outerWidth()/2-h.outerWidth()/2,d=i.offset().top-g(h)-l,h.find(".tipso_arrow").css({marginLeft:-8}),d<k.scrollTop()?(d=i.offset().top+i.outerHeight()+l-40,h.find(".tipso_arrow").css({"border-bottom-color":"#ccc","border-top-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass("bottom")):(h.find(".tipso_arrow").css({"border-top-color":"#ccc","border-bottom-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass("top"));break;case"bottom":e=i.offset().left+i.outerWidth()/2-h.outerWidth()/2,d=i.offset().top+i.outerHeight()+l-25,h.find(".tipso_arrow").css({marginLeft:-8}),d+g(h)>k.scrollTop()+k.outerHeight()?(d=i.offset().top-g(h)-l+25,h.find(".tipso_arrow").css({"border-top-color":"#ccc","border-bottom-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass("top")):(h.find(".tipso_arrow").css({"border-bottom-color":"#ccc","border-top-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass(j.settings.position));break;case"left":e=i.offset().left-h.outerWidth()-l,d=i.offset().top+i.outerHeight()/2-g(h)/2,h.find(".tipso_arrow").css({marginTop:-8,marginLeft:""}),e<k.scrollLeft()?(e=i.offset().left+i.outerWidth()+l,h.find(".tipso_arrow").css({"border-right-color":"#ccc","border-left-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass("right")):(h.find(".tipso_arrow").css({"border-left-color":"#ccc","border-right-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass(j.settings.position));break;case"right":e=i.offset().left+i.outerWidth()+l,d=i.offset().top+i.outerHeight()/2-g(h)/2,h.find(".tipso_arrow").css({marginTop:-8,marginLeft:""}),e+l+j.settings.width>k.scrollLeft()+k.outerWidth()?(e=i.offset().left-h.outerWidth()-l,h.find(".tipso_arrow").css({"border-left-color":"#ccc","border-right-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass("left")):(h.find(".tipso_arrow").css({"border-right-color":"#ccc","border-left-color":"transparent","border-top-color":"transparent","border-bottom-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass(j.settings.position))}e<k.scrollLeft()&&("bottom"==j.settings.position||"top"==j.settings.position)&&(h.find(".tipso_arrow").css({marginLeft:e-40}),e=0),e+j.settings.width>k.outerWidth()&&("bottom"==j.settings.position||"top"==j.settings.position)&&(f=k.outerWidth()-(e+j.settings.width),h.find(".tipso_arrow").css({marginLeft:-f-8,marginTop:""}),e+=f),e<k.scrollLeft()&&("left"==j.settings.position||"right"==j.settings.position)&&(e=i.offset().left+i.outerWidth()/2-h.outerWidth()/2,h.find(".tipso_arrow").css({marginLeft:-8,marginTop:""}),d=i.offset().top-g(h)-l,d<k.scrollTop()?(d=i.offset().top+i.outerHeight()+l,h.find(".tipso_arrow").css({"border-bottom-color":"#ccc","border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass("bottom")):(h.find(".tipso_arrow").css({"border-top-color":"#ccc","border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass("top")),e+j.settings.width>k.outerWidth()&&(f=k.outerWidth()-(e+j.settings.width),h.find(".tipso_arrow").css({marginLeft:-f-8,marginTop:""}),e+=f),e<k.scrollLeft()&&(h.find(".tipso_arrow").css({marginLeft:e-8}),e=0)),e+j.settings.width>k.outerWidth()&&("left"==j.settings.position||"right"==j.settings.position)&&(e=i.offset().left+i.outerWidth()/2-h.outerWidth()/2,h.find(".tipso_arrow").css({marginLeft:-8,marginTop:""}),d=i.offset().top-g(h)-l,d<k.scrollTop()?(d=i.offset().top+i.outerHeight()+l,h.find(".tipso_arrow").css({"border-bottom-color":"#ccc","border-top-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass("bottom")):(h.find(".tipso_arrow").css({"border-top-color":"#ccc","border-bottom-color":"transparent","border-left-color":"transparent","border-right-color":"transparent"}),h.removeClass("top bottom left right"),h.addClass("top")),e+j.settings.width>k.outerWidth()&&(f=k.outerWidth()-(e+j.settings.width),h.find(".tipso_arrow").css({marginLeft:-f-8,marginTop:""}),e+=f),e<k.scrollLeft()&&(h.find(".tipso_arrow").css({marginLeft:e-8}),e=0)),h.css({left:e+j.settings.offsetX-120,top:d+j.settings.offsetY})}var i="tipso",j={speed:0,background:"#fff",color:"#666",position:"top",width:800,delay:0,offsetX:150,offsetY:0,content:null,ajaxContentUrl:null,useTitle:!1,onBeforeShow:null,onShow:null,onHide:null};a.extend(e.prototype,{init:function(){var b=this,d=this.element;d.addClass("tipso_style").removeAttr("title"),f()?(d.on("click."+i,function(a){"hide"==b.mode?b.show():b.hide(),a.stopPropagation()}),a(c).on("click",function(){"show"==b.mode&&b.hide()})):(d.on("mouseover."+i,function(){b.show()}),d.on("mouseout."+i,function(){}))},tooltip:function(){return this.tipso_bubble||(this.tipso_bubble=a('<div class="tipso_bubble"><div class="tipso_content"></div><div class="tipso_arrow"></div></div>')),this.tipso_bubble},show:function(){var c=this.tooltip(),d=this,e=a(b);a.isFunction(d.settings.onBeforeShow)&&d.settings.onBeforeShow(a(this)),c.css({background:d.settings.background,color:d.settings.color,width:d.settings.width}).hide(),c.find(".tipso_content").html(d.content()),h(d),e.resize(function(){h(d)}),d.timeout=b.setTimeout(function(){c.appendTo("body").stop(!0,!0).fadeIn(d.settings.speed,function(){d.mode="show",a.isFunction(d.settings.onShow)&&d.settings.onShow(a(this))})},d.settings.delay)},hide:function(){var c=this,d=this.tooltip();b.clearTimeout(c.timeout),c.timeout=null,d.stop(!0,!0).fadeOut(c.settings.speed,function(){a(this).remove(),a.isFunction(c.settings.onHide)&&"show"==c.mode&&c.settings.onHide(a(this)),c.mode="hide"})},destroy:function(){var a=this.element;a.off("."+i),a.removeData(i),a.removeClass("tipso_style").attr("title",this._title)},content:function(){var b=this.element,c=this,d=this._title;return c.settings.ajaxContentUrl?a.ajax({type:"GET",url:c.settings.ajaxContentUrl,async:!1}).responseText:c.settings.content?c.settings.content:!0===c.settings.useTitle?d:b.data("tipso")},update:function(a,b){var c=this;if(!b)return c.settings[a];c.settings[a]=b}}),a[i]=a.fn[i]=function(b){var c=arguments;if(b===d||"object"==typeof b)return this instanceof a||a.extend(j,b),this.each(function(){a.data(this,"plugin_"+i)||a.data(this,"plugin_"+i,new e(this,b))});if("string"==typeof b&&"_"!==b[0]&&"init"!==b){var f;return this.each(function(){var d=a.data(this,"plugin_"+i);d||(d=a.data(this,"plugin_"+i,new e(this,b))),d instanceof e&&"function"==typeof d[b]&&(f=d[b].apply(d,Array.prototype.slice.call(c,1))),"destroy"===b&&a.data(this,"plugin_"+i,null)}),f!==d?f:this}}}(jQuery,window,document),define("tipso",function(){}),define("views/assessment/target-item-view",["talent","templates/assessment","jquery.ui.effect","jquery.ui","views/assessment/ratescore-composite-view","views/natureDialog/goalOperation/index-page-view","views/natureDialog/addSubItem/index-page-view","views/assessment/copytask-item-view","views/assessment/third-feed-item-view","views/assessment/key-result-composite-view","views/common/dialog/dialog-index-view","views/common/controls/CommonDropDownListCtl","$.tipsy","taskWidget","pullScreenWidget","views/assessment/helpers/authority","views/common/helpers/validator","titaDatePicker","views/common/event-name","moment","tipso"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t){return a.ItemView.extend({getTemplate:function(){var a=this.model.get("ModuleType");return 4==a?b["assessment/target-item-summy"]:5==a?b["assessment/target-item-addsub"]:6==a?b["assessment/target-item-custom"]:b["assessment/target-item"]},initialize:function(){var b=this,c=this.model.toJSON(),d=c.mode;_.extend(b,{i18n:_.langs("assessment").target,taskData:[],_cacheData:[],hasRender:0,$weightBtn:$(".btnWeightChange"),store:a.Store("session")}),this.model.set({i18n:b.i18n,MaxWidth:100,showValue:!0,showName:!1,showDescription:!1,AssessmentItemManageType:BSGlobal.EpmData.AssessmentItemManageType,showItemScore:c.ItemScoreAuthority}),4!=c.ModuleType&&5!=c.ModuleType&&(p.disableEditGoalItem(d,c)&&this.$el.addClass("edit-disabled"),p.rateScoreCanOperate(c.RateScoreList,c)),a.app.vent.on("showContent",function(a){b.model.get("Id")==a&&(b.$el.attr("isdone",!0),b.toggleGoalContent())}),a.app.vent.on("pullClose",function(a){b.model.get("Id")==a&&b.pullClose()});var e=c.ScoreLevelOptions;if(0==c.ScoreType&&(1!=c.TypeId||1==c.TypeId&&1==c.ScoringMethod)){var f=_.findWhere(e.ScoreOptions,{Id:c.ScoreLevelId}),g={Name:b.i18n.selectEmpty,Value:"",Description:b.i18n.selectEmpty};if(f){f.ScoreLevelOptions||(f.ScoreLevelOptions=[g]);var h=_.findWhere(f.ScoreLevelOptions,{Value:c.RateScore})||g,i=_.findWhere(c.ScoreLevelSettings,{DisplayType:2});_.each(c.RateScoreList,function(a){_.each(f.ScoreLevelOptions,function(b){a.Score==b.Value&&(a.ScoreName=b.Name)})});var j=p.customLevelSetting(i);_.extend(j,{ScoreName:h.Name,ScoreDescription:h.Description,ScoreLevelOptions_new:f})}this.model.set(j)}this.model.set("RateScoreList",c.RateScoreList),a.inItalent&&this.registerEventForItalent(),cacheContainer.get("InIframe")?(this.model.set("InIframe",!0),0==c.Assessment.Status&&(this.model.set("FeedCount",0),this.model.set("AppraiserCount",0))):this.model.set("InIframe",!1),this.thirdCached={},Number(this.model.get("FeedCount"))||this.model.set("FeedCount",0)},_isErrorValue:function(a){return void 0===a||null===a||""===a},registerEventForItalent:function(){var a=this;window.iTalentSDK.unregister(s("ASSESSMENT_COPYTASK_OK",this.model.get("Id"))),window.iTalentSDK.register({listenEvent:s("ASSESSMENT_COPYTASK_OK",this.model.get("Id")),cb:function(b){a.saveItemTask(b.params)}}),window.iTalentSDK.unregister(s("ASSESSMENT_DELETEGOAL_OK",this.model.get("Id"))),window.iTalentSDK.register({listenEvent:s("ASSESSMENT_DELETEGOAL_OK",this.model.get("Id")),cb:function(b){a.deleteObject(b)}}),window.iTalentSDK.unregister(s("ASSESSMENT_EDITGOAL_OK",this.model.get("Id"))),window.iTalentSDK.register({listenEvent:s("ASSESSMENT_EDITGOAL_OK",this.model.get("Id")),cb:_.bind(a.saveGoal,a)}),window.iTalentSDK.unregister(s("ASSESSMENT_EDITSUBGOAL_OK",this.model.get("Id"))),window.iTalentSDK.register({listenEvent:s("ASSESSMENT_EDITSUBGOAL_OK",this.model.get("Id")),cb:_.bind(a.saveAndSubGoal,a)})},className:"target-item",ui:{taskList:".task-container",kRList:".key-result",targetItem:".target-item",objDesc:".goal-desc",taskNameInput:".input-taskname",target_title:".target-title",add_taskItem:".add-taskItem",addTask:".addTask",show_content:".show-content",object_edit:".js-edit",addsub_edit:".editAddSub",object_delete:".js-delete ",copy_taskItem:".copy-taskItem",obj_desc:".goal-desc",viewGoal:".add-feedback,.object-name .obj-name",feed:".object-feed a",input_tasktime:".input-tasktime",input_score:"input.item-score",input_weight:"input.weight-val",spantaskName:"li.planitem",item_score:".item-score",ratescore_list:".ratescore-list",third_feed:".third-feed"},events:function(){var a={};return a["click "+this.ui.spantaskName]="clickSpanTaskName",a["mouseenter "+this.ui.objDesc]="showDescriptionTip",a["click "+this.ui.add_taskItem]="showAddTask",a["click "+this.ui.addTask]="addTask",a["click "+this.ui.show_content]="toggleGoalContent",a["click "+this.ui.target_title]="targetTitleClick",a["click "+this.ui.object_edit]="showEditDialog",a["click "+this.ui.addsub_edit]="showEditAddSubDialog",a["click "+this.ui.object_delete]="showAskDelete",a["click "+this.ui.copy_taskItem]="showCopyTaskDialog",a["click "+this.ui.viewGoal]="viewGoal",a["click "+this.ui.feed]="viewThirdBack",a["focus "+this.ui.taskNameInput]="tasknameFocus",a["keyup "+this.ui.taskNameInput]="taskNameOnChange",a["blur "+this.ui.taskNameInput]="tasknameBlur",a["click "+this.ui.input_tasktime]="tasktimeFocus2",a["blur "+this.ui.input_tasktime]="tasktimeBlur",a["keyup "+this.ui.input_score]="scoreKeyUp",a["focus "+this.ui.input_score]="scoreFocus",a["change "+this.ui.input_score]="checkInputValue",a["keyup "+this.ui.input_weight]="weightKeyUp",a},tasktimeFocus2:function(a){var b=$(a.currentTarget),c=this.model.toJSON(),d=this;$(a.currentTarget).datepicker({clearBtn:!1,language:"zh-CN",autoclose:!0,orientation:"bottom auto",defaultViewDate:{year:1977,month:4,day:25}}).on("changeDate",function(a){var e=t(a.date).format("YYYY-MM-DD");b.val(e),d.store.set(c.Id+"_taskdate",e)}),$(a.currentTarget).datepicker("show")},taskNameOnChange:function(a){var b=$(a.currentTarget),c=this.model.toJSON();this.store.set(c.Id+"_taskname",$.trim(b.val()))},showDescriptionTip:function(a){var b=_.escape(this.model.get("Description")),c="en-US"==BSGlobal.lang,d=c?40:22;b.length>d&&(this.ui.objDesc.tipso({position:"bottom",content:b.replace(/\n/g,"<br/>"),onShow:function(a){$(a).click(function(){return!1}),$(a).on("mouseenter",function(){return!1}),$(a).on("mouseleave",function(){$(a).remove()})}}),this.ui.objDesc.tipso("show"))},weightKeyUp:function(a){var b=$(a.currentTarget),c=this.model.toJSON(),d=$.trim(b.val()),e=q.isCorrectWeight(d);if(!e)return b.addClass("error"),e;b.removeClass("error"),this.model.set("Weight",_.toFixed(d,2));var f=d-Number(c.Weight),g="moduleGoalWeight"+c.ModuleId,h=_.toFixed(Number(localStorage.getItem(g))+Number(f),2);localStorage.setItem(g,h),b.parents(".module-item").find(".count-weight strong").text(h+"%")},_setCurrent:function(a){var b=this,c=$(a.currentTarget),d=c.parents(".object-score").attr("index"),e=this.model.get("currentScore")||{},f=this.model.toJSON(),g=Number($.trim(c.val())),h=f.ScoreMethod;if(1==h)var i=q.isCorrectScore(g,{max:f.TargetScoreLevels.MaxValue,min:f.TargetScoreLevels.MinValue});else if(2==h)var i=q.isCorrectScore(g,{max:f.WeightScoreLevel.MaxValue,min:f.WeightScoreLevel.MinValue});if(!i)return c.addClass("error"),i;c.removeClass("error");var j=f.RateScoreList&&f.RateScoreList[d];return j&&(e.Score=_.toFixed(g,2),j.currentScore=e,b.model.set({currentScore:e})),!0},checkInputValue:function(a){this._setCurrent(a)},scoreKeyUp:function(a){var b=this;b._setCurrent(a)&&(b.timer&&clearTimeout(b.timer),b.timer=setTimeout(function(){b.trigger("scoreChange",b.model.toJSON())},500))},scoreFocus:function(a){var b=$(a.currentTarget),c=this.model.toJSON(),d=Number(b.val()),e=c.ScoreMethod;if(b.removeClass("error"),1==e&&d){if(isNaN(d)||d<Number(c.TargetScoreLevels.MinValue)||d>Number(c.TargetScoreLevels.MaxValue))return void b.addClass("error")}else if(2==e&&d&&(isNaN(d)||d<Number(c.WeightScoreLevel.MinValue)||d>Number(c.WeightScoreLevel.MaxValue)))return void b.addClass("error")},showEditDialog:function(b){b.stopPropagation(),this.$weightBtn.removeClass("warn_class");var c=this.model.toJSON();if("quickScore"==c.mode||"weightChange"==c.mode&&2!=c.WeightType)return!1;var d=[];_.map(c.ModuleList,function(a){a.ModuleType==c.ModuleType&&d.push({Id:a.Id,Name:a.Name,ModuleType:a.ModuleType,FieldRight:a.FieldRight,RelType:a.RelType,WeightType:a.WeightType})});var e={height:"512",width:"600",inHeight:"440",title:_.langs("assessment","target","editTarget"),currentStepTypeId:c.Assessment.CurrentStepTypeId,mode:"edit",Unit:c.Unit||"",endDate:this.model.get("EndDate"),startDate:this.model.get("StartDate"),ModuleList:d,UserId:c.ownerId,AssessmentId:c.assessmentId,description:c.Description,name:c.Name,FieldRight:c.FieldRight,weight:c.Weight,moduleId:c.ModuleId,typeId:c.TypeId||0,MinimumValue:c.MinimumValue,ItemValue:c.ItemValue,ChallengeValue:c.ChallengeValue,CompleteValue:c.CompleteValue,targetValue:c.TargetValue,objectiveTypeIn:c.objectiveTypeIn,CompleteValueSource:c.CompleteValueSource,Id:c.Id,CustomFields:c.CustomFields};if(a.inItalent){var g=_.getPopUrl("goalOperation","editNormalGoal"+c.Id);window.iTalentSDK.showPopup(g,601,525,e)}else this.editItemView=new f(e),this.editItemView.render(),this.listenTo(this.editItemView,"dialogSave",this.saveGoal)},showEditAddSubDialog:function(b){b.stopPropagation();var c,d=this.model.toJSON();c=1==d.ScoreType?_.findWhere(d.ScoreLevelOptions.ScoreLevels,{Id:d.ScoreLevelId}):d.ScoreLevelOptions_new.ScoreLevelOptions;var e={height:"512",width:"600",inHeight:"430",title:self._i18n.operationToolbar.btnEditAddSum,timeColse:null,scoreLevel:c,FieldRight:d.FieldRight,singeItemId:d.Id,description:d.Description||"",moduleId:d.ModuleId,score:d.RateScore||"",scoreLevelId:d.ScoreLevelId,operate:"edit",mode:"edit",typeId:0,name:d.Name,Id:d.Id,ScoreLevelSettings:d.ScoreLevelSettings,isScoreLevel:1!=d.ScoreType};if(a.inItalent){var f=_.getPopUrl("addSubItem","editAndSubGoal"+d.Id);window.iTalentSDK.showPopup(f,601,525,e)}else this.addSubItemView=new g(e),this.addSubItemView.render(),this.listenTo(this.addSubItemView,"addSubSave",this.saveAndSubGoal)},_setParamsGoalValue:function(a,b,c){b["item."+c+".IsAdopt"]=a.IsAdopt,b["item."+c+".Value"]=a.Value},saveAndSubGoal:function(b){var c=this,d={},e="",f=this.model.toJSON(),g={"item.Id":b.Id,"item.Name":b.goalName,"item.Score":b.score,"item.ModuleType":5,"item.Description":b.description,"item.AssessmentModuleId":b.moduleId,"item.AssessmentId":f.Assessment.Id};a.app.request("Target:updateItem",g).done(function(a){if(Number(a.Result)>0){d={Name:b.goalName,Description:b.description,ModuleId:b.moduleId,WorkflowStepScoreList:a.WorkflowStepScoreList};var g=_.findWhere(a.ItemScores,{Id:f.Id})||{Score:""};e=void 0==g.Score||null==g.Score?"":g.Score,_.extend(d,{RateScore:e||b.score||"",ModuleRates:a.ModuleRates,TotalScore:a.TotalScore}),c.model.set(d),f.ModuleId==b.moduleId?(c._isErrorValue(c.model.get("FeedCount"))&&c.model.set("FeedCount",0),c.render()):c.model.set({GoalChangeModule:!0}),c.trigger("goalOperation",c.model.toJSON())}})},_isErrorValue:function(a){return void 0===a||null===a||""===a},saveGoal:function(b){var c=this,d={},e={},f="",g=this.model.toJSON();e.UserId=g.ownerId,e["item.Id"]=g.Id,e["item.Description"]=g.Id,e["item.Name"]=b.name,e["item.Description"]=b.description,e["item.Weight"]=b.weight,e["item.BeginTime"]=b.startDate,e["item.EndTime"]=b.endDate,e["item.AssessmentModuleId"]=b.moduleId,e["item.AssessmentId"]=g.Assessment.Id,e["item.WorkId"]=g.TitaObjectId,e["item.TypeId"]=g.TypeId,e["item.ScoreMethod"]=g.ScoreMethod,e["item.ScoreType"]=g.ScoreType,e["item.ScoreLevelId"]=g.ScoreLevelId,_.each(b.goalCustomDatas,function(a,b){e["item.CustomField["+b+"].IsRequire"]=a.IsRequire,e["item.CustomField["+b+"].MaxLength"]=a.MaxLength,e["item.CustomField["+b+"].Code"]=a.Code,e["item.CustomField["+b+"].Name"]=a.Name,e["item.CustomField["+b+"].Type"]=a.Type,e["item.CustomField["+b+"].Description"]=a.Description});var h=_.findWhere(g.ModuleList,{Id:b.moduleId})||{};e["item.ModuleType"]=h.ModuleType,1==g.TypeId&&(c._setParamsGoalValue(b.ItemValue,e,"ItemValue"),c._setParamsGoalValue(b.MinimumValue,e,"MinimumValue"),c._setParamsGoalValue(b.ChallengeValue,e,"ChallengeValue"),void 0==b.CompleteValue&&null==b.CompleteValue||(e["item.CompleteValue"]=b.CompleteValue)),a.app.request("Target:updateItem",e).done(function(e){if(c.model.set("WeightScoreLevel",e.WeightScoreLevel),a.inItalent&&window.iTalentSDK.sendMessage({publishEvent:s("ASSESSMENT_ANDGOAL_CANCEL",g.Id),data:null}),Number(e.Result)>0){d={Name:b.name,StartDate:b.startDate,Weight:b.weight,Description:b.description,EndDate:b.endDate,CreateDate:b.startDate,ModuleId:b.moduleId,CustomFields:b.goalCustomDatas,WorkflowStepScoreList:e.WorkflowStepScoreList},1==g.TypeId&&_.extend(d,{ItemValue:b.ItemValue,CompleteValue:b.CompleteValue,MinimumValue:b.MinimumValue,ChallengeValue:b.ChallengeValue});var h=_.findWhere(e.ItemScores,{Id:g.Id})||{Score:""};f=void 0==h.Score||null==h.Score?"":h.Score,_.extend(d,{RateScore:f,ModuleRates:e.ModuleRates,TotalScore:e.TotalScore}),c.model.set(d),g.ModuleId==b.moduleId?(c._isErrorValue(c.model.get("FeedCount"))&&c.model.set("FeedCount",0),c.render()):c.model.set({GoalChangeModule:!0}),c.trigger("goalOperation",c.model.toJSON())}})},showCopyTaskDialog:function(){var b=this.model.toJSON(),c=this,d=[];_.each(b.ModuleList,function(a){d.push({Id:a.Id,Name:a.Name})});var e={height:"427",width:"600",inHeight:"333",title:c.i18n.copyTaskTitle,timeColse:"",ModuleList:d,UserId:b.ownerId,AssessmentId:b.assessmentId,Id:b.Id};if(a.inItalent){var f=_.getPopUrl("copytask","copyTaskDialog");window.iTalentSDK.showPopup(f,601,429,e)}else this.copyTaskItemView=new h(e),this.listenTo(this.copyTaskItemView,"dialogSave",this.saveItemTask),this.trigger("quickAddItem"),this.copyTaskItemView.render()},saveItemTask:function(b){var c=this;b.assessmentItemId=this.model.get("Id"),a.app.request("Target:copyItemTask",b).done(function(b){$(c.ui.taskList).empty();a.Context.getUserInfo().UserId,c.model.get("ownerId"),c.model.get("TitaObjectId");c.isDone=!1;var d=c.model.toJSON().UserInfo;$(c.ui.taskList).empty();var e=b.Module;_.each(e,function(a){a.tasks=a.Tasks,a.startDate=_.formatDate2(a.startDate,"YYYY/MM/DD HH:mm:ss"),a.createDate=_.formatDate2(a.createDate,"YYYY/MM/DD"),a.deadLine=_.formatDate2(a.deadLine,"YYYY/MM/DD HH:mm:ss"),a.finishDate=_.formatDate2(a.finishDate,"YYYY/MM/DD HH:mm:ss"),a.isPush=!0,a.isAddExperience=!0,a.editStatusable=!0,a.user.name=d.Name,a.principalUser.name=d.Name,a.principalUser.userId=d.UserId,c.taskData.push(a)}),c.taskTotal=c.taskData.length,c.taskListView=new n.TaskListView({isShowKclass:!1,isShowDelete:!1,isShowCommentTotal:!0,isShowExperienceTotal:!0,isPush:!0,data:c.taskData}),c.$("#taskNumber").text(c.taskTotal),$(c.ui.taskList).html(c.taskListView.render().el)})},deleteObject:function(b){var c=this,d=this.model.toJSON();c.$weightBtn.removeClass("warn_class"),b.result&&a.app.request("Target:deleteGoal",{ownerId:d.UserInfo.UserId,assessmentId:d.Assessment.Id,itemlId:d.Id,moduleId:d.ModuleId,moduleType:d.ModuleType}).done(function(a){a.Result>0&&(c.model.set({ModuleRates:a.ModuleRates,TotalScore:a.TotalScore,GoalChangeModule:!0,WorkflowStepScoreList:a.WorkflowStepScoreList,doType:"delete",operation:"remove"}),c.$el.slideUp(function(){c.$el.remove(),c.close()}),c.trigger("goalOperation",c.model.toJSON()))})},targetTitleClick:function(a){if(5==this.model.get("ModuleType"))return!1;this.ui.objDesc.tipso("destroy");$(a.currentTarget);if($(a.currentTarget).parent(".target-item").hasClass("edit-disabled"))return!1;this.toggleGoalContent(a)},toggleGoalContent:function(){function b(){c.render(),c.$(".target-content").hide(),setTimeout(function(){c.$(".target-content").slideDown(function(){c.$el.attr("isdone",!0),a.app.vent.trigger("targetOpen")})},0)}a.$(document).find(".tipso_bubble").remove();var c=this,d=this.model.toJSON();if("simple"==d.mode||"quickScore"==d.mode||"weightChange"==d.mode){if(c.model.set("mode","all"),1==c._hasCache)return b(),!1;void 0==d.FeedCount||void 0==d.AppraiserCount?a.app.request("Assessment:getRatesAndFeeds",{assessmentId:d.Assessment.Id,id:d.Id,activityId:d.Assessment.ActivityId,moduleType:d.ModuleType,ownerId:d.UserInfo.UserId}).done(function(a){var e=a.Data,f=_.map(e.RateScoreList,function(a,b){return _.extend(a,d.RateScoreList[b],{UserAvatar:a.UserAvatar})});c.model.set({AppraiserCount:e.AppraiserCount,CreateDate:e.CreateDate,FeedCount:e.FeedCount||0,ScoreLevelId:e.ScoreLevelId,ScoreLevelOptions:e.ScoreLevelOptions,ScoreType:e.ScoreType,TargetScoreLevels:e.TargetScoreLevels,RateScoreList:f}),c._hasCache=1,b()}):(c.render(),c.$(".target-content").hide(),setTimeout(function(){c.$(".target-content").slideDown(function(){c.$el.attr("isdone",!1),a.app.vent.trigger("targetOpen")})},0))}else"all"==d.mode&&setTimeout(function(){c.$(".target-content").slideUp(function(){c.model.set("mode","simple"),c.render(),c.$el.attr("isdone",!0),a.app.vent.trigger("hideTarget")})},0);return!1},onRender:function(){var a=this,b=this.model.toJSON();this.$weightBtn.removeClass("warn_class"),"all"==b.mode&&(this.refreshScoreList(),this.refreshTaskList()),"quickScore"!=b.mode&&"weightChange"!=b.mode||localStorage.setItem(b.Id+"view","edit");var c=_.findWhere(b.RateScoreList,{WorkflowStepId:b.CurrentStepId});c||(c=_.findWhere(b.RateScoreList,{WorkflowStepId:null})),a.model.set("currentScore",_.extend({},c));var d={},e={};if(0==this.model.get("ScoreType")&&4!=this.model.get("ModuleType")){var f=void 0,g=[],h={value:void 0,activeText:_.langs("common","selectDefault"),text:_.langs("common","selectDefault")},i=b.ScoreLevelSettings;_.each(i,function(a){switch(a.DisplayType){case 1:e=a;break;case 2:d=a}}),c&&null!=c.Score?f=c.Score:g.unshift(h),b.ScoreLevelOptions_new&&_.each(b.ScoreLevelOptions_new.ScoreLevelOptions,function(a,b){var c=_.formatScoreByConfig(a,e),f=_.formatScoreByConfig(a,d),h={value:a.Value,activeText:f,text:c};g.push(h)}),g=_.sortScoreLevel(g),this.scoreSelector=new l({formName:"Score",showLabel:!1,value:f,required:!1,state:"create",dataSource:g}),this.listenTo(this.scoreSelector,"optionChange",this.selectChange),this.ui.item_score.html(this.scoreSelector.render().el)}this.$("input.item-score,input.weight-val").tipsy({gravity:"s",title:"tip-info"}),4!=this.model.get("ModuleType")&&5!=a.model.get("ModuleType")&&0==a.hasRender&&(a.autoWidth(),a.hasRender=1),a.autoWidth()},autoWidth:function(){var a=this;setTimeout(function(){if(4!=a.model.get("ModuleType")&&5!=a.model.get("ModuleType")){if(0==a.$(".scoreList").length)return;var b=a.$(".scoreList").css("width").replace("px",""),c=a.$(".target-title").css("width").replace("px","");a.MaxWidth=c-b-100,a.model.set("MaxWidth",a.MaxWidth),a.$(".show_obj_name2").css("max-width",c-b-100+"px")}},0)},pullClose:function(){this._hasCache=0,this.$el.attr("isdone",!0),this.isDone=!1,this.refreshTaskList(),this.isDone=!0},selectChange:function(a){var b=this,c=this.model.toJSON(),d=this.scoreSelector.$el.find(".tit_sel"),e=d.parents(".object-score").attr("index"),f=c.currentScore||{};f[a.formName]=(a.value-0).toFixed(1);var g=_.findWhere(c.ScoreLevelOptions_new.ScoreLevelOptions,{Value:a.value});if(g){d.removeClass("input-error"),_.extend(f,{ScoreDescription:g.Description,ScoreName:g.Name,Score:g.Value});var h=c.RateScoreList&&c.RateScoreList[e];h&&(h.currentScore=f,b.model.set("currentScore",f)),b.timer&&clearTimeout(b.timer),b.timer=setTimeout(function(){b.trigger("scoreChange",b.model.toJSON())},500)}else d.addClass("input-error")},refreshScoreList:function(){this.rateScoreListView=new e(this.model.toJSON()),this.ui.ratescore_list.html(this.rateScoreListView.render().el),this.listenTo(this.rateScoreListView,"ScoreChange",this.operateScore)},operateScore:function(a){var b=this,c=this.model.toJSON(),d=_.findWhere(a.RateScoreList,{WorkflowStepId:c.CurrentStepId}),e={DisplayFields:["Value"]},f={};if(2==c.currentStep&&d)if(this.model.set("currentScore",_.extend({},d)),0==this.model.get("ScoreType")){var g=[],h=c.ScoreLevelSettings;_.each(h,function(a){switch(a.DisplayType){case 1:f=a;break;case 2:e=a;break;case 0:speechFrameSetting=a}}),_.each(c.ScoreLevelOptions_new.ScoreLevelOptions,function(a,b){var c=_.formatScoreByConfig(a,f),d=_.formatScoreByConfig(a,e),h={value:a.Value,activeText:d,text:c};g.push(h)}),this.scoreSelector=new l({formName:"Score",showLabel:!1,value:d.Score,required:!1,state:"create",dataSource:g}),this.listenTo(this.scoreSelector,"optionChange",this.selectChange),this.ui.item_score.html(this.scoreSelector.render().el),d.Score&&(this.w_target=_.find(c.ScoreLevelOptions_new.ScoreLevelOptions,function(a,b){return d.Score==a.Value}),this.w_target&&this.$(".item-score + strong").text(_.formatScoreByConfig(this.w_target,e)))}else{var i=0;_.find(a.RateScoreList,function(a,b){return i=b,1==a.CanOperate});var j=d.Score?_.toFixed(d.Score):"-";this.$el.find(".score-container .object-score").eq(i).find(".obj-value > strong").text(j)}if(this.model.set({TotalScore:a.TotalScore,ModuleRates:a.ModuleRates}),a.RateScore!=this.model.get("RateScore")&&void 0!=a.RateScore){this.model.set("RateScore",a.RateScore);var k=this.$el.find(".score-container .object-score"),i=0;_.find(a.RateScoreList,function(a,b){return i=b,1==a.CanOperate}),k.each(function(d,f){if(d==k.length-1){var g=Number(a.RateScore)==Number(1e4)?"":_.toFixed(a.RateScore);$(f).find("strong").text(g)}else if(d==i){var h=null!=a.RateScoreList[d].Score?Number(a.RateScoreList[d].Score)==Number(1e4)?"":_.toFixed(a.RateScoreList[d].Score):"-";!b.w_target&&c.ScoreLevelOptions_new&&(b.w_target=_.find(c.ScoreLevelOptions_new.ScoreLevelOptions,function(b){return a.RateScoreList[d].Score==b.Value})),b.w_target?$(f).find("strong").text(_.formatScoreByConfig(b.w_target,e)):$(f).find("strong").text(h)}})}this.model.set("WorkflowStepScoreList",a.WorkflowStepScoreList),this.model.set("RateScoreList",a.RateScoreList),this.trigger("goalOperation",this.model.toJSON())},refreshTaskList:function(){var b=this,c=this.model.toJSON();if("all"==this.model.get("mode")){var d=b.model.get("AssessmentItemManageType"),e=b.model.get("TitaObjectId");if(!e||"0"==e)return!1;if("OKR"==d&&0==c.ModuleType){var f=b.model.get("TargetId");if("00000000-0000-0000-0000-000000000000"==f||!f)return!1;a.app.request("Task:getKeyResult",{goalId:f}).done(function(c){if(c.length){b.KrTotal=c.length;var d=c,e=Date.parse(new Date);_.each(d,function(a){var b=a.EndDate.replace("/Date(","").replace(")/",""),c=a.StartDate.replace("/Date(","").replace(")/",""),d=(e-c)/(b-c)*100;a.timesPross=d<0?0:d,a.timesPross=d>100?100:d,a.StartDate=_.formatDate2(a.StartDate,"MM/DD"),a.EndDate=_.formatDate2(a.EndDate,"MM/DD")}),b.KeyRListView=new j({collection:new a.Collection(d)}),b.$("#KrNumber").text(b.KrTotal),$(b.ui.taskList).html(b.KeyRListView.render().el)}})}else("OKR"==d&&7==c.ModuleType||"Task"==d)&&(b.isDone?(b.taskListView=new n.TaskListView({isShowKclass:!1,isShowDelete:!1,isShowToggle:!0,isPush:!0,data:b.taskData}),_.each(b.taskListView.collection.models,function(a){b.listenTo(a,"change:status",b.changeStatus)}),b.$("#taskNumber").text(b.taskTotal),$(b.ui.taskList).html(b.taskListView.render().el)):a.app.request("Task:queryTaskList",{work_id:e,page_num:1,page_size:50}).done(function(a){var c=a.Data||[],d=b.model.toJSON().UserInfo;_.each(c,function(a){a.isAddExperience=!0,a.startDate=_.formatDate2(a.startDate,"YYYY/MM/DD HH:mm:ss"),a.createDate=_.formatDate2(a.createDate,"YYYY/MM/DD"),a.deadLine=_.formatDate2(a.deadLine,"YYYY/MM/DD HH:mm:ss"),a.finishDate=_.formatDate2(a.finishDate,"YYYY/MM/DD HH:mm:ss"),a.user.name=d.Name,a.principalUser.name=d.Name}),cacheContainer.get("InIframe")&&_.each(c,function(a){a.editStatusable=!1}),b.taskListView=new n.TaskListView({isShowKclass:!1,isShowDelete:!1,isShowCommentTotal:!0,isShowExperienceTotal:!0,isPush:!0,isShowStar:!cacheContainer.get("InIframe"),isShowToggle:!0,data:c}),_.each(b.taskListView.collection.models,function(a){b.listenTo(a,"change:status",b.changeStatus)}),b.isDone=!0,$(b.ui.taskList).html(b.taskListView.render().el),cacheContainer.get("InIframe")&&$(".list-container .left_ttpl").on("click",function(a){return!1}),b.taskData=c.slice(),b.taskTotal=c.length,b.model.set("TaskList",b.taskData),b.$("#taskNumber").text(b.taskData.length),localStorage.setItem("TitaObjectId"+e,"1")}))}},changeStatus:function(a){var b=a.toJSON(),c=this;_.each(c.taskData,function(a){a.taskId==b.taskId&&_.extend(a,b)})},operateTask2:function(){this.refreshTaskList()},tasknameFocus:function(a){var b=$(a.currentTarget);b.addClass("hasval"),b.val()==this.i18n.taskName&&b.val("")},tasknameBlur:function(a){var b=$(a.currentTarget);""==b.val()&&(b.removeClass("hasval"),b.val(this.i18n.taskName))},tasktimeKeyup:function(a){$(a.currentTarget).val("")},tasktimeFocus2:function(a){var b=this,c=$(a.currentTarget),d=this.model.toJSON();c.val()==this.i18n.taskDeadline&&(c.val(""),b.store.set(d.Id+"_taskdate",""));var e=this.$el.find(".add-task .input-tasktime"),f=c.offset();this.titaDatePicker=new r.DateTimePickerView({id:"date-task-time-picker",count:1,viewType:"date",isShowDateView:!0,isShowCycleView:!1,isShowLongView:!0,rangepickerOptions:{showLong:!0,startDate:d.startDate,endDate:d.endDate,format:"YYYY-MM-DD",timePicker:!1}}),this.listenTo(this.titaDatePicker,"apply",function(a){var c=b.titaDatePicker.model.toJSON();e.val(c.endDate)}),$("#main-region").append(this.titaDatePicker.render().el),this.titaDatePicker.$el.on("apply.daterangepicker",function(a){var c=b.titaDatePicker.model.toJSON();e.val(c.endDate),b.store.set(d.Id+"_taskdate",c.endDate)}),b.titaDatePicker.onShow(),b.titaDatePicker.show(b.$el),b.titaDatePicker.$el.hide(),setTimeout(function(){var a,c;a=Number(f.left),c=Number(f.top)+30,b.titaDatePicker.$el.css({position:"absolute",left:a,top:c,"z-index":9999999}),b.titaDatePicker.$el.slideDown(),$("#date-task-time-picker .calendar-time").hide(),$("#date-task-time-picker").css("display","block"),$(".tt-time-date-picker").css("display","block")},20)},tasktimeBlur:function(a){var b=$(a.currentTarget),c=$.trim(b.val());""==c?(b.removeClass("hasval"),b.val(this.i18n.taskDeadline)):this.store.set(this.model.get("Id")+"_taskdate",c)},addTask:function(b){var c=this,d=$(b.currentTarget),e=d.parents(".task-item");this.$weightBtn.removeClass("warn_class");var f=this.model.get("Id"),g={name:e.find(".input-taskname").val(),endDate:e.find(".input-tasktime").val(),createUserId:a.Context.getUserInfo().UserId,principalId:this.model.get("UserInfo").UserId,workId:this.model.get("TitaObjectId")};return""==g.name||g.name==this.i18n.taskName?(e.find(".input-taskname").addClass("error"),!1):""==g.endDate||g.endDate==this.i18n.taskDeadline?(e.find(".input-tasktime").addClass("error"),!1):(c.isDone=!1,d.removeClass("btn-blue").addClass("btn-disabled"),e.find(".input-tasktime").removeClass("error"),e.find(".input-taskname").removeClass("error"),g.endDate=g.endDate+" 18:00:00",g.onlyOnce=!0,void a.app.request("Task:addTask",g).done(function(a,b){var g=c.model.toJSON().UserInfo;if(c.store.set(f+"_taskname",""),c.store.set(f+"_taskdate",""),e.find(".input-taskname,.input-tasktime").val(""),a.Msg&&a.Msg.Module){var h=a.Msg.Module;h.tasks=h.Tasks,h.startDate=_.formatDate2(h.startDate,"YYYY/MM/DD HH:mm:ss"),h.createDate=_.formatDate2(h.createDate,"YYYY/MM/DD"),h.deadLine=_.formatDate2(h.deadLine,"YYYY/MM/DD HH:mm:ss"),h.finishDate=_.formatDate2(h.finishDate,"YYYY/MM/DD HH:mm:ss"),h.parentTaskId=null,h.isPush=!0,h.editStatusable=!0,h.isAddExperience=!0,h.user.name=g.Name,h.principalUser.name=g.Name,h.principalUser.userId=g.UserId,c.taskData.push(h)}c.taskTotal=c.taskData.length,c.taskListView=new n.TaskListView({isShowKclass:!1,isShowDelete:!1,isShowCommentTotal:!0,isShowExperienceTotal:!0,isPush:!0,isShowOwnerTag:!0,quirkOwnerTag:!0,data:c.taskData}),_.each(c.taskListView.collection.models,function(a){c.listenTo(a,"change:status",c.changeStatus)}),c.$("#taskNumber").text(c.taskTotal),$(c.ui.taskList).html(c.taskListView.render().el),d.removeClass("btn-disabled").addClass("btn-blue"),b.reset()}))},showAddTask:function(){var a=this,b=this.model.toJSON();this.$weightBtn.removeClass("warn_class");var c=a.store.get(b.Id+"_taskname"),d=a.store.get(b.Id+"_taskdate");""!=$.trim(c)&&a.ui.taskNameInput.val(a.store.get(b.Id+"_taskname"));var e=this.$el.find(".add-task .input-tasktime");""!=$.trim(d)&&e.val(a.store.get(b.Id+"_taskdate")),a.$(".add-task").slideDown()},showAskDelete:function(a){a.stopPropagation();var b=this.model.toJSON();if(this.$weightBtn.removeClass("warn_class"),5!=b.ModuleType&&("quickScore"==b.mode||"weightChange"==b.mode&&2!=b.WeightType))return!1;if(5==b.ModuleType)var c=this.i18n.deleteAddSubTip;else var c=this.i18n.deleteTargetTip;var d={contentStr:c,icon:"asking",showClose:!1,height:110,width:240,inHeight:64,Id:b.Id};this.confirmDialog=new k(d),this.listenTo(this.confirmDialog,"dialogClose",this.deleteObject),this.confirmDialog.render()},viewThirdBack:function(b){var c=this.model.toJSON(),d=this,e=$(b.currentTarget),f=e.text(),g=$(b.currentTarget),h=g.data("type");if(0===g.data("count"))return!1;this.$weightBtn.removeClass("warn_class");var j=d.i18n.watch,k=d.i18n.hide,l={feed:"rate",rate:"feed"};if(d.thirdCached[h])d.thirdCached[h]=!1,d.thirdCached[l[h]]=!0,e.text(f.replace(k,j)),d.$(".third-feed").html("");else{var m=e.siblings(".link");m.text(m.text().replace(k,j)),e.text(f.replace(j,k)),c.type=e.data("type");var n={assessmentId:c.assessmentId,UserId:c.ownerId,goalId:c.Id,moduleType:c.ModuleType,scoretype:e.data("type")};cacheContainer.get("InIframe")&&(n.fromType=3),a.app.request("Appraiser:getGoalThirdContent",n).done(function(a){a.type=e.data("type"),a.ownerName=c.ownerName,d.thirdCached[h]=!0,d.thirdCached[l[h]]=!1,d.thirdFeedItem=new i(a),d.ui.third_feed.html(d.thirdFeedItem.render().el)})}},viewGoal:function(b){b.stopPropagation();var c=this.model.toJSON(),d=$(b.currentTarget);c.AssessmentItemManageType,c.TargetUrl;if(d.hasClass("add-feedback")){this.$weightBtn.removeClass("warn_class");var e={id:c.Id,userId:c.ownerId,moduletype:c.ModuleType,r:Math.random()};a.app.request("Target:getGoalDetails",e).done(function(b){"0"==c.ModuleType&&($(".outcontent_tita_widget h2").html(c.Name),_.createFeedIframe(b.Data.FeedId,a.$(".content_tita_widget iframe"),a.$(".ps-details-container"),a.$(".content_tita_widget"),$(window).height()))})}},onShow:function(){this.ui.objDesc.tipso("destroy")},onClose:function(){$("body").find(".tipso_bubble").remove()}})}),define("views/common/empty-item-view",["talent","templates/common"],function(a,b){return a.ItemView.extend({template:b["common/empty-item"],isEmpty:!0,initialize:function(){},events:{},onRender:function(){},onShow:function(){},onClose:function(){}})}),define("views/assessment/target-composite-view",["talent","templates/assessment","views/assessment/target-item-view","views/common/empty-item-view"],function(a,b,c,d){return a.CompositeView.extend({template:b["assessment/target-composite-view"],itemView:c,itemViewContainer:"ul",emptyView:d,initialize:function(){var b=this.model.toJSON();this.sumWeight={value:b.Weight};var c=b.GoalList;$(c).each(function(a,c){_.extend(c,b,{index:a,Id:c.Id,ModuleId:b.Id,ownerId:b.UserInfo.UserId,Name:c.Name,Weight:c.Weight,currentStep:b.CurrentStepTypeId,currentStepId:b.CurrentStepId,assessmentId:b.Assessment.Id,ownerName:b.UserInfo.Name,WeightScoreLevel:c.WeightScoreLevel,objectiveTypeIn:b.FieldRight&&b.FieldRight.ObjectiveType}),""!==c.RateScore&&null!==c.RateScore||(c.RateScore=""),c.GoalList&&delete c.GoalList,c.ItemList&&delete c.ItemList}),this.collection=new a.Collection(c),this.model=new a.Model(this.options),this.model.set("mode",b.mode)},onBeforeItemAdded:function(b){var c=this.model.toJSON();if(b.isEmpty){if(5==c.model.get("ModuleType"))var d="emptyAddSubTarget";else var d="emptyTarget";b.model=new a.Model({text:_.langs("assessment").target[d]})}else b.sumWeight=this.sumWeight},onAfterItemAdded:function(a){var b=this;this.listenTo(a,"scoreChange",this.scoreChange),this.listenTo(a,"goalOperation",this.refresh),this.listenTo(a,"quickAddItem",function(){b.trigger("quickAddItem")})},scoreChange:function(b){var c=new a.Collection(this.collection.toJSON()).toJSON(),d=-1;_.find(c,function(a,c){return d=c,a.Id==b.Id}),d>-1&&(c[d]=b),this.trigger("scoreChange",c)},refresh:function(b){var c,d=b.operation,e=this.collection.toJSON();this.model.toJSON();if("remove"==d)e=_.filter(e,function(a){return a.Id!=b.Id});else{var f=-1;_.find(e,function(a,c){return f=c,a.Id==b.Id}),f>-1&&(e[f]=b)}this.collection=new a.Collection(e),c=b.ModuleRates&&b.ModuleRates[0]?b.ModuleRates[0].Score:b.Score;var g={GoalList:this.collection.toJSON(),doType:b.doType,WorkflowStepScoreList:b.WorkflowStepScoreList,TotalScore:b.TotalScore,GoalChangeModule:b.GoalChangeModule,Score:c};this.trigger("operateGoal",g)},onRender:function(){this.el.setAttribute("id","compositeView");var a=this;setTimeout(function(){a.$(".summy-item").last().css("border-bottom","none")},0)}})}),define("views/assessment/target-custom-item-view",["talent","templates/assessment","views/common/dialog/dialog-index-view"],function(a,b,c){return a.ItemView.extend({template:b["assessment/target-item-custom"],className:"targetItem",initialize:function(){var b=this,c=a.Context.getUserInfo().Id;if(_.extend(b,{i18n:_.langs("assessment")}),this.options.attributes&&this.options.attributes.isNewAdd){this.addflag=!0;var d=JSON.parse(JSON.stringify(this.options.toJSON()))}else{this.addflag=!1;var d=this.model.toJSON()}this.model.set(d.showData),this.model.set({i18n:b.i18n,moduleId:d.moduleId,isShowAddBtn:d.isShowAddBtn});var e,f,g=this.model.get("GroupId"),h=(this.model.get("AssessorId"),[]),i=!1;if(_.each(d.dataList,function(a,b){if(a.GroupId==g&&(e=b),curId=a.AssessorId,!f)return f=curId,void h.push(b);curId!=f&&h.push(b),f=curId}),_.each(h,function(a){a==e&&(i=!0)}),b.CustomItems=[],_.each(d.showData.CustomItems,function(a){b.CustomItems.push(a.Content)}),this.addflag){this.model.set("mode","add");var j=this.model.toJSON().CustomItems;_.each(j,function(a,b){a.Id=_.guid()}),this.model.set("CustomItems",j);var k=d.dataList.length;0!=k&&c==d.dataList[k-1].AssessorId||(i=!0)}else this.model.set({mode:"text",placeHolderList:d.placeHolderList});b.model.set("isShowImage",i),b.model.set("InIframe",cacheContainer.get("InIframe")),c==d.showData.AssessorId&&cacheContainer.get("HasTask")&&d.FieldRight&&1==d.FieldRight.RateStatement?this.model.set("CanOperate","edit"):this.model.set("CanOperate",!1)},className:"content-left clearfix",ui:{},events:{"click .save-custom":"saveCustom","click .cancel-custom":"cancelCustom","click .delete-custom":"deleteCustom","click .edit-custom":"editCsutom","keyup .tArea":"textKeyup","focus .tArea":"textFocus","blur .tArea":"textBlur","click .customOptionRadio":"hideErrorTip"},deleteCustom:function(){var b=this,c=b.model.get("GroupId");b.showConfirmDialog("asking",_.langs("assessment","warmDelete"),function(d){0!=d.result&&a.app.request("Target:deleteCustomItem",{groupId:c}).done(function(a){a.Result&&(b.trigger("customItemChange"),b.$el.remove(),b.close())})})},showConfirmDialog:function(a,b,d,e){var f={contentStr:b,icon:a,showClose:!1,height:110,width:300,inHeight:64};e&&(f=e),this.confirmDialog&&this.confirmDialog.close(),this.confirmDialog=new c(f),this.listenTo(this.confirmDialog,"dialogClose",d),this.confirmDialog.render()},saveCustom:function(){var b=this,c=this.model.toJSON(),d={},e=this.$("textarea"),f=(this.$(".optionRadioList"),b.flag?b.flag:"Id"),g=c.CustomItems;return!this.saving&&(this.saving=!0,_.each(g,function(a,g){if(1==a.Type)_.each(e,function(e,h){var i=c.placeHolderList&&c.placeHolderList[g]||[];if($(e).data("id")==a.CustomItemId){if(a.MinCharCount&&($(e).val()==a.Content&&"add"==c.mode||$.trim($(e).val()).length<a.MinCharCount||$(e).val()==i.Content)){$(e).addClass("error");var j=b.$(".requerdError");(!$.trim($(e).val())||$(e).val()==a.Content&&"add"==c.mode||$(e).val()==i.Content)&&_.each(j,function(b){$(b).data("id")==a.CustomItemId&&$(b).show()}),b.saving=!1}d["items["+g+"]."+f]=a.Id,d["items["+g+"].CustomItemId"]=a.CustomItemId,b.addflag&&$(e).val()==a.Content?d["items["+g+"].Content"]="":b.addflag||$(e).val()!=i.Content?d["items["+g+"].Content"]=_.encodescript($.trim($(e).val())):d["items["+g+"].Content"]=""}});else if(2==a.Type){var h=b.$("input[name='"+a.Id+"']:checked").val();if(("add"==c.mode||"edit"==c.mode)&&a.MinCharCount&&!h){var i=b.$(".requerdError");_.each(i,function(b){$(b).data("id")==a.CustomItemId&&$(b).show()}),b.saving=!1}d["items["+g+"]."+f]=a.Id,d["items["+g+"].CustomItemId"]=a.CustomItemId,d["items["+g+"].Content"]=h}}),!e.hasClass("error")&&(d.moduleId=c.moduleId,d.assessmentId=cacheContainer.get("AssessmentId"),d.groupId=c.GroupId,void(b.saving&&a.app.request("Target:saveCustomItem",d).done(function(a){a.Result&&(b.addflag?b.trigger("customItemChange"):(_.each(c.CustomItems,function(a,b){a.Content=d["items["+b+"].Content"]}),b.model.set(c),b.model.set("mode","text"),b.render()))}).fail(function(a){b.saving=!1}))))},cancelCustom:function(){if("add"==this.model.toJSON().mode)return this.trigger("customItemDelete"),void this.$el.remove();this.model.set("mode","text"),this.render()},textFocus:function(a){var b=$(a.currentTarget);b.addClass("hasval"),b.val()==b.data("holder")&&(b.val(""),b.width("98.5%").next(".warning-tip").css("display","none"))},textKeyup:function(a){var b=$(a.currentTarget),c=($.trim(b.val())||"").length;b.next().next("span.str-len").text(c+"/4000");var d=self.$(".requerdError");_.each(d,function(a){$(a).data("id")==b.data("id")&&$(a).hide()}),c>4e3?b.addClass("error"):b.removeClass("error")},textBlur:function(a){var b=$(a.currentTarget);""==b.val()&&(b.removeClass("hasval"),b.val(b.data("holder")))},hideErrorTip:function(a){$(a.currentTarget).closest(".form-select").find(".requerdError").hide()},editCsutom:function(){this.model.set("mode","edit"),this.render(),this.$el.find("textarea").autosize()},onRender:function(){var a=(this.model.toJSON(),this),b=this.$el.find("textarea");setTimeout(function(){a.saving=!1,b.autosize()},0)},onShow:function(){},onClose:function(){}})}),define("views/assessment/target-custom-composite-view",["talent","templates/assessment","views/assessment/target-custom-item-view","views/common/empty-item-view"],function(a,b,c,d){return a.CompositeView.extend({template:b["assessment/target-custom-composite-view"],itemView:c,itemViewContainer:"ul",emptyView:d,ui:{quick_add_custom:".quick_add_custom"},events:function(){var a={};return a["click "+this.ui.quick_add_custom]="addCustomItem",a},initialize:function(){var b,c=this.options,d=c.AssessorCustomItemList||[],e=[],f=c.CustomItemDef,g=a.Context.getUserInfo().Id;c.AllowAddOfCusModule&&(c.isShowAddBtn=g==f.AssessorId),_.each(d,function(a,b){_.each(a.CustomItems,function(a,b){a.Options=f.CustomItems[b].Options});var g={showData:a,moduleId:c.moduleId,dataList:d,FieldRight:c.FieldRight,placeHolderList:c.CustomItemDef.CustomItems||[],isShowAddBtn:c.isShowAddBtn};e.push(g)}),b={FieldRight:c.FieldRight,InIframe:cacheContainer.get("InIframe"),isShowAddBtn:c.isShowAddBtn},this.model.set(b),this.collection=new a.Collection(e)},onBeforeItemAdded:function(b){var c=(this.model.toJSON(),this.options.AllowAddOfCusModule?"emptyCustomItem":"multiEmptyCustomItem");b.isEmpty&&(b.model=new a.Model({text:_.langs("assessment").target[c]}))},onAfterItemAdded:function(a){var b=this;this.listenTo(a,"customItemChange",function(){b.trigger("customListChange")})},addCustomItem:function(){var b=this;this.$(".empty-target").hide();var d=this.options,e=new c(new a.Model({isNewAdd:!0,isShowAddBtn:d.isShowAddBtn,FieldRight:d.FieldRight,showData:d.CustomItemDef,dataList:d.AssessorCustomItemList,moduleId:d.moduleId}));this.listenTo(e,"customItemChange",function(){b.trigger("customListChange")}),this.listenTo(e,"customItemDelete",function(){b.$(".empty-target").show()}),this.$(".target-container").append(e.render().el)},onRender:function(){var a=this,b=this.options,c=BSGlobal.loginUserInfo.Id,d=b.AssessorCustomItemList.some(function(a){return a.AssessorId==c});b.AssessorCustomItemList.length||d||b.CustomItemDef.AssessorId!=c||!b.FieldRight.RateStatement||b.AllowAddOfCusModule||this.addCustomItem(),setTimeout(function(){a.$(".summy-item").last().css("border-bottom","none")},0)}})}),function(a){"use strict";"function"==typeof define&&define.amd?define("sortable",a):"undefined"!=typeof module&&void 0!==module.exports?module.exports=a():window.Sortable=a()}(function(){"use strict";function a(a,c){this.el=a,this.options=c=c||{},c.group=c.group||Math.random(),c.store=c.store||null,c.handle=c.handle||null,c.draggable=c.draggable||a.children[0]&&a.children[0].nodeName||(/[uo]l/i.test(a.nodeName)?"li":"*"),c.ghostClass=c.ghostClass||"sortable-ghost",c.ignore=c.ignore||"a, img","onAdd onUpdate onRemove onStart onEnd".split(" ").forEach(function(a){c[a]=b(this,c[a]||E)}),a[x]=c.group;for(var d in this)"_"===d.charAt(0)&&(this[d]=b(this,this[d]));e(a,"add",c.onAdd),e(a,"update",c.onUpdate),e(a,"remove",c.onRemove),e(a,"start",c.onStart),e(a,"stop",c.onEnd),e(a,"mousedown",this._onTapStart),e(a,"touchstart",this._onTapStart),B&&e(a,"selectstart",this._onTapStart),e(a,"dragover",this._onDragOver),e(a,"dragenter",this._onDragOver),G.push(this._onDragOver),c.store&&this.sort(c.store.get(this))}function b(a,b){var c=F.call(arguments,2);return b.bind?b.bind.apply(b,[a].concat(c)):function(){return b.apply(a,c.concat(F.call(arguments)))}}function c(a,b,c){if("*"===b)return a;if(a){c=c||z,b=b.split(".");var d=b.shift().toUpperCase(),e=new RegExp("\\s("+b.join("|")+")\\s","g");do{if(!(""!==d&&a.nodeName!=d||b.length&&((" "+a.className+" ").match(e)||[]).length!=b.length))return a}while(a!==c&&(a=a.parentNode))}return null}function d(a){a.dataTransfer.dropEffect="move",a.preventDefault()}function e(a,b,c){a.addEventListener(b,c,!1)}function f(a,b,c){a.removeEventListener(b,c,!1)}function g(a,b,c){if(a)if(a.classList)a.classList[c?"add":"remove"](b);else{var d=(" "+a.className+" ").replace(/\s+/g," ").replace(" "+b+" ","");a.className=d+(c?" "+b:"")}}function h(a,b,c){if(a&&a.style){if(void 0===c)return z.defaultView&&z.defaultView.getComputedStyle?c=z.defaultView.getComputedStyle(a,""):a.currentStyle&&(c=a.currentStyle),void 0===b?c:c[b];a.style[b]=c+("string"==typeof c?"":"px")}}function i(a,b,c){if(a){var d=a.getElementsByTagName(b),e=0,f=d.length;if(c)for(;f>e;e++)c(d[e],e);return d}return[]}function j(a){return a.draggable=!1}function k(){C=!1}function l(a,b){var c=a.lastElementChild.getBoundingClientRect();return b.clientY-(c.top+c.height)>5}function m(a){for(var b=a.innerHTML+a.className+a.src,c=b.length,d=0;c--;)d+=b.charCodeAt(c);return d.toString(36)}var n,o,p,q,r,s,t,u,v,w,x="Sortable"+(new Date).getTime(),y=window,z=y.document,A=y.parseInt,B=!!z.createElement("div").dragDrop,C=!1,D=function(a,b){var c=z.createEvent("Event");return c.initEvent(a,!0,!0),c.item=b,c},E=function(){},F=[].slice,G=[];return a.prototype={constructor:a,_applyEffects:function(){g(n,this.options.ghostClass,!0)},_onTapStart:function(a){var b=a.touches&&a.touches[0],f=(b||a).target,g=this.options,h=this.el;if(g.handle&&(f=c(f,g.handle,h)),f=c(f,g.draggable,h),f&&"selectstart"==a.type&&"A"!=f.tagName&&"IMG"!=f.tagName&&f.dragDrop(),f&&!n&&f.parentNode===h){v=a,p=this.el,n=f,q=n.nextSibling,u=this.options.group,n.draggable=!0,g.ignore.split(",").forEach(function(a){i(f,a.trim(),j)}),b&&(v={target:f,clientX:b.clientX,clientY:b.clientY},this._onDragStart(v,!0),a.preventDefault()),e(z,"mouseup",this._onDrop),e(z,"touchend",this._onDrop),e(z,"touchcancel",this._onDrop),e(this.el,"dragstart",this._onDragStart),e(this.el,"dragend",this._onDrop),e(z,"dragover",d);try{z.selection?z.selection.empty():window.getSelection().removeAllRanges()}catch(a){}n.dispatchEvent(D("start",n))}},_emulateDragOver:function(){if(w){h(o,"display","none");var a=z.elementFromPoint(w.clientX,w.clientY),b=a,c=this.options.group,d=G.length;if(b)do{if(b[x]===c){for(;d--;)G[d]({clientX:w.clientX,clientY:w.clientY,target:a,rootEl:b});break}a=b}while(b=b.parentNode);h(o,"display","")}},_onTouchMove:function(a){if(v){var b=a.touches[0],c=b.clientX-v.clientX,d=b.clientY-v.clientY,e="translate3d("+c+"px,"+d+"px,0)";w=b,h(o,"webkitTransform",e),h(o,"mozTransform",e),h(o,"msTransform",e),h(o,"transform",e),a.preventDefault()}},_onDragStart:function(a,b){var c=a.dataTransfer;if(this._offUpEvents(),b){var d,f=n.getBoundingClientRect(),g=h(n);o=n.cloneNode(!0),h(o,"top",f.top-A(g.marginTop,10)),h(o,"left",f.left-A(g.marginLeft,10)),h(o,"width",f.width),h(o,"height",f.height),h(o,"opacity","0.8"),h(o,"position","fixed"),h(o,"zIndex","100000"),p.appendChild(o),d=o.getBoundingClientRect(),h(o,"width",2*f.width-d.width),h(o,"height",2*f.height-d.height),e(z,"touchmove",this._onTouchMove),e(z,"touchend",this._onDrop),e(z,"touchcancel",this._onDrop),this._loopId=setInterval(this._emulateDragOver,150)}else c.effectAllowed="move",c.setData("Text",n.textContent),e(z,"drop",this._onDrop);setTimeout(this._applyEffects)},_onDragOver:function(a){if(!C&&u===this.options.group&&(void 0===a.rootEl||a.rootEl===this.el)){var b=this.el,d=c(a.target,this.options.draggable,b);if(0===b.children.length||b.children[0]===o||b===a.target&&l(b,a))b.appendChild(n);else if(d&&d!==n&&void 0!==d.parentNode[x]){r!==d&&(r=d,s=h(d),t=d.getBoundingClientRect());var e,f=t,g=f.right-f.left,i=f.bottom-f.top,j=/left|right|inline/.test(s.cssFloat+s.display),m=d.offsetWidth>n.offsetWidth,p=d.offsetHeight>n.offsetHeight,q=(j?(a.clientX-f.left)/g:(a.clientY-f.top)/i)>.5,v=d.nextElementSibling;C=!0,setTimeout(k,30),e=j?d.previousElementSibling===n&&!m||q&&m:v!==n&&!p||q&&p,e&&!v?b.appendChild(n):d.parentNode.insertBefore(n,e?v:d)}}},_offUpEvents:function(){f(z,"mouseup",this._onDrop),f(z,"touchmove",this._onTouchMove),f(z,"touchend",this._onDrop),f(z,"touchcancel",this._onDrop)},_onDrop:function(a){clearInterval(this._loopId),f(z,"drop",this._onDrop),f(z,"dragover",d),f(this.el,"dragend",this._onDrop),f(this.el,"dragstart",this._onDragStart),f(this.el,"selectstart",this._onTapStart),this._offUpEvents(),a&&(a.preventDefault(),a.stopPropagation(),o&&o.parentNode.removeChild(o),n&&(j(n),g(n,this.options.ghostClass,!1),p.contains(n)?n.nextSibling!==q&&n.dispatchEvent(D("update",n)):(p.dispatchEvent(D("remove",n)),n.dispatchEvent(D("add",n))),n.dispatchEvent(D("stop",n))),p=n=o=q=v=w=r=s=u=null,this.options.store&&this.options.store.set(this))},toArray:function(){for(var a,b=[],c=this.el.children,d=0,e=c.length;e>d;d++)a=c[d],b.push(a.getAttribute("data-id")||m(a));return b},sort:function(a){var b={},c=this.el;this.toArray().forEach(function(a,d){b[a]=c.children[d]}),a.forEach(function(a){b[a]&&(c.removeChild(b[a]),c.appendChild(b[a]))})},destroy:function(){var a=this.el,b=this.options;f(a,"add",b.onAdd),f(a,"update",b.onUpdate),f(a,"remove",b.onRemove),f(a,"start",b.onStart),f(a,"stop",b.onEnd),f(a,"mousedown",this._onTapStart),f(a,"touchstart",this._onTapStart),f(a,"selectstart",this._onTapStart),f(a,"dragover",this._onDragOver),f(a,"dragenter",this._onDragOver),Array.prototype.forEach.call(a.querySelectorAll("[draggable]"),function(a){a.removeAttribute("draggable")}),G.splice(G.indexOf(this._onDragOver),1),this._onDrop(),this.el=null}},a.utils={on:e,off:f,css:h,find:i,bind:b,closest:c,toggleClass:g},a.version="0.4.1",a}),define("views/assessment/module-item-view",["talent","templates/assessment","views/assessment/target-composite-view","views/assessment/target-custom-composite-view","views/common/dialog/dialog-index-view","views/natureDialog/addSubItem/index-page-view","jquery.ui","views/assessment/helpers/authority","sortable"],function(a,b,c,d,e,f,g,h,i){return a.ItemView.extend({getTemplate:function(){var a=this.model.toJSON();return 4==a.ModuleType?b["assessment/module-item-summy"]:0!=a.RelType?b["assessment/module-item-thirdmodules"]:5==a.ModuleType?b["assessment/module-item-addsub"]:6==a.ModuleType?b["assessment/module-item-custom"]:b["assessment/module-item"]},statetpl:b["assessment/module-item-state"],initialize:function(){var a=this.model.toJSON(),b=0;if(self._i18n=_.langs("assessment"),6!=a.moduleType){var c=h.moduleScoreVisible(a);this.model.set("showModuleScore",c),cacheContainer.get("InIframe")?this.model.set("InIframe",!0):this.model.set("InIframe",!1);var d=0;1==a.WeightType?$(a.GoalList).each(function(a,c){1==c.TypeId&&0==c.ScoringMethod&&b++,d+=Number(c.Weight)}):($(a.GoalList).each(function(a,c){1==c.TypeId&&0==c.ScoringMethod&&b++}),d=a.Weight),(d||0===parseInt(d))&&(d=_.toFixed(d));var e=b==a.GoalList.length;localStorage.setItem("moduleGoalWeight"+a.Id,d),this.model.set("goalWeightCount",d),this.model.set("hideSave",e),$(document).click(function(a){$(".pd-down-list").removeClass("dp-down-active")})}},className:"module-item",ui:{quick_add_target:".quick_add_target",quick_add_addsubmodel:".quick_add_addsubmodel",target_btn_cancel:".add-quick-target .btn-cancel",target_btn_sure:".add-quick-target .btn-sure",module_btn_cancel:".module-operate .btn-cancel",module_btn_sure:".module-operate .btn-sure",sort_weight_click:".sort-weight,.sort-time",module_title:".module-title",target_list:".target-list",sort_customize_status:".sort-customize-status",goalNameInput:"input[name=target_name]",target_list:".target-list",sortableBtn:".sortable-btn",cancelSortBtn:".btn-cancel-sort",ensure_Order:".btn-ensure-sort",sort_order:".sort-order",listfrontMenu:".dp-list-front",showTips:".score-error"},events:function(){var a={};return a["click "+this.ui.quick_add_target]="showAddTarget",a["click "+this.ui.quick_add_addsubmodel]="showAddSubmodel",a["click "+this.ui.target_btn_cancel]="cancelAddTarget",a["click "+this.ui.target_btn_sure]="addTarget",a["click "+this.ui.module_btn_cancel]="cancelUpdate",a["click "+this.ui.module_btn_sure]="updateData",a["click "+this.ui.sort_weight_click]="sortWeightClick",a["click "+this.ui.cancel_Order]="cancelOrder",a["keydown "+this.ui.goalNameInput]="targetInputEnter",a["click "+this.ui.sortableBtn]="clickSortableAction",a["click "+this.ui.cancelSortBtn]="cancelSortAction",a["click "+this.ui.ensure_Order]="ensureOrder",a["click "+this.ui.sort_order]="sortOrder",a["mouseleave "+this.ui.listfrontMenu]="hideSortMenu",a},hideSortMenu:function(a){$(a.currentTarget).parents(".pd-down-list").removeClass("dp-down-active")},sortOrder:function(a){a.stopPropagation(),$(a.currentTarget).find(".pd-down-list").toggleClass("dp-down-active")},ensureOrder:function(){var b=this.model.toJSON(),c=[],d=[],e=this;$(this.el).find(".target-item").each(function(){var a=$(this).find(".target-title").data("id");c.push(a);for(var e=0;e<b.GoalList.length;e++)if(b.GoalList[e].Id==a)return d.push(b.GoalList[e]),b.GoalList.splice(e,1),!0}),_.each(d,function(a,c){b.GoalList.push(a)}),this.model.set("GoalList",d),c.length&&a.app.request("Assessment:SetOrderCustom",{moduleId:b.Id,moduleType:b.ModuleType,assessmentId:b.Assessment.Id,itemIds:c.join(",")}).done(function(a){e.model.set("OrderType",3)}),e.cancelSortAction()},cancelSortAction:function(){var a=this;a.$(".add-quick-target").show(),$(".zhDiv").remove(),a.refreshTarget("simple"),setTimeout(function(){a.sortEl.destroy()},0)},clickSortableAction:function(a){var b=this;$(a.currentTarget).parents(".pd-down-list").removeClass("dp-down-active"),b.$(".add-quick-target").hide(),$(".zhDiv").remove();var c=$("<div/>",{class:"zhDiv"});$("#main-region").append(c),b.refreshTarget("sortable"),setTimeout(function(){b.$(".target-item").off(),b.sortEl=new i($(".target-container-status-sortable")[0],{draggable:".target-item"})},0)},targetInputEnter:function(a){var b=$(a.currentTarget),c=b.val();c.length>50&&b.val(c.substring(0,50))},render:function(){var a=this;return a.unbindUIElements&&a.unbindUIElements(),this.calculateScore(),this.$el.html(this.getTemplate()(this.model.toJSON())),a.bindUIElements&&a.bindUIElements(),this.refreshState(),this.refreshTarget(),this},refreshState:function(){var a=this.model.toJSON();a.Limit={},a.LowScoreOfAddOrSub&&a.UpperScoreOfAddOrSub?a.Limit=a.LowScoreOfAddOrSub+"~"+a.UpperScoreOfAddOrSub:a.LowScoreOfAddOrSub&&!a.UpperScoreOfAddOrSub?a.Limit="下限"+a.LowScoreOfAddOrSub:!a.LowScoreOfAddOrSub&&a.UpperScoreOfAddOrSub?a.Limit="上限"+a.UpperScoreOfAddOrSub:a.Limit=null;var b=this.statetpl(a);this.ui.module_title.html(b);var c=Number(a.LowScoreOfAddOrSub),d=Number(a.UpperScoreOfAddOrSub),e=Number(a.Score);d&&c&&a.Score&&(e>d||e<c)?this.setError():!d&&c&&a.Score&&e<c?this.setError():!c&&d&&a.Score&&e>d?this.setError():this.model.set("AddAndSubScoreError","0"),this.trigger("moduleChange",{Module:this.model.toJSON()})},setError:function(){this.$(".moduleScore").addClass("score-error"),this.model.set("AddAndSubScoreError","1"),this.$(".moduleScore").attr("title","得分超出模块得分限制")},updateData:function(a){this[$(a.currentTarget).data("handlar")]()},sortWeightClick:function(b){var c={},d=this,e=this.model.toJSON(),f=0,g=$(b.currentTarget).attr("index");"0"==e.WeightType&&(_.each(e.GoalList,function(a){f+=a.Weight-0}),e.goalWeightCount=f,e.Weight=f),0==g?(c.ordertype=0,this.model.set("OrderType",0)):(c.ordertype=1,this.model.set("OrderType",1)),c.moduleType=e.ModuleType,c.assessmentId=e.Assessment.Id,c.moduleId=e.Id,c.ownerId=e.UserInfo.UserId,a.app.request("Assessment:saveUserOrderRule",c).done(function(a){if(a.Code>0){var b=0;b=c.ordertype?1:0;var f=[];_.each(a.Data||[],function(a){var b=_.find(e.GoalList,{Id:a})||{};f.push(b)}),d.model.set({GoalList:f||[],OrderType:b,mode:"simple"}),d.trigger("moduleChange",{Module:d.model.toJSON(),mode:"simple"}),d.render()}})},upWeight:function(){var b=this,c={},d=this.model.toJSON();if(weightInfo=[],c["batchModifyWeight.AssessmentId"]=d.Assessment.Id,c["batchModifyWeight.ModuleId"]=d.Id,b.model.set("mode","simple"),this.$el.find("input.weight-val.error").length>0)return!1;this.$el.find(".target-title").each(function(a,b){var d=_.toFixed2($(b).find("input.weight-val").val()),e={id:$(b).data("id"),type:$(b).data("type"),weight:d};weightInfo.push(e),c["batchModifyWeight.WeightInfos["+a+"].ItemId"]=$(b).data("id"),c["batchModifyWeight.WeightInfos["+a+"].ModuleType"]=$(b).data("type"),c["batchModifyWeight.WeightInfos["+a+"].Weight"]=d,c["batchModifyWeight.WeightInfos["+a+"].ScoreType"]=$(b).data("scoretype"),c["batchModifyWeight.WeightInfos["+a+"].ScoreLevelId"]=$(b).data("scorelevelid")}),a.app.request("Target:addBatchModifyWeight",c).done(function(a){if(a.Result>0){var c=d.GoalList,e=0;_.each(a.WeightScoreLevelList,function(a,b){_.each(c,function(b,c){a.AssessmentItemId==b.Id&&(b.WeightScoreLevel=a)})}),$(weightInfo).each(function(b,d){_.each(c,function(b,c){b.Id==d.id&&(b.Weight=_.toFixed(Number(d.weight)),e+=parseFloat(b.Weight),b.RateScore=a.ItemScores[c].Score,b.NumRateScore=parseFloat(b.RateScore))})}),1!=d.WeightType&&(b.model.set("Weight",e+""),localStorage.setItem("moduleWeight"+d.Id,d.Weight)),b.model.set("goalWeightCount",e),b.model.set("Score",a.ModuleRates[0]&&a.ModuleRates[0].Score),b.model.set("GoalList",c),b.trigger("moduleChange",{Module:b.model.toJSON(),TotalScore:a.TotalScore+"",WorkflowStepScoreList:a.WorkflowStepScoreList}),b.render()}})},upScore:function(){var b=this,c={},d=this.model.toJSON();if(targetListcollection=this.targetListView.collection.toJSON(),d.hideSave)return void this.cancelUpdate();if(b.model.set("mode","simple"),c.UserId=d.UserInfo.UserId,c.assessmentId=d.Assessment.Id,c["itemScores.AssessmentId"]=d.Assessment.Id,c["itemScores.ModuleId"]=d.Id,c["itemScores.ModuleType"]=d.ModuleType,c["itemScores.WorkflowStepId"]=d.CurrentStepId,this.$("input.item-score").each(function(a){""==$.trim($(this).val())&&$(this).addClass("error")}),this.$el.find("input.item-score.error,.input-error").length>0)return!1;var e=0,f=_.filter(targetListcollection,function(a){return"1"!=a.TypeId||1==a.TypeId&&1==a.ScoringMethod});return $(f).each(function(a,d){if(1==d.TypeId&&1!=d.ScoringMethod)c["itemScores.ItemScores["+a+"].Id"]=d.Id,c["itemScores.ItemScores["+a+"].Score"]="-"==d.RateScore?0:d.RateScore;else{if(null==d.currentScore.Score||""==d.currentScore.Score)return e++,b.$(".target-title[data-id="+d.Id+"]").find("a.tit_sel").addClass("input-error"),!1;null!=d.currentScore.Score||null!=d.RateScore&&""!=d.RateScore||e++,void 0!=d.currentScore.Score&&(c["itemScores.ItemScores["+a+"].Id"]=d.Id,c["itemScores.ItemScores["+a+"].Score"]=d.currentScore.Score)}}),0==targetListcollection.length?(b.render(),!1):!(e>0)&&void a.app.request("Target:batchSaveRate",c).done(function(a){a.Result>0&&(b.model.set("Score",a.ModuleRates[0].Score),$(targetListcollection).each(function(b,c){c.Score=c.currentScore.Score,$(c.RateScoreList).each(function(a,b){b.CanOperate&&(b.Score=c.currentScore.Score,b.ScoreName=c.currentScore.ScoreName,b.ScoreDescription=c.currentScore.ScoreDescription),b.WorkflowStepId==c.currentScore.WorkflowStepId&&(WorkflowStepId=c.currentScore)}),$(a.ItemScores).each(function(a,b){c.Id.toLowerCase()==b.Id.toLowerCase()&&(c.RateScore=b.Score)})}),b.model.set("GoalList",targetListcollection),b.trigger("moduleChange",{WorkflowStepScoreList:a.WorkflowStepScoreList||[],Module:b.model.toJSON(),TotalScore:a.TotalScore}),b.render())})},showInfoDialog:function(a){var b={contentStr:a,icon:"info",showClose:!0,height:"58",width:278,inHeight:"auto",timeColse:3e3,showFoot:!1};this.infoDialog=new e(b),this.infoDialog.render()},cancelUpdate:function(){var b=this,c=this.model.toJSON();b.model.set("mode","simple"),_.each(c.GoalList,function(a){_.each(a.RateScoreList,function(a){a.currentScore=null})}),a.app.vent.trigger("resetPageDataMoudleList",c.GoalList,c.index),b.render()},showAddTarget:function(a){$(a.currentTarget).hide(),this.$el.find(".add_target_container").show(),this.trigger("quickAddItem")},showAddSubmodel:function(){var b=this.model.toJSON();1==b.ModuleScoreType?scoreLevel=b.ModuleTargetScoreLevels:scoreLevel=b.ModuleScoreLevelOptions;var c={height:"512",width:"600",inHeight:"430",title:self._i18n.operationToolbar.btnNewAddSum,timeColse:null,scoreLevel:scoreLevel,FieldRight:b.FieldRight,UserId:"",AssessmentId:"",description:"",moduleId:b.Id,score:"",name:"",operate:"add",mode:"add",typeId:0,ScoreLevelSettings:{},Id:b.Assessment.Id,isScoreLevel:1!=b.ModuleScoreType};if(a.inItalent){var d=_.getPopUrl("addSubItem","addAddSubGaol"+b.Id);window.iTalentSDK.showPopup(d,601,525,c)}else this.addSubItemView=new f(c),this.addSubItemView.render(),this.listenTo(this.addSubItemView,"addSubSave",this.saveAddSub)},saveAddSub:function(a){this.trigger("addSubSave",a)},cancelAddTarget:function(){this.$el.find(".add_target_container").hide(),this.$el.find(".quick_add_target").show()},addTarget:function(b){var c=this,d=$(b.currentTarget),e=this.model.toJSON(),f=_.escape(this.$el.find("input[name='target_name']").removeClass("error").val());return""==$.trim(f)?(this.$el.find("input[name='target_name']").addClass("error"),!1):!d.hasClass("btn-disabled")&&(d.removeClass("btn-blue").addClass("btn-disabled"),c.timer&&clearTimeout(c.timer),void(c.timer=setTimeout(function(){a.app.request("Target:quickAddItem",{UserId:e.UserInfo.UserId,moduleId:e.Id,assessmentId:e.Assessment.Id,goalName:f,moduleType:e.ModuleType,UserId:e.UserInfo.UserId}).done(function(a){0!=a.Result&&c.trigger("moduleChange",{GoalChangeModule:!0,Module:c.model.toJSON(),doType:"add"})})},500)))},_updateScore:function(a){this.$(".module-score strong").text(a)},_updateWeidget:function(a){this.$(".totalWeight").text(a)},refreshTarget:function(b){var e=this,f=this.model.toJSON(),g=f.AssessorCustomItemList;if(6!=f.ModuleType)b&&(f.mode=b),this.targetListView=new c({model:new a.Model(f)}),this.ui.target_list.html(this.targetListView.render().el),this.listenTo(this.targetListView,"changeState",function(a){e.model.set({GoalList:a,Weight:_.reduce(a,function(a,b){return a+Number(b.Weight)},0)}),e.refreshState()}),this.listenTo(this.targetListView,"quickAddItem",function(){e.trigger("quickAddItem")}),this.listenTo(this.targetListView,"scoreChange",function(a){e.model.set({GoalList:a}),a.length!=e.model.get("GoalList").length&&e.cancelUpdate(),0==a.length&&(e.refreshTarget(),e.$el.find(".person-score").text("")),e.calculateScore(!0);var b=e.$(".module-count .person-score"),c=e.model.get("WeightScoreList");e.trigger("moduleChange",{Module:e.model.toJSON(),GoalChangeModule:!1,TotalScore:a.TotalScore}),c.length>0&&$(b).each(function(a,b){$(b).text(_.toFixed(c[a].ScoreCount,2))})}),this.listenTo(this.targetListView,"operateGoal",function(a){a.Score!=e.model.get("Score")&&e._updateScore(a.Score),e.model.set({GoalList:a.GoalList,Score:a.Score,WorkflowStepScoreList:a.WorkflowStepScoreList}),e.model.get("WeightType")-0==0&&e.model.set({Weight:_.reduce(a.GoalList,function(a,b){return a+Number(b.Weight)},0)}),a.GoalList.length!=e.model.get("GoalList").length&&e.cancelUpdate(),0==a.GoalList.length&&(e.refreshTarget(),e.$el.find(".person-score").text("")),e.refreshState(),e.trigger("moduleChange",{Module:e.model.toJSON(),GoalChangeModule:a.GoalChangeModule,TotalScore:a.TotalScore,WorkflowStepScoreList:a.WorkflowStepScoreList,doType:a.doType}),e.calculateScore();var b=e.$(".module-count .person-score"),c=e.model.get("WeightScoreList");if(!c)return!1;_.each(b,function(a,b){$(a).text(_.toFixed(c[b].ScoreCount,2))})});else if(null!=g||g&&0!=g.length){var h=new d({CustomItemDef:f.CustomItemDef,AssessorCustomItemList:f.AssessorCustomItemList,moduleId:f.Id,FieldRight:f.FieldRight,AllowAddOfCusModule:f.AllowAddOfCusModule});this.listenTo(h,"customListChange",function(){e.trigger("moduleChange")}),this.ui.target_list.html(h.render().el)}},_execScoreCount:function(a,b,c){var d=this.model.toJSON();c?_.each(b,function(b){b.currentScore?null!=b.currentScore.Score&&""!=b.currentScore.Score&&"10000.00"!=b.currentScore.Score&&(2==d.ScoreMethod?(a.isSum=!0,a.ScoreCount+=Number(b.currentScore.Score)):(a.HasScored=!0,a.WeightCount+=Number(b.GoalWeight),a.ScoreCount+=b.GoalWeight*Number(b.currentScore.Score))):null!=b.Score&&""!=b.Score&&"10000.00"!=b.Score&&(2==d.ScoreMethod?(a.isSum=!0,a.ScoreCount+=Number(b.Score)):(a.HasScored=!0,a.WeightCount=Number(Number(a.WeightCount)+Number(b.GoalWeight)),a.ScoreCount+=b.GoalWeight*Number(b.Score)))}):_.each(b,function(b){null!=b.Score&&""!=b.Score&&"10000.00"!=b.Score&&(2==d.ScoreMethod?(a.isSum=!0,a.ScoreCount+=Number(b.Score)):(a.HasScored=!0,a.WeightCount=Number(a.WeightCount)+Number(b.GoalWeight),a.ScoreCount+=b.GoalWeight*Number(b.Score)))})},calculateScore:function(a){var b=this,c=this.model.toJSON(),d=c.GoalList,e=[],f=[],g=[];_.each(d,function(a){1==a.TypeId&&0==a.ScoringMethod&&g.push(a)}),d=_.filter(d,function(a){return 0==a.TypeId||1==a.TypeId&&1==a.ScoringMethod}),_.each(d,function(a,b){var d=a.RateScoreList;_.each(d,function(b,d){b.WorkflowStepId||(b.WorkflowStepId=c.CurrentStepId),_.extend(b,{GoalId:a.Id,GoalWeight:a.Weight}),e.push(b)})}),modelScoreList=_.groupBy(e,"WorkflowStepId");var h=_.keys(modelScoreList);_.each(h,function(d,h){_.each(g,function(a,b){e.push(_.extend({},{WorkflowStepId:d,Score:a.RateScore,GoalWeight:a.Weight,currentScore:null}))}),modelScoreList=_.groupBy(e,"WorkflowStepId");var i=_.find(c.WorkflowStepList,function(a){return a.Id==d}),j={WorkflowStepId:d,ScoreCount:0,showIndex:i.StepIndex,WeightCount:0,HasScored:!1},k=modelScoreList[d];b._execScoreCount(j,k,a),j.isSum||(j.HasScored?0==j.ScoreCount||0==j.WeightCount?j.ScoreCount=0:j.ScoreCount=_.toFixed(j.ScoreCount/j.WeightCount,2):j.ScoreCount="-"),f.push(j)}),f.sort(function(a,b){return a.showIndex-b.showIndex>0}),this.model.set("WeightScoreList",f)}})}),define("views/assessment/module-composite-view",["talent","templates/home","views/assessment/module-item-view","views/common/empty-item-view"],function(a,b,c,d){return a.CompositeView.extend({template:_.template(""),itemView:c,emptyView:d,initialize:function(){var b=this,c=b.model.toJSON(),d=c.ModuleList;_attr_modulelist=[],_.each(d,function(a){_attr_modulelist.push(_.extend({},a,{ModuleList:void 0,GoalList:void 0,ItemList:void 0}))}),b.i18n=_.langs("assessment","module"),_.each(d,function(a,d){_.extend(a,c,{index:d,i18n:b.i18n,ModuleList:_attr_modulelist}),a.ItemList&&delete a.ItemList}),this.collection=new a.Collection(d)},onBeforeItemAdded:function(b){var c=this;this.listenTo(b,"quickAddItem",function(){c.trigger("quickAddItem")}),this.listenTo(b,"addSubSave",function(a){c.trigger("addSubSave",a)}),b.isEmpty?(b.$el.addClass("target-list"),b.model=new a.Model({text:c.i18n.noTarget})):c.listenTo(b,"moduleChange",function(a){var b=this.model.toJSON();a?(b.doType=a.doType,b.ModuleList[a.Module.index]=a.Module,void 0==a.TotalScore&&null==a.TotalScore||(b.TotalScore=a.TotalScore),a.GoalChangeModule&&(b.GoalChangeModule=a.GoalChangeModule),a.mode&&(b.mode=a.mode),b.WorkflowStepScoreList=a.WorkflowStepScoreList,this.trigger("listChange",b)):this.trigger("customModuleChange",b)})}})}),define("views/assessment/signinfo-item-view",["talent","templates/assessment","views/common/controls/CommonDropDownListCtl","$.autoresize"],function(a,b,c){return a.ItemView.extend({template:b["assessment/signinfo-item"],initialize:function(){this.model.set("operation",!1);var b=this.model.toJSON(),c=this.model.get("page"),d=a.Context.getUserInfo().Id;cacheContainer.get("InIframe")?b.InIframe=!0:b.InIframe=!1,b.Result==c.SignModule.AgreeTwo.Name||b.Result==c.SignModule.AgreeOne.Name?b.mode="view":c.Assessment.HasTask&&4==c.Assessment.CurrentStepTypeId&&d==b.UserId?b.mode="add":null==b.Result?b.mode="signing":""==b.Result?b.mode="empty":b.mode="view",b.UserId==c.UserInfo.UserId?b.sClass="left":b.sClass="right",d==b.UserId&&(b.operation="1"),this.model.set(b)},ui:{},events:{"click .add-signModule":"saveSignModule","click .cancel-signModule":"cancelSignModule","click .edit-signModule":"editSignModule","click .radio":"radioSelect"},saveSignModule:function(){if($(".str_renson").val().length<=500){var b=this.model.toJSON(),c=this,d=this.$el.find(".radio_checked").data("value"),e=this.$el.find("textarea").val(),f=0;d==b.page.SignModule.AgreeTwo.Name&&(f=b.page.SignModule.SendEmailFlag),a.app.request("Assessment:confirmSign",{assessmentId:b.page.Assessment.Id,result:d,opinion:encodeURIComponent(e),flag:f,UserId:b.page.UserInfo.UserId}).done(function(a){a.Result>0&&c.model.set({mode:"view",Reason:e,Result:d}),c.render()})}else $(".str_renson").addClass("errorColor")},cancelSignModule:function(){this.model.set("mode","view"),this.render()},editSignModule:function(){this.model.set("mode","edit"),this.render()},radioSelect:function(a){var b=$(a.currentTarget);if(b.hasClass("radio_checked"))return!1;this.$el.find(".radio_checked").removeClass("radio_checked").addClass("radio_uncheck"),b.removeClass("radio_uncheck").addClass("radio_checked")},onRender:function(){this.$el.find("textarea").autosize(),$(".btnWeightChange").removeClass("warn_class"),this.trigger("signChange",this.model.toJSON())},onShow:function(){},onClose:function(){}})}),define("views/assessment/signinfo-composite-view",["talent","templates/home","views/assessment/signinfo-item-view"],function(a,b,c){return a.CompositeView.extend({template:_.template(""),itemView:c,initialize:function(){var b=this.options;this.model=new a.Model(b);var c=[],d=_.langs("assessment","signinfo");$(b.SignModule.SignInfos).each(function(a,e){e.page=b,!b.Assessment.HasTask&&e.Result&&(e.mode="signing"),e.i18n=d,(b.Assessment.HasTask||e.Result)&&(null==e.Result?e.mode="edit":e.mode="view"),c.push(e)}),this.collection=new a.Collection(c)},onBeforeItemAdded:function(b){var c=this,d=this.model.toJSON(),e=this.collection.toJSON();this.listenTo(b,"signChange",function(b){$(e).each(function(a,c){b.WorkflowStepId==c.WorkflowStepId&&(e[a]=b)}),this.collection=new a.Collection(e),d.SignModule.SignInfos=e,c.trigger("signListChange",d.SignModule)})},onRender:function(){},onShow:function(){},onClose:function(){}})}),define("views/assessment/signconfirm-item-view",["talent","templates/assessment","views/assessment/signinfo-composite-view"],function(a,b,c){return a.ItemView.extend({template:b["assessment/signconfirm-item"],initialize:function(){},ui:{radio:".radio",reson:".reson",module_content:".module-content",str_renson:".str_renson"},events:function(){var a={};return a["click "+this.ui.radio]="selectRadio",a["keyup "+this.ui.str_renson]="reasonNum",a},selectRadio:function(a){"1"==$(a.currentTarget).attr("isok")?this.$(".reson").hide():this.$(".reson").show()},reasonNum:function(a){var b=($(a.currentTarget),$.trim($(".str_renson").val()).length);$(".str-len").html(b+"/500"),b>500?$(".str_renson").addClass("errorColor"):$(".str_renson").removeClass("errorColor")},onRender:function(){var a=this;this.signInfoList=new c(this.model.toJSON()),this.listenTo(this.signInfoList,"signListChange",function(b){a.trigger("SignModuleChange",b)}),this.ui.module_content.html(this.signInfoList.render().el)},onShow:function(){},onClose:function(){}})}),define("views/assessment/history-panel-item-view",["talent","templates/assessment"],function(a,b){return a.ItemView.extend({template:b["assessment/history-panel-item"],className:"hp-container"})}),define("views/assessment/history-panel-composite-view",["talent","templates/assessment","views/assessment/history-panel-item-view"],function(a,b,c){return a.CompositeView.extend({template:_.template('<div class="historyPanelShow"><div class="inner-tip"></div><div class="historyItemContainer"><ul class="historyList"></ul></div></div>'),itemView:c,itemViewContainer:"ul.historyList",initialize:function(a){}})}),define("views/assessment/overview-item-view",["talent","templates/assessment","$.tipsy","views/common/helpers/validator","views/assessment/history-panel-composite-view","$.autoresize"],function(a,b,c,d,e){return a.ItemView.extend({template:b["assessment/overview-item"],initialize:function(){this.$weightBtn=$(".btnWeightChange"),this.historyFlag=!0;var a=this,b=this.model.toJSON(),c=b.OverviewModule,d=c.GradeList||[];b.ShowGrade=d.length>0&&1==c.AssessmentClassNeed,b.ShowScore=c.AssessmentResultShow,null==c.MatchRange&&(b.ModifyAssessmentClass=1),b.OverviewModule.GradeList=_.sortScoreLevel2(b.OverviewModule.GradeList);var e=a._getTrueScore(c);if(c.MatchRange){var f=this.getMatchRangeByAssessmentClassName(e);f&&a._updateOverviewModule({AssessmentClass:f.ScoreValue,AssessmentClassName:f.ScoreName,AssessmentClassDescription:f.Description})}b.OverviewStatus=this.getCurrentState(b),cacheContainer.set("initComment",c.RateStatement),cacheContainer.set("initDevelopmentPlan",c.DevelopmentPlan),this.model.set(b),this._oldOverviewModule=_.extend({},JSON.parse(JSON.stringify(this.model.toJSON().OverviewModule))),this.submitData={UserId:b.UserInfo.UserId,assessmentId:b.Assessment.Id,changeScore:c.ChangeScore,assessmentClass:c.AssessmentClass,assessmentClassName:c.AssessmentClassName||("10000.00"==c.AssessmentClass?"无法评价":""),developmentPlan:c.DevelopmentPlan,comment:c.RateStatement,ForcedClassScore:""};var g=b.OverviewModule.FieldRight;cacheContainer.get("InIframe")?(5==b.Assessment.Status&&(b.OverviewModule.ModifyAssessmentClass=1),this.model.set({InIframe:!0,OverviewStatus:"view",textdisabled:!1,devPlanDisabled:!1,commentDisabled:!1,classDisabled:!1}),2!=b.Assessment.Status&&4!=b.Assessment.Status||this.model.set("textdisabled",!0)):(this.model.set("InIframe",!1),this.model.set("textdisabled",1!=g.ChangeScore),this.model.set("devPlanDisabled",1!=g.DevelopmentPlan),this.model.set("commentDisabled",1!=g.RateStatement),this.model.set("classDisabled",1!=g.AssessmentClassName))},_getTrueScore:function(a){return Number(a.ChangeScore||a.RateScore)},modelEvents:{"change:OverviewStatus":"render","change:forceRender":"_beforeRender","change:RateScore":"_beforeRender"},_isEmpty:function(a){return""==a||void 0==a||null==a},getCurrentState:function(a){var b=this,c=a.OverviewModule;if(c.IsHasStore)return"view";if(a.Assessment.HasTask){if(4==a.CurrentStepTypeId)return"view";var d=[],e=!0;return 1==a.CurrentStepTypeId||2==a.CurrentStepTypeId||5==a.CurrentStepTypeId?("1"==c.IsModifyScore&&(d.push(b._isEmpty(c.ChangeScore)),1==c.FieldRight.ChangeScore&&(e=!1)),a.ShowGrade&&(d.push(b._isEmpty(c.AssessmentClassName||"10000.00"==c.AssessmentClass&&"无法评价")),1==c.FieldRight.AssessmentClassName&&(e=!1)),c.DevelopmentPlanNeed&&c.DevelopmentPlanShow&&(d.push(b._isEmpty(c.DevelopmentPlan)),1==c.FieldRight.DevelopmentPlan&&(e=!1)),c.AllcommentNeed&&c.RateStatementShow&&(d.push(b._isEmpty(c.RateStatement)),1==c.FieldRight.RateStatement&&(e=!1)),e?"view":-1==_.indexOf(d,!0)?"view":"add"):"view"}return"view"},getMatchRangeByAssessmentClassName:function(a){var b,c=this,d=this.model.toJSON(),e=d.OverviewModule,f=e.MatchRange;e.Assessment;return b=1e4==Number(e.AssessmentClass)?{Id:"00000000-0000-0000-0000-000000000000",ScoreValue:"10000.00",ScoreName:"无法评价",Description:"我不知道，无法评价"}:_.extend({},_.findWhere(f,{ScoreName:e.AssessmentClassName})),b&&!$.isEmptyObject(b)||(b=c.getFocedItem(a)),b},getFocedItem:function(a){var b=this,c=this.model.toJSON(),d=c.OverviewModule.MatchRange;c.Assessment;return!!d&&(""==a?{Description:"",Id:"00000000-0000-0000-0000-000000000000",ScoreName:"",ScoreValue:""}:b._getTargetMatchItem(a,d))},_getTargetMatchItem:function(a,b){var c=b.length;return a>b[c-1].MaxValue?b[c-1]:a<=b[0].MinValue?b[0]:_.find(b,function(b){return a<=b.MaxValue&&a>b.MinValue})},_updateOverviewModule:function(a){var b=this.model.toJSON(),c=b.OverviewModule;return _.extend(c,a),this.model.set(b),c},getGradeItem:function(a){var b=this,c=this.model.toJSON(),d=c.OverviewModule,e=d.GradeList,f=c.Assessment;if(!a)return!1;var g=_.findWhere(e,{Name:a.ScoreName,OverviewStatus:void 0})||{};return d=b._updateOverviewModule({AssessmentClass:g.Value,AssessmentClassName:g.Name}),b.trigger("overviewChange",{Assessment:f,OverviewModule:d,OverviewStatus:c.OverviewStatus,OverviewShowgrade:c.OverviewShowgrade}),g},ui:{comment:".comment",grade_item:".grade-item",add_overflow:".add-overflow",cancel_overflow:".cancel-overflow",edit_overflow:".edit-overflow",hand_input:".hand-input",textarea:"textarea",scoreRangeTip:".overflow-range",finalScore:".finalScore",historyShow:".historyShow",module_title:".module-title",historyPanelShow:".historyPanelShow",historyContainer:".historyContainer"},events:function(){var a={};return a["click "+this.ui.grade_item]="changeGrade",a["click "+this.ui.add_overflow]="saveOverview",a["click "+this.ui.cancel_overflow]="cancelOverview",a["click "+this.ui.edit_overflow]="editOverview",a["keydown "+this.ui.hand_input]="changeScoreKeyDown",a["keyup "+this.ui.hand_input]="changeScoreKeyUp",a["focus "+this.ui.hand_input]="changeScoreInputFocus",a["blur "+this.ui.hand_input]="changeScoreInputBlur",a["keyup "+this.ui.textarea]="textKeyUp",a["change "+this.ui.textarea]="textChange",a["click "+this.ui.historyShow]="historyPanel",a},changeScoreInputBlur:function(a){this.ui.hand_input&&this.ui.hand_input instanceof jQuery&&!this.ui.hand_input.hasClass("error")&&this.ui.scoreRangeTip.hide()},historyPanel:function(b){var c=this,d=this.model.toJSON();b.stopPropagation(),a.app.request("Assessment:getAssessmentResultRecord",{assessmentId:d.Assessment.Id}).done(function(b){c.historyTemplate=new e({collection:new a.Collection(b.RecordsResult)}),c.historyFlag&&($(c.ui.historyContainer).append(c.historyTemplate.render().el),c.historyFlag=!1)}),$(document).on("click",function(){$(".historyPanelShow").hide(),c.historyFlag=!0})},changeScoreInputFocus:function(a){$(a.currentTarget).addClass("hasval"),this.ui.scoreRangeTip.show()},textKeyUp:function(a){var b=$(a.currentTarget),c=(b.attr("class"),$.trim(b.val()).length);b.next(".str-len").text(c+"/500"),c>500?b.addClass("input-error"):b.removeClass("input-error")},textChange:function(a){var b=$(a.currentTarget);b.hasClass("comment")?cacheContainer.set("comment",b.val()):cacheContainer.set("developPlan",b.val())},_beforeRender:function(){var a=this,b=this.model.toJSON(),c=cacheContainer.get("assessmentClassName");if(b.forceRender&&b.forceRender.force){var d;if(b.OverviewModule.MatchRange){d=a.getFocedItem(b.OverviewModule.ChangeScore||b.OverviewModule.RateScore),a.getGradeItem(d);var e=_.find(b.OverviewModule.GradeList,function(b,c){return parseFloat(b.Value)==parseFloat(a.model.get("OverviewModule").AssessmentClass)});e&&(a.model.set({assessmentClass:e.Value,assessmentClassName:e.Name,assessmentClassDescription:e.Description}),_.extend(a.submitData,{assessmentClass:e.Value,assessmentClassName:e.Name,assessmentClassDescription:e.Description}),b.OverviewModule.AssessmentClassName=e.Name,b.OverviewModule.AssessmentClass=e.Value,b.OverviewModule.AssessmentClassDescription=e.Description,a.model.set(b))}else c&&(b.OverviewModule.AssessmentClassName=c.assessmentClassName,b.OverviewModule.AssessmentClass=c.assessmentClass)}this.render(),this.triggerMethod("render")},render:function(){var a=this,b=this.model.toJSON();a.unbindUIElements(),this.$weightBtn.removeClass("warn_class");var c=b.OverviewModule;return c.ChangeScore||""!==c.ChangeScore||(c.FinalScore=c.RateScore||c.FinalScore),this.trigger("overviewChange",{Assessment:b.Assessment,DevelopmentPlan:b.OverviewModule.DevelopmentPlan,RateStatement:b.OverviewModule.RateStatement||"",OverviewStatus:b.OverviewStatus,OverviewShowgrade:b.ShowGrade}),b.OverviewModule.DevelopmentPlan=cacheContainer.get("developPlan")||_.encodescript2(b.OverviewModule.DevelopmentPlan),b.OverviewModule.RateStatement=cacheContainer.get("comment")||_.encodescript2(b.OverviewModule.RateStatement),this.$el.html(this.template(b)),a.bindUIElements(),this._oldOverviewModule=_.extend({},JSON.parse(JSON.stringify(b.OverviewModule))),this.$(".grade-item,.grade-item-active").tipsy({gravity:"s"}),setTimeout(function(){a.$("textarea").autosize()},0),this},changeScoreKeyDown:function(a){var b,c,d=$(a.currentTarget),e=$.trim(d.val()),f=a.keyCode||a.which,g=a.currentTarget.selectionEnd,h=a.currentTarget.selectionStart,i=g-h>0;return b=[8,190,37,39,46,110].some(function(a){return a==f}),!((f<48||f>58)&&(f<96||f>105)&&!b)&&(e.indexOf(".")>=g&&(c=!0),!(e&&""!==e&&!/^\d+(.\d{0,1})?$/.test(e)&&!b&&!c)||!!i)},_isErrorValue:function(a){return void 0===a||null===a||""===a},changeScoreKeyUp:function(b){var c=this,e=$(b.currentTarget),f=$.trim(e.val()),g=this.model.toJSON(),h=!!b.currentTarget,i=c.$(".calcScore").html();if(""==f){var j=c.$(".calcScore,.finalScore");g.OverviewModule.RateScore?j.html(i).parent().next().show():j.html(i).parent().next().hide()}else c.ui.finalScore.html(f).parent().next().show();c.overviewTimer&&clearTimeout(c.overviewTimer),a.$("body").find(".btn-commit").attr("disabled","disabled"),c.overviewTimer=setTimeout(function(){var b=g.OverviewModule;if(""!=f){var i=d.isCorrectScore(f,{max:9999,min:0}),j=d.isBetweenLimits(f,{max:b.UpperScore,min:b.LowerScore});if(!i||!j)return e.addClass("error"),!1}else h&&(b.ChangeScore="");e.removeClass("error");var k;if(f?(k=c.getFocedItem(f,!0),g.OverviewModule.ChangeScore=f):k=c.getFocedItem(b.RateScore),!g.OverviewModule.MatchRange)return!1;c.getGradeItem(k);var l=_.find(g.OverviewModule.GradeList,function(a,b){return parseFloat(a.Value)==parseFloat(c.model.get("OverviewModule").AssessmentClass)});if(c.$(".grade-item-active").removeClass("grade-item-active").addClass("grade-item"),c.submitData.assessmentClass="",c.submitData.assessmentClassName="",l){c.$(".grade-item-active").removeClass("grade-item-active").addClass("grade-item");var m=$('.grade-item[data-kid="'+l.Id+'"]');return c.submitData.assessmentClass=l.Value,c.submitData.assessmentClassName=l.Name,m.removeClass("grade-item").addClass("grade-item-active"),!1}a.$("body").find(".btn-commit").removeAttr("disabled")},300),setTimeout(function(){a.$("body").find(".btn-commit").removeAttr("disabled")},2e3)},_validatorText:function(a,b){var c=$.trim(b.val()),d=!1;return(a&&0==c.length||c.length>500)&&(d=!0),d?b.addClass("input-error"):b.removeClass("input-error"),d},saveOverview:function(){var b=this,c=this.$el,d=this.model.toJSON(),e=!1;if("1"==d.OverviewModule.IsModifyScore&&0==d.textdisabled){var f=this.$(".hand-input"),g=""==f.val()?"":Number(f.val());(!/^\d*(\.\d{0,2})?$/.test(g)||Number(g)>=1e4)&&(f.addClass("error"),e=!0);var h=d.OverviewModule.UpperScore,i=d.OverviewModule.LowerScore;if(g+""!=""){!b._isErrorValue(h)&&b._isErrorValue(i)?g>h-0&&(e=!0):b._isErrorValue(h)&&!b._isErrorValue(i)?g<i-0&&(e=!0):b._isErrorValue(h)||b._isErrorValue(i)||(g>h-0||g<i-0)&&(e=!0)}b.submitData.changeScore=g+""}if(e)return!1;var j=this.$(".grade-container");if(d.ShowGrade&&1==d.OverviewModule.ModifyAssessmentClass&&(0!=d.OverviewModule.FieldRight.AssessmentClassName||d.InIframe)&&(""==this.submitData.assessmentClassName||!j.find(".grade-item-active")[0]))return j.parent("li").addClass("input-error"),e=!0,!1;if(d.OverviewModule.AllcommentNeed&&d.OverviewModule.RateStatementShow&&0==d.commentDisabled){var k=this.$("textarea.comment");if(e=b._validatorText(d.OverviewModule.AllcommentWriteIn,k))return!1;b.submitData.comment=encodeURIComponent(c.find(".comment").val())}if(d.OverviewModule.DevelopmentPlanNeed&&d.OverviewModule.DevelopmentPlanShow&&0==d.devPlanDisabled){var l=this.$("textarea.developPlan");if(e=b._validatorText(d.OverviewModule.DevelopmentPlanWriteIn,l))return!1;b.submitData.developmentPlan=encodeURIComponent(c.find(".developPlan").val())}if(cacheContainer.set("initComment",c.find(".comment").val()),cacheContainer.set("initDevelopmentPlan",c.find(".developPlan").val()),e)return!1;this.submitData.moduleId=d.OverviewModule.ModuleId,this.submitData.fromType=cacheContainer.get("InIframe")?3:1,a.app.request("Assessment:saveOverview",b.submitData).done(function(a){a.Result>0&&(d.OverviewModule.DevelopmentPlan=decodeURIComponent(b.submitData.developmentPlan),d.OverviewModule.RateStatement=decodeURIComponent(b.submitData.comment),d.OverviewModule.ChangeScore=d.OverviewModule.FinalScore=b.submitData.changeScore,d.OverviewModule.AssessmentClass=b.submitData.assessmentClass,d.OverviewModule.AssessmentClassName=b.submitData.assessmentClassName,d.OverviewModule.IsHasStore=!0,d.OverviewStatus="view",b.model.set(d),b._oldOverviewModule=_.extend({},b.model.toJSON().OverviewModule),b.trigger("overviewChange",{Assessment:d.Assessment,OverviewModule:d.OverviewModule,DevelopmentPlan:d.DevelopmentPlan,RateStatement:d.RateStatement,OverviewStatus:d.OverviewStatus,SaveOverview:!0}))})},cancelOverview:function(){var a=cacheContainer.get("initComment"),b=cacheContainer.get("initDevelopmentPlan");cacheContainer.set("comment",a),cacheContainer.set("developPlan",b),this.model.set({OverviewModule:this._oldOverviewModule,OverviewStatus:"view"})},editOverview:function(){var a=this,b=this.model.toJSON();b.OverviewModule.IsHasStore=!1,b.OverviewStatus="edit",a.model.set(b),setTimeout(function(){a.$("textarea").autosize()},0)},changeGrade:function(a){var b=$(a.currentTarget),c=this.model.toJSON(),d=cacheContainer.get("InIframe");if(0==c.OverviewModule.FieldRight.AssessmentClassName&&!d)return!1;var e={assessmentClass:b.data("value"),assessmentClassName:b.data("name"),assessmentClassDescription:b.data("description")};if("0"==c.OverviewModule.ModifyAssessmentClass&&!d||0===c.AssessmentClassName)return!1;this.$(".grade-container").parent("li").removeClass("input-error"),b.prop("class","grade-item-active").siblings().prop("class","grade-item"),cacheContainer.set("assessmentClassName",e),_.extend(this.submitData,e),c.OverviewModule.OverviewGradeClick=!0,this.trigger("overviewChange",{Assessment:c.Assessment,OverviewModule:c.OverviewModule,OverviewStatus:c.OverviewStatus,OverviewShowgrade:c.OverviewShowgrade})}})}),function(a){var b=function(b){function c(){!F.find("#BS_scroll").length>0&&(G&&(G.style.position="relative",G.style.overflow="hidden"),b.setStyle?F.append(['<div style="display:none;top:0;position: absolute;" id="BS_scroll"  >','<em style="min-height: 15px;display:inline-block;" id="BS_scroll_main"></em>',"</div>"].join("")):F.append(['<div style="display:none;top:0;position: absolute;right: 1px;width: 11px;" id="BS_scroll"  >','<em style="height:0;background-image: url('+C+'/webim_scroll_bg.png);background-position: -9px 0;background-repeat: repeat-y;width: 11px;min-height: 5px;border-radius: 4px;display:inline-block;" id="BS_scroll_main"></em>',"</div>"].join(""))),s=F.find("#BS_scroll")[0],s.style.zIndex=1e3,t=F.find("#BS_scroll_main")[0],o(G),n(G),d()}function d(){if(z=G.scrollHeight,A=a(G).outerHeight(),u=A<z){var b=A/z,c=parseInt(A*b>E?A*b:E);t.style.height=c-7+"px",x=A-c,w=z-A;var d=G.scrollTop/w;d>1&&(d=1),d<0&&(d=0),m(d),f()}}function e(){s.style.display="none"}function f(){s.style.display=""}function g(a){I||(I=!0,a=a||widow.event,y=a.clientY,r(a))}function h(a){if(I){a=a||window.event;var b=a.clientY;v=(b-y)/x+H,v>1&&(v=1),v<0&&(v=0),m(v),r(a)}}function i(a){I&&(I=!1,H=v)}function j(b){var b=b||window.event;b.srcElement||b.target;B&&clearTimeout(B),!u||(B=setTimeout(function(){f(),p(document,"mousemove",h),a(document).on("selectstart.sortable",function(){return!1})},300))}function k(b){B&&clearTimeout(B),B=setTimeout(function(){e(),q(document,"mousemove",h),a(document).off("selectstart.sortable")},500)}function l(a){if(u){var b=D?a.detail:-a.wheelDelta/40;H=(G.scrollTop+16*b)/w,H>1&&(H=1,d()),H<0&&(H=0),m(H),r(a)}}function m(a){G.scrollTop=a*w,s.style.top=a*x+G.scrollTop+"px",v=a}function n(){p(G,D?"DOMMouseScroll":"mousewheel",l),p(t,"mousedown",g),p(document,"mouseup",i),p(G,"mouseover",j),p(G,"mouseout",k)}function o(){q(G,D?"DOMMouseScroll":"mousewheel",l),q(t,"mousedown",g),q(document,"mouseup",i),q(G,"mouseover",j),q(G,"mouseout",k)}function p(a,b,c){return window.addEventListener?a.addEventListener(b,c,!1):window.attachEvent?a.attachEvent("on"+b,c):{}}function q(a,b,c){return window.addEventListener?a.removeEventListener(b,c,!1):window.detachEvent?a.detachEvent("on"+b,c):{}}function r(a){a.preventDefault?a.preventDefault():a.returnValue=!1}var s,t,u,v,w,x,y,z,A,B,C=b.imgUrl||"",D=(b.setStyle,navigator.userAgent.toLowerCase().match(/firefox\/([\d.]+)/)),E=(!window.XMLHttpRequest&&window.ActiveXObject,20),F=this,G=this[0],H=0,I=!1;c()};a.fn.extend({scrollable:b})}(jQuery),define("$.scrollable",function(){}),define("views/common/person-range/person-range-view",["talent","templates/common","$.scrollable"],function(a,b,c){return a.ItemView.extend({template:b["common/person-range/person-range-item"],initialize:function(){var b,c=this.options;this.i18n=_.langs("common","personList"),_.each(c.MyUndoneTasking,function(b,d){b.OwnerId==a.Context.getUserInfo().UserId&&1!=c.CurrentStepTypeId||(6==c.CurrentStepTypeId?c.appraiserId&&(b.AppraiserId.toLowerCase()==c.appraiserId.toLowerCase()?b.classstr="current":b.classstr=""):b.AssessmentId.toLowerCase()==c.assessmentId.toLowerCase()?b.classstr="current":b.classstr="")}),b=6==c.CurrentStepTypeId?_.langs("home","allStep","6"):1==c.CurrentStepTypeId?this.i18n.plan:this.i18n.noRate,c.i18n=this.i18n,c.titleContext=b,c.mode="narrow",this.model.set(c)},ui:{},events:{"click .person-range-arrow,.range-arrow-hide,.range-arrow-show":"changeViewMode"},changeViewMode:function(){var a=this;"narrow"==this.model.get("mode")?this.model.set("mode","wide"):this.model.set("mode","narrow"),"narrow"==this.model.get("mode")?this.$el.parent().width(70):this.$el.parent().width(287),a.render()},onRender:function(){var a=this,b=2==this.model.get("Assessment").CurrentStepTypeId?350:130;this.$el.find(".datanot-container,ul.data-container").height(window.innerHeight-b),setTimeout(function(){var b=a.$(".current");0!=b.length&&(b.hasClass("totask-person")?a.$(".datanot-container").scrollTop(b.position().top-230):a.$(".data-container").scrollTop(b.position().top-130))},0)},onShow:function(){},onClose:function(){}})}),define("views/common/modules/person-range-view",["talent","templates/common","views/common/person-range/person-range-view"],function(a,b,c){return a.ItemView.extend({template:b["common/modules/person-range-item"],initialize:function(a){var a=this.options;this.model.set(a)},ui:{},events:{},onRender:function(){this.personRangeView=new c(this.model.toJSON()),this.$(".person-range-right").html(this.personRangeView.render().el)},onClose:function(){}})}),define("views/assessment/assessment-count-info-item-view",["talent","templates/assessment"],function(a,b){return a.ItemView.extend({template:b["assessment/assessment-count-info-item"],initialize:function(b){this.model=new a.Model(b)}})}),function(){function a(){this.pageCache={}}var b=a.prototype;b.set=function(a){"object"!=typeof a?this.pageCache[arguments[0]]=arguments[1]:this.pageCache=this._extendObj(this.pageCache,a)},b.get=function(a){return this.pageCache[a]},b.destory=function(){},b._extendObj=function(){var a=arguments;if(!(a.length<2)){for(var b=this._cloneObj(a[0]),c=1;c<a.length;c++)for(var d in a[c])b[d]=a[c][d];return b}},b._cloneObj=function(a){if("object"!=typeof a)return a;if(null==a)return a;var b=new Object;for(var c in a)b[c]=this._cloneObj(a[c]);return b},define("cachecontainer",[],function(){return a})}(),define("views/common/dialog/loading-item-view",["talent","templates/common"],function(a,b){return a.ItemView.extend({template:b["common/dialog/loading-item"],template2:b["common/dialog/loading-item-old"],initialize:function(){this.mode=$.support.leadingWhitespace,window.navigator.userAgent.indexOf("MSIE")>0&&navigator.userAgent.indexOf("MSIE 9.0")>0&&(this.isIE9=!0)},render:function(){return this.mode&&!this.isIE9?this.$el.html(this.template()):this.$el.html(this.template2()),this},onRender:function(){},onShow:function(){},onClose:function(){}})}),define("views/assessment/mixins/feed-mixin",["talent"],function(a){return{closeFeedBack:function(){this.$(".ps-details-container").hide("slide",{width:470,direction:"right"},500),a.$(".content_tita_widget iframe").attr("src",null)},btnFeedBack:function(){var b=this,c=b.model.toJSON();$(window).height();b._operationClassForWeightBtn(),a.app.request("Assessment:getAssessmentFeedId",{assessmentId:c.Assessment.Id,UserId:c.OwnerInfo.UserId}).done(function(b){0!=b.Code&&(a.$(".outcontent_tita_widget h2").text(c.Assessment.Name),_.createFeedIframe(b.Data,a.$(".content_tita_widget iframe"),a.$(".ps-details-container"),a.$(".content_tita_widget"),$(window).height()))})}}}),define("views/common/dialog/back-dialog-view",["talent","templates/common","simplemodal"],function(a,b,c){return a.ItemView.extend({template:b["common/dialog/dialog-back"],events:{"click .btn-sure":"saveBtnFn","click .btn-cancel,.btn-close":"closeBtnFn","dblclick .btn-sure":"dblSureFn","focus .dialog-text":"reasonFoucs","blur .dialog-text":"reasonBlur"},reasonBlur:function(a){var b=$(a.currentTarget);$.trim(b.val())||(b.val(this.i18n.writeReason),b.removeClass("hasval"))},reasonFoucs:function(a){$(a.currentTarget).addClass("hasval")},saveBtnFn:function(){var a=this.$el.find("textarea").val();this.trigger("dialogClose",{result:1,reason:a}),this.trigger("smalledialogClose"),this.$el.remove()},dblSureFn:function(){return!1},closeBtnFn:function(a){$(a.currentTarget).hasClass("btn-cancel")&&this.trigger("dialogClose",{result:0}),this.trigger("smalledialogClose"),this.$el.remove()},initialize:function(){this.DialogView=new c({zIndex:1100,position:[100,100]}),this.i18n=_.langs("assessment"),this.$el=this.DialogView.$el},render:function(){var a=this.model.toJSON();this.DialogView.render(this.template(a)).appendTo($("body"));var b=this.$el.find("textarea");return b.val(b.data("placeholder")),b.focus(function(){$(this).val()==$(this).data("placeholder")&&$(this).val("")}),b.blur(function(){""==$(this).val()&&$(this).val($(this).data("placeholder"))}),this},onRender:function(){}})}),function(a){"use strict";a.fn.pin=function(b){var c=0,d=[],e=!1,f=a(window);b=b||{};var g=function(){for(var c=0,g=d.length;c<g;c++){var h=d[c];if(b.minWidth&&f.width()<=b.minWidth)h.parent().is(".pin-wrapper")&&h.unwrap(),h.css({width:"",left:"",top:"",position:""}),b.activeClass&&h.removeClass(b.activeClass),e=!0;else{e=!1;var i=b.containerSelector?h.closest(b.containerSelector):a(document.body),j=h.offset(),k=i.offset(),l=h.offsetParent().offset();h.parent().is(".pin-wrapper")||h.wrap("<div class='pin-wrapper'>");var m=a.extend({top:0,bottom:0},b.padding||{});h.data("pin",{pad:m,from:(b.containerSelector?k.top:j.top)-m.top,to:k.top+i.height()-h.outerHeight()-m.bottom,end:k.top+i.height(),parentTop:l.top}),h.css({width:a(".user-info").width()}),h.parent().css("height","80px")}}},h=function(){if(!e&&!b.InIframe){c=f.scrollTop();for(var g=[],h=0,i=d.length;h<i;h++){var j=a(d[h]),k=j.data("pin");if(k){g.push(j);var l=k.from-k.pad.bottom,m=k.to-k.pad.top;l+j.outerHeight()>k.end?j.css("position",""):l<c?(!("fixed"==j.css("position"))&&j.css({left:j.offset().left,top:Talent.inItalent?"0px":"41px","z-index":"993"}).css("position","fixed"),b.activeClass&&j.addClass(b.activeClass)):c>=m?(j.css({left:"",top:m-k.parentTop+k.pad.top}).css("position","absolute"),b.activeClass&&j.addClass(b.activeClass)):(j.css({position:"",top:"",left:""}),b.activeClass&&j.removeClass(b.activeClass))}}d=g}},i=function(){g(),h()};return this.each(function(){var b=a(this),c=a(this).data("pin")||{};c&&c.update||(d.push(b),a("img",this).one("load",g),c.update=i,a(this).data("pin",c))}),f.scroll(h),f.resize(function(){g()}),g(),f.load(i),this}}(jQuery),define("$.pin",function(){}),function(a){"use strict";"function"==typeof define&&define.amd?define("$.scrollTo",["jquery"],a):"undefined"!=typeof module&&module.exports?module.exports=a(require("jquery")):a(jQuery)}(function(a){"use strict";function b(b){return!b.nodeName||-1!==a.inArray(b.nodeName.toLowerCase(),["iframe","#document","html","body"])}function c(b){return a.isFunction(b)||a.isPlainObject(b)?b:{top:b,left:b}}var d=a.scrollTo=function(b,c,d){return a(window).scrollTo(b,c,d)};return d.defaults={axis:"xy",duration:0,limit:!0},a.fn.scrollTo=function(e,f,g){"object"==typeof f&&(g=f,f=0),"function"==typeof g&&(g={onAfter:g}),"max"===e&&(e=9e9),g=a.extend({},d.defaults,g),f=f||g.duration;var h=g.queue&&g.axis.length>1;return h&&(f/=2),g.offset=c(g.offset),g.over=c(g.over),this.each(function(){function i(b){var c=a.extend({},g,{queue:!0,duration:f,complete:b&&function(){b.call(l,n,g)}});m.animate(o,c)}if(null!==e){var j,k=b(this),l=k?this.contentWindow||window:this,m=a(l),n=e,o={};switch(typeof n){case"number":case"string":if(/^([+-]=?)?\d+(\.\d+)?(px|%)?$/.test(n)){n=c(n);break}n=k?a(n):a(n,l);case"object":if(0===n.length)return;(n.is||n.style)&&(j=(n=a(n)).offset())}var p=a.isFunction(g.offset)&&g.offset(l,n)||g.offset;a.each(g.axis.split(""),function(a,b){var c="x"===b?"Left":"Top",e=c.toLowerCase(),f="scroll"+c,q=m[f](),r=d.max(l,b);if(j)o[f]=j[e]+(k?0:q-m.offset()[e]),g.margin&&(o[f]-=parseInt(n.css("margin"+c),10)||0,o[f]-=parseInt(n.css("border"+c+"Width"),10)||0),o[f]+=p[e]||0,g.over[e]&&(o[f]+=n["x"===b?"width":"height"]()*g.over[e]);else{var s=n[e];o[f]=s.slice&&"%"===s.slice(-1)?parseFloat(s)/100*r:s}g.limit&&/^\d+$/.test(o[f])&&(o[f]=o[f]<=0?0:Math.min(o[f],r)),!a&&g.axis.length>1&&(q===o[f]?o={}:h&&(i(g.onAfterFirst),o={}))}),i(g.onAfter)}})},d.max=function(c,d){var e="x"===d?"Width":"Height",f="scroll"+e;if(!b(c))return c[f]-a(c)[e.toLowerCase()]();var g="client"+e,h=c.ownerDocument||c.document,i=h.documentElement,j=h.body;return Math.max(i[f],j[f])-Math.min(i[g],j[g])},a.Tween.propHooks.scrollLeft=a.Tween.propHooks.scrollTop={get:function(b){return a(b.elem)[b.prop]()},set:function(b){var c=this.get(b);if(b.options.interrupt&&b._last&&b._last!==c)return a(b.elem).stop();var d=Math.round(b.now);c!==d&&(a(b.elem)[b.prop](d),b._last=this.get(b))}},d}),define("views/assessment/index-page-view",["talent","templates/assessment","views/common/viewHelper","$.tipsy","jquery.ui.effect","views/assessment/user-item-view","views/assessment/linkcaret-item-view","views/common/modules/workflow-item-view","views/assessment/assessment-operate-view","views/assessment/module-composite-view","views/assessment/signconfirm-item-view","views/assessment/overview-item-view","views/common/modules/person-range-view","views/common/dialog/dialog-index-view","views/assessment/assessment-count-info-item-view","pullScreenWidget","cachecontainer","views/common/dialog/loading-item-view","views/assessment/mixins/feed-mixin","views/common/event-name","views/common/dialog/back-dialog-view","views/assessment/helpers/authority","views/assessment/target-custom-item-view","$.pin","$.scrollTo"],function(a,b,c,d,e,f,g,h,i,j,k,l,m,n,o,p,q,r,s,t,u,v,w){var x=a.Layout.extend({template:b["assessment/index-page"],assessment_operation_tpl:b["assessment/assessment-operation-item"],assessment_warn_tpl:b["assessment/assessment-operation-warn"],assessment_link_tpl:b["assessment/assessment-link-item"],initialize:function(b){var d=this,e=(d.model.toJSON(),a.Context.getUserInfo().UserId);window.cacheContainer=new q,d._i18n=_.langs("assessment"),_.preventDelEvent();var f=decodeURIComponent(location.hash).indexOf("fromType");f>-1?3==decodeURIComponent(location.hash).slice(f+9,f+10)?(cacheContainer.set("InIframe",!0),d.model.set("InIframe",!0)):(d.model.set("InIframe",!1),c.paceStart()):(c.paceStart(),d.model.set("InIframe",!1)),this.hasRenderOV=0,a.app.request("history:getQueryObject").done(function(a){d.taskId=a.pullScreeId,d.fromDone=a.fromDone}),window.onhashchange=function(){a.app.request("history:getQueryObject").done(function(a){a.pullScreeId&&(d.taskId=a.pullScreeId,d.targetId=d.$("#"+d.taskId).parents(".target-item").find(".target-title").attr("data-id"))})};var g=_.extend({},this.options.queryObject,{loginUserId:e,i18n:d._i18n});d.model.set(g),d.moduleModel=new a.Model({loginUserId:e}),d.userInfoModel=new a.Model,d.workflowModel=new a.Model,d.signConfirmModel=new a.Model,a.app.vent.on("hideTarget",function(){$(".target-item .content-hide").length===$(".target-item").length&&(d.$(".btnOpenAll").text(d._i18n.operationToolbar.btnOpenAll),d.isAll=!1)}),a.app.vent.on("targetOpen",function(){$(".btnOpenAll").text(d._i18n.operationToolbar.btnCloseAll),$(".target-item").length===$(".target-item[isdone=true]").length&&(d.isAll=!0)}),a.Context.setPageTitle(d._i18n.pageTitle)},className:"assessment-page-container",regions:{UserRegion:".user-info",WorkFlowRegion:".work-flowlist",ModuleRegion:".module-list",asscountRegion:".assessment-count-region"},ui:{detailsPopup:".ps-details-container",moduleListArea:".module-list",icon:".icon",back_home:".back-home",close_communicate:".close_communicate",btn_commit:".btn-commit",btn_reback:".btn-reback",work_flow_region:"div.work-flowlist",userInfo_region:".user-info",top_region:".topView",assessment_operate:"div.assessment-operate",assessment_warn:"div.assessment-operation-warn",largeWeightModule:".largeWeightModule-region",right_container_region:"div.right-container-region",epmtothird_module:".epmtothird-module",assessment_operation:".assessment-operation",assessment_commit_region:".assessment-operation-commit-region",assessment_link_region:".assessment-link-region",ps_details_container:".ps-details-container"},events:function(){var a={};return a["click "+this.ui.back_home]="backHome",a["click "+this.ui.icon]="open",a["click "+this.ui.close_communicate]="closeFeedBack",a["click "+this.ui.btn_reback]="backAssessment",a["click "+this.ui.btn_commit]="commitAssessment",a},backHome:function(){var a=this.model.toJSON(),b=BSGlobal.tenantInfo.Id,c="Url/Routing?ver=1&msgType=52&data="+a.Assessment.ActivityManagerId+"_"+a.Assessment.CurrentStepTypeId+"&user="+b+"_"+a.loginUserId;top.location.href=c},btnOpenAll2:function(b,c){var b=this;b._operationClassForWeightBtn(),b.watchAll?(b.refreshModuleList("all"),b.isAll=!0,c.removeClass("btn-disabled")):a.app.request("Assessment:getModuleList",{assessmentId:b.model.get("assessmentId"),UserId:b.model.get("userId")}).done(function(a){var d=b.model.get("ModuleList");_.each(d,function(b){var c=b.GoalList;_.each(c,function(b,c){var d=_.find(a.Data,function(a){return a.Id==b.Id})||{};_.extend(b,d)})}),b.moduleModel.set("ModuleList",d),b.model.set("ModuleList",d),b.watchAll=!0,b.refreshModuleList("all"),b.isAll=!0,c.removeClass("btn-disabled")})},btnOpenAll:function(b){var c=this,d=$(b.currentTarget),e="";c._operationClassForWeightBtn(),d.hasClass("btn-disabled")||(d.addClass("btn-disabled"),d.text()===c._i18n.operationToolbar.btnOpenAll?(e=c._i18n.operationToolbar.btnCloseAll,c.$(".target-item").attr("watched",!1),c.watchAll?(c.refreshModuleList("all"),c.isAll=!0,d.removeClass("btn-disabled")):a.app.request("Assessment:getModuleList",{assessmentId:c.model.get("assessmentId"),UserId:c.model.get("userId")}).done(function(a){var b=c.model.get("ModuleList");_.each(b,function(b){var c=b.GoalList;_.each(c,function(b,c){var d=_.find(a.Data,function(a){return a.Id==b.Id})||{};_.extend(b,d)})}),c.moduleModel.set("ModuleList",b),c.model.set("ModuleList",b),c.watchAll=!0,c.refreshModuleList("all"),c.isAll=!0,d.removeClass("btn-disabled")})):(c.$(".target-item").attr("watched",!0),e=c._i18n.operationToolbar.btnOpenAll,c.openAll=!1,c.isAll=!1,this.refreshModuleList("simple"),d.removeClass("btn-disabled")),d.text(e))},backAssessment:function(){var b=this,c=this.model.toJSON();b._operationClassForWeightBtn(),this.backDialogView=new u,this.backDialogView.render(),this.listenTo(this.backDialogView,"dialogClose",function(d){d.result&&a.app.request("Activity:restartTask",{assessmentIfnos:c.Assessment.Id+","+c.OwnerInfo.UserId,dismissedReason:d.reason}).done(function(a){6==c.WorkflowStepList[c.CurrentStepIndex-2].StepType?b._backHomePage():a>0?c.showNext?location.href=c.nextLink:c.showPrev?location.href=c.topLink:b.backHome():($(".btn-commit").show(),b.watchAll=!1,b.render())})})},commitAssessment:function(){var b=this,c=b.model.toJSON(),d=c.ModuleList,e=BSGlobal.EpmData.IsTargetValueRequired,f=BSGlobal.EpmData.IsCompleteValueRequired;if(b._operationClassForWeightBtn(),!b.CheckScore())return!1;var g=!0;return $.each(d,function(a,c){var d=c.GoalList,h=c.CurrentStepTypeId,i=c.FieldRight.ObjectiveType,j=c.FieldRight.CompleteValue;$.each(d,function(a,c){if("1"==c.TypeId){var d=c.ChallengeValue,k=c.ItemValue,l=c.MinimumValue,m=c.CompleteValue,n=c.CompleteValueSource;if(e&&1==i){if("1"==d.IsAdopt&&!d.Value)return g=!1,b.showInfoDialog(b._i18n.warnNoGoalValTip),!1;if("1"==k.IsAdopt&&!k.Value)return g=!1,b.showInfoDialog(b._i18n.warnNoGoalValTip),!1;if("1"==l.IsAdopt&&!l.Value)return g=!1,b.showInfoDialog(b._i18n.warnNoGoalValTip),!1}if(g&&f&&1==j&&1!=h&&6!=h&&!m&&1==n)return g=!1,b.showInfoDialog(b._i18n.warnNoComplateValTip),!1}})}),g?!!b.CheckAddAndSubLimit()&&(!!b.CheckOverView()&&void a.app.request("Assessment:checkModulesWeight",{UserId:c.OwnerInfo.UserId,assessmentId:c.Assessment.Id}).done(function(a){var d="";if(a.Result)b.checkAssessment();else if(a.Message.IsHasSameGoal?b.showInfoDialog(b._i18n.warnGoalRepeat(a.Message.SameGoalMsg)):a.Message.IsWeightError?Number(a.Message.WeightRightMsg)>0?d=b._i18n.warnWeightLt100:Number(a.Message.WeightRightMsg)<0&&(d=b._i18n.warnWeightGt100):a.Message.IsScoreRangeError&&b.showInfoDialog(b._i18n.warnLineOutOfRange(a.Message.ScoreRangeRightMsg)),""!=d){var e={contentStr:d,icon:"asking",showClose:!1,height:110,width:300,inHeight:64,yesText:b._i18n.editWeight,Id:c.Assessment.Id,fromType:"assessment"};b.showConfirmDialog("info",d+"\n"+b._i18n.sureCommit,function(a){if(!a||0==a.result)return!1;_.scrollTopAnimate(),b._operationClassForWeightBtn(!0)},e)}})):void 0},_operationClassForWeightBtn:function(a){var b="warn_class",c=$(".btnWeightChange");a?c.addClass(b):c.removeClass(b)},checkAssessment:function(){for(var a=this.model.get("ModuleList"),b=this.model.get("ScoreMethod"),c=this,d=[],e=0;e<a.length;e++){var f=a[e];if(4!=f.ModuleType){if(0!=f.RelType)continue;if(1==f.WeightType){var g=0,h=BSGlobal.tenantInfo.Id;$(f.GoalList).each(function(a,b){g+=Number(b.Weight)}),g=Math.floor(100*g.toFixed(2))/100,f.Name.indexOf("OKR目标评分")>-1&&"110006"==h||"关键举措"==f.Name&&("100013"==h||"107239"==h)&&1==b||(1==b?g>100?d.push(f.Name+c._i18n.warnModuleWeightGt100):g<100&&d.push(f.Name+c._i18n.warnModuleWeightLt100):2==b&&(g>f.NumWeight?d.push(f.Name+c._i18n.warnModuleWeightGt(f.NumWeight)+"."):g<f.NumWeight&&d.push(f.Name+c._i18n.warnModuleWeightLt(f.NumWeight)+".")))}}}if(d.length>0){d=d.join("<br/>")+"<br/>";var i={contentStr:d,icon:"asking",showClose:!1,height:166,width:320,inHeight:120,yesText:c._i18n.editWeight,noText:_.langs("common","cancel")};c.showConfirmDialog("asking",d,function(a){if(!a.result)return!1;_.scrollTopAnimate(),c._operationClassForWeightBtn(!0)},i)}else{if(!c.CheckBatchScoreOrWeight())return!1;if(!c.CheckSignModule())return!1;c.commitCount=0,c.showConfirmDialog("asking",c._i18n.sureCommitAssessment,c.saveCommitResult)}},CheckScore:function(){var a=this.model.get("ModuleList"),b=this.model.toJSON(),c=this,d=0;return 2==b.CurrentStepTypeId&&($(a).each(function(a,c){4!=c.ModuleType&&5!=c.ModuleType&&0==c.RelType&&(1!=c.FieldRight.RateScore&&1!=c.FieldRight.RateStatement||$(c.GoalList).each(function(a,e){if(1!=e.TypeId||1==e.TypeId&&1==e.ScoringMethod){var f=e.RateScoreList,g=_.find(f,function(a){return a.WorkflowStepId==b.Assessment.CurrentStepId})||{};(b.Assessment.HasTask&&1==c.FieldRight.RateScore&&!g.Score||1==c.FieldRight.IsCommentRequired&&!g.Comment)&&d++}}))}),d>0||this.$(".module-operate").length>0||this.$(".ratescore-edit").length>0)?(c.$("#batch_bs_sure")[0]?c.showInfoDialog(c._i18n.warnSaveWeight):c.showInfoDialog(c._i18n.warnSaveRateScore),!1):!(this.$(".custom-edit").length>0)||(c.showInfoDialog(c._i18n.warnSaveData),!1)},CheckAddAndSubLimit:function(){var a=this,b=!0,c=this.model.toJSON();return $.each(c.ModuleList,function(c,d){if("1"==d.AddAndSubScoreError)return a.showInfoDialog(a._i18n.warnAddAndSubLimit(d.Name),100),b=!1,!1}),b},CheckBatchScoreOrWeight:function(){var a=this,b=!0;return this.$el.find(".module-list .js-module-info").length>0&&(b=!1),b||a.showInfoDialog(a._i18n.warnSaveData),b},CheckOverView:function(){var a=this.model.toJSON(),b=!0;return null==a.OverviewModule||(a.OverviewModule&&"view"!=a.OverviewStatus&&void 0!=a.OverviewStatus&&(this.showInfoDialog(this._i18n.warnOverModuleNotSave),b=!1),b)},CheckSignModule:function(){var a=this.model.toJSON(),b=!0;if(a.SignModule&&4==a.CurrentStepTypeId){var c=a.SignModule,d=this,b=!0;c&&c.SignInfos.length&&$(c.SignInfos).each(function(c,d){d.WorkflowStepId==a.Assessment.CurrentStepId&&"view"!=d.mode&&(b=!1)}),b||d.showInfoDialog(d._i18n.warnSignNotSave)}return b},commitCount:0,saveCommitResult:function(b){var c=this,d=c.model.toJSON();b.result?($(".btn-commit").hide(),c.commitTimer&&clearTimeout(c.commitTimer),c.commitTimer=setTimeout(function(){var b={assessmentIds:d.Assessment.Id};if(4==d.Assessment.CurrentStepTypeId){var e=0,f="",g="",h=d.SignModule;if(h){var i=h.SignInfos;if(i){var j=i[i.length-1]||{};f=j.Reason,g=j.Result,g==h.AgreeTwo.Name&&(e=h.SendEmailFlag)}}_.extend(b,{result:g,opinion:f,flag:e,UserId:d.OwnerInfo.UserId})}a.app.request("Activity:submitWorkFlow",b).done(function(a){a.SuccessCount>0?d.showNext?location.href=d.nextLink:d.showPrev?location.href=d.topLink:c.backHome():($(".btn-commit").show(),c.watchAll=!1,c.render())})},200)):(c.watchAll=!1,$(".btn-commit").show())},showInfoDialog:function(a,b){var c={contentStr:a,icon:"info",showClose:!0,height:b||"70",width:278,inHeight:"70",timeColse:3e3,showFoot:!1};this.infoDialog=new n(c),this.infoDialog.render()},showConfirmDialog:function(a,b,c,d){var e={contentStr:b,icon:a,showClose:!1,height:110,width:300,inHeight:64};d&&(e=d),this.confirmDialog&&this.confirmDialog.close(),this.confirmDialog=new n(e),this.listenTo(this.confirmDialog,"dialogClose",c),this.confirmDialog.render()},WeightChange:function(){this.watchAll=!1,$(".btnOpenAll").text(this._i18n.operationToolbar.btnOpenAll),this.refreshModuleList("weightChange"),setTimeout(function(){$.scrollTo(this.$(".module-list"),300,{margin:!0,offset:-70})},0)},ScoreQuick:function(){if($(".btnOpenAll").hasClass("btn-disabled"))return!1;this.watchAll=!1,$(".btnOpenAll").text(this._i18n.operationToolbar.btnOpenAll),this.refreshModuleList("quickScore"),setTimeout(function(){$.scrollTo(this.$(".module-list"),300,{margin:!0,offset:-70})},0)},addSubGoal:function(b){var c=this,d=c.model.toJSON(),e=c.moduleModel.get("mode");c._operationClassForWeightBtn();var f={};f["item.Name"]=b.goalName,f["item.Description"]=b.description,f["item.Score"]=b.score,f["item.ModuleType"]=5,f["item.AssessmentModuleId"]=b.moduleId,f["item.AssessmentId"]=d.Assessment.Id,f["item.Id"]=b.Id,a.app.request("Target:updateItem",f).done(function(a){if(Number(a.Result)>=0&&(e="quickScore"==e?"simple":e,e="weightChange"==e?"simple":e,c.moduleModel.set("mode",e),c.refreshModule(),c.watchAll=!1,c.$(".btnOpenAll").text(c._i18n.operationToolbar.btnOpenAll),a.WorkflowStepScoreList&&a.WorkflowStepScoreList.length>0&&(_.each(d.WorkflowStepScoreList,function(b,d){var e=_.find(a.WorkflowStepScoreList,function(a){return b.WorkFlowStepId==a.WorkFlowStepId});e&&b.Score!=e.Score&&c.renderRightView(),e&&(b.Score=e.Score)}),d.WorkflowStepScoreList.sort(function(a,b){return a.OrderIndex-b.OrderIndex>0}),c.model.set("WorkflowStepScoreList",d.WorkflowStepScoreList),c.refreshAssessmentCountInfo(d.WorkflowStepScoreList)),void 0!=a.TotalScore&&d.OverviewModule&&a.TotalScore!=Number(d.OverviewModule.RateScore))){var b=c.overModel.get("OverviewModule");b.RateScore=String(a.TotalScore),b.RuleSetting=d.RuleSetting,b.ModifyAssessmentClass=d.ModifyAssessmentClass,c.model.set("OverviewModule",b),b.forceRender={force:!0,uid:_.uniqueId("tms_performance")},c.overModel.set(b)}c.allPersonLen>0&&c.renderRightView()})},addDetailItem:function(){var a=this,b=a.model.toJSON(),c=(this.model.get("ModuleList"),b.Assessment);a._operationClassForWeightBtn();var d=[];$(b.ModuleList).each(function(a,b){1==b.FieldRight.Property&&4!=b.ModuleType&&5!=b.ModuleType&&7!=b.ModuleType&&(0!=b.RelType||6!=b.ModuleType&&d.push({Id:b.Id,Name:b.Name,ModuleType:b.ModuleType,FieldRight:b.FieldRight,WeightType:b.WeightType}))});var e={height:"512",width:"600",inHeight:"430",title:this._i18n.operationToolbar.btnNewAdd,timeColse:null,endDate:c.EndDate,startDate:c.StartDate,ModuleList:d,UserId:b.OwnerInfo.UserId,AssessmentId:b.Assessment.Id,description:"",moduleId:d[0]&&d[0].Id,weight:"",operate:"add",typeId:0,CustomFields:b.CustomFileds,ModuleType:c.ModuleType,Id:c.Id},f=_.getPopUrl("goalOperation","addGoal"+c.Id);window.iTalentSDK.showPopup(f,601,515,e)},addGoal:function(b){var c=this,d=c.model.toJSON(),e=c.moduleModel.get("mode");c._operationClassForWeightBtn();var f={UserId:d.OwnerInfo.UserId};f["item.Name"]=b.name,f["item.Description"]=b.description,f["item.Weight"]=b.weight,f["item.BeginTime"]=b.startDate,f["item.EndTime"]=b.endDate,f["item.AssessmentModuleId"]=b.moduleId,f["item.AssessmentId"]=d.Assessment.Id,_.each(b.goalCustomDatas,function(a,b){f["item.CustomField["+b+"].IsRequire"]=a.IsRequire,f["item.CustomField["+b+"].MaxLength"]=a.MaxLength,f["item.CustomField["+b+"].Code"]=a.Code,f["item.CustomField["+b+"].Name"]=a.Name,f["item.CustomField["+b+"].Id"]=a.Id,f["item.CustomField["+b+"].Type"]=a.Type,f["item.CustomField["+b+"].Description"]=a.Description});var g=_.findWhere(d.ModuleList,{Id:b.moduleId});f["item.ModuleType"]=g.ModuleType,a.app.request("Target:updateItem",f).done(function(a){Number(a.Result)>0&&(e="quickScore"==e?"simple":e,e="weightChange"==e?"simple":e,c.moduleModel.set("mode",e),c.refreshModule(),c.watchAll=!1,c.$(".btnOpenAll").text(c._i18n.operationToolbar.btnOpenAll),a.WorkflowStepScoreList&&a.WorkflowStepScoreList.length>0&&(_.each(d.WorkflowStepScoreList,function(b,d){var e=_.find(a.WorkflowStepScoreList,function(a){return b.WorkFlowStepId==a.WorkFlowStepId});e&&b.Score!=e.Score&&c.renderRightView(),e&&(b.Score=e.Score)}),d.WorkflowStepScoreList.sort(function(a,b){return a.OrderIndex-b.OrderIndex>0}),c.model.set("WorkflowStepScoreList",d.WorkflowStepScoreList),c.refreshAssessmentCountInfo(d.WorkflowStepScoreList)))})},btnBindObject:function(){var a=this,b=a.model.toJSON(),c=b.ModuleList,d=b.Assessment;a._operationClassForWeightBtn();var e=_.map(c,function(a){return{Name:a.Name,Id:a.Id,FieldRight:a.FieldRight,ModuleType:a.ModuleType,RelType:a.RelType}}),f={height:"493",width:"600",inHeight:"410",title:a._i18n.operationToolbar.btnBindObject,timeColse:null,year:d.StartDate&&d.StartDate.split(".")[0]||(new Date).getFullYear(),ModuleList:e,UserId:b.OwnerInfo.UserId,AssessmentId:d.Id,Id:d.Id,CurrentStepIndex:b.CurrentStepIndex,WorkflowStepList:b.WorkflowStepList},g=_.getPopUrl("copyGoalFromObject","copyGoalFromObject"+d.Id);window.iTalentSDK.showPopup(g,601,494,f)},copyFromGoal:function(b){var c=this;c._operationClassForWeightBtn();var d=7==b.moduleType?"isMbo":"",e=c.moduleModel.get("mode");b.result&&a.app.request("Target:addFromGoalManagement",b).done(function(a){a.Result>0&&(c.watchAll=!1,e="quickScore"==e?"simple":e,e="weightChange"==e?"simple":e,c.moduleModel.set("mode",e),c.refreshModule(d),$(".btnOpenAll").text(c._i18n.operationToolbar.btnOpenAll))})},_getModuleList:function(a){var b=[];return $(a.ModuleList).each(function(a,c){1==c.FieldRight.Property&&"0"==c.ModuleType&&b.push(c)}),b},copyFromObjectManagement:function(){var a=this,b=a.model.toJSON(),c=b.ModuleList,d=b.Assessment;a._operationClassForWeightBtn();var e=_.map(c,function(a){return{Id:a.Id,Name:a.Name,FieldRight:a.FieldRight,RelType:a.RelType,ModuleType:a.ModuleType}}),f={height:"473",width:"600",inHeight:"385",timeColse:null,endDate:d.EndDate,startDate:d.StartDate,ModuleList:e,UserId:b.OwnerInfo.UserId,AssessmentId:d.Id,Id:d.Id},g=_.getPopUrl("copyGoal","copyGoalDialog");window.iTalentSDK.showPopup(g,601,475,f)},copyGoal:function(b){var c=this,d=c.moduleModel.get("mode");b.result&&(a.inItalent&&window.iTalentSDK.sendMessage({publishEvent:t("ASSESSMENT_COPYGOAL_CANCEL",this.model.get("Assessment").Id),data:null}),0==b.submittype?a.app.request("Target:copyFromGoalLib",b).done(function(a){a.Result>0&&(c.watchAll=!1,$(".btnOpenAll").text(c._i18n.operationToolbar.btnOpenAll),d="quickScore"==d?"simple":d,d="weightChange"==d?"simple":d,c.moduleModel.set("mode",d),c.refreshModule())}):a.app.request("Target:addCopy",b).done(function(a){a.Result>0&&(c.watchAll=!1,$(".btnOpenAll").text(c._i18n.operationToolbar.btnOpenAll),d="quickScore"==d?"simple":d,d="weightChange"==d?"simple":d,c.moduleModel.set("mode",d),c.refreshModule())}))},renderTopView:function(a){var b=this,c=a.Assessment||{},d=a.OwnerInfo||{};b.refreshLinkCaretView(d,c,a)},refreshLinkCaretView:function(b,c,d){var e=this;e.topView=new g({model:new a.Model({OwnerInfo:b,Assessment:c,ItemCanEdit:e.model.get("ItemCanEdit"),I360Link:d.I360Link,Show360Link:d.Show360Link})}),$(e.ui.top_region).html(e.topView.render().el)},refreshOperationView:function(a){var b=this;a||(a=b.model.toJSON()),b.assessmentOperateView=new i({ModuleList:a.ModuleList,CurrentStepTypeId:a.CurrentStepTypeId,HasTask:a.Assessment.HasTask,Status:a.Assessment.Status,HasGoal:a.HasGoal,QuickEstimate:a.QuickEstimate,BatchWeightChange:a.BatchWeightChange}),b.listenTo(b.assessmentOperateView,"newAdd",b.addDetailItem),b.listenTo(b.assessmentOperateView,"bindObject",b.btnBindObject),b.listenTo(b.assessmentOperateView,"copyFromObjectManagement",b.copyFromObjectManagement),b.listenTo(b.assessmentOperateView,"weightChange",b.WeightChange),b.listenTo(b.assessmentOperateView,"btnOpenAll",b.btnOpenAll),b.listenTo(b.assessmentOperateView,"ScoreQuick",b.ScoreQuick),b.listenTo(b.assessmentOperateView,"btnFeedBack",b.btnFeedBack),$(b.ui.assessment_operate).html(b.assessmentOperateView.render().el)},refreshAssessmentCountInfo:function(a){var b=this,c=this.model.toJSON();b.acitView=new o({stepScopreList:a,OwnerInfo:c.OwnerInfo}),_.each(c.WorkflowStepScoreList,function(a){1==a.ScoreShow&&b.safeHtml(b.$("div.assessment-count-region"),b.acitView.render().el)})},refreshUserInfo:function(b){var c=this;b||(b=c.model.toJSON()),c.userInfoModel.set({UserInfo:b.OwnerInfo,CurrentStepUserId:b.CurrentStepUserId,CurrentStepTypeId:b.CurrentStepTypeId,AppraiserInfo:b.AppraiserInfo,Assessment:b.Assessment,loginUserId:a.Context.getUserInfo().UserId,ModuleList:b.ModuleList,i18n:c.model.get("i18n")}),c.userInfoItem=new f({model:c.userInfoModel}),this.listenTo(this.userInfoItem,"refreshPage",function(){c.watchAll=!1,c.render()}),$(c.ui.userInfo_region).html(c.userInfoItem.render().el)},refreshWorkFlow:function(a){var b=this;a||(a=b.model.toJSON()),b.workflowModel.set({workflowList:a.AssessmentSteps,currentIndex:a.CurrentStepIndex,Status:a.Assessment.Status}),this.workFlowCompositeView=new h({model:b.workflowModel}),$(this.ui.work_flow_region).html(this.workFlowCompositeView.render().el)},refreshModule:function(b){var c=this,d=c.model.toJSON();this.$el.find(".module-list").append(_.loading(!1)),a.app.request("Assessment:getDetailList",{assessmentId:d.Assessment.Id,UserId:d.OwnerInfo.UserId,iscontaincollect:!0}).done(function(a){var d=a.Data,e=d.ScoreLevelOptions;c.moduleModel.set("ModuleList",a.Data.Module),c.model.set({ScoreLevelOptions:a.Data.ScoreLevelOptions,ModuleList:a.Data.Module,WorkflowStepScoreList:a.Data.WorkflowScoreList}),c.refreshAssessmentCountInfo(a.Data.WorkflowScoreList),_.each(d.Module,function(a){_.each(a.GoalList,function(a){var b=a.ScoreLevelId;0==a.ScoreType?_.each(e.ScoreOptions,function(c){c.Id==b&&(a.ScoreLevelOptions=c.ScoreLevelOptions,a.TargetScoreLevels=null)}):_.each(e.ScoreLevels,function(c){c.Id==b&&(a.ScoreLevelOptions=c,a.TargetScoreLevels=c)})})}),c.model.set("ModuleList",d.Module),c.moduleModel.set("ModuleList",d.Module),"isMbo"===b&&c.refreshOverView();var f=c.moduleModel.get("mode");c.refreshModuleList(f),c.refreshLargeWeightModuleList()})},refreshModuleList:function(a){this._mode=a;var b=this,c=[],d=[],e=this.model.toJSON();_.each(e.ModuleList,function(a){a.OrderIndex>2e8?d.push(a):c.push(a)}),b.moduleModel.set({ModuleList:c,LargeWeightModuleList:d,CurrentStepTypeId:e.CurrentStepTypeId,CurrentStepId:e.Assessment.CurrentStepId,CurrentStepUserId:e.CurrentStepUserId,CurrentStepIndex:e.CurrentStepIndex,Assessment:e.Assessment,ScoreLevelSettings:e.ScoreLevelSettings,ScoreLevelOptions:e.ScoreLevelOptions,UserInfo:e.OwnerInfo,WorkflowStepList:e.WorkflowStepList,ScoreMethod:e.ScoreMethod}),b._getGoalCount(e.ModuleList.Module||e.ModuleList,0),b.safeHtml(b.ui.assessment_commit_region)(b.assessment_operation_tpl(b.model.toJSON())),b.safeHtml(b.ui.assessment_warn)(b.assessment_warn_tpl(b.model.toJSON())),this.$(".assessment-count-info").show(),b.moduleModel.set("mode",a),b.moduleListView=new j({model:b.moduleModel}),this.listenTo(this.moduleListView,"listChange",this.moduleListChange),this.listenTo(this.moduleListView,"quickAddItem",this._operationClassForWeightBtn),this.listenTo(this.moduleListView,"addSubSave",this.addSubGoal),this.listenTo(this.moduleListView,"customModuleChange",this.refreshModule),this.ui.moduleListArea.html(b.moduleListView.render().el)},_getGoalCount:function(a,b){return _.reduce(a||[],function(a,b){return a+b.GoalList.length+(b.AssessorCustomItemList?b.AssessorCustomItemList.length:0)},b)},moduleListChange:function(a){var b=this,c=this.model.toJSON(),d=b.moduleModel.get("mode");if(d="quickScore"==d?"simple":d,d="weightChange"==d?"simple":d,b.moduleModel.set("mode",d),b.watchAll=!1,void 0!==a.TotalScore&&(this.refreshCountList(),c.OverviewModule&&a.TotalScore!==Number(c.OverviewModule.RateScore))){var e=b.overModel.get("OverviewModule");e.RateScore=String(a.TotalScore),""==a.TotalScore&&(e.OverviewStatus="add"),e.ModifyAssessmentClass=c.OverviewModule.ModifyAssessmentClass,b.model.set("OverviewModule",e),e.forceRender={force:!0,uid:_.uniqueId("tms_performance")},b.overModel.set({forceRender:{force:!0,uid:_.uniqueId("tms_performance")},OverviewModule:e})}if(b.model.set("Assessment",a.Assessment),a.WorkflowStepScoreList&&a.WorkflowStepScoreList.length>0&&(_.each(c.WorkflowStepScoreList,function(c,d){var e=_.find(a.WorkflowStepScoreList,function(a){return c.WorkFlowStepId==a.WorkFlowStepId});e&&c.Score!=e.Score&&b.renderRightView(),e&&(c.Score=e.Score)}),c.WorkflowStepScoreList.sort(function(a,b){return a.OrderIndex-b.OrderIndex>0}),b.model.set("WorkflowStepScoreList",c.WorkflowStepScoreList),b.refreshAssessmentCountInfo(c.WorkflowStepScoreList)),a.GoalChangeModule&&"delete"!=a.doType)this.refreshModule();else{b.model.set("ModuleList",a.ModuleList);var f=0;$(a.ModuleList).each(function(a,b){f+=b.GoalList.length}),0==f||this.$el.find(".assessment-operation .btn-commit,.assessment-operation .btn-reback").show()}},refreshCountList:function(a){var b=this;a||(a=this.model.toJSON()),b.refreshAssessmentCountInfo(a.WorkflowStepScoreList)},refreshLargeWeightModuleList:function(a){var b=this,c=b.moduleModel.get("LargeWeightModuleList");b.safeHtml(b.ui.largeWeightModule,""),a||(a=this.model.toJSON()),a.SignModule&&c.push(a.SignModule),a.OverviewModule&&c.push(a.OverviewModule),c.sort(function(a,b){return a.OrderIndex-b.OrderIndex}),_.each(c,function(c){if(6==c.ModuleType){var d=[c],e=b.moduleModel.clone();e.set({ModuleList:d}),b.targetCustomItemView=new j({model:e}),b.ui.largeWeightModule.append(b.targetCustomItemView.render().el),b.listenTo(b.targetCustomItemView,"customModuleChange",b.refreshModule)}else 2==c.ModuleType?b.refreshOverView(a):3==c.ModuleType&&b.refreshSignConfirm(a)})},refreshSignConfirm:function(b){var c=this;b||(b=this.model.toJSON());var d=b.SignModule;if(d){if((d.SignInfos||[]).length<1)return;c.signConfirmModel.set({loginUserId:a.Context.getUserInfo().UserId,SignModule:d,CurrentStepUserId:b.CurrentStepUserId,UserInfo:b.OwnerInfo,Assessment:b.Assessment}),this.signConfirmView=new k({model:c.signConfirmModel}),this.listenTo(this.signConfirmView,"SignModuleChange",this.changeSignData),c.ui.largeWeightModule.append(c.signConfirmView.render().el)}},changeSignData:function(a){this.model.set("SignModule",a),this.signConfirmModel.set("SignModule",a)},refreshOverView:function(b){var c=this;b||(b=this.model.toJSON());var d=_.extend({},{overviewModule:c._i18n.overviewModule,common:_.langs("common")});b.OverviewModule&&(c.overModel=new a.Model({OverviewModule:b.OverviewModule,RuleSetting:b.RuleSetting,CurrentStepTypeId:b.CurrentStepTypeId,CurrentStepUserId:b.CurrentStepUserId,loginUserId:b.loginUserId,UserInfo:b.OwnerInfo,Assessment:b.Assessment,ModifyAssessmentClass:b.ModifyAssessmentClass,i18n:d}),this.overViewItem=new l({model:c.overModel,hasRender:!!this.hasRenderOV}),this.listenTo(this.overViewItem,"overviewChange",this.changeOverView),c.ui.largeWeightModule.append(c.overViewItem.render().el),this.hasRenderOV=1)},renderRightView:function(){var b=this,c=b.model.toJSON();if(!c.Assessment.HasTask)return!1;a.Api("Assessment:getMyTasking",{assessmentId:c.assessmentId}).done(function(a){if(0==a.Code)return!1;var d=a.MyUndoneTasking||[],e=a.MyDoneTasking||[];b.allPersonLen=d.length+e.length;var f=a.RatescoreShow||"",g=a.ManagerScoreShow||"",h=a.AssessmentClassNameShow;v.showAssessmentTodo(c,b.allPersonLen)&&(b.model.set({MyUndoneTasking:d,MyDoneTasking:e,allPersonLen:b.allPersonLen,RatescoreShow:f,ManagerScoreShow:g,AssessmentClassNameShow:h}),b.setNextAndPrev(),b.showPersonRange(),$(b.ui.assessment_link_region).html(b.assessment_link_tpl(b.model.toJSON())))})},changeOverView:function(a){var b=this;b.model.set({OverviewStatus:a.OverviewStatus,OverviewShowgrade:a.OverviewShowgrade}),b.overModel.set("OverviewShowgrade",a.OverviewShowgrade),a.SaveOverview&&(b.model.set("OverviewModule",a.OverviewModule),b.overModel.set("OverviewModule",a.OverviewModule),b.allPersonLen>0&&b.renderRightView())},showPersonRange:function(){this.personRangeView=new m(this.model.toJSON()),a.$(this.ui.right_container_region).html(this.personRangeView.render().el)},showFeed:function(){var a=this;a.feedItemView=new FeedItemView({model:a.model}),$(a.ui.ps_details_container).html(a.feedItemView.render().el)},_backHomePage:function(a){var b=this.model.toJSON(),c=BSGlobal.tenantInfo.Id,d="Url/Routing?ver=1&msgType=52&user="+c+"_"+b.loginUserId;top.location.href=d},doneToUnauthorize:function(){localStorage.setItem("authorize","1"),location.href="#unauthorize"},onRender:function(){var b=this,c=b.model.toJSON(),d=!!cacheContainer.get("InIframe");if(void 0===c.assessmentId||void 0===c.userId)return this._backHomePage(),!1;var e=new r;b.$el.append(e.render().el);var f=cacheContainer.get("InIframe")?{assessmentId:c.assessmentId,UserId:c.userId,fromType:3,iscontaincollect:!0}:{assessmentId:c.assessmentId,UserId:c.userId,iscontaincollect:!0};a.app.request("Assessment:getAssessmentDetail",{assessmentId:c.assessmentId,UserId:c.userId,fromType:b.options.queryObject&&b.options.queryObject.fromType}).done(function(c){var g=c.Data;if("Unauthorize"===c.Message)return void(1==b.fromDone?b.doneToUnauthorize():b._backHomePage());if(_.isNull(g.OwnerInfo)||_.isNull(g.Assessment))return void b._backHomePage();var h=g.ModuleList;cacheContainer.set({OwnerId:g.OwnerInfo.UserId,AssessmentId:g.Assessment.Id}),a.app.request("Assessment:getModuleList",f).done(function(c){var f=c.Data;_.each(h,function(a){_.each(a.GoalList,function(a,b){var c=_.findWhere(f,{Id:a.Id})||{};_.extend(a,c)})});var i,j,k=g.Assessment,l=g.WorkflowStepList,m=k.CurrentStepId,n=_.findWhere(l,{Id:m});n&&(i=n.StepType,j=n.StepIndex),4!=g.Assessment.Status&&2!=g.Assessment.Status||(i=100,j=100),_.extend(g,{CurrentStepTypeId:i,CurrentStepIndex:j,HasTask:k.HasTask}),cacheContainer.set("OwnerId",g.OwnerInfo.UserId),cacheContainer.set("AssessmentId",g.Assessment.Id),cacheContainer.set("HasTask",g.Assessment.HasTask),b.model.set(g),b.signConfirmModel.set("signModule",g.SignModule),a.app.vent.on("resetPageDataMoudleList",function(a,c){var d=b.model.get("ModuleList")||[];d[c]&&(d[c].GoalList=a),b.model.set("ModuleList",d)}),cacheContainer.get("InIframe")||(b.PullScreen=p.PullScreenView({status:"iframe"}),b.$el.append(b.PullScreen.render().el),b.listenTo(b.PullScreen,"closed",b.pullClose)),cacheContainer.get("InIframe")&&($(".assessment-page-container").css({"margin-right":"0px"}),$("html").css({"overflow-y":"hidden"})),cacheContainer.get("InIframe")?b.$(".assessment-operation").hide():(b.renderTopView(g),b.refreshUserInfo(g),b.refreshWorkFlow(g),b.renderRightView()),b.refreshOperationView(g),5==b.model.get("CurrentStepTypeId")&&b.model.get("HasTask")&&!b.model.get("InIframe")?b.refreshModuleList("simple"):b.refreshModuleList("all"),b.refreshCountList(g),b.refreshLargeWeightModuleList(g),b.$(".perform-detail").show(),$(".tipso_bubble").remove(),$(".assessment-operate").pin({InIframe:d}),e.close(),a.inItalent&&(window.iTalentSDK.register({listenEvent:t("ASSESSMENT_ANDGOAL_OK",g.Assessment.Id),cb:_.bind(b.addGoal,b)}),window.iTalentSDK.register({listenEvent:t("ASSESSMENT_ADDSUBGOAL_OK",g.Assessment.Id),cb:_.bind(b.addSubGoal,b)}),window.iTalentSDK.register({listenEvent:t("ASSESSMENT_COPYGOAL_OK",g.Assessment.Id),cb:_.bind(b.copyGoal,b)}),window.iTalentSDK.register({listenEvent:t("ASSESSMENT_CHECKWEIGHT_OK",g.Assessment.Id),cb:_.bind(b.checkWeight,b)}),window.iTalentSDK.register({listenEvent:t("ASSESSMENT_COPYGOALFROMOBJECT_OK",g.Assessment.Id),cb:_.bind(b.copyFromGoal,b)}))})}),$(".grade-item").tipsy({gravity:"s"}),cacheContainer.get("InIframe")&&(this.iframeTimer=setInterval(function(){var a=window.document.body.offsetHeight;cacheContainer.set("docHeight",a),window.parent.postMessage(a,"*")},500))},checkWeight:function(a){var b=this;if(!a||0==a.result)return!1;_.scrollTopAnimate(),b._operationClassForWeightBtn(!0)},setNextAndPrev:function(){var a=this.model.get("MyUndoneTasking")||[],b=this.model.get("MyDoneTasking")||[],c=this.model.get("userId"),d=this._getEvaluationUserIndexById(a,c)>-1,e=!1,f=!1,g=b.concat(a),h="javascript:void(0)",i="javascript:void(0)",j="javascript:void(0)",k=this._getEvaluationUserIndexById(g,c),l=this._getEvaluationUserIndexById(b,c),m=this._getEvaluationUserIndexById(a,c);k>0&&(f=!0),k>=0&&k<g.length-1&&(e=!0);var n={};d?(f&&(h=0==m?"#assessment?assessmentId="+b[b.length-1].AssessmentId+"&userId="+b[b.length-1].OwnerId:"#assessment?assessmentId="+a[m-1].AssessmentId+"&userId="+a[m-1].OwnerId),e&&(i="#assessment?assessmentId="+a[m+1].AssessmentId+"&userId="+a[m+1].OwnerId)):(f&&(h="#assessment?assessmentId="+b[l-1].AssessmentId+"&userId="+b[l-1].OwnerId),e&&(n=a.length>0?a[0]:b[l+1],i="#assessment?assessmentId="+n.AssessmentId+"&userId="+n.OwnerId)),a&&a.length>0&&(j="#assessment?assessmentId="+a[0].AssessmentId+"&userId="+a[0].OwnerId),0==a.length&&b.length>0&&(j="#assessment?assessmentId="+b[0].AssessmentId+"&userId="+b[0].OwnerId),this.model.set({nextLink:i,prevLink:h,topLink:j,showNext:e,showPrev:f})},_getEvaluationUserIndexById:function(a,b){return _.indexOf(_.pluck(a,"OwnerId"),Number(b))},pullClose:function(b){var c=this;c.targetId||(c.targetId=this.$("#"+c.taskId).parents(".target-item").find(".target-title").attr("data-id")),a.app.vent.trigger("pullClose",this.targetId)},onShow:function(){var b=this.model.toJSON(),c=b.loginUserId!=b.userId?"#team":"#myhome";a.app.vent.trigger("sidebar-view:click",c),_.splash("assessment")},onClose:function(){a.$("body").find(".tipso_bubble").remove(),a.app.vent.off("showContent"),a.app.vent.off("pullClose"),this.workFlowCompositeView=null,this.iframeTimer=null}});return _.extend(x.prototype,s),a.BasePageView.extend({mainViewClass:x,layout:top===self?"master-layout":"empty-layout",pageTitle:_.langs("assessment","pageTitle"),hideSidebar:!1,highlightSidebar:"#home"})});
